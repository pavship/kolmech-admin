{"version":3,"sources":["serviceWorker.js","constants.js","apollo/defaults.js","graphql/layout.js","graphql/order.js","graphql/doc.js","graphql/status.js","graphql/file.js","graphql/drawing.js","graphql/model.js","graphql/enquiry.js","graphql/lists.js","apollo/resolvers.js","apollo/apollo.js","components/styled/styled-semantic.js","components/notifications/Notification.js","components/notifications/Notifications.js","components/notifications/NotificationsContext.js","graphql/disk.js","components/context/DiskContext.js","utils/jwtHelper.js","components/hooks/apolloHooks.js","graphql/account.js","graphql/user.js","components/auth/LoginPage.js","components/auth/AuthContext.js","components/context/UserContext.js","components/Menu.js","components/context/GlobalContext.js","components/Enquiry/EnquiriesSubmenu.js","components/Enquiry/EnquiriesMenu.js","components/common/Table.js","utils/format.js","components/common/TableRow.js","utils/object.js","components/Enquiry/EnquiriesTable.js","components/DetailsOld/DetailsDataProvider.js","components/DetailsOld/DetailsHeaderContainer.js","components/DetailsOld/DetailsHeaderSubitle.js","components/DetailsOld/DetailsHeaderTitle.js","components/DetailsOld/DetailsHeaderButtons.js","components/common/RefreshButton.js","components/DetailsOld/DetailsMainHeader.js","components/styled/entity-table.js","components/common/DraftEditor.js","components/common/WrappedDraftEditor.js","utils/validateInn.js","utils/dates.js","graphql/opType.js","graphql/org.js","graphql/combinedQueries.js","components/common/DatePicker.js","components/presentational/SecondarySection.js","components/form/utils.js","schema/commonTypes.js","schema/model.js","components/form/FormikCurrency.js","components/form/FormikInput.js","components/form/FormikTel.js","components/form/FormikField.js","components/Model/Form.js","components/Enquiry/Edit.js","components/common/LocalDatePicker.js","components/common/CurrencyInput.js","components/common/SmartForm.js","components/Enquiry/EnquiryCommercialOffer.js","components/Enquiry/EnquiryDetails.js","components/common/SmartInput.js","components/Order/OrderEdit.js","components/DetailsOld/DetailsHeader.js","components/presentational/CollapsableSection.js","components/Order/ProdsByDept.js","components/Order/DeptProdTable.js","components/Order/ReserveProdsButton.js","graphql/prod.js","components/context/ProdContext.js","components/Order/ModelProdsSection.js","components/Order/OrderDetails.js","components/Model/Details/Drawings/Drawing.js","components/Model/Details/Drawings/Sortable.js","components/Model/Details/Drawings/SortedCollectionProvider.js","components/context/StatefulList.js","components/context/StatefulBool.js","components/Model/Details/Drawings.js","components/Model/Details.js","components/DetailsOld/Details.js","components/Order/ProdTableUtils.js","components/context/ListProvider.js","components/context/OrderContext.js","components/DetailsOld/DetailsExtra.js","components/DetailsOld/DetailsSidebar.js","components/common/PanelPusher.js","graphql/tel.js","graphql/person.js","graphql/employee.js","components/Employee/PanelHeader.js","components/list/Tel.js","components/list/Field.js","components/list/List.js","schema/tel.js","schema/person.js","schema/employee.js","components/Employee/Details.js","components/Employee/Form.js","components/Employee/Edit.js","components/Employee/Table.js","components/Enquiry/EnquiriesBottomPanel.js","components/Enquiry/EnquiriesPage.js","graphql/article.js","graphql/mpProject.js","graphql/mdKontragent.js","graphql/payment.js","components/Payments/Chart.js","graphql/amo.js","schema/payment.js","components/Payments/Form.js","components/Payments/Stats.js","components/Payments/Table.js","graphql/tochka.js","components/Payments/Page.js","graphql/dealStatus.js","graphql/bpStat.js","graphql/exec.js","graphql/task.js","graphql/appoint.js","graphql/op.js","graphql/proc.js","graphql/element.js","graphql/workpiece.js","graphql/batch.js","graphql/deal.js","components/Deals/context/Context.js","components/Details/Menu/LeftIcon.js","components/Details/Menu/Menu.js","components/Org/Details/InnForm.js","components/Org/Details/Requisites.js","components/common/HtmlDatePicker.js","components/common/HtmlInput.js","components/common/HtmlTextArea.js","components/common/HtmlSelect.js","components/form/Field.js","components/Org/Details/Contract.js","components/Org/Details/Details.js","components/Batch/Details.js","components/Deals/Details/Details.js","components/ComOffer/CreateComOfferDetails.js","components/Task/CreateTaskDetails.js","components/hooks/useUpsert.js","components/Exec/SelectExecDetails.js","components/Task/Controls.js","components/Task/TaskListItem.js","components/Task/NewTask.js","components/Task/TasksDetails.js","components/Details/Provider.js","components/Deals/TableCells/DropdownMenu.js","components/Deals/TableCells/Org.js","components/Deals/TableCells/Model.js","components/Deals/TableCells/Qty.js","components/Deals/TableCells/BpStat/Stat.js","components/Deals/TableCells/BpStat/BpStat.js","components/Deals/TableCells/Proc.js","components/Deals/TableCells/Op/OpType.js","components/Deals/TableCells/Op/DealLabour.js","components/Deals/TableCells/Exec/Name.js","components/Deals/Task/Task.js","components/Deals/TableCells/Appoint/Appoint.js","components/Deals/TableCells/Op/Op.js","components/Deals/TableCells/Op/Ops.js","components/Deals/TableCells/Element/Element.js","components/Deals/TableCells/Element/NewElement.js","components/Deals/TableCells/Element/Elements.js","components/Deals/TableCells/Batch.js","components/Deals/TableCells/Batches.js","components/Deals/TableCells/Deal.js","components/Deals/Row.js","components/hooks/useTraceUpdate.js","components/Deals/Table.js","components/Deals/Menu.js","components/Deals/Timeline/Timeline.js","components/Deals/Timeline/Plot/Header.js","components/Deals/Timeline/Plot/Plot.js","components/Deals/Page.js","components/Root.js","index.js","App.js"],"names":["Boolean","window","location","hostname","match","AUTH_TOKEN","defaults","newEnquiry","__typename","id","layout","details","extra","bottomPanel","lists","selectedProdIds","getLayout","gql","_templateObject","getLayoutOptions","props","_ref","data","setLayout","_templateObject2","setExpanded","_templateObject3","orderFragmentBasic","order_templateObject","orderFragmentFull","order_templateObject2","upsertOrder","order_templateObject3","orderLocal","_templateObject4","orderDetails","_templateObject5","reserveProds","_templateObject6","docFragmentBasic","doc_templateObject","statusFragment","status_templateObject","fileFragmentFull","file_templateObject","drawingFragmentBasic","drawing_templateObject","drawingFragmentFull","drawing_templateObject2","createDrawings","drawing_templateObject3","deleteDrawings","drawing_templateObject4","setDrawingsSortOrder","drawing_templateObject5","modelFragmentBasic","model_templateObject","modelFragmentWithDrawings","model_templateObject2","modelFragmentFull","model_templateObject3","modelLocal","model_templateObject4","modelDetails","model_templateObject5","upsertModel","model_templateObject6","enquiryFragmentBasic","enquiry_templateObject","allEnquiries","enquiry_templateObject2","enquiryDetails","enquiry_templateObject3","enquiryLocal","enquiry_templateObject4","enquiry_templateObject5","createEnquiry","enquiry_templateObject6","updateEnquiry","_templateObject7","createEnquiryEvent","_templateObject8","enquiryFragment","_templateObject9","getLists","lists_templateObject","setList","lists_templateObject2","resolvers","Enquiry","isExpanded","Mutation","_","_ref2","input","cache","query","readQuery","Object","objectSpread","cloneDeep","writeQuery","_ref3","_ref4","_ref3$args","args","enquiryId","value","enquiries","find","e","_ref5","_ref6","name","InMemoryCache","dataIdFromObject","object","defaultDataIdFromObject","cacheRedirects","Query","dealLocal","getCacheKey","orgLocal","prodsLocal","ids","map","authMiddleware","ApolloLink","operation","forward","token","localStorage","getItem","setContext","_ref7","_ref7$headers","headers","Authorization","concat","client","ApolloClient","link","from","onError","_ref8","graphQLErrors","networkError","console","log","message","setItem","removeItem","resetStore","withClientState","createUploadLink","uri","theme","widths","formLabel","detailsPL","extraSidebar","colors","green","blue","error","errorBorder","getThemeColor","color","baseSet","bt","bb","bc","bl","br","bs","bsh","c","cur","d","f","fl","fs","fw","h","l","lh","mw","minw","m","mb","mt","ml","mr","o","ov","ox","oy","p","pb","pe","pos","pl","pr","pt","t","tr","ta","to","v","va","w","whs","ws","z","Div","styled","inline","rest","objectWithoutProperties","react_default","a","createElement","styled_semantic_templateObject","P","esm_extends","styled_semantic_templateObject2","Span","styled_semantic_templateObject3","A","styled_semantic_templateObject4","cancel","Header","styled_semantic_templateObject5","Icon","active","activeColor","selectMode","disabled","onClick","assign","undefined","styled_semantic_templateObject6","Caret","styled_semantic_templateObject7","size","Button","menu","styled_semantic_templateObject8","Message","_ref9","section","styled_semantic_templateObject9","SectionPropFiltered","React","forwardRef","_ref10","ref","head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","Section","_templateObject10","Popup","_ref11","showIf","_templateObject11","Label","label","_templateObject12","InputPropFilter","_ref12","Ref","innerRef","Input","_templateObject13","SDropdown","_templateObject14","_ref13","Form","Field","_templateObject15","Notification","_ref$message","type","title","content","timerId","dismissNotification","cancelAutoDismiss","styled_semantic_Message","compact","icon","header","info","success","warning","onDismiss","onMouseEnter","NotificationsHolder","div","Notifications_templateObject","PosedItem","posed","boobl","y","opacity","enter","exit","x","Notifications","messages","reactDom","createPortal","react_pose_es","animateOnMount","preEnterPose","key","initialPose","document","getElementById","NotificationsContext","createContext","NotificationsProvider","_useState","useState","_useState2","slicedToArray","setMessages","create","cuid","setTimeout","dismiss","produce","draft","push","messageId","splice","findIndex","providerValue","useMemo","notify","Provider","clearTimeout","NotificationsConsumer","Consumer","PureChild","memo","useNotifications","useContext","useCallback","msg","highlightFolder","disk_templateObject","DiskContext","DiskProvider","react_components_esm","mutation","orgId","dealId","variables","isTokenExpired","date","decoded","decode","exp","Date","setUTCSeconds","getTokenExpirationDate","valueOf","offsetSeconds","useQuery","arguments","length","errMsg","options","useApolloQuery","err","useMutation","onCompleted","successMsg","mark","useApolloMutation","res","accountFragmentBasic","account_templateObject","accountFragmentFull","account_templateObject2","accounts","account_templateObject3","userFragmentBasic","user_templateObject","me","user_templateObject2","meLocal","user_templateObject3","login","user_templateObject4","MenuDiv","LoginPage_templateObject","MenuHeader","LoginPage_templateObject2","SSegment","Segment","LoginPage_templateObject3","LoginPage","refreshToken","email","setEmail","_useState3","_useState4","password","setPassword","_useMutation","lQ","_useMutation2","_useMutation2$","loading","Fragment","basic","placeholder","onChange","target","primary","floated","asyncToGenerator","regenerator_default","_callee","wrap","_context","prev","next","sent","stop","AuthContext","AuthProvider","apolloClient","setToken","useEffect","bootStrapData","UserContext","Container","Menu_templateObject","components_Menu","titleLinkTo","Link","preventDefault","styled_semantic_Header","_data$me$person","person","fName","lName","amoName","menuNameTitle","split","compose","graphql","_ref$layout","setDetails","setExtra","setBottomPanel","setSelectedProdIds","SubmenuDiv","EnquiriesSubmenu_templateObject","context_GlobalContext","_ref$details","_data$enquiryLocal","num","addNewOrderForbidden","docs","some","styled_semantic_Popup","position","flowing","trigger","styled_semantic_Button","circular","Content","EnquiriesMenu","refetchEnquiries","enquiriesAreLoading","Enquiry_EnquiriesSubmenu","STable","table","Table_templateObject","TableHeaderRow","Table_templateObject2","noTopBorder","Td","td","Table_templateObject3","TBody","tbody","Table_templateObject4","Table","fields","expand","indent","noServiceField","modes","select","fieldsExtended","toConsumableArray","width","className","react","tableFields","field","formatTel","number","country","conformToMask","guide","conformedValue","currency","trailing","curNum","toFixed","replace","slice","isNaN","Number","Row","TableRow_templateObject","noRowHover","lightRowHower","lineHeight","lastSecondaryRow","bold","tdActiveStyle","TableRow_templateObject2","service","hoverable","hideUnhovered","hasEntries","truncated","Untruncated","TableRow_templateObject3","TableRow","_props$rowFields","rowFields","entity","expandFor","expanded","rowField","rf","selected","TableRow_Row","TableRow_Td","stopPropagation","component","path","iconColor","val","obj","pathArr","i","getObjProp","EnquiriesTable","common_Table","enquiry","org","model","orders","common_TableRow","amount","employees","drawings","styled_semantic_Icon","reduce","prods","order","skip","query1","query2","query3","localQuery1","localQuery2","localQuery3","localQuery","refetch","localEntity","SIcon","DetailsHeaderContainer_templateObject","SCaret","DetailsHeaderContainer_templateObject2","close","DetailsHeaderSubitle","DetailsHeaderTitle","subtitle","DetailsOld_DetailsHeaderSubitle","DetailsHeaderButtons","SButton","RefreshButton_templateObject","RefreshButton","settings","titleNew","titleExisting","Order","Model","DetailsMainHeader","closeDetails","refresh","editMode","fullnum","article","dateLocal","DetailsHeaderContainer","DetailsOld_DetailsHeaderTitle","DetailsOld_DetailsHeaderButtons","common_RefreshButton","entity_table_templateObject","Tr","entity_table_templateObject2","entity_table_templateObject3","InputTd","entity_table_templateObject4","EditorTd","entity_table_templateObject5","DraftEditor","_this","editorState","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","setState","newContent","getCurrentContent","_this$props","setEditorHasText","setEditorDiff","setHasFocus","hasText","state","oriContent","getSelection","getHasFocus","kolmechKeyBindingFn","keyCode","KeyBindingUtil","hasCommandModifier","getDefaultKeyBinding","handleKeyCommand","command","onCtrlEnter","newState","RichUtils","clear","EditorState","ContentState","createFromText","exportHtml","html","stateToHTML","convertFromHTML","contentBlocks","initFromHtml","blocksFromHTML","createWithContent","createFromBlockArray","entityMap","createEmpty","Draft","keyBindingFn","readOnly","Component","EditorWrapper","WrappedDraftEditor_templateObject","borderless","hasFocus","diff","WrappedDraftEditor","forwardedRef","common_DraftEditor","WrappedDraftEditor_WrappedDraftEditor","validateInn","inn","result","toString","test","code","indexOf","checkDigit","coefficients","n","parseInt","n11","n12","isValidDate","isValidDateString","dateString","parse","tz","getTimezoneOffset","toLocalISOString","getTime","toISOString","toLocalDateString","toLocalDatetimeString","fromLocalISOString","string","opTypeFragmentBasic","opType_templateObject","orgFragmentBasic","org_templateObject","orgFragmentFull","org_templateObject2","orgExecFragment","org_templateObject3","createContract","org_templateObject4","org_templateObject5","org_templateObject6","createPostEnvelopeAddressInsert","org_templateObject7","createOrg","org_templateObject8","mergeOrg","org_templateObject9","org_templateObject10","orgDetails","org_templateObject11","upsertOrgExec","org_templateObject12","allOrgsAndModels","combinedQueries_templateObject","PickerDiv","DatePicker_templateObject","DatePicker","selectedDate","selectDay","inputRef","useRef","setDate","setInput","_useState5","_useState6","setErr","DayPickerInput_default","onDayChange","current","onDayPickerHide","dayPickerProps","firstDayOfWeek","month","SecondarySection","onClose","projectEntity","schema","handleObj","preparePayload","values","initialValues","handlePayloadObj","objSchema","keys","forEach","k","Array","isArray","handleArr","endsWith","arrSchema","arr","resultArr","initialObj","handlePayloadArr","initialArr","getStructure","getSkeleton","getArrSkeleton","filter","item","analysePath","acc","dotPos","braketPos","last","closingBraketPos","array","arrayItem","assignNested","preserveKeys","startsWith","produceNested","idValidationType","matches","validationSchema","shape","notRequired","trim","min","max","when","required","formikSchema","FormikCurrency","setField","number_format_default","customInput","decimalSeparator","thousandSeparator","decimalScale","allowNegative","onValueChange","floatValue","FormikInput","formik","getIn","Dropdown","selection","fluid","search","noResultsMessage","setFieldValue","styled_semantic_Input","touched","errors","handleChange","onBlur","handleBlur","connect","countryOtions","text","inputError","FormikTel_templateObject","Error","FormikTel_templateObject2","Tel","baseName","renderDropdown","FormikTel_Dropdown","tabIndex","react_input_mask_default","mask","maskChar","inputProps","form_FormikInput","FormikTel_Error","FormikField_templateObject","FormikField_templateObject2","FormikField_templateObject3","InputContainer","FormikField_templateObject4","FormikField_templateObject5","contentBeforeField","inputLabel","FormikField_Container","FormikField_Label","formik_esm","render","arrayHelpers","FormikTel","FormikField_Error","ModelForm","didMount","_this2","toggleEditMode","refetchQueries","onSubmit","upserted","resetForm","abrupt","_x","_x2","apply","handleSubmit","handleReset","FormikField","Edit_templateObject","EnquiryEdit","closeNewModelSection","newModelMode","changeFieldValue","newVal","_this$setState","fieldObj","curVal","isNewEnquiry","oriVal","includes","defineProperty","pickedDate","handleOrgDropdownSearchChange","searchQuery","orgDdn","handleModelDropdownSearchChange","modelDdn","handleQtyInputChange","selectOrg","selectModel","submitNewModel","modelId","componentIsMounted","t0","submit","_callee2","_context2","_x3","_callee3","_context3","_x4","oriEnquiry","events","qty","requiredFields","_this$state","_this$props2","orgs","models","requiredIsEmpty","someFieldHasError","Edit_Dropdown","selectOnBlur","selectOnNavigation","onSearchChange","allowAdditions","additionLabel","onAddItem","Form_ModelForm","hidden","update","sort","b","unshift","LocalDatePicker_templateObject","LocalDatePicker","handleDayChange","_this$props$field","LocalDatePicker_PickerDiv","CurrencyInput","SmartForm","isNewEntity","oriEntity","formState","EnquiryCommercialOffer","isNewCO","co","common_SmartForm","_ref$formState","common_LocalDatePicker","common_CurrencyInput","Divider","fitted","EnquiryDetails_templateObject","Comments","Comment","Group","EnquiryDetails_templateObject2","CIcon","EnquiryDetails_templateObject3","UserLabel","EnquiryDetails_templateObject4","CContent","EnquiryDetails_templateObject5","CMetadata","Metadata","EnquiryDetails_templateObject6","CText","Text","EnquiryDetails_templateObject7","CMessage","EnquiryDetails_templateObject8","EnquiryDetails","editorRef","createRef","noteEditorRef","editorHasText","noteEditorDiff","noteKey","activeCO","creatingComment","changingStatus","statusPending","savingNote","enableEditMode","exitEditMode","bool","setNoteEditorDiff","cancelEdit","createComment","htmlText","changeStatus","coStatusId","enquiryQuery","statuses","s","statusId","doc","cancelPendingStatusChange","saveNote","htmlNote","coEvents","curStatus","status","pop","rawStatuses","orderStatusId","refusalStatusIds","stage","eventStatusPresentationHelpers","Edit","entity_table_Table","entity_table_Td","_ref6$doc","common_WrappedDraftEditor","labelPosition","labeled","button","Math","abs","detail","Label_Label","Enquiry_EnquiryCommercialOffer","minimal","as","dividing","_e$user$person","user","userInitials","datetimeLocal","dangerouslySetInnerHTML","__html","sanitize","reply","onSave","newEvent","fragment","readFragment","writeFragment","SmartInput","debouncedSetField","debounce","writeVal","handleInputChange","intVal","valueAsNumber","_this$props3","OrderEdit","_ref2$formState","common_SmartInput","upsertedOrder","buttons","titleSize","OuterSection","CollapsableSection_templateObject","PosedDetailsHeader","DetailsHeader","visible","invisible","InnerSection","CollapsableSection_templateObject2","CollapsableSection","initiallyExpanded","headerInvisible","forceExpanded","overflowVisible","headerProps","mode","pose","ProdsByDept","oriProds","selectedIds","orderId","selectLimit","_ref$selectedProds","selectedProds","orderProdsQty","expandedIds","limitReached","allProds","unionBy","depts","sortBy","groupBy","dept","count","readyCount","progress","hasDefect","isSpoiled","prod","ordered","added","op","removed","sp","orderedCount","selectedCount","availCount","every","unreservedProdsCount","xor","xorBy","defaultFields","DeptProdTable","_ref$skipFields","skipFields","nameFieldWidth","IconRight","ReserveProdsButton_templateObject","ReserveProdsButton","prodIds","modelProds","prod_templateObject","prod_templateObject2","ModelProdsSection","_ref$order","Order_ReserveProdsButton","context_ProdContext","Order_ProdsByDept","Order_DeptProdTable","OrderDetails","Order_ModelProdsSection","AspectRatioDiv","Drawing_templateObject","proportion","Drawing_templateObject2","ImgSpacer","shrinked","height","fullsize","Image","img","Drawing_templateObject3","Mask","Drawing_templateObject4","hide","off","CheckBox","Drawing_templateObject5","Check","Drawing_templateObject6","SortableElement","_ref2$drawing","drawing","files","toggleSelection","sortMode","oriImage","imgFor","image","Drawing_Container","open","focus","src","SortableContainer","toggleDrawingSelection","selectedDrawings","drw","Drawing","index","SortedCollectionProvider","sortedCollection","move","oldIndex","newIndex","_draft$sortedCollecti","collection","prevPropsCollection","StatefulList","list","toggle","removeMany","items","StatefulBool","enable","disable","DropzoneArea","Drawings_templateObject","DropzoneOverlay","Drawings_templateObject2","MenuOverlay","Drawings_templateObject3","MenuLeftIcon","Drawings_templateObject4","Drawings","sidebarRef","NotificationsContext_NotificationsConsumer","creating","deleting","sorting","SortedCollectionProvider_SortedCollectionProvider","moveDrawing","StatefulList_StatefulList","deselectAllDrawings","deselectManyDrawings","StatefulBool_StatefulBool","enableSortMode","disableSortMode","es","onDrop","acceptedFiles","writeData","collapsableSection","disableClick","accept","onDropRejected","getRootProps","getInputProps","openFileDialog","isDragActive","Loader","reordered","sortOrder","Sortable","onSortEnd","getContainer","Model_Details","Drawings_Drawings","Details_templateObject","Details","_ref2$details","Details_Container","DetailsOld_DetailsDataProvider","DetailsOld_DetailsMainHeader","Enquiry_EnquiryDetails","Order_OrderEdit","Order_OrderDetails","ProdTableUtils","propDepts","newList","without","difference","idsWithinLimit","take","union","ListProvider","DetailsExtra_templateObject","DetailsExtra","closeExtra","DetailsExtra_Container","context_OrderContext","ListProvider_ListProvider","toggleExpanded","Order_ProdTableUtils","SSidebar","Sidebar","DetailsSidebar_templateObject","DetailsSidebar","detailsClosing","_this$props$layout","node","animation","direction","DetailsOld_Details","DetailsOld_DetailsExtra","PanelPusher_templateObject","Main","PanelPusher_templateObject2","Panel","PanelPusher_templateObject3","panelVisible","PanelPusher","panel","panelRendered","PanelPusher_Container","telFragment","tel_templateObject","personFragmentBasic","person_templateObject","personContactsFragment","person_templateObject2","personExecFragment","person_templateObject3","persons","person_templateObject4","upsertPersonExec","person_templateObject5","person_templateObject6","person_templateObject7","orgEmployees","employee_templateObject","upsertEmployee","employee_templateObject2","PanelHeader_templateObject","PanelHeader","closePanel","PanelHeader_MenuDiv","list_Tel","tel","Field_templateObject","Field_templateObject2","Field_templateObject3","list_Field","Field_Container","Field_Label","Field_Content","List","renderObj","schemaKeys","oneOf","default","lazy","transform","join","is","then","otherwise","mName","tels","of","telValidationSchema","personValidationSchema","listSchema","Employee_Details","emp","fullname","EmployeeForm","EmployeeEdit","Form_EmployeeForm","Employee_Table","emps","EmployeesPanelBody","EnquiriesBottomPanel_templateObject","EmployeesPanelTableSection","EnquiriesBottomPanel_templateObject2","EmployeeDetailsSection","EnquiriesBottomPanel_templateObject3","EnquiriesBottomPanel","activeEmp","Edit_EmployeeEdit","_draft$person","Pushable","EnquiriesPage_templateObject","EnquiriesPage","_Component","_getPrototypeOf2","_len","_key","panelClosing","inherits","createClass","_this$props$allEnquir","Enquiry_EnquiriesMenu","DetailsOld_DetailsSidebar","Pusher","PanelPusher_PanelPusher","Enquiry_EnquiriesTable","alias","articleFragmentBasic","article_templateObject","articleFragmentFull","article_templateObject2","mpProjectFragmentBasic","mpProject_templateObject","mpProjectFragmentFull","mpProject_templateObject2","mdKontragentFragmentBasic","mdKontragent_templateObject","createMdKontragent","mdKontragent_templateObject2","paymentFragmentBasic","payment_templateObject","paymentsPage","payment_templateObject2","payment_templateObject3","upsertPayment","payment_templateObject4","Chart_templateObject","Chart","_data$reduce","payments","isLoan","isIncome","arrs","y0","_data$reduce2","positive","negative","total","sum","lineData","reverse","pointIndex","Chart_Container","react_vis_es","margin","left","stackBy","tickFormat","toLocaleDateString","stack","syncWithAmoContacts","amo_templateObject","accountId","articleId","mpProjectId","integer","personId","purpose","Form_templateObject","Form_templateObject2","Fields","Form_templateObject3","labelWidth","CounterpartyFieldSwitch","payment","orgCounterparty","setOrgCounterparty","Payments_Form","accountsQuery","articles","defaultAccountId","mdKontragents","mpProjects","reset","refetchAccounts","accountOptions","articleOptions","rusName","mpProjectOptions","Id","Name","bankPayment","Form_Container","personsLoading","refetchPersons","Form_Header","_cache$readQuery","foundIndex","fetchPolicy","enableReinitialize","Form_CounterpartyFieldSwitch","_ref14","_ref15","orgsLoading","Inn","_ref17","_ref16","existing","created","mdk","_x5","_x6","Stats_templateObject","SStatistic","Statistic","Stats_templateObject2","Stats","userRole","uniquePersons","up","debtsAndLoans","debts","Stats_Container","Value","balance","horizontal","lastIndexOf","Payments_Table_templateObject","PaymentTable","activePayment","onClickEdit","onClickCopy","Table_Container","createdBy","updatedBy","kontragent","account","amoId","mp","syncWithTochkaPayments","tochka_templateObject","Page_templateObject","TopSection","Page_templateObject2","BottomSection","Page_templateObject3","Page","objectDestructuringEmpty","_useContext$me","role","defaultAccount","accountsAvailable","_useQuery","accountsLoading","accountsError","setActivePayment","paymentsLoading","_ref3$data","refetchPayments","matchPath","href","Page_Container","Route","exact","dealStatusFragmentBasic","dealStatus_templateObject","dealStatusFragmentFull","dealStatus_templateObject2","bpStatFragmentBasic","bpStat_templateObject","bpStatFragmentMiddle","bpStat_templateObject2","execFragmentBasic","exec_templateObject","orgsAndPersonsExecs","exec_templateObject2","exec_templateObject3","taskFragmentBasic","task_templateObject","taskFragmentMiddle","task_templateObject2","taskFragmentFull","task_templateObject3","tasksDetails","task_templateObject4","task_templateObject5","upsertTask","task_templateObject6","appointFragmentBasic","appoint_templateObject","appointFragmentMiddle","appoint_templateObject2","upsertAppoint","appoint_templateObject3","appoint_templateObject4","appoint_templateObject5","opFragmentBasic","op_templateObject","opFragmentMiddle","op_templateObject2","opFragmentDetails","op_templateObject3","op_templateObject4","procFragmentBasic","proc_templateObject","procFragmentMiddle","proc_templateObject2","procFragmentDetails","proc_templateObject3","elementFragmentBasic","element_templateObject","elementFragmentMiddle","element_templateObject2","elementFragmentDetails","element_templateObject3","workpieceFragmentBasic","workpiece_templateObject","workpieceFragmentWithDrawings","workpiece_templateObject2","batchFragmentBasic","batch_templateObject","batchFragmentMiddle","batch_templateObject2","batchFragmentDetails","batch_templateObject3","batchDetails","batch_templateObject4","upsertBatch","batch_templateObject5","dealFragmentBasic","deal_templateObject","dealFragmentMiddle","deal_templateObject2","dealsPage","deal_templateObject3","deal_templateObject4","dealDetails","deal_templateObject5","createComOffer","deal_templateObject6","syncDeals","deal_templateObject7","deal_templateObject8","upsertDeal","deal_templateObject9","DealsContext","DealsContextProvider","opTypes","budgetMode","LeftIcon","Menu_Menu_templateObject","Menu","Menu_Container","InnForm","setVal","Requisites","HtmlDatePicker_templateObject","HtmlDatePicker","HtmlDatePicker_Input","HtmlInput_templateObject","propValue","setValue","HtmlInput_Input","onKeyDown","TextArea","textarea","HtmlTextArea_templateObject","HtmlTextArea","debouncedWrite","debouncedOnChange","Select","HtmlSelect_templateObject","_ref$undefinedOptionN","undefinedOptionName","form_Field_templateObject","form_Field_templateObject2","form_Field_templateObject3","Field_templateObject4","Field_templateObject5","form_Field","inputWidth","form_Field_Container","form_Field_Label","form_Field_Content","Field_InputContainer","HtmlTextArea_HtmlTextArea","HtmlSelect","HtmlInput","Field_Error","animated","Contract_templateObject","Contract","createMode","setCreateMode","transitions","useTransition","leave","Contract_MenuOverlay","style","OrgDetails","Menu_Menu","BatchDetails","batchProp","batch","bIndex","batchId","uB","Dimmer","descript","_batch$model","_batch$model$drawings2","drwName","wp","workpiece","_batch$procs$","procs","_batch$procs$$ops","ops","wpName","material","hardness","wpDrwName","batchStructure","opType","opClass","description","opIndex","DealDetails","deal","batches","CreateComOfferDetails","cCO","CreateTaskDetails","appointId","setFrom","setText","uT","useUpsert","objTypeName","mutate","pathsAndValuesArr","useSpecUpsert","_useMutation3","FiltersContainer","SelectExecDetails_templateObject","Lists","SelectExecDetails_templateObject2","ListTitle","h4","SelectExecDetails_templateObject3","ListSubTitle","SelectExecDetails_templateObject4","ListItemContainer","SelectExecDetails_templateObject5","ListItemControl","SelectExecDetails_templateObject6","ListItem","onRemove","SelectExecDetails","opTypeId","searchInput","execId","setExecId","setPerson","setOrg","_useState7","_useState8","setSearch","toLowerCase","sWAC","syncingContacts","_useSpecUpsert","upsertSpecPerson","_useSpecUpsert3","upsertSpecOrg","_partition","partition","exec","ot","_partition2","suitablePersons","otherPersons","_partition3","_partition4","suitableOrgs","otherOrgs","_data","_execId","_data2","_execId2","upsertPerson2","upsertOrg","sub","SelectExecDetails_ListItem","disconnect","Controls_templateObject","ContolsContainer","Controls_templateObject2","TaskControls","taskId","Controls_Container","TaskListItem_templateObject","TaskListItem","_ref$task","task","TaskListItem_Container","NewTask_templateObject","NewTask","useApolloClient","NewTask_Container","tasks","appoint","TasksDetails_templateObject","TasksDetails","upsertAnyAppoint","userExecId","tasksByExec","grouped","isNew","execIds","TasksDetails_ListTitle","draftHandler","transition","ease","Provider_templateObject","DetailsContext","DetailsProvider","Provider_Sidebar","MenuButton","DropdownMenu_templateObject","DropdownMenu","Org_templateObject","Title","Org_templateObject2","Org_templateObject3","_ref$org","cPEAI","Org_Container","Org_Menu","DropdownMenu_DropdownMenu","Item","_ref$batch","isNewBatch","_ref$model","setEditMode","Qty_templateObject","Qty","iniQty","setQty","Qty_Input","Stat","isAuto","onAutoEnable","FlexContainer","BpStat_templateObject","BpStat","bpStat","upsertParent","hideLaborCell","autoPlanCost","autoPlanLabor","autoPlanRevenue","factCost","factLabor","factRevenue","planCost","planLabor","planRevenue","Proc_templateObject","Proc_templateObject2","isMachiningClass","Proc_templateObject3","WarningItem","Proc_templateObject4","Proc","proc","deleteElement","isNewProc","Proc_Container","Proc_Title","Proc_Menu","OpType","isNewOp","_ref$opType","laborPrice","opt","DealLabour","basePath","dealLabor","ExecName","laborCost","isNewAppoint","_appoint$exec","_appoint$exec$person","addMode","setAddMode","Task_templateObject","TitleContainer","Task_templateObject2","Task_templateObject3","Task_templateObject4","Task","Task_Container","Task_Untruncated","Appoint_templateObject","Appoint_templateObject2","HeaderContainer","Appoint_templateObject3","Appoint_templateObject4","Appoint_templateObject5","Appoint_templateObject6","Appoint","uAq","upsertAppointProto","Appoint_Container","Appoint_TitleContainer","Appoint_Title","Appoint_Menu","Appoint_WarningItem","Wrapper","Op_templateObject","Op_templateObject2","Op_templateObject3","Op_templateObject4","Op_templateObject5","Op","appoints","Op_TitleContainer","Op_Title","Op_Menu","Op_WarningItem","appointIndex","Ops_templateObject","Ops","Ops_Container","Op_Op","Element_templateObject","Element","_ref$element","element","Element_Container","Ops_Ops","NewElement","newElementIndex","inputRef2","inputRef3","elementType","setElementType","upsertOp","SortableItemContainer","Elements_templateObject","sortableContainer","DragHandle","sortableHandle","sortableElement","Elements","elements","upsertBatchDeprecated","_useUpsert","useDragHandle","modifierArr","Batch_templateObject","Batch_templateObject2","Batch_templateObject3","uBq","upsertBatchProto","_produce","batchAutoStat","evalOp","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","ap","_i","_arr","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_i2","_arr2","Batch_Container","Batch_TitleContainer","Batch_ContolsContainer","Batches_templateObject","SortableBatch","Batches_SortableItemContainer","Batches_DragHandle","TableCells_Batch","Batches","Batches_SortableContainer","Deal_templateObject","Deal_templateObject2","Deal_templateObject3","Deal","_ref$deal","Deal_Container","Deal_Title","Deal_Menu","rel","Row_templateObject","changedProps","entries","ps","useTraceUpdate","isFirstRow","Row_Container","TableCells_Org","TableHeader","Deals_Table_templateObject","Background","Deals_Table_templateObject2","DealsTable","deals","Deals_Row","DealsMenu","refetchDeals","setBudgetMode","sD","Timeline_templateObject","Timeline","Timeline_Container","Header_templateObject","days","Header_Container","day","Window","Plot_templateObject","draggable","Plot_templateObject2","TimelinePlot","startDate","getDate","currentHalfHour","floor","now","setHours","isWeekend","getDay","Plot_Container","Header_Header","Deals_Page_templateObject","Deals_Page_templateObject2","DealsPage","Provider_DetailsProvider","Deals_Page_Container","Context_DealsContextProvider","Root","meQuery","context_UserContext","HashRouter","Switch","PaymentsPage","Redirect","ReactDOM","react_common_esm","styled_components_browser_esm","DiskContext_DiskProvider","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.92f28e7a.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n\r\n              // Execute callback\r\n              if (config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","export const AUTH_TOKEN = 'kolmech-token'\r\n","const defaults = {\r\n\tnewEnquiry: {\r\n\t\t__typename: 'Enquiry',\r\n\t\tid: 'new'\r\n\t},\r\n\tlayout: {\r\n\t\t__typename: 'Layout',\r\n\t\tdetails: null,\r\n\t\textra: null,\r\n\t\tbottomPanel: null\r\n\t},\r\n\tlists: {\r\n\t\t__typename: 'Lists',\r\n\t\tselectedProdIds: [],\r\n\t},\r\n}\r\n\r\nexport default defaults","import gql from 'graphql-tag'\r\n\r\nexport const getLayout = gql`\r\n\tquery getLayout {\r\n\t\tlayout @client {\r\n\t\t\tdetails\r\n\t\t\textra\r\n\t\t\tbottomPanel\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getLayoutOptions = ({\r\n\tprops: ({ data: { layout } }) => {\r\n\t\treturn {\r\n\t\t\tlayout: layout || {}\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport const setLayout = gql`\r\n\tmutation SetLayout($input: json) {\r\n\t\tsetLayout(input: $input) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const setExpanded = gql`\r\n\tmutation SetExpanded($args: json) {\r\n\t\tsetExpanded(args: $args) @client {\r\n\t\t\targs\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const orderFragmentBasic = gql`\r\n\tfragment OrderFragmentBasic on Order {\r\n\t\tid\r\n\t\tfullnum\r\n\t\tdateLocal\r\n\t\tqty\r\n\t\tamount\r\n\t}\r\n`\r\n\r\nexport const orderFragmentFull = gql`\r\n\tfragment OrderFragmentFull on Order {\r\n\t\t...OrderFragmentBasic\r\n\t\thtmlNote\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tprods {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n\t\t\thasDefect,\r\n\t\t\tisSpoiled,\r\n\t\t\tprogress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\n\r\nexport const upsertOrder = gql`\r\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\r\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\r\n\t\t\t...OrderFragmentBasic\r\n\t\t\tenquiry {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tprods {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\nexport const orderLocal = gql`\r\n\tquery OrderLocal ($id: ID!) {\r\n\t\torderLocal (id: $id) {\r\n\t\t\tid\r\n\t\t\tfullnum\r\n\t\t\tdateLocal\r\n\t\t\tqty\r\n\t\t\tamount\r\n\t\t}\r\n\t}\r\n`\r\nexport const orderDetails = gql`\r\n\tquery OrderDetails ($id: ID!) {\r\n\t\torder (id: $id) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`\r\nexport const reserveProds = gql`\r\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\r\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const docFragmentBasic = gql`\r\n\tfragment DocFragmentBasic on Doc {\r\n\t\tid\r\n\t\ttype\r\n\t\tdateLocal\r\n\t\tamount\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const statusFragment = gql`\r\n\tfragment StatusFragment on Status {\r\n\t\tid\r\n    name\r\n    stage\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const fileFragmentFull = gql`\r\n\tfragment FileFragmentFull on File {\r\n\t\tid\r\n\t\tpath\r\n\t\tsize\r\n\t\tfilename\r\n\t\tmimetype\r\n\t\twidth\r\n\t\theight\r\n\t\timgFor\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { fileFragmentFull } from './file'\r\n\r\nexport const drawingFragmentBasic = gql`\r\n\tfragment DrawingFragmentBasic on Drawing {\r\n\t\tid\r\n\t\tname\r\n\t\tsortOrder\r\n\t}\r\n`\r\n\r\nexport const drawingFragmentFull = gql`\r\n\tfragment DrawingFragmentFull on Drawing {\r\n\t\t...DrawingFragmentBasic\r\n\t\tfiles { ...FileFragmentFull }\r\n\t}\r\n\t${drawingFragmentBasic}\r\n\t${fileFragmentFull}\r\n`\r\n\r\nexport const createDrawings = gql`\r\n\tmutation CreateDrawings(\r\n\t\t$modelId: ID!\r\n\t\t$files: [Upload!]!\r\n\t) {\r\n\t\tcreateDrawings(\r\n\t\t\tmodelId: $modelId\r\n\t\t\tfiles: $files\r\n\t\t) {\r\n\t\t\t...DrawingFragmentFull\r\n\t\t}\r\n\t}\r\n\t${drawingFragmentFull}\r\n`\r\n\r\nexport const deleteDrawings = gql`\r\n\tmutation DeleteDrawings( $ids: [ID!]! ) {\r\n\t\tdeleteDrawings(ids: $ids) { count }\r\n\t}\r\n`\r\n\r\nexport const setDrawingsSortOrder = gql`\r\n\tmutation SetDrawingsSortOrder( $ids: [ID!]! ) {\r\n\t\tsetDrawingsSortOrder(ids: $ids) { count }\r\n\t}\r\n`\r\n","import gql from 'graphql-tag'\r\nimport { drawingFragmentBasic, drawingFragmentFull } from './drawing';\r\n\r\nexport const modelFragmentBasic = gql`\r\n\tfragment ModelFragmentBasic on Model {\r\n\t\tid\r\n\t\tname\r\n\t\tarticle\r\n\t}\r\n`\r\n\r\nexport const modelFragmentWithDrawings = gql`\r\n\tfragment ModelFragmentWithDrawings on Model {\r\n\t\t...ModelFragmentBasic\r\n\t\tdrawings { ...DrawingFragmentBasic }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${drawingFragmentBasic}\r\n`\r\n\r\nexport const modelFragmentFull = gql`\r\n\tfragment ModelFragmentFull on Model {\r\n\t\t...ModelFragmentBasic\r\n\t\tdrawings { ...DrawingFragmentFull }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${drawingFragmentFull}\r\n`\r\n\r\nexport const modelLocal = gql`\r\n\tquery ModelLocal ($id: ID!) {\r\n\t\tmodelLocal (id: $id) {\r\n\t\t\t...ModelFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${modelFragmentBasic}\r\n`\r\n\r\nexport const modelDetails = gql`\r\n\tquery ModelDetails ($id: ID!) {\r\n\t\tmodel (id: $id) {\r\n\t\t\t...ModelFragmentFull\r\n\t\t}\r\n\t}\r\n\t${modelFragmentFull}\r\n`\r\n\r\nexport const upsertModel = gql`\r\n\tmutation UpsertModel(\r\n\t\t$input: ModelInput!\r\n\t) {\r\n\t\tupsertModel(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { orderFragmentBasic } from './order'\r\nimport { docFragmentBasic } from './doc'\r\nimport { statusFragment } from './status'\r\nimport { modelFragmentWithDrawings, modelFragmentBasic } from './model';\r\n\r\nexport const enquiryFragmentBasic = gql`\r\n\tfragment EnquiryFragmentBasic on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t}\r\n`\r\n\r\nexport const allEnquiries = gql`\r\n\tquery AllEnquiries {\r\n\t\tenquiries {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\temployees {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\torders {\r\n\t\t\t\t...OrderFragmentBasic\r\n\t\t\t\tprods {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tisExpanded @client\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${orderFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryDetails = gql`\r\n\tquery EnquiryDetails ($id: ID!) {\r\n\t\tenquiry (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentBasic }\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryLocal = gql`\r\n\tquery EnquiryLocal ($id: ID!) {\r\n\t\tenquiryLocal (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n`\r\nexport const newEnquiry = gql`\r\n\tquery {\r\n\t\tnewEnquiry @client {\r\n\t\t\tid\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const createEnquiry = gql`\r\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\r\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t\torders {\r\n\t\t\t\tid\r\n\t\t\t\tfullnum\r\n\t\t\t\tdateLocal\r\n\t\t\t\tqty\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const updateEnquiry = gql`\r\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\r\n\t\tupdateEnquiry(input: $input) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const createEnquiryEvent = gql`\r\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\r\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const enquiryFragment = gql`\r\n\tfragment myEnquiry on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t\thtmlNote\r\n\t\tisExpanded\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\tqty\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${modelFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const getLists = gql`\r\n\tquery getLists {\r\n\t\tlists @client {\r\n\t\t\tselectedProdIds\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getListsOptions = ({\r\n\tprops: ({ data: { lists } }) => ({\r\n    lists: lists || {}\r\n\t})\r\n})\r\n\r\nexport const setList = gql`\r\n\tmutation SetList($name: String!, $value: [ID!]) {\r\n\t\tsetList(name: $name, value: $value) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`","import { getLayout } from '../graphql/layout'\r\nimport { allEnquiries } from '../graphql/enquiry'\r\nimport { getLists } from '../graphql/lists'\r\nimport { cloneDeep } from 'apollo-utilities'\r\n\r\nconst resolvers = {\r\n\tEnquiry: {\r\n\t\tisExpanded: () => false\r\n\t},\r\n\tMutation: {\r\n\t\tsetLayout: (_, { input }, { cache }) => {\r\n\t\t\tconst query = getLayout\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.layout = {\r\n\t\t\t\t...data.layout,\r\n\t\t\t\t...cloneDeep(input)\r\n\t\t\t}\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetExpanded: (_, { args: { id: enquiryId, value } }, { cache }) => {\r\n\t\t\tconst query = allEnquiries\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tconst enquiry = data.enquiries.find(e => e.id === enquiryId)\r\n\t\t\tenquiry.isExpanded = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetList: (_, { name, value }, { cache }) => {\r\n\t\t\tconst query = getLists\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.lists[name] = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t}\r\n}\r\n\r\nexport default resolvers","import { ApolloClient } from 'apollo-client'\r\n// import { HttpLink } from 'apollo-link-http'\r\nimport { createUploadLink } from 'apollo-upload-client'\r\nimport { ApolloLink } from 'apollo-link'\r\n// import { ApolloLink, Observable, split } from 'apollo-link'\r\nimport { withClientState } from 'apollo-link-state'\r\nimport { onError } from 'apollo-link-error'\r\nimport { InMemoryCache, defaultDataIdFromObject } from 'apollo-cache-inmemory'\r\n// import { WebSocketLink } from 'apollo-link-ws'\r\nimport { AUTH_TOKEN } from '../constants'\r\n\r\nimport defaults from './defaults'\r\nimport resolvers from './resolvers'\r\n// import typeDefs from './typeDefs'\r\n\r\n// init with Apollo Client:\r\nconst cache = new InMemoryCache({\r\n\tdataIdFromObject: object => {\r\n\t\tswitch (object.__typename) {\r\n\t\t\tcase 'NewEnquiry': return 'NewEnquiry'\r\n\t\t\tdefault: return defaultDataIdFromObject(object)\r\n\t\t}\r\n\t},\r\n\tcacheRedirects: {\r\n\t\tQuery: {\r\n\t\t\tdealLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Deal', id: args.id }),\r\n\t\t\torgLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Org', id: args.id }),\r\n\t\t\tenquiryLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Enquiry', id: args.id }),\r\n\t\t\torderLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Order', id: args.id }),\r\n\t\t\tmodelLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Model', id: args.id }),\r\n\t\t\tprodsLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\targs.ids.map(id =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Prod', id: id }))\r\n\t\t}\r\n\t}\r\n})\r\n\r\nconst authMiddleware = new ApolloLink((operation, forward) => {\r\n\tconst token = localStorage.getItem(AUTH_TOKEN) || null\r\n  operation.setContext(({ headers = {} }) => ({\r\n    headers: {\r\n      ...headers,\r\n      Authorization: token ? `Bearer ${token}` : '',\r\n    }\r\n  }))\r\n  return forward(operation)\r\n})\r\n\r\n// NOT WORKING!!! TODO find solution to redirect to Login page when token has expired\r\nconst refreshToken = (token) => {\r\n\tif (token) {\r\n\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t} else {\r\n\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\tclient.resetStore()\r\n\t}\r\n}\r\n\r\n// @ts-ignore\r\nexport const client = new ApolloClient({\r\n\tlink: ApolloLink.from([\r\n\t\tonError(({ graphQLErrors, networkError }) => {\r\n\t\t\tif (graphQLErrors) {\r\n\t\t\t\tconsole.log('graphQLErrors!!! > ', graphQLErrors)\r\n\t\t\t}\r\n\t\t\tif (networkError) {\r\n\t\t\t\tconsole.log('networkError!!! > ', networkError)\r\n\t\t\t\tconsole.log('networkError.name > ', networkError.name)\r\n\t\t\t\tconsole.log('networkError.message > ', networkError.message)\r\n\t\t\t\tconsole.log(networkError.message === 'Unexpected token I in JSON at position 0')\r\n\t\t\t\tif (networkError.message === 'Unexpected token I in JSON at position 0') refreshToken(null)\r\n\t\t\t\t// logoutUser();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tauthMiddleware,\r\n\t\twithClientState({\r\n      defaults,\r\n\t\t\tresolvers,\r\n\t\t\t// typeDefs,\r\n      cache\r\n\t\t}),\r\n\t\t// new HttpLink({ uri: 'http://localhost:4000' })\r\n\t\tcreateUploadLink({\r\n\t\t\t// uri: 'http://localhost:4000',\r\n\t\t\t// uri: 'https://now-advanced.now.sh',\r\n\t\t\turi: 'https://env-1542080.mircloud.ru',\r\n\t\t})\r\n\t]),\r\n\tcache\r\n})\r\n\r\n// const httpLink = new HttpLink({ uri: 'https://now-advanced.now.sh' })\r\n\r\n// // authenticated httplink\r\n// const httpLinkAuth = middlewareAuthLink.concat(httpLink)\r\n\r\n// const wsLink = new WebSocketLink({\r\n//     uri: `ws://now-advanced.now.sh`,\r\n//     options: {\r\n//         reconnect: true,\r\n//         connectionParams: {\r\n//         Authorization: `Bearer ${localStorage.getItem(AUTH_TOKEN)}`,\r\n//         },\r\n//     },\r\n// })\r\n  \r\n// const link = split(\r\n//     // split based on operation type\r\n//     ({ query }) => {\r\n//         const { kind, operation } = getMainDefinition(query)\r\n//         return kind === 'OperationDefinition' && operation === 'subscription'\r\n//     },\r\n//     wsLink,\r\n//     httpLinkAuth,\r\n// )\r\n\r\n// const client = new ApolloClient({\r\n//     cache,\r\n//     link: ApolloLink.from([\r\n//         stateLink,\r\n//         httpLinkAuth\r\n//     ]),\r\n//     connectToDevTools: true,\r\n// })\r\n\r\n// client.cache.reset()\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\n// S prefix is used throughout the App just to have flexebility (two names for each component)\r\n// N prefix stands for NativeCssImplementation of a component (When html element is styled instead of semantic ui component) \r\n\r\nimport {\r\n    Header as SHeader,\r\n    // Label as SLabel,\r\n    Icon as SIcon,\r\n    Button as SButton,\r\n    Message as SMessage,\r\n    Popup as SPopup,\r\n    Input as SInput,\r\n    Dropdown as SDropdown,\r\n    Form as SForm,\r\n    Ref\r\n} from 'semantic-ui-react';\r\n\r\nexport const theme = {\r\n\twidths: {\r\n\t\tformLabel: '122px', //required calc(110px + 0.857143em)\r\n\t\tdetailsPL: '55px',\r\n\t\textraSidebar: '250px'\r\n\t},\r\n\tcolors: {\r\n\t\tgreen: '#016936',\r\n\t\tblue: '#0E6EB8',\r\n\t\terror: '#9f3a38',\r\n\t\terrorBorder: '#e0b4b4'\r\n\t}\r\n}\r\nconst getThemeColor = (color) => theme.colors[color] || color\r\nconst baseSet = ({ theme, bt, bb, bc, bl, br, bs, bsh, c, cur, d, f, fl, fs, fw, h, l, lh, mw, minw, m, mb, mt, ml, mr, o, ov, ox, oy, p, pb, pe, pos, pl, pr, pt, t, tr, ta, to, v, va, w, whs, ws, z }) => {\r\n\treturn `\r\n\t\t${bt \t? `border-top: ${bt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bb \t? `border-bottom: ${bb};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bc \t? `background-color: ${bc};`\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bl \t? `border-left: ${bl};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${br \t? `border-right: ${br};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bs \t? `box-sizing: ${bs};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bsh ? `box-shadow: ${bsh};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${c \t? `color: ${theme.colors && theme.colors[c] || c};`\t: ''}\r\n\t\t${cur \t? `cursor: ${cur};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${d \t? `display: ${d};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${f \t? `flex: ${f};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fl \t? `float: ${fl};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fs \t? `font-size: ${fs};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fw \t? `font-weight: ${fw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${h \t? `height: ${h};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${l \t? `left: ${l};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${lh \t? `line-height: ${lh};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mw \t? `max-width: ${mw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${minw? `min-width: ${minw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${m \t? `margin: ${m};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mb \t? `margin-bottom: ${mb};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mt \t? `margin-top: ${mt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ml \t? `margin-left: ${ml};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mr \t? `margin-right: ${mr};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${o  \t? `opacity: ${o};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ov  ? `overflow: ${ov};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ox  ? `overflow-x: ${ox};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${oy  ? `overflow-y: ${oy};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${p \t? `padding: ${p};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pb \t? `padding-bottom: ${pb};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pl \t? `padding-left: ${pl};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pe \t? `pointer-events: ${pe};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pos ? `position: ${pos};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pr \t? `padding-right: ${pr};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pt \t? `padding-top: ${pt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${t \t? `top: ${t};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${tr \t? `transition: ${tr};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ta \t? `text-align: ${ta};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${to \t? `text-overflow: ${to};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${v \t? `visibility: ${v};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${va \t? `vertical-align: ${va};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${w \t? `width: ${(theme.widths && theme.widths[w]) || w};`\t\t: ''}\r\n\t\t${whs ? `white-space: ${whs};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ws \t? `word-spacing: ${ws};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${z \t? `z-index: ${z};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t`\r\n}\r\n\r\nconst DivPropFilter = ({ ml, w, inline, ...rest }) => (\r\n\t<div {...rest} />\r\n)\r\nexport const Div = styled(DivPropFilter)`\r\n\t${props => props.inline && `display: inline-block;`}\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst PPropFilter = ({ ...rest }) => (\r\n\t<p {...rest} />\r\n)\r\nexport const P = styled(PPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst SpanPropFilter = ({ ml, ...rest }) => (\r\n\t<span {...rest} />\r\n)\r\nexport const Span = styled(SpanPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nexport const A = styled.a`\r\n\tcursor: pointer;\r\n\t${props => props.cancel && `{\r\n\t\tpadding-left: 15px;\r\n\t\tcolor: rgba(0,0,0,.87);\r\n\t\t&:hover {\r\n\t\t\tcolor: #B03060;\r\n\t\t}\r\n\t}`}\r\n`\r\n\r\nconst HeaderPropFilter = ({ inline, c, ...rest }) => (\r\n\t<SHeader {...rest} />\r\n)\r\nexport const Header = styled(HeaderPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.inline && `{\r\n\t\t\tmargin: 0;\r\n\t\t\tpadding: 0 1rem;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst IconPropFilter = ({\r\n\tactive,\r\n\tactiveColor,\r\n\tselectMode,\r\n\tdisabled,\r\n\tonClick,\r\n\t...rest\r\n}) => (\r\n\t<SIcon\r\n\t\t{...rest}\r\n\t\tdisabled={disabled}\r\n\t\tonClick={disabled ? undefined : onClick}\r\n\t/>\r\n)\r\nexport const Icon = styled(IconPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&&&& {\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t${props.active && `color: ${getThemeColor(props.activeColor)} !important;`}\r\n\t\t}`}\r\n\t\t${props => props.disabled && 'opacity: .45!important;'}\r\n\t}\r\n`\r\n\r\nconst DropdownIcon = ({active, disabled, ...rest}) => (\r\n\t<SIcon {...rest}\r\n\t\tname='dropdown'\r\n\t/>\r\n)\r\nexport const Caret = styled(DropdownIcon)`\r\n\ttransform: ${\r\n\t\tprops => !props.active && (\r\n\t\t\tprops.size === 'large'\r\n\t\t\t? 'translateX(0) translateY(0) rotate(-90deg) !important'\r\n\t\t\t: 'translateX(-3px) translateY(3px) rotate(-90deg) !important'\r\n\t\t)\r\n\t};\r\n\t&&& {\r\n\t\t${props => props.disabled && `{\r\n\t\t\tcolor: rgba(0,0,0,.6);\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst ButtonPropFilter = ({ activeColor, menu, ...rest }) => (\r\n\t<SButton {...rest} />\r\n)\r\nexport const Button = styled(ButtonPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t&.compact {\r\n\t\t\tpadding: .5rem 1rem;\r\n\t\t}\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n        \t}\r\n\t\t}`}\r\n\t\t${props => props.menu && `{\r\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\r\n\t\t\tz-index: 3;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst MessagePropFilter = ({\r\n\tsection,\r\n\t...rest\r\n}) => (\r\n\t<SMessage {...rest} />\r\n)\r\nexport const Message = styled(MessagePropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.section && `\r\n\t\t\tmargin-top: 0;\r\n\t\t\tpadding-left: ${props.theme.widths.detailsPL};\r\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\r\n\t\t\tborder-radius: 0;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nconst SectionPropFiltered = React.forwardRef(({\r\n\thead,\r\n\tminor,\r\n\tsmall,\r\n\tsecondary,\r\n\tnoP,\r\n\tnoLP,\r\n\tnoIndent,\r\n\ttopBorder,\r\n\tbottomBorder,\r\n\tchildren,\r\n\tonClick,\r\n\t...rest\r\n}, ref) => (\r\n\t\t<div\r\n\t\t\tref={ref}\r\n\t\t\t{...rest}\r\n\t\t\tonClick={onClick || undefined}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</div>\r\n))\r\nexport const Section = styled(SectionPropFiltered)`\r\n\twidth: 100%;\r\n\tpadding: 1em 1em 1em 55px;\r\n\t${props => baseSet(props)}\r\n\t${props => props.head && `{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding-top: 0;\r\n\t\tpadding-bottom: 0;\r\n\t}`}\r\n\t${props => props.onClick && `{\r\n\t\tcursor: pointer;\r\n\t}`}\r\n\t${props => props.minor && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => !props.size && props.head && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => props.size === 'small' && `{\r\n\t\tmin-height: 2.5em;\r\n\t}`}\r\n\t${props => props.secondary && `{\r\n\t\tbackground: #f3f4f5;\r\n\t\tcolor: rgba(0,0,0,.6);\r\n\t}`}\r\n\t${props => props.noLP && `{\r\n\t\tpadding-left: 0;\r\n\t}`}\r\n\t${props => props.noIndent && `{\r\n\t\tpadding-left: 1em;\r\n\t}`}\r\n\t${props => props.topBorder && `{\r\n\t\tborder-top: 1px solid ${props.topBorder === 'dark' ? 'rgba(152, 153, 154, 1)' : 'rgba(34,36,38,.15)'};\r\n\t}`}\r\n\t${props => props.bottomBorder && `{\r\n\t\tborder-bottom: 1px solid ${props.bottomBorder === 'dark' ? 'rgba(126, 127, 129, 1)' : 'rgba(34,36,38,.1)'};\r\n\t}`}\r\n`\r\n\r\nconst PopupPropFilter = ({ showIf, ...rest }) => (\r\n\t<SPopup {...rest} />\r\n)\r\nexport const Popup = styled(PopupPropFilter)`\r\n\t&&& {\r\n\t\t${props => !props.showIf && `{\r\n\t\t\topacity: 0;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nexport const Label = styled.label`\r\n\t${props => baseSet(props)}\r\n\twidth: ${props => props.theme.widths.formLabel} !important;\r\n\tmargin-right: 0 !important;\r\n`\r\n\r\nconst InputPropFilter = React.forwardRef(({ w, ...rest }, ref) => (\r\n\t<Ref innerRef={ref}>\r\n\t\t<SInput {...rest} />\r\n\t</Ref>\r\n))\r\nexport const Input = styled(InputPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nexport const Dropdown = styled(SDropdown)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nconst FormFieldPropFilter = ({ w, ...rest }) => (\r\n\t<SForm.Field {...rest} />\r\n)\r\nexport const FormField = styled(FormFieldPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`","import React from 'react'\r\nimport { Message } from '../styled/styled-semantic'\r\n\r\nexport default ({\r\n\tmessage: { id, type, title, content, timerId },\r\n\tdismissNotification,\r\n\tcancelAutoDismiss\r\n}) => {\r\n  return (\r\n\t\t<Message\r\n\t\t\tm='0 0 2rem 2rem'\r\n\t\t\tw='unset'\r\n\t\t\tmw='550px'\r\n\t\t\tpr='4em'\r\n\t\t\tpe='all'\r\n\t\t\tcompact\r\n\t\t\tsize='large'\r\n\t\t\ticon={\r\n\t\t\t\ttype === 'error' ? 'exclamation' :\r\n\t\t\t\ttype === 'warning' ? 'info' :\r\n\t\t\t\ttype === 'success' ? 'check' :\r\n\t\t\t\tundefined\r\n\t\t\t}\r\n\t\t\theader={title}\r\n\t\t\tcontent={content}\r\n\t\t\terror={type === 'error'}\r\n\t\t\tinfo={type === 'info'}\r\n\t\t\tsuccess={type === 'success'}\r\n\t\t\twarning={type === 'warning'}\r\n\t\t\tonDismiss={timerId ? undefined : (() => dismissNotification(id))}\r\n\t\t\tonMouseEnter={timerId ? (() => cancelAutoDismiss(id)) : undefined}\r\n\t\t/>\r\n\t)\r\n}","import React from \"react\"\r\nimport reactDom from 'react-dom'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport Notification from \"./Notification\"\r\n\r\nconst NotificationsHolder = styled.div`\r\n\tposition: fixed;\r\n  bottom: 0;\r\n\ttop: 0;\r\n\tleft: 0;\r\n  width: 100%;\r\n\theight: 100%;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: flex-end;\r\n\tpointer-events: none;\r\n  z-index: 100;\r\n`\r\n\r\nconst PosedItem = posed.div({\r\n  boobl: {\r\n\t\ty: 200,\r\n\t\topacity: 0,\r\n\t},\r\n  enter: {\r\n\t\ty: 0,\r\n\t\topacity: 1,\r\n\t},\r\n\texit: {\r\n\t\tx: -400,\r\n\t\topacity: 0,\r\n\t},\r\n})\r\n\r\nexport default function Notifications ({\r\n\tmessages,\r\n\tdismissNotification,\r\n\tcancelAutoDismiss\r\n}) {\r\n\t// this Portal is never unmounted\r\n  return reactDom.createPortal(\r\n\t\t<NotificationsHolder>\r\n\t\t\t<PoseGroup\r\n\t\t\t\tanimateOnMount\r\n\t\t\t\tpreEnterPose='boobl'\r\n\t\t\t>\r\n\t\t\t\t{messages.map(m =>\r\n\t\t\t\t\t<PosedItem\r\n\t\t\t\t\t\tkey={m.id}\r\n\t\t\t\t\t\tinitialPose=\"boobl\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Notification\r\n\t\t\t\t\t\t\tmessage={m}\r\n\t\t\t\t\t\t\tdismissNotification={dismissNotification}\r\n\t\t\t\t\t\t\tcancelAutoDismiss={cancelAutoDismiss}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</PosedItem>\r\n\t\t\t\t)}\r\n\t\t\t</PoseGroup>\r\n\t\t</NotificationsHolder>,\r\n\t\tdocument.getElementById('kolmech-notifications')\r\n\t)\r\n}","import React, { useContext, useMemo, useState, useCallback } from 'react'\r\nimport produce from 'immer'\r\nimport cuid from 'cuid'\r\nimport Notifications from './Notifications'\r\n\r\nconst NotificationsContext = React.createContext()\r\nexport default NotificationsContext\r\n\r\nexport function NotificationsProvider ({\r\n  children\r\n}) {\r\n  const [ messages, setMessages ] = useState([])\r\n  const create = message => {\r\n    message.id = cuid()\r\n    // notification will auto dismiss\r\n    message.timerId = setTimeout(() => {\r\n      dismiss(message.id)\r\n    }, 5000)\r\n    setMessages(produce(messages, draft => {\r\n      draft.push(message)\r\n    }))\r\n  }\r\n  const dismiss = messageId => setMessages(produce(messages, draft => {\r\n    console.log('messageId > ', messageId)\r\n    return draft.splice[messages.findIndex(m => m.id === messageId), 1]\r\n  }))\r\n  const cancelAutoDismiss = messageId => setMessages(produce(messages, draft => {\r\n    const message = draft[messages.findIndex(m => m.id === messageId)]\r\n    clearTimeout(message.timerId)\r\n    delete message.timerId\r\n  }))\r\n  const providerValue = useMemo(() => ({ notify: create }), [])\r\n  return <NotificationsContext.Provider\r\n    value={providerValue}\r\n  >\r\n    <Notifications\r\n      messages={messages}\r\n      dismissNotification={dismiss}\r\n      cancelAutoDismiss={cancelAutoDismiss}\r\n    />\r\n    {children}\r\n  </NotificationsContext.Provider>\r\n}\r\n\r\nexport const NotificationsConsumer = ({ children }) => (\r\n  <NotificationsContext.Consumer>\r\n    {({ notify }) =>\r\n      <PureChild notify={notify} >\r\n        {children}\r\n      </PureChild>\r\n    }\r\n  </NotificationsContext.Consumer>\r\n)\r\n\r\nconst PureChild = React.memo(({ notify, children }) => children({ notify }))\r\n\r\nexport const useNotifications = () => {\r\n  const { notify } = useContext(NotificationsContext)\r\n  return {\r\n    // notify: useMemo(notify, [])\r\n    notify: useCallback((msg) => notify(msg), [])\r\n  }\r\n}\r\n\r\n","import gql from 'graphql-tag'\r\n\r\nexport const highlightFolder = gql`\r\n\tmutation highlightFolder ($orgId: ID, $dealId: ID) {\r\n\t\thighlightFolder (orgId: $orgId, dealId: $dealId) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n","import React from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { highlightFolder } from '../../graphql/disk'\r\n\r\nconst DiskContext = React.createContext()\r\nexport default DiskContext\r\n\r\nexport const DiskProvider = ({\r\n  children\r\n}) => {\r\n  return (\r\n    <Mutation\r\n      mutation={highlightFolder}\r\n    >\r\n      {(highlightFolder) =>\r\n        <DiskContext.Provider\r\n          value={{\r\n            highlightFolder: ({ orgId, dealId }) => highlightFolder({\r\n              variables: { orgId, dealId }\r\n            })\r\n          }}\r\n        >\r\n          {children}\r\n        </DiskContext.Provider>\r\n      }\r\n    </Mutation>\r\n  )\r\n}","import decode from 'jwt-decode'\r\n\r\nexport function getTokenExpirationDate(token) {\r\n  const decoded = decode(token)\r\n  if (!decoded.exp) {\r\n    return null\r\n  }\r\n  const date = new Date(0) // The 0 here is the key, which sets the date to the epoch\r\n  date.setUTCSeconds(decoded.exp)\r\n  return date\r\n}\r\n\r\nexport function isTokenExpired(token) {\r\n  const date = getTokenExpirationDate(token)\r\n  const offsetSeconds = 0\r\n  if (date === null) {\r\n    return false\r\n  }\r\n  return !(date.valueOf() > new Date().valueOf() + offsetSeconds * 1000)\r\n}\r\n","import { useContext } from 'react'\r\nimport {\r\n  useQuery as useApolloQuery,\r\n  useMutation as useApolloMutation\r\n} from '@apollo/react-hooks'\r\nimport NotificationsContext from '../notifications/NotificationsContext'\r\n\r\nexport function useQuery(\r\n  query,\r\n  {\r\n    onError,\r\n    errMsg,\r\n    ...options\r\n  } = {},\r\n) {\r\n  const { notify } = useContext(NotificationsContext)\r\n  return useApolloQuery(query, {\r\n    ...options,\r\n    onError: err => {\r\n      if (onError) onError(err)\r\n      notify({\r\n        type: 'error',\r\n        title: errMsg || 'Ошибка загрузки данных',\r\n        content: err.message,\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nexport const useMutation = (\r\n  mutation,\r\n  {\r\n    onCompleted,\r\n    onError,\r\n    successMsg,\r\n    errMsg,\r\n    mark,\r\n    ...options\r\n  } = {}\r\n) => {\r\n  // const refMounted = useRefMounted()\r\n  // console.log('refMounted.current1 > ', refMounted.current)\r\n  // console.log('useMutation > ', mark)\r\n  const { notify } = useContext(NotificationsContext)\r\n  return useApolloMutation(mutation, {\r\n    ...options,\r\n    onCompleted: res => {\r\n      console.log('onCompleted > ', onCompleted)\r\n      if (onCompleted) onCompleted(res)\r\n      successMsg !== null && notify({\r\n        type: 'success',\r\n        title: successMsg || 'Данные сохранены',\r\n      })\r\n    },\r\n    onError: err => {\r\n      if (onError) onError(err)\r\n      notify({\r\n        type: 'error',\r\n        title: errMsg || 'Ошибка загрузки данных',\r\n        content: err.message,\r\n      })\r\n    }\r\n  })\r\n}","import gql from 'graphql-tag'\r\n\r\nexport const accountFragmentBasic = gql`\r\n\tfragment accountFragmentBasic on Account {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const accountFragmentFull = gql`\r\n\tfragment accountFragmentFull on Account {\r\n\t\t...accountFragmentBasic\r\n\t\tbalance\r\n\t\tname\r\n\t\tnumber\r\n\t}\r\n\t${accountFragmentBasic}\r\n`\r\n\r\nexport const accounts = gql`\r\n\tquery accounts {\r\n\t\taccounts { ...accountFragmentFull }\r\n\t}\r\n\t${accountFragmentFull}\r\n`","import gql from 'graphql-tag'\r\nimport { accountFragmentFull } from './account'\r\n\r\nexport const userFragmentBasic = gql`\r\n\tfragment userFragmentBasic on User {\r\n\t\tid\r\n\t\tperson {\r\n\t\t\tid\r\n\t\t\tamoName\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const me = gql`\r\n\tquery Me {\r\n\t\tme {\r\n\t\t\tid\r\n\t\t\temail\r\n\t\t\tperson {\r\n\t\t\t\tid\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t\tamoName\r\n\t\t\t\texec {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trole\r\n\t\t\taccount { ...accountFragmentFull }\r\n\t\t\taccounts { ...accountFragmentFull }\r\n\t\t}\r\n\t}\r\n\t${accountFragmentFull}\r\n`\r\n\r\nexport const meLocal = gql`\r\n\tquery MeLocal {\r\n\t\tme @client {\r\n\t\t\tperson {\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t\tamoName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const login = gql`\r\n\tmutation Login($email: String!, $password: String!) {\r\n\t\tlogin(email: $email, password: $password) {\r\n\t\t\ttoken\r\n\t\t}\r\n\t}\r\n`","import React, { useState } from 'react'\r\nimport { useMutation } from '../hooks/apolloHooks'\r\nimport { login as lQ } from '../../graphql/user'\r\n\r\nimport styled from 'styled-components'\r\nimport { Header, Form, Message, Button, Segment } from 'semantic-ui-react'\r\n\r\n\r\nconst MenuDiv = styled.div`\r\n\tborder-bottom: 1px solid #7e7e81;\r\n`\r\n\r\nconst MenuHeader = styled(Header)`\r\n\tdisplay: inline;\r\n\tpadding: 0 1rem !important;\r\n`\r\n\r\nconst SSegment = styled(Segment)`\r\n\tmax-width: 350px !important;\r\n\tmargin: auto !important;\r\n`\r\n\r\nexport default function LoginPage ({ refreshToken }) {\r\n\tconst [ email, setEmail ] = useState('')\r\n\tconst [ password, setPassword ] = useState('')\r\n\tconst [ login, { loading, error } ] = useMutation(lQ, {\r\n\t\tvariables: { email, password },\r\n\t\tsuccessMsg: null\r\n\t\t// TODO make sure password isn't cached\r\n\t\t// fetchPolicy: 'no-cache'\r\n\t})\r\n\treturn <>\r\n\t\t<MenuDiv>\r\n\t\t\t<MenuHeader size='large'>\r\n\t\t\t\t<i>Колмех</i>\r\n\t\t\t</MenuHeader>\r\n\t\t</MenuDiv>\r\n\t\t<SSegment basic>\r\n\t\t\t<Form error={!!error}>\r\n\t\t\t\t<Form.Field>\r\n\t\t\t\t\t<label>E-mail</label>\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\ttype=\"email\" \r\n\t\t\t\t\t\tplaceholder='E-mail'\r\n\t\t\t\t\t\tonChange={({ target: { value }}) => setEmail(value)} />\r\n\t\t\t\t</Form.Field>\r\n\t\t\t\t<Form.Field>\r\n\t\t\t\t\t<label>Пароль</label>\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\ttype=\"password\" \r\n\t\t\t\t\t\tplaceholder='Пароль'\r\n\t\t\t\t\t\tonChange={({ target: { value }}) => setPassword(value)} />\r\n\t\t\t\t</Form.Field>\r\n\t\t\t\t<Message\r\n\t\t\t\t\terror\r\n\t\t\t\t\theader='Войти не удалось..'\r\n\t\t\t\t\tcontent={error} />\r\n\t\t\t\t<Button \r\n\t\t\t\t\tprimary\r\n\t\t\t\t\ttype='submit'\r\n\t\t\t\t\tfloated='right'\r\n\t\t\t\t\tdisabled={!email || !password || loading}\r\n\t\t\t\t\tloading={loading}\r\n\t\t\t\t\tonClick={async () => {\r\n\t\t\t\t\t\tconst res = await login()\r\n\t\t\t\t\t\trefreshToken(res.data.login.token)\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tВойти\r\n\t\t\t\t</Button>\r\n\t\t\t</Form>\r\n\t\t</SSegment>\r\n\t</>\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport { AUTH_TOKEN } from '../../constants'\r\nimport { isTokenExpired } from '../../utils/jwtHelper'\r\n\r\nimport LoginPage from './LoginPage'\r\n\r\nexport const AuthContext = React.createContext()\r\nexport default AuthContext\r\n\r\nexport function AuthProvider ({\r\n  children,\r\n\tapolloClient\r\n}) {\r\n\tconst [ token, setToken ] = useState(localStorage.getItem(AUTH_TOKEN))\r\n\tuseEffect(() => {bootStrapData()}, [])\r\n\tconst bootStrapData = () => {\r\n\t\ttry {\r\n\t\t\tconst token = localStorage.getItem(AUTH_TOKEN)\r\n\t\t\tif (token !== null && token !== undefined) {\r\n\t\t\t\tconst expired = isTokenExpired(token)\r\n\t\t\t\tif (expired) {\r\n\t\t\t\t\trefreshToken(null)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetToken(token)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('bootStrapData error')\r\n\t\t}\r\n\t}\r\n\tconst refreshToken = token => {\r\n\t\tif (token) {\r\n\t\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\t\tconsole.log('apolloClient > ', apolloClient)\r\n\t\t\tif (apolloClient) apolloClient.resetStore()\r\n\t\t}\r\n\t\tsetToken(token)\r\n\t}\r\n  return <AuthContext.Provider\r\n    value={{ refreshToken }}\r\n  >\r\n    {token\r\n      ? children\r\n      : <LoginPage\r\n          refreshToken={refreshToken}\r\n        />\r\n    }\r\n  </AuthContext.Provider>\r\n}\r\n","import React from 'react'\r\n\r\nconst UserContext = React.createContext()\r\nexport default UserContext\r\n","import React, { useContext } from 'react'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Header } from './styled/styled-semantic'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { meLocal } from '../graphql/user'\r\nimport AuthContext from './auth/AuthContext'\r\n\r\nconst Container = styled.div`\r\n  height: 36px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n  background: white;\r\n`\r\n\r\nexport default ({\r\n  children,\r\n  title,\r\n  titleLinkTo,\r\n}) => {\r\n  const { refreshToken } = useContext(AuthContext)\r\n\treturn (\r\n    <Container>\r\n      <Link\r\n        to={titleLinkTo || ''}\r\n        onClick={titleLinkTo\r\n          ? undefined\r\n          : e => e.preventDefault()\r\n        }\r\n      >\r\n        <Header inline\r\n          size='medium'\r\n          content={title}\r\n        />\r\n      </Link>\r\n      {children}\r\n      <Query query={meLocal}>\r\n        { ({ data }) => {\r\n          if (data && data.me) {\r\n            const { fName, lName, amoName } = data.me.person\r\n            // const amoNameParts = amoName.split(' ')\r\n            // const menuNameTitle = amoNameParts[1] + ' ' + `${amoNameParts[0].slice(0,1)}.`\r\n            const menuNameTitle = amoName ? amoName.split(' ')[0] : lName || fName\r\n            return (\r\n              <Header inline\r\n                ml='auto'\r\n                size='small'\r\n                content={menuNameTitle} \r\n              />\r\n          )} else return null\r\n        }}\r\n      </Query>\r\n      <Icon link\r\n        name='log out'\r\n        size='large'\r\n        onClick={() => refreshToken(null)} \r\n      />\r\n    </Container>\r\n\t)\r\n}\r\n","import { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { getLayout, getLayoutOptions, setLayout, setExpanded } from '../../graphql/layout'\r\nimport { getLists, getListsOptions, setList } from '../../graphql/lists'\r\n\r\nconst GlobalContext = ({\r\n\t\tchildren,\r\n\t\tlayout: { details, extra, bottomPanel },\r\n\t\tsetLayout,\r\n\t\tsetExpanded,\r\n\t\tlists: { selectedProdIds },\r\n\t\tsetList\r\n}) => {\r\n  return children({\r\n\t\tdetails,\r\n\t\textra,\r\n\t\tbottomPanel,\r\n\t\tsetDetails: (details) => setLayout({ variables: { input: { details, extra: null } }}),\r\n\t\tsetExtra: (extra) => setLayout({ variables: { input: { extra } } }),\r\n\t\tsetBottomPanel: (bottomPanel) => setLayout({ variables: { input: { bottomPanel } } }),\r\n\t\tsetExpanded: (args) => setExpanded({variables: { args }}),\r\n\t\tselectedProdIds,\r\n\t\tsetSelectedProdIds: (value) => \r\n\t\t\tsetList({variables: { name: 'selectedProdIds', value }}),\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(setExpanded, { name: 'setExpanded' }),\r\n\tgraphql(getLists, getListsOptions),\r\n\tgraphql(setList, { name: 'setList' }),\r\n)(GlobalContext)","import React from 'react'\r\n\r\nimport { Icon, Popup as SPopup } from 'semantic-ui-react'\r\nimport { Div, Header, Button, Popup } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../../graphql/layout'\r\nimport { enquiryLocal } from '../../graphql/enquiry'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst SubmenuDiv = styled.div`\r\n\talign-self: stretch;\r\n\tposition: relative;\r\n\tmargin-left: 10px;\r\n\tpadding: 0 1em;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground-color: #f5f6f7;\r\n\tborder-top-right-radius: .35rem;\r\n\tborder-bottom-right-radius: .35rem;\r\n\t::before {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tleft: 0;\r\n\t\tbackground-color: #fff;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\r\n\t}\r\n\t/* ::after {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tright: 0;\r\n\t\tbackground-color: #f3f4f5;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\r\n\t} */\r\n`\r\n\r\n// const EnquiriesSubmenu = ({ item, addNewOrder, setLayout, layout: { details } }) => {\r\nconst EnquiriesSubmenu = () => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId }, setDetails }) => (\r\n\t\t\t\t<Query \r\n\t\t\t\t\tquery={enquiryLocal}\r\n\t\t\t\t\tvariables={{ \r\n\t\t\t\t\t\tid: type === 'Enquiry' \r\n\t\t\t\t\t\t\t? id\r\n\t\t\t\t\t\t\t: enquiryId\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\tif (data && data.enquiryLocal) {\r\n\t\t\t\t\t\t\tconst { num, docs } = data.enquiryLocal\r\n\t\t\t\t\t\t\tconst addNewOrderForbidden = !docs.some(d => d.type === 'CO')\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<SubmenuDiv>\r\n\t\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\t\tc='rgba(0,0,0,.68)'\r\n\t\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\t\tcontent={`Заявка №${num}`}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Popup \r\n\t\t\t\t\t\t\t\t\t\tposition='bottom left'\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tflowing\r\n\t\t\t\t\t\t\t\t\t\tshowIf={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\ttrigger={\r\n\t\t\t\t\t\t\t\t\t\t\t<Div inline>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent='Заказ'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === 'new'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'new',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tenquiryId: id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Header content='Не все условия выполнены' />\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon name='cancel' color='red' />\r\n\t\t\t\t\t\t\t\t\t\t\tВыставлено КП\r\n\t\t\t\t\t\t\t\t\t\t</SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t\t\t\t</SubmenuDiv>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t} else return null\r\n\t\t\t\t\t}}\r\n\t\t\t\t</Query>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(getLayout, getLayoutOptions),\r\n)(EnquiriesSubmenu)\r\n","import React from 'react'\r\n\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport Menu from '../Menu'\r\nimport EnquiriesSubmenu from './EnquiriesSubmenu'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst EnquiriesMenu = ({\r\n\trefetchEnquiries,\r\n\tenquiriesAreLoading,\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details, setDetails }) => (\r\n\t\t\t\t<Menu\r\n\t\t\t\t\ttitle='Заявки и заказы'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tw='118.5px'\r\n\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\tta='left'\r\n\t\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\t\tonClick={refetchEnquiries}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\t\tcolor={enquiriesAreLoading ? 'blue' : undefined} \r\n\t\t\t\t\t\t\tloading={enquiriesAreLoading}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{enquiriesAreLoading ? 'Загрузка' : 'Обновить'}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\tcontent='Заявка'\r\n\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t&& details.id === 'new'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonClick={() => setDetails({type: 'Enquiry', id: 'new'})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{details && (\r\n\t\t\t\t\t\t(details.type === 'Enquiry' && details.id !== 'new')\r\n\t\t\t\t\t\t|| (details.type === 'Order' && details.id === 'new')\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\t\t<EnquiriesSubmenu />\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesMenu\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst STable = styled.table`\r\n\ttable-layout: fixed;\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n\t/* TODO Make this table with scrollable tbody (Not trivial css trick) */\r\n\t/* thead, tbody, tr {\r\n\t\tdisplay: block;\r\n\t} */\r\n`\r\n\r\nconst TableHeaderRow = styled.tr`\r\n\tcolor: rgba(0,0,0,.8);\r\n\tline-height: 1.5em;\r\n\tbackground: rgb(233, 234, 235);\r\n\tborder-top: 1px solid #d4d4d5;\r\n\t/* ${props => props.noTopBorder ? '' : 'border-top: 1px solid #d4d4d5;'} */\r\n\tborder-bottom: 1px solid #d4d4d5;\r\n\tfont-weight: bold;\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\t// @ts-ignore\r\n\t${props => props.w && `width: ${props.w};`}\r\n`\r\n\r\nconst TBody = styled.tbody`\r\n\t/* overflow-y: auto;\r\n  overflow-x: hidden; */\r\n`\r\n\r\nconst Table = ({\r\n\tchildren,\r\n\texpand,\r\n\tfields,\r\n\tindent,\r\n\tnoServiceField,\r\n\tnoTopBorder,\r\n\tselect,\r\n}) => {\r\n\tconst modes =  {\r\n\t\texpand: !!expand,\r\n\t\tindent: !!indent,\r\n\t\tnoServiceField: !!noServiceField,\r\n\t\tselect: !!select,\r\n\t}\r\n\tconst fieldsExtended = [\r\n\t\t...modes['indent'] ? [{\r\n\t\t\tname: 'indent',\r\n\t\t\twidth: indent\r\n\t\t}] : [],\r\n\t\t...!modes['noServiceField'] ? [{\r\n\t\t\tname: 'service',\r\n\t\t\twidth: '28px'\r\n\t\t}] : [],\r\n\t\t...modes['select'] ? [{\r\n\t\t\tname: 'select',\r\n\t\t\twidth: '28px'\r\n\t\t}]: [],\r\n\t\t...fields,\r\n\t\t// lastField is needed to take remaining width in fixed table-layout\r\n\t\t{ name: 'lastField' }\r\n\t]\r\n\treturn (\r\n\t\t<STable>\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<TableHeaderRow\r\n\t\t\t\t\t\tclassName='fz-tableHeaderRow'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{fieldsExtended.map(f =>{\r\n\t\t\t\t\t\t\t// console.log(f)\r\n\t\t\t\t\t\t\treturn <Td\r\n\t\t\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\tw={f.width}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{f.title}\r\n\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</TableHeaderRow>\r\n\t\t\t\t</thead>\r\n\t\t\t<TBody>\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t{children({\r\n\t\t\t\t\t\ttableFields: fieldsExtended.map(f => {\r\n\t\t\t\t\t\t\tconst field = { ...f }\r\n\t\t\t\t\t\t\tdelete field.width\r\n\t\t\t\t\t\t\tdelete field.title\r\n\t\t\t\t\t\t\treturn field\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t})}\r\n\t\t\t\t</Fragment>\r\n\t\t\t</TBody>\r\n\t\t</STable>\r\n\t)\r\n}\r\n\r\nexport default Table","import { conformToMask } from 'react-text-mask'\r\n\r\nexport const formatTel = ({ number, country }) => {\r\n\treturn country === 'rus'\r\n\t\t? '+7 ' + conformToMask(\r\n\t\t\t\tnumber,\r\n\t\t\t\t['(', /\\d/, /\\d/, /\\d/, ')', ' ', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, '-', /\\d/, /\\d/],\r\n\t\t\t\t{guide: false}\r\n\t\t\t).conformedValue\r\n\t\t: '+ ' + number\r\n}\r\n\r\nexport const currency = (num, trailing) => {\r\n\tif (!num && num !== 0) return  '- ₽'\r\n\tlet curNum = (num).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$& ').replace(/\\./, ',')\r\n\tif (!trailing) curNum = curNum.slice(0,-3)\r\n\treturn curNum + ' ₽'\r\n}\r\nexport const isNaN = Number.isNaN || function(value) {\r\n\treturn value !== value;\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Caret } from '../styled/styled-semantic'\r\n\r\nimport { getObjProp } from '../../utils/object'\r\nimport { currency } from '../../utils/format'\r\n\r\nconst Row = styled.tr`\r\n\tvertical-align: unset;\r\n\tfont-size: 1rem;\r\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t${props => !props.noRowHover && `\r\n\t\t:hover {\r\n\t\t\tbackground: ${props.lightRowHower\r\n\t\t\t\t? 'rgb(250, 250, 250)'\r\n\t\t\t\t: 'rgb(242, 242, 242)'};\r\n\t\t\tcolor: rgba(0,0,0,.95);\r\n\t\t}\r\n\t`}\r\n\t${props => !!props.onClick && `cursor: pointer;`}\r\n\t${props => props.lineHeight && `\r\n\t\tline-height: ${props.lineHeight};\r\n\t`}\r\n\t${props => props.secondary && `\r\n\t\tbackground: rgba(0,0,50,.02);\r\n\t\t${!props.lastSecondaryRow ? 'border-bottom: none;' : ''}\r\n\t`}\r\n\t${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\r\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t`}\r\n\t${props => props.bold && `\r\n\t\tfont-weight: bold;\r\n\t`}\r\n`\r\n\r\nconst tdActiveStyle = `\r\n\tbackground: rgba(0,0,0,.12);\r\n\topacity: 1 !important;\r\n\t.icon {\r\n\t\topacity: 1 !important;\r\n\t}\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\twhite-space: nowrap;\r\n\ttext-overflow: ellipsis;\r\n\t${props => !!props.onClick && `cursor: pointer;`}\r\n\t${props => props.service && `padding-left: 3px;`}\r\n\t${Row}:not(:hover) & {\r\n\t\t${props => props.hoverable\r\n\t\t\t&& props.hideUnhovered\r\n\t\t\t&& !props.active\r\n\t\t\t&& !props.hasEntries && `\r\n\t\t\topacity: 0 !important;\r\n\t\t`}\r\n\t}\r\n\t${props => props.color && `color: ${props.color};`}\r\n\t${props => props.truncated && `position: relative`}\r\n\t${props => props.hoverable && `\r\n\t\ttransition: background .3s ease;\r\n\t\t${props.hideUnhovered && `\r\n\t\t\topacity: 0.8;\r\n\t\t\tpadding-left: ${props.hasEntries ? '5px' : '7.5px'};\r\n\t\t`};\r\n\t\t:hover {\r\n\t\t\t${tdActiveStyle}\r\n\t\t}\r\n\t\t${props.active ? tdActiveStyle : ''}\r\n\t`}\r\n`\r\n\r\nconst Untruncated = styled.div`\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\tbox-sizing: content-box;\r\n\t/*\r\n\t// horizontal overlay\r\n\t:hover {\r\n\t\twidth: max-content;\r\n\t\toverflow: unset;\r\n\t\tbackground-color: white;\r\n\t} */\r\n\t/* vertical overlay */\r\n\t:hover {\r\n\t\tposition: absolute;\r\n\t\ttop: 1px;\r\n\t\tleft: -4px;\r\n\t\twidth: 100%;\r\n\t\tz-index: 1;\r\n\t\toverflow: unset;\r\n\t\twhite-space: normal;\r\n\t\tbackground-color: white;\r\n\t\tborder: 5px solid rgb(242,242,242);\r\n    border-top: none;\r\n\t}\r\n`\r\n\r\nconst TableRow = props => {\r\n\tconst {\r\n\t\ttableFields,\r\n\t\trowFields = [],\r\n\t\tentity,\r\n\t\texpandFor,\r\n\t\texpanded,\r\n\t\texpand,\r\n\t\tselect,\r\n\t\t...rest \r\n\t} = props\r\n\t// const [isRowHovered, setIsRowHovered] = useState(false)\r\n\t// rowFields are merged into tableFields\r\n\tconst fields = tableFields.map(f => {\r\n\t\tconst rowField = rowFields.find(rf => rf.name === f.name)\r\n\t\treturn rowField ? { ...f, ...rowField } : f\r\n\t})\r\n\tconst { selected, disabled } = entity\r\n\treturn (\r\n\t\t<Row\r\n\t\t\t{...rest}\r\n\t\t\t// onMouseEnter={() => setIsRowHovered(true)}\r\n\t\t\t// onMouseLeave={() => setIsRowHovered(false)}\r\n\t\t>\r\n\t\t\t{fields.map(f => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'service'\r\n\t\t\t\t\t&& typeof expanded !== 'undefined'\r\n\t\t\t\t\t&& entity[expandFor].length\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\texpand()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Caret\r\n\t\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'select'\r\n\t\t\t\t\t&& typeof select !== 'undefined'\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\tselect()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\tselected === 'partly' ? 'square' :\r\n\t\t\t\t\t\t\t\tselected \r\n\t\t\t\t\t\t\t\t\t? 'check square outline'\r\n\t\t\t\t\t\t\t\t\t: 'square outline'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcomponent,\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tpath,\r\n\t\t\t\t\ticon,\r\n\t\t\t\t\ticonColor,\r\n\t\t\t\t\tonClick,\r\n\t\t\t\t\t...rest\r\n\t\t\t\t} = f\r\n\t\t\t\tif (component || content) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Td\r\n\t\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t!!onClick\r\n\t\t\t\t\t\t\t\t? e => {\r\n\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\tonClick()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{/* {component && React.cloneElement(component, { isRowHovered })} */}\r\n\t\t\t\t\t\t\t{component && component}\r\n\t\t\t\t\t\t\t{content ? content : null}\r\n\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tlet val = value || (path ? getObjProp(entity, path) : null)\r\n\t\t\t\tif (val && name === 'amount') val = currency(val)\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t!!onClick\r\n\t\t\t\t\t\t\t? e => {\r\n\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\tonClick()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{val && icon &&\r\n\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\tlink={!!onClick}\r\n\t\t\t\t\t\t\t\tname={icon}\r\n\t\t\t\t\t\t\t\tcolor={iconColor || undefined}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{f.truncated\r\n\t\t\t\t\t\t\t? <Untruncated>\r\n\t\t\t\t\t\t\t\t\t{val}\r\n\t\t\t\t\t\t\t\t</Untruncated>\r\n\t\t\t\t\t\t\t: val\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</Row>\r\n\t)\r\n}\r\n\r\nexport default TableRow","export const getObjProp = function(obj, path){\r\n  const pathArr = path.split('.')\r\n  for (let i=0; i<pathArr.length; i++){\r\n      obj = obj[pathArr[i]]\r\n      if (!obj) return undefined\r\n  }\r\n  return obj\r\n}","import React, { Fragment } from 'react'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\n\r\nconst fields = [{\r\n\tname: 'num',\r\n\tpath: 'num',\r\n\ttitle: '№',\r\n\twidth: '45px'\r\n},{\r\n\tname: 'date',\r\n\tpath: 'dateLocal',\r\n\ttitle: 'Дата',\r\n\twidth: '110px'\r\n},{\r\n\tname: 'org',\r\n\tpath: 'org.name',\r\n\ttitle: 'Организация',\r\n\twidth: '225px',\r\n  truncated: true\r\n},{\r\n\tname: 'emps',\r\n\tpath: 'org.name',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'model',\r\n\tpath: 'model.name',\r\n\ttitle: 'Изделие',\r\n\twidth: '250px'\r\n},{\r\n\tname: 'qty',\r\n\tpath: 'qty',\r\n\ttitle: 'Кол.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'reserved',\r\n\ttitle: 'Рез.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'amount',\r\n\ttitle: 'Сумма',\r\n\twidth: '105px'\r\n},{\r\n\tname: 'status',\r\n\tpath: 'status.name',\r\n\ttitle: 'Статус',\r\n\twidth: '130px'\r\n}]\r\n\r\nconst EnquiriesTable = ({ enquiries }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details,extra, setDetails, bottomPanel, setBottomPanel, setExpanded }) =>\r\n\t\t\t\t<Table\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\tenquiries.map(enquiry => {\r\n\t\t\t\t\t\t\tconst { id, org, docs, isExpanded, model, orders } = enquiry\r\n\t\t\t\t\t\t\tconst active = details\r\n\t\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Fragment key={id} >\r\n\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\tlineHeight='21px'\r\n\t\t\t\t\t\t\t\t\t\tentity={enquiry}\r\n\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: docs.length && docs[docs.length - 1].amount\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'emps',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: org.employees.length ? 'user' : 'user plus',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'grey',\r\n\t\t\t\t\t\t\t\t\t\t\thoverable: true,\r\n\t\t\t\t\t\t\t\t\t\t\thideUnhovered: true,\r\n\t\t\t\t\t\t\t\t\t\t\thasEntries: !!org.employees.length,\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: org.employees.length || ' ',\r\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetBottomPanel({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Employees',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId: org.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tactive: bottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.type === 'Employees'\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.orgId === org.id\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'model',\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: <Div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td='flex'\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tminw='215px'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{model.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!!model.drawings.length &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmr='5px'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\to='.6'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='image outline'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor='grey'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Div>,\r\n\t\t\t\t\t\t\t\t\t\t\thoverable: true,\r\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Model',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: model.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tactive: details\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& details.type === 'Model'\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& details.id === model.id\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'reserved',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: orders.reduce((res, o) => res += o.prods.length, 0),\r\n\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\texpandFor='orders'\r\n\t\t\t\t\t\t\t\t\t\texpanded={isExpanded}\r\n\t\t\t\t\t\t\t\t\t\texpand={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)}}\r\n\t\t\t\t\t\t\t\t\t\tactive={active}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !active ? true : !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t{\tisExpanded && orders.map((order, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { id, prods } = order\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === enquiry.orders.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\tentity={order}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'num',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'fullnum'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'org',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.org.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'model',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.model && enquiry.model.name //check only for migration from aws\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserved',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: prods.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'amount'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& details.type === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesTable","import { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\n\r\nimport { enquiryDetails, enquiryLocal } from '../../graphql/enquiry'\r\nimport { orderDetails, orderLocal } from '../../graphql/order'\r\nimport { modelDetails, modelLocal } from '../../graphql/model'\r\n\r\nconst DetailsDataProvider = ({\r\n  children,\r\n  type,\r\n  id,\r\n  query1,\r\n  query2,\r\n  query3,\r\n  localQuery1,\r\n  localQuery2,\r\n  localQuery3,\r\n}) => {\r\n  const query = query1 || query2 || query3\r\n  const { loading, error, refetch } = query\r\n  const entity =\r\n    type === 'Enquiry' ? query.enquiry :\r\n    type === 'Order' ? query.order :\r\n    type === 'Model' ? query.model\r\n    : null\r\n  const localQuery = localQuery1 || localQuery2 || localQuery3\r\n  const localEntity =\r\n    id === 'new' ? null :\r\n    type === 'Enquiry' ? localQuery.enquiryLocal :\r\n    type === 'Order' ? localQuery.orderLocal :\r\n    type === 'Model' ? localQuery.modelLocal\r\n    : null\r\n  return children({\r\n    loading,\r\n    error,\r\n    refetch,\r\n    entity,\r\n    localEntity\r\n  })\r\n}\r\n\r\nexport default compose(\r\n  graphql(enquiryDetails, {\r\n    name: 'query1',\r\n    skip: ({ type }) => type !== 'Enquiry'\r\n  }),\r\n  graphql(orderDetails, {\r\n    name: 'query2',\r\n    skip: ({ type }) => type !== 'Order'\r\n  }),\r\n  graphql(modelDetails, {\r\n    name: 'query3',\r\n    skip: ({ type }) => type !== 'Model'\r\n  }),\r\n  graphql(enquiryLocal, {\r\n    name: 'localQuery1',\r\n    skip: ({ type, id }) => type !== 'Enquiry' || id === 'new',\r\n  }),\r\n  graphql(orderLocal, {\r\n    name: 'localQuery2',\r\n    skip: ({ type, id }) => type !== 'Order' || id === 'new',\r\n  }),\r\n  graphql(modelLocal, {\r\n    name: 'localQuery3',\r\n    skip: ({ type, id }) => type !== 'Model' || id === 'new',\r\n  }),\r\n)(DetailsDataProvider)","import React, { forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section, Caret } from '../styled/styled-semantic'\r\n\r\nconst SIcon = styled(Icon)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\nconst SCaret = styled(Caret)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\n\r\nexport default forwardRef(({\r\n\tchildren,\r\n\t// style\r\n\tsize,\r\n\tbottomBorder,\r\n\tclose,\r\n\texpanded,\r\n\tdisabled,\r\n\tonClick,\r\n\tnoIndent,\r\n}, ref) => {\r\n\tconst modes = {\r\n\t\t...close && { close: true },\r\n\t\t...(typeof expanded !== 'undefined') && { expand: true },\r\n\t}\r\n\treturn (\r\n\t\t<Section\r\n\t\t\tref={ref}\r\n\t\t\tbc='white'\r\n\t\t\thead\r\n\t\t\tnoLP\r\n\t\t\tnoIndent={noIndent}\r\n\t\t\tbottomBorder={bottomBorder || true}\r\n\t\t\tsize={size || undefined}\r\n\t\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\t{ modes['close']\r\n\t\t\t\t?\t<SIcon link\r\n\t\t\t\t\t\tsize='big'\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tonClick={close}\r\n\t\t\t\t\t/> :\r\n\t\t\t\t// TODO make disabled work (grey out color)\r\n\t\t\t\tmodes['expand']\r\n\t\t\t\t? <SCaret\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t/> : null\r\n\t\t\t}\r\n\t\t\t{children}\r\n\t\t</Section>\r\n\t)\r\n})\r\n","import React from 'react'\r\n\r\nimport { Span } from '../styled/styled-semantic'\r\n\r\nconst DetailsHeaderSubitle = ({ content }) => {\r\n\treturn (\r\n\t\t<Span\r\n\t\t\tml='10px'\r\n\t\t\tfs='1rem'\r\n\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\tws='0.5em'\r\n\t\t>\r\n\t\t\t{content}\r\n\t\t</Span>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderSubitle\r\n","import React from 'react'\r\n\r\nimport { Header } from '../styled/styled-semantic'\r\nimport DetailsHeaderSubitle from './DetailsHeaderSubitle'\r\n\r\nconst DetailsHeaderTitle = ({\r\n\ttitle,\r\n\tsubtitle,\r\n\tsize\r\n}) => {\r\n\treturn (\r\n\t\t<Header\r\n\t\t\tm='0'\r\n\t\t\tsize={size || 'medium'}\r\n\t\t>\r\n\t\t\t{title}\r\n\t\t\t{(subtitle || subtitle === 0) &&\r\n\t\t\t\t<DetailsHeaderSubitle\r\n\t\t\t\t\tcontent={subtitle}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</Header>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderTitle\r\n","import React from 'react'\r\n\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nconst DetailsHeaderButtons = ({ children }) => {\r\n\treturn (\r\n\t\t<Div\r\n\t\t\tml='auto'\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Div>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderButtons\r\n","import React from 'react'\r\n\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nconst SButton = styled(Button)`\r\n\tpadding: .78571429em !important;\r\n\t&>i {\r\n\t\topacity: .9 !important;\r\n\t\tmargin: 0 !important;\r\n\t}\r\n`\r\n\r\nconst RefreshButton = ({ loading, onClick }) => {\r\n\treturn (\r\n\t\t<SButton\r\n\t\t\tactiveColor='blue'\r\n\t\t\tactive={loading}\r\n\t\t\tonClick={onClick} >\r\n\t\t\t<Icon \r\n\t\t\t\tname='refresh'\r\n\t\t\t\tloading={loading} \r\n\t\t\t/>\r\n\t\t</SButton>\r\n\t)\r\n}\r\n\r\nexport default RefreshButton\r\n","import React from 'react'\r\n\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\nimport RefreshButton from '../common/RefreshButton'\r\n\r\nconst settings = {\r\n\tEnquiry: {\r\n\t\ttitleNew: 'Новая заявка',\r\n\t\ttitleExisting: 'Заявка №',\r\n\t},\r\n\tOrder: {\r\n\t\ttitleNew: 'Новый заказ',\r\n\t\ttitleExisting: 'Заказ №',\r\n\t},\r\n\tModel: {\r\n\t\ttitleNew: 'Новое изделие',\r\n\t\ttitleExisting: '',\r\n\t}\r\n}\r\n\r\nconst DetailsMainHeader = ({\r\n\ttype,\r\n\tcloseDetails,\r\n\tloading,\r\n\trefresh,\r\n\tsetDetails,\r\n\teditMode,\r\n\tlocalEntity\r\n}) => {\r\n\tconst { id, num, fullnum, name, article, dateLocal } = localEntity || {}\r\n\treturn (\r\n\t\t<DetailsHeaderContainer\r\n\t\t\tclose={closeDetails}\r\n\t\t>\r\n\t\t\t{ !id && // new entity\r\n\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\ttitle={settings[type].titleNew}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{ id && // existing entity\r\n\t\t\t\t<>\r\n\t\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\t\ttitle={type === 'Model'\r\n\t\t\t\t\t\t\t? name\r\n\t\t\t\t\t\t\t: settings[type].titleExisting + ' ' + (num || fullnum)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubtitle={type === 'Model'\r\n\t\t\t\t\t\t\t? (article ? `Артикул: ${article}` : '')\r\n\t\t\t\t\t\t\t: 'от ' + dateLocal\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t\t<RefreshButton\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={refresh}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ticon='edit'\r\n\t\t\t\t\t\t\tactiveColor='blue'\r\n\t\t\t\t\t\t\tactive={editMode || false}\r\n\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\t\tid: localEntity.id,\r\n\t\t\t\t\t\t\t\teditMode: true\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t/> \r\n\t\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</DetailsHeaderContainer>\r\n\t)\r\n}\r\n\r\nexport default DetailsMainHeader\r\n","import styled from 'styled-components'\r\n\r\nexport const Table = styled.table`\r\n\t/* table-layout: fixed; */\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n`\r\n\r\nexport const Tr = styled.tr`\r\n  margin: 0 0 1em;\r\n  line-height: 1.4285em;\r\n  color: rgba(0,0,0,.87);\r\n`\r\n\r\nexport const Td = styled.td`\r\n  :nth-child(1) {\r\n\t\twidth: ${props => props.theme.widths.formLabel};\r\n\t// color: rgba(0,0,0,.87);\r\n\t/* font-size: .92857143em; */\r\n\t/* line-height: 32px; */\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n\t\tvertical-align: top;\r\n  }\r\n  :nth-child(2) {\r\n\t\t// width: 100px;\r\n\t\tfont-size: 1em;\r\n\t\tfont-weight: bold;\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n  }\r\n`\r\nexport const InputTd = styled(Td)`\r\n\tpadding-top: 0 !important;\r\n`\r\n\r\nexport const EditorTd = styled(InputTd)`\r\n\tfont-weight: unset !important;\r\n\t/* padding-bottom: 0 !important; */\r\n`","import React from 'react'\r\nimport {\r\n\tEditor,\r\n\tEditorState,\r\n\tContentState,\r\n\tRichUtils,\r\n\tconvertFromHTML,\r\n\tgetDefaultKeyBinding,\r\n\tKeyBindingUtil\r\n} from 'draft-js'\r\nimport 'draft-js/dist/Draft.css'\r\nimport {stateToHTML} from 'draft-js-export-html'\r\n\r\nclass DraftEditor extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tlet editorState\r\n\t\tif (props.initFromHtml) {\r\n\t\t\tconst blocksFromHTML = convertFromHTML(props.initFromHtml)\r\n\t\t\teditorState = EditorState.createWithContent(\r\n\t\t\t\tContentState.createFromBlockArray(\r\n\t\t\t\t\tblocksFromHTML.contentBlocks,\r\n\t\t\t\t\tblocksFromHTML.entityMap\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\teditorState = EditorState.createEmpty()\r\n\t\t}\r\n\t\tthis.state = { \r\n\t\t\teditorState,\r\n\t\t\toriContent: editorState.getCurrentContent()\r\n\t\t}\r\n\t}\r\n\tonChange = (editorState) => {\r\n\t\tthis.setState({ editorState })\r\n\t\tconst newContent = editorState.getCurrentContent()\r\n\t\tconst { setEditorHasText, setEditorDiff, setHasFocus } = this.props\r\n\t\tif (editorState && setEditorHasText) setEditorHasText(newContent.hasText())\r\n\t\tif (setEditorDiff) setEditorDiff(newContent !== this.state.oriContent)\r\n\t\tif (setHasFocus) setHasFocus(editorState.getSelection().getHasFocus())\r\n\t}\r\n\tkolmechKeyBindingFn = (e) => {\r\n\t\t// catch Ctrl + Enter event\r\n\t\tif (e.keyCode === 13 && KeyBindingUtil.hasCommandModifier(e)) {\r\n\t\t  return 'ctrlEnter'\r\n\t\t}\r\n\t\treturn getDefaultKeyBinding(e)\r\n\t}\r\n\thandleKeyCommand = (command, editorState) => {\r\n\t\t// handle Ctrl + Enter command\r\n\t\tif (command === 'ctrlEnter') {\r\n\t\t\tthis.props.onCtrlEnter()\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\tconst newState = RichUtils.handleKeyCommand(editorState, command);\r\n\t\tif (newState) {\r\n\t\t\tthis.onChange(newState);\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\treturn 'not-handled'\r\n\t}\r\n\tclear = () => this.setState({ \r\n\t\teditorState: EditorState.push(this.state.editorState, ContentState.createFromText(''), 'remove-range')\r\n\t})\r\n\texportHtml = () => {\r\n\t\tconst html = stateToHTML(this.state.editorState.getCurrentContent())\r\n\t\tif (!convertFromHTML(html).contentBlocks) return null\r\n\t\treturn html\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Editor\r\n\t\t\t\teditorState={this.state.editorState}\r\n\t\t\t\tonChange={this.onChange}\r\n\t\t\t\thandleKeyCommand={this.handleKeyCommand}\r\n\t\t\t\tkeyBindingFn={this.kolmechKeyBindingFn}\r\n\t\t\t\treadOnly={this.props.readOnly}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default DraftEditor","import React, { Component } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport DraftEditor from './DraftEditor'\r\n\r\nconst EditorWrapper = styled.div`\r\n\tpadding: calc(0.678571em - 1px) 1em;\r\n\tline-height: 1.4285em;\r\n\tborder: 1px solid rgba(34,36,38,.15);\r\n\tborder-radius: .28571429rem;\r\n\ttransition: all .1s ease;\r\n\t${({ borderless, hasFocus, diff }) =>\r\n\t\tborderless\r\n\t\t&& !hasFocus\r\n\t\t&& !diff && `\r\n\t\t\tmargin-left: -1em;\r\n\t\t\tborder: 1px solid white;\r\n\t\t\t:hover {\r\n\t\t\t\tbackground: rgba(0,0,0,.05);\r\n\t\t\t\tcolor: rgba(0,0,0,.65);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\t\t`\r\n\t}\r\n`\r\n\r\nclass WrappedDraftEditor extends Component {\r\n\tstate = {\r\n\t\thasFocus: false\r\n\t}\r\n\tsetHasFocus = (hasFocus) => this.setState({ hasFocus })\r\n\trender() {\r\n\t\tconst { hasFocus } = this.state\r\n\t\tconst {\r\n\t\t\tborderless,\r\n\t\t\tdiff,\r\n\t\t\tforwardedRef,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\t\treturn (\r\n\t\t\t<EditorWrapper\r\n\t\t\t\tborderless={borderless}\r\n\t\t\t\thasFocus={hasFocus}\r\n\t\t\t\tdiff={diff}\r\n\t\t\t>\r\n\t\t\t\t<DraftEditor\r\n\t\t\t\t\tref={forwardedRef}\r\n\t\t\t\t\tsetHasFocus={this.setHasFocus}\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t/>\r\n\t\t\t</EditorWrapper>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default React.forwardRef((props, ref) =>\r\n\t<WrappedDraftEditor\r\n\t\tforwardedRef={ref}\r\n\t\t{...props}\r\n\t/>\r\n)","const validateInn = (inn, error) => {\r\n    var result = false;\r\n\tif (typeof inn === 'number') {\r\n        inn = inn.toString();\r\n\t} else if (typeof inn !== 'string') {\r\n        inn = '';\r\n\t}\r\n\tif (!inn.length) {\r\n        error.code = 1;\r\n\t\terror.message = 'ИНН пуст';\r\n\t} else if (/[^0-9]/.test(inn)) {\r\n        error.code = 2;\r\n\t\terror.message = 'ИНН может состоять только из цифр';\r\n\t} else if ([10, 12].indexOf(inn.length) === -1) {\r\n        error.code = 3;\r\n\t\terror.message = 'ИНН может состоять только из 10 или 12 цифр';\r\n\t} else {\r\n        var checkDigit = function (inn, coefficients) {\r\n            var n = 0;\r\n\t\t\tfor (var i in coefficients) {\r\n                n += coefficients[i] * inn[i];\r\n\t\t\t}\r\n            // eslint-disable-next-line\r\n\t\t\treturn parseInt(n % 11 % 10);\r\n\t\t};\r\n        // eslint-disable-next-line\r\n\t\tswitch (inn.length) {\r\n            case 10:\r\n            var n10 = checkDigit(inn, [2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if (n10 === parseInt(inn[9])) {\r\n                result = true;\r\n            }\r\n            break;\r\n\t\t\tcase 12:\r\n            var n11 = checkDigit(inn, [7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            var n12 = checkDigit(inn, [3, 7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if ((n11 === parseInt(inn[10])) && (n12 === parseInt(inn[11]))) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (!result) {\r\n\t\t\terror.code = 4;\r\n\t\t\terror.message = 'Неправильное контрольное число ИНН';\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport default validateInn","export const isValidDate = date => date instanceof Date && !isNaN(date.valueOf())\r\nexport const isValidDateString = dateString => isValidDate(new Date(Date.parse(dateString))) && dateString.length === 10\r\nexport const tz = new Date().getTimezoneOffset() * 60000\r\nexport const toLocalISOString = date => new Date(date.getTime() - tz).toISOString()\r\nexport const toLocalDateString = date => toLocalISOString(date).slice(0,10)\r\nexport const toLocalDatetimeString = date => toLocalISOString(date).slice(0,16)\r\nexport const fromLocalISOString = (string) => new Date(Date.parse(string) + tz)\r\n// util to split array into chunks\r\nexport const toChunks = (arr, size) => {\r\n    let chunks = []\r\n    for (let i = 0; i < arr.length; i += size) {\r\n        chunks.push(arr.slice(i, i + size))\r\n    }\r\n    return chunks\r\n}\r\n\r\n// groupBy = (xs, key) => xs.reduce((rv, x) => {\r\n//     (rv[x[key]] = rv[x[key]] || []).push(x)\r\n//     return rv\r\n//   }, {})\r\n// groupByArray(xs, key) => xs.reduce( (rv, x) => {\r\n//   let v = key instanceof Function ? key(x) : x[key];\r\n//   let el = rv.find((r) => r && r.key === v);\r\n//   if (el) { el.values.push(x); } else { rv.push({ key: v, values: [x] }); }\r\n//   return rv;\r\n// }, [])\r\n// const splitBy = (xs, key) => xs.reduce( (rv, x) => {\r\n//   let el = rv.find(r => r[0][key] === x[key])\r\n//   if (el) { el.push(x); } else { rv.push([x]); }\r\n// }, [])\r\n","import gql from 'graphql-tag'\r\n\r\nexport const opTypeFragmentBasic = gql`\r\n\tfragment opTypeFragmentBasic on OpType {\r\n\t\tid\r\n\t\tlaborCost\r\n\t\tlaborPrice\r\n\t\tname\r\n\t\topClass\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\nexport const orgFragmentBasic = gql`\r\n\tfragment OrgFragmentBasic on Org {\r\n\t\tid\r\n\t\tinn\r\n\t\tname\r\n\t}\r\n`\r\n\r\nexport const orgFragmentFull = gql`\r\n\tfragment OrgFragmentFull on Org {\r\n\t\t...OrgFragmentBasic\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\n\r\nexport const orgExecFragment = gql`\r\n\tfragment orgExecFragment on Org {\r\n\t\tid\r\n\t\tname\r\n\t\texec {\r\n\t\t\tid\r\n\t\t\topTypes { ...opTypeFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const org = gql`\r\n\tquery org ($id: ID!) {\r\n\t\torg (id: $id) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const allOrgs = gql`\r\n\tquery allOrgs {\r\n\t\torgs {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const createContract = gql`\r\n\tmutation createContract($id: ID!, $date: String) {\r\n\t\tcreateContract(id: $id, date: $date) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const createPostEnvelopeAddressInsert = gql`\r\n\tmutation createPostEnvelopeAddressInsert($orgId: ID!) {\r\n\t\tcreatePostEnvelopeAddressInsert(orgId: $orgId) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const createOrg = gql`\r\n\tmutation createOrg($inn: String!) {\r\n\t\tcreateOrg(inn: $inn) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const mergeOrg = gql`\r\n\tmutation mergeOrg($id: ID!, $inn: String!) {\r\n\t\tmergeOrg(id: $id, inn: $inn) {\r\n\t\t\t...OrgFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orgFragmentFull}\r\n`\r\n\r\nexport const orgLocal = gql`\r\n\tquery OrgLocal ($id: ID!) {\r\n\t\torgLocal (id: $id) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const orgDetails = gql`\r\n\tquery orgDetails ($id: ID!) {\r\n\t\torgDetails (id: $id) {\r\n\t\t\t...OrgFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orgFragmentFull}\r\n`\r\n\r\nexport const upsertOrgExec = gql`\r\n\tmutation upsertOrg($input: OrgInput!) {\r\n\t\tupsertOrg(input: $input) {\r\n\t\t\t...orgExecFragment\r\n\t\t}\r\n\t}\r\n\t${orgExecFragment}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const allOrgsAndModels = gql`\r\n    query AllOrgsAndModels {\r\n        orgs {\r\n            id\r\n            inn\r\n            name\r\n        }\r\n        models {\r\n            id\r\n            article\r\n            name\r\n        }\r\n    }\r\n`","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { toLocalISOString, isValidDate, isValidDateString } from '../../utils/dates'\r\nimport { Button } from 'semantic-ui-react';\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.error && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nexport default ({\r\n\tselectedDate,\r\n\tselectDay,\r\n\terror\r\n}) => {\r\n\tconst inputRef = useRef(null)\r\n\tconst [ date, setDate ] = useState(selectedDate || new Date())\r\n\tconst [ input, setInput ] = useState(toLocalISOString(date).slice(0, 10))\r\n\tconst [ err, setErr ] = useState('')\r\n\t// useEffect(() => {\r\n\t// \tisValidDate(selectedDate)\r\n\t// \t\t? setDate(selectedDate) || setErr('') || setInput(toLocalISOString(date).slice(0, 10))\r\n\t// \t\t: setErr('Provided date is not valid')\r\n\t// }, [selectedDate])\r\n\t// useEffect(() => {\r\n\t// \tconsole.log('useEffect > ') || setDate(selectedDate)\r\n\t// \t|| setInput(toLocalISOString(selectedDate).slice(0, 10))\r\n\t// }, [date, selectedDate, input])\r\n\tuseEffect(() => {\r\n\t\tconsole.log('useEffect > ') || setDate(selectedDate)\r\n\t\t|| setInput(toLocalISOString(selectedDate).slice(0, 10))\r\n\t}, [selectedDate])\r\n\tconsole.log(' render > date, input, err > ', date, input, err)\r\n\treturn (\r\n\t\t<PickerDiv\r\n\t\t\terror={err}\r\n\t\t>\r\n\t\t\t<Button\r\n\t\t\t\tonClick={() => setInput(input.slice(0,-1))}\r\n\t\t\t>\r\n\t\t\t\tClick ME!\r\n\t\t\t</Button>\r\n\t\t\t<DayPickerInput\r\n\t\t\t\tref={inputRef}\r\n\t\t\t\tvalue={input}\r\n\t\t\t\tonDayChange={date => {\r\n\t\t\t\t\t// console.log('inputRef > ', inputRef.current.input.value)\r\n\t\t\t\t\tconsole.log('onDateChange > ') ||\r\n\t\t\t\t\tisValidDateString(inputRef.current.input.value)\r\n\t\t\t\t\t\t? setErr('') || setDate(date)\r\n\t\t\t\t\t\t: setErr('Provided date is not valid')\r\n\t\t\t\t}}\r\n\t\t\t\tonDayPickerHide={() => {\r\n\t\t\t\t\tconsole.log('onDayPickerHide > ')\r\n\t\t\t\t\tconsole.log('selectedDate > ', selectedDate)\r\n\t\t\t\t\tconsole.log('toLocalISOString(selectedDate).slice(0, 10) > ', toLocalISOString(selectedDate).slice(0, 10))\r\n\t\t\t\t\tconsole.log('inputRef.current.input.value > ', inputRef.current.input.value)\r\n\t\t\t\t\tconsole.log('isValidDateString(inputRef.current.input.value) > ', isValidDateString(inputRef.current.input.value))\r\n\t\t\t\t\tconsole.log('((date.getTime() !== selectedDate.getTime()) > ', date.getTime() !== selectedDate.getTime())\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn ((date.getTime() !== selectedDate.getTime())\r\n\t\t\t\t\t\t&& isValidDateString(inputRef.current.input.value))\r\n\t\t\t\t\t\t\t?\t(console.log('selectDay > ') || selectDay(date))\r\n\t\t\t\t\t\t\t// : (console.log('setDate & input > ') || setDate(selectedDate)|| setInput(toLocalISOString(selectedDate).slice(0, 10))) || setErr('')\r\n\t\t\t\t\t\t\t: (console.log('setDate & input > ')\r\n\t\t\t\t\t\t\t\t|| setDate(selectedDate)\r\n\t\t\t\t\t\t\t\t|| setInput(toLocalISOString(selectedDate).slice(0, 10)))\r\n\t\t\t\t\t\t\t\t|| setErr('')\r\n\t\t\t\t\t\t\t\t|| (inputRef.current.input.value = toLocalISOString(selectedDate).slice(0, 10))\r\n\t\t\t\t}\r\n\t\t\t\t\t\t// ? setErr('') || setDate(date)\r\n\t\t\t\t\t\t// : setErr('Provided date is not valid')\r\n\t\t\t\t\t// console.log('date, selectedDate > ', date, selectedDate)\r\n\t\t\t\t\t// (date.getTime() !== selectedDate.getTime()) && selectDay(date)\r\n\t\t\t\t\t// () => (date.getTime() !== selectedDate.getTime()) && selectDay(date)\r\n\t\t\t\t\t// console.log('onDayPickerHide > ', date)\r\n\t\t\t\t\t// selectDay(date)\r\n\t\t\t\t}\r\n\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\tmonth: selectedDate\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</PickerDiv>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { Section, Header, Div, Icon } from '../styled/styled-semantic';\r\n\r\nexport default ({\r\n  title,\r\n  content,\r\n  onClose\r\n}) => {\r\n  return (\r\n    <Div\r\n      m='0 -1em 1em -55px'\r\n    >\r\n      <Section\r\n        head\r\n        minor\r\n        secondary\r\n        topBorder\r\n        bottomBorder\r\n        noLP={!!onClose}\r\n      >\r\n        {!!onClose &&\r\n          <Icon\r\n            bs='content-box'\r\n            w='calc(55px - 1em)'\r\n            m='0 0.5em'\r\n            link\r\n            size='large'\r\n            name='close'\r\n            // onClick={() => onClose()}\r\n            onClick={onClose}\r\n          />\r\n        }\r\n        <Header\r\n          m='0'\r\n        >\r\n          {title}\r\n        </Header>\r\n      </Section>\r\n      <Section\r\n        secondary\r\n        bottomBorder\r\n      >\r\n        {content}\r\n      </Section>\r\n    </Div>\r\n  )\r\n}\r\n","import produce from 'immer'\r\n\r\nexport const projectEntity = (entity, schema) => {\r\n\tlet result = {}\r\n\thandleObj(schema, entity, result)\r\n\treturn result\r\n}\r\n\r\nexport const preparePayload = (values, initialValues, schema) => {\r\n\tlet result = {}\r\n\thandlePayloadObj(schema, initialValues, values, result)\r\n\treturn result\r\n}\r\n\r\nconst handleObj = (objSchema, obj = {}, result) => {\r\n\t// preserve ids of entity objects\r\n\tif (obj.id) result.id = obj.id\r\n\tObject.keys(objSchema).forEach(k => {\r\n\t\tconst type = typeof objSchema[k]\r\n\t\t// NOTE form schema should contain only non-empty nested objects\r\n\t\tif (type === 'object' && Array.isArray(objSchema[k]))\r\n\t\t\treturn handleArr(objSchema[k], obj[k], result[k] = [])\r\n\t\tif (type === 'object')\r\n\t\t\treturn handleObj(objSchema[k], obj[k], result[k] = {})\r\n\t\tif (k.endsWith('Id') && !!obj[k.slice(0, -2)])\r\n\t\t\treturn result[k] = obj[k.slice(0, -2)].id\r\n\t\tresult[k] = obj[k] || objSchema[k]\r\n\t})\r\n}\r\n\r\nconst handleArr = (arrSchema, arr = [], resultArr) => {\r\n\t// NOTE schema array should contain one element only just to define schema\r\n\tconst type = typeof arrSchema[0]\r\n\t// TODO handle array of primitives (now only collections)\r\n\tif (type === 'object') {\r\n\t\treturn arr.length\r\n\t\t\t? arr.forEach((obj, i) => handleObj(arrSchema[0], obj, resultArr[i] = {}))\r\n\t\t\t: handleObj(arrSchema[0], {}, resultArr[0] = {})\r\n\t}\r\n}\r\n\r\nconst handlePayloadObj = (objSchema, initialObj, obj, result) => {\r\n\t// preserve ids of entity objects\r\n\tif (obj.id) result.id = obj.id\r\n\tObject.keys(objSchema).forEach(k => {\r\n\t\t// console.log('k > ', k)\r\n\t\t// console.log('objSchema[k] > ', objSchema[k])\r\n\t\tconst type = typeof objSchema[k]\r\n\t\t// NOTE form schema should contain only non-empty nested objects\r\n\t\tif (type === 'object' && Array.isArray(objSchema[k]))\r\n\t\t\treturn handlePayloadArr(objSchema[k], initialObj[k], obj[k], result[k] = [])\r\n\t\tif (type === 'object')\r\n\t\t\treturn handlePayloadObj(objSchema[k], initialObj[k], obj[k], result[k] = {})\r\n\t\t// result includes changed values\r\n\t\tif (obj[k] !== initialObj[k]) return result[k] = obj[k]\r\n\t\t// and non-empty schema values\r\n\t\tif (!obj[k] && !!objSchema[k]) return result[k] = objSchema[k]\r\n\t})\r\n}\r\n\r\nconst handlePayloadArr = (arrSchema, initialArr, arr, resultArr) => {\r\n\t// NOTE schema array should contain one element only just to define schema\r\n\tconst type = typeof arrSchema[0]\r\n\t// TODO handle array of primitives (now only collections)\r\n\tif (type === 'object') {\r\n\t\t// arr should contain at least one element\r\n\t\treturn arr.forEach((obj, i) =>\r\n\t\t\thandlePayloadObj(arrSchema[0], initialArr[i], obj, resultArr[i] = {})\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport const getStructure = obj => {\r\n\tconst result = {}\r\n\tgetSkeleton(obj, result)\r\n\treturn result\r\n}\r\n\r\nconst getSkeleton = (obj, result) => {\r\n\t// preserve ids of entity objects\r\n\tObject.keys(obj).forEach(k => {\r\n\t\tif (k === 'id')\r\n\t\t\treturn result.id = obj.id\r\n\t\tif (obj[k] === null)\r\n\t\t\t// return result[k] = {}\r\n\t\t\treturn\r\n\t\tconst type = typeof obj[k]\r\n\t\tif (type === 'object' && Array.isArray(obj[k]))\r\n\t\t\treturn result[k] = getArrSkeleton(obj[k])\r\n\t\tif (type === 'object')\r\n\t\t\treturn getSkeleton(obj[k], result[k] = {})\r\n\t})\r\n}\r\n\r\nconst getArrSkeleton = arr => arr\r\n\t.filter(item => typeof item === 'object')\r\n\t.map(obj => {\r\n\t\tconst result = {}\r\n\t\tgetSkeleton(obj, result)\r\n\t\treturn result\r\n\t})\r\n\r\nconst analysePath = (path, acc = []) => {\r\n\tconst dotPos = path.indexOf('.')\r\n\tconst braketPos = path.indexOf('[')\r\n\tif (path === '') {\r\n\t\tacc[acc.length - 1].last = true\r\n\t\treturn acc\r\n\t}\r\n\tif (dotPos*braketPos === 1) return [\r\n\t\t...acc, {\r\n\t\tkey: path,\r\n\t\tlast: true\r\n\t}]\r\n\tif (braketPos === -1 || dotPos + 1 && dotPos < braketPos) return analysePath(\r\n\t\tpath.slice(dotPos + 1), [\r\n\t\t\t...acc, {\r\n\t\t\t\tkey: path.slice(0, dotPos)\r\n\t\t\t}\r\n\t])\r\n\tif (dotPos === -1 || braketPos + 1 && braketPos < dotPos) {\r\n\t\tconst closingBraketPos = path.indexOf(']')\r\n\t\treturn analysePath(\r\n\t\t\tpath.slice(closingBraketPos + 2), [\r\n\t\t\t\t...acc, {\r\n\t\t\t\t\tkey: path.slice(0, braketPos),\r\n\t\t\t\t\tarray: true\r\n\t\t\t\t}, {\r\n\t\t\t\t\tkey: path.slice(braketPos + 1, closingBraketPos),\r\n\t\t\t\t\tarrayItem: true\r\n\t\t\t\t}\r\n\t\t])\r\n\t}\r\n}\r\n\r\nexport const assignNested = (obj, path, val, preserveKeys=false) => {\r\n\tconst keys = analysePath(path)\r\n\t// console.log('keys > ', keys)\r\n\tkeys.reduce((obj, { key, last, array, arrayItem }) => {\r\n\t\t// console.log('obj > ', JSON.stringify(obj, null, 2))\r\n\t\t!preserveKeys &&\r\n\t\t\tObject.keys(obj)\r\n\t\t\t\t.filter(k => !(\r\n\t\t\t\t\tk === 'id'\r\n\t\t\t\t\t|| k === key\r\n\t\t\t\t\t|| key.startsWith('id=') && obj[k].id === key.slice(3)\r\n\t\t\t\t))\r\n\t\t\t\t.forEach(k => {\r\n\t\t\t\t\tif (arrayItem) obj[k] = { id: obj[k].id }\r\n\t\t\t\t\telse delete obj[k]\r\n\t\t\t\t})\r\n\t\tif (arrayItem && key === 'length' && !last) {\r\n\t\t\tobj[obj.length] = {}\r\n\t\t\treturn obj[obj.length - 1]\r\n\t\t}\r\n\t\tif (key.startsWith('id=') && !last)\r\n\t\t\treturn obj.find(i => i.id === key.slice(3))\r\n\t\tif (last) {\r\n\t\t\tif (arrayItem && key === 'length')\r\n\t\t\t\treturn obj[obj.length] = val\r\n\t\t\tif (key.startsWith('id='))\r\n\t\t\t\treturn obj[obj.findIndex(i => i.id === key.slice(3))] = {\r\n\t\t\t\t\t...Object.keys(val).length > 0 && {id: key.slice(3)},\r\n\t\t\t\t\t...val\r\n\t\t\t\t}\r\n\t\t\treturn obj[key] = val\r\n\t\t}\r\n\t\tif (!obj[key]) {\r\n\t\t\tif (array) obj[key] = []\r\n\t\t\telse obj[key] = {}\r\n\t\t}\r\n\t\treturn obj[key]\r\n\t}, obj)\r\n}\r\n\r\nexport const produceNested = (obj, path, val, preserveKeys=false) => {\r\n\tconst keys = analysePath(path)\r\n\treturn produce(obj, obj => {\r\n\t\tkeys.reduce((obj, { key, last, array, arrayItem }) => {\r\n\t\t\tObject.keys(obj).forEach(k => {\r\n\t\t\t\tif (k === 'id' || k === key) return\r\n\t\t\t\tif (!preserveKeys) {\r\n\t\t\t\t\tif (arrayItem) obj[k] = { id: obj[k].id }\r\n\t\t\t\t\telse delete obj[k]\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (last) {\r\n\t\t\t\tif (arrayItem && key === 'length') return obj[obj.length] = val\r\n\t\t\t\treturn obj[key] = val\r\n\t\t\t}\r\n\t\t\tif (!obj[key]) {\r\n\t\t\t\tif (array) obj[key] = []\r\n\t\t\t\telse obj[key] = {}\r\n\t\t\t}\r\n\t\t\treturn obj[key]\r\n\t\t}, obj)\r\n\t})\r\n}\r\n","import { string } from 'yup'\r\n\r\nexport const idValidationType = string().matches(/^[a-z0-9]{25}$/)","import { object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  // orgId: idValidationType\r\n\t// \t.when('id', (id, schema) => id\r\n\t// \t\t? schema.notRequired()\r\n\t// \t\t: schema.required('Организация не указана')\r\n\t// \t),\r\n  name: string().trim().min(4).max(255)\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required()\r\n    ),\r\n  article: string().trim().min(4).max(10).notRequired(),\r\n})\r\n\r\nexport const formikSchema = {\r\n  name: '',\r\n  article: ''\r\n}\r\n\r\nexport const listSchema = {\r\n  name: {\r\n    label: 'Наименование'\r\n  },\r\n  article: {\r\n    label: 'Артикул'\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport NumberFormat from 'react-number-format'\r\n\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Span } from '../styled/styled-semantic'\r\n// import CurrencyInput from './CurrencyInput'\r\n\r\nexport default ({\r\n\tplaceholder,\r\n\tname,\r\n\tvalue,\r\n\tsetField\r\n}) => {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<NumberFormat\r\n\t\t\t\tcustomInput={Input}\r\n\t\t\t\t// customInput={CurrencyInput}\r\n\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tdecimalSeparator=','\r\n\t\t\t\tthousandSeparator=' '\r\n\t\t\t\tdecimalScale={2}\r\n\t\t\t\tallowNegative={false}\r\n\t\t\t\tonValueChange={values => setField(name, values.floatValue)} />\r\n\t\t\t<Span\r\n\t\t\t\tpl='6px'\r\n\t\t\t\tfs='1.3rem'\r\n\t\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\t>\r\n\t\t\t\t₽\r\n\t\t\t</Span>\r\n\t\t\t{/* <Span pl='9px' fs='1.1rem' ws='0.1em'>с НДС</Span> */}\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, { Component } from 'react'\r\nimport { connect, getIn } from 'formik'\r\n\r\nimport FormikCurrency from './FormikCurrency'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { Dropdown } from 'semantic-ui-react'\r\n\r\nclass FormikInput extends Component {\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tformik,\r\n\t\t\tname,\r\n\t\t\ttype,\r\n\t\t\toptions,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\t\tconst value = getIn(formik.values, name)\r\n\t\tif (options) return (\r\n\t\t\t<Dropdown\r\n\t\t\t\t{...rest}\r\n\t\t\t\tselection\r\n\t\t\t\tfluid\r\n\t\t\t\tsearch\r\n\t\t\t\tnoResultsMessage='Ничего не найдено'\r\n\t\t\t\tvalue={value}\r\n\t\t\t\toptions={options}\r\n\t\t\t\tonChange={(e, {value}) => formik.setFieldValue(name, value)}\r\n\t\t\t/>\r\n\t\t)\r\n\t\tif (name.endsWith('amount')) return (\r\n\t\t\t<FormikCurrency\r\n\t\t\t\tname={name}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tsetField={formik.setFieldValue}\r\n\t\t\t/>\r\n\t\t)\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\t{...rest}\r\n\t\t\t\tw='100%'\r\n\t\t\t\tname={name}\r\n\t\t\t\tvalue={type === 'date' ? value.slice(0,16) : value}\r\n\t\t\t\terror={getIn(formik.touched, name) && !!getIn(formik.errors, name)}\r\n\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\tonBlur={formik.handleBlur}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default connect(FormikInput)","import React, { Component } from 'react'\r\nimport { connect, getIn } from 'formik'\r\nimport InputMask from 'react-input-mask'\r\nimport styled from 'styled-components'\r\nimport { Dropdown as SDropdown } from 'semantic-ui-react';\r\nimport { Input } from '../styled/styled-semantic';\r\nimport FormikInput from './FormikInput.js';\r\n\r\nconst countryOtions = [\r\n  { key: 'rus', text: '+7', value: 'rus' },\r\n  { key: 'notRus', text: '+', value: 'notRus' },\r\n]\r\n\r\nconst DropdownPropFilter = ({ inputError, ...rest }) => (\r\n\t<SDropdown {...rest} />\r\n)\r\nexport const Dropdown = styled(DropdownPropFilter)`\r\n\t&&&&&& {\r\n    ${props => props.inputError && `\r\n      border: 1px solid ${props.theme.colors.errorBorder};\r\n      border-right-color: transparent;\r\n    `}\r\n\t}\r\n`\r\n\r\nconst Error = styled.div`\r\n  color: ${props => props.theme.colors.error};\r\n`\r\n\r\nclass Tel extends Component {\r\n  render() {\r\n    const {\r\n      baseName,\r\n      formik,\r\n      ...rest\r\n    } = this.props\r\n    const number = getIn(formik.values, baseName + '.number')\r\n    const country = getIn(formik.values, baseName + '.country')\r\n    const touched = getIn(formik.touched, baseName + '.number')\r\n    const error = getIn(formik.errors, baseName)\r\n    const renderDropdown =() => (\r\n      <Dropdown\r\n        tabIndex={-1}\r\n        name={baseName + '.country'}\r\n        value={country}\r\n        options={countryOtions}\r\n        inputError={touched && !!error}\r\n        onChange={(e, { name, value }) => formik.setFieldValue( name, value )}\r\n      />\r\n    )\r\n    return <>\r\n      {country === 'rus'\r\n        ? <InputMask\r\n            name={baseName + '.number'}\r\n            mask='( 999 ) 999-99-99'\r\n            maskChar=''\r\n            value={number}\r\n            onBlur={formik.handleBlur}\r\n            onChange={formik.handleChange}\r\n          >\r\n            {(inputProps) =>\r\n              <Input\r\n                w='240px !important'\r\n                // placeholder='Номер телефона'\r\n                error={touched && !!error}\r\n                label={renderDropdown()}\r\n                {...rest}\r\n                {...inputProps}\r\n              />\r\n            }\r\n          </InputMask>\r\n        : <FormikInput\r\n            w='240px !important'\r\n            name={baseName + '.number'}\r\n            error={touched && !!error}\r\n            // placeholder='Телефон с кодом страны'\r\n            label={renderDropdown()}\r\n            {...rest}\r\n          />\r\n      }\r\n      <Error>\r\n        {touched && error && error.number}\r\n      </Error>\r\n    </>\r\n  }\r\n}\r\n\r\nexport default connect(Tel)\r\n","import React, { Fragment } from 'react'\r\nimport { getIn, connect, FieldArray } from 'formik'\r\nimport styled from 'styled-components'\r\n\r\nimport FormikInput from './FormikInput'\r\nimport FormikTel from './FormikTel'\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tmargin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n\tflex: 0 0 122px;\r\n\tpadding-top: calc(10.5rem/14);\r\n\tfont-size: calc(13rem/14);\r\n\tfont-weight: bold;\r\n\tline-height: 1.21428571rem;\r\n\t${props => props.required && `\r\n\t\t::after {\r\n\t\t\tcontent: '*';\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tmargin: -.2em 0 0 .2em;\r\n\t\t\tvertical-align: top;\r\n\t\t\tcolor: #db2828;\r\n\t\t}\r\n\t`}\r\n`\r\n\r\nconst Content = styled.div`\r\n\tflex: 1 1 auto;\r\n\tmax-width: calc(100% - 122px);\r\n`\r\n\r\nconst InputContainer = styled.div`\r\n\tmax-width: 240px;\r\n`\r\n\r\nconst Error = styled.div`\r\n\tcolor: ${props => props.theme.colors.error};\r\n`\r\n\r\nconst Field = ({\r\n\tlabel,\r\n\trequired,\r\n\tname,\r\n\ttype,\r\n\tformik,\r\n\tinputLabel,\r\n\tcontentBeforeField,\r\n\t...rest\r\n}) => {\r\n\tconst isArray = name === 'person.tels'\r\n\t// const component = data =>\r\n\t//   type === 'string' ? data :\r\n\t//   type === 'tel' ? <FormikTel tel={data} />\r\n\t//   : null\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Label\r\n\t\t\t\tclassName='fz-formFieldLabel'\r\n\t\t\t\trequired={required}\r\n\t\t\t>\r\n\t\t\t\t{label}\r\n\t\t\t</Label>\r\n\t\t\t<Content>\r\n\t\t\t\t{isArray\r\n\t\t\t\t\t? <FieldArray\r\n\t\t\t\t\t\t\tname={name}\r\n\t\t\t\t\t\t\trender={arrayHelpers => (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{getIn(formik.values, name).map((_, i) => \r\n\t\t\t\t\t\t\t\t\t\t<Fragment\r\n\t\t\t\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormikTel\r\n\t\t\t\t\t\t\t\t\t\t\t\tbaseName={`${name}.${i}`}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t: <>\r\n\t\t\t\t\t\t\t<InputContainer>\r\n\t\t\t\t\t\t\t\t{contentBeforeField}\r\n\t\t\t\t\t\t\t\t<FormikInput\r\n\t\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t\t\tname={name}\r\n\t\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</InputContainer>\r\n\t\t\t\t\t\t\t<Error>\r\n\t\t\t\t\t\t\t\t{getIn(formik.touched, name) ? getIn(formik.errors, name) : ''}\r\n\t\t\t\t\t\t\t</Error>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t</Content>\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\nexport default connect(Field)","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertModel } from '../../graphql/model'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/model'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\nexport default class ModelForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      model,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries,\r\n      onSubmit,\r\n    } = this.props\r\n    let schema = model ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = model ? projectEntity(model, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertModel}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertModel, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('upsertModel input > ', input)\r\n              const upserted = await upsertModel({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return model\r\n                ? toggleEditMode()\r\n                : this.didMount && onSubmit(upserted.data.upsertModel.id)\r\n            }}\r\n          >\r\n            {({\r\n              handleSubmit,\r\n              handleReset,\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label='Наименование'\r\n                  name='name'\r\n                  required\r\n                />\r\n                <Field\r\n                  label='Артикул'\r\n                  name='article'\r\n                />\r\n                {!!error &&\r\n                  <Message\r\n                    d='block !important'\r\n                    error\r\n                    header='Не удалось добавить..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  type='button'\r\n                  primary\r\n                  content={model ? 'Сохранить' : 'Добавить'}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ model ? toggleEditMode : handleReset}\r\n                >\r\n                  {model ? 'Отмена' : 'Очистить'}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport validateInn from '../../utils/validateInn'\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { allEnquiries, createEnquiry, updateEnquiry } from '../../graphql/enquiry'\r\nimport { createOrg } from '../../graphql/org'\r\nimport { allOrgsAndModels } from '../../graphql/combinedQueries'\r\n\r\nimport styled from 'styled-components'\r\nimport { Form, Input, Message, Dropdown as SDropdown } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Button, Section } from '../styled/styled-semantic.js'\r\nimport DatePicker from '../common/DatePicker'\r\nimport SecondarySection from '../presentational/SecondarySection'\r\nimport ModelForm from '../Model/Form'\r\n\r\nconst Dropdown = styled(SDropdown)`\r\n\t&&&&&& {\r\n\t\twidth: 350px;\r\n\t\t&:hover {\r\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n\t\t}\r\n\t}\r\n`\r\n\r\nclass EnquiryEdit extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEnquiry = props.id === 'new'\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tthis.state = {\r\n\t\t\tloading: false,\r\n\t\t\t// if any of the form fields has error, the following err prop should always contain non empty string error message with explanaition \r\n\t\t\terr: {\r\n\t\t\t\tmessage: ''\r\n\t\t\t},\r\n\t\t\torgDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tmodelDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tnewModelMode: false\r\n\t\t}\r\n\t\t// gather form fields on oriEnquiry object\r\n\t\tconst oriEnquiry = cloneDeep(props.enquiry)\r\n\t\t// console.log('props.enquiry > ', props.enquiry)\r\n\t\tif (isNewEnquiry) oriEnquiry.dateLocal = toLocalISOString(new Date()).slice(0, 10)\r\n\t\tdelete oriEnquiry.events\r\n\t\toriEnquiry.orgId = oriEnquiry.org ? oriEnquiry.org.id : null\r\n\t\toriEnquiry.modelId = oriEnquiry.model ? oriEnquiry.model.id : null\r\n\t\toriEnquiry.qty = oriEnquiry.qty ? oriEnquiry.qty : ''\r\n\t\t// console.log('oriEnquiry > ', oriEnquiry)\r\n\t\tthis.fields = Object.keys(oriEnquiry)\r\n\t\t\t.filter(key => !['__typename', 'id', 'num', 'org', 'model'].includes(key))\r\n\t\t// console.log('this.fields > ', this.fields)\r\n\t\tthis.requiredFields = ['dateLocal', 'orgId', 'modelId', 'qty']\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\t// console.log(key, oriEnquiry[key])\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tcurVal: oriEnquiry[key],\r\n\t\t\t\t// err bool controls weather the field is heighlighted with error (red) style\r\n\t\t\t\terr: false,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!isNewEnquiry && {\r\n\t\t\t\t\toriVal: oriEnquiry[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (!isNewEnquiry) this.state.diff = false\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tcloseNewModelSection = () => this.setState({ newModelMode: false })\r\n\tchangeFieldValue = (field, newVal) => {\r\n\t\tconsole.log('change ', field, ' to value > ', newVal)\r\n\t\tconst fieldObj = cloneDeep(this.state[field])\r\n\t\tfieldObj.curVal = newVal\r\n\t\tfieldObj.err = false\r\n\t\tif (!this.isNewEnquiry) fieldObj.diff = fieldObj.curVal !== fieldObj.oriVal\r\n\t\tconst diff = this.fields.filter(f => f !== field).map(f => this.state[f].diff).includes(true) || fieldObj.diff\r\n\t\tthis.setState({ [field]: fieldObj, diff, err: { message: '' } })\r\n\t}\r\n\tselectDay = (pickedDate) => {\r\n\t\tif (!isValidDate(pickedDate)) return this.setState({ \r\n\t\t\tdateLocal: { ...this.state.dateLocal, err: true },\r\n\t\t\terr: { title: 'Ошибка ввода даты', message: 'Дата заявки не соответствует формату дат' } \r\n\t\t})\r\n\t\tthis.changeFieldValue('dateLocal', toLocalISOString(pickedDate).slice(0, 10))\r\n\t}\r\n\thandleOrgDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\torgDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleModelDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\tmodelDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleQtyInputChange = ( e, { value } ) => {\r\n\t\tconst newVal = parseInt(value, 10) || ''\r\n\t\tthis.changeFieldValue('qty', newVal)\r\n\t}\r\n\tselectOrg = (e, { value }) => {\r\n\t\tthis.setState({ orgDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('orgId', value)\r\n\t}\r\n\tselectModel = (e, { value }) => {\r\n\t\tthis.setState({ modelDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('modelId', value)\r\n\t}\r\n\tsubmitNewModel = (modelId) => {\r\n\t\tthis.changeFieldValue('modelId', modelId)\r\n\t\tthis.closeNewModelSection()\r\n\t}\r\n\tcreateOrg = async (e, { value: inn }) => {\r\n\t\ttry {\r\n\t\t\tlet err = {}\r\n\t\t\tconst isValidInn = validateInn(inn, err)\r\n\t\t\tif (!isValidInn) throw new Error(err.message)\r\n\t\t\tthis.setState({ orgDdn: { search: inn, loading: true} })\r\n\t\t\tconst data = await this.props.createOrg({ variables: { inn } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.selectOrg(null, { value: data.data.createOrg.id } )\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Добавить организацию по ИНН не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t},\r\n\t\t\t\torgDdn: {\r\n\t\t\t\t\tsearch: inn,\r\n\t\t\t\t\tloading: false\r\n\t\t\t\t},\r\n\t\t\t\torgId: {\r\n\t\t\t\t\t...this.state.orgId,\r\n\t\t\t\t\terr: true\r\n\t\t\t\t}\r\n\t\t\t })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst enquiry = {}\r\n\t\t// take out only changed fields for update\r\n\t\tthis.fields.forEach(f => {\r\n\t\t\tif (this.isNewEnquiry || this.state[f].diff) enquiry[f] = this.state[f].curVal\r\n\t\t})\r\n\t\tconst variables = { ...enquiry }\r\n\t\tif (this.isNewEnquiry) return this.createEnquiry(variables)\r\n\t\tvariables.id = this.props.id\r\n\t\tthis.updateEnquiry(variables)\r\n\t}\r\n\tcreateEnquiry = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.createEnquiry({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid: res.data.createEnquiry.id\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Создать не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tupdateEnquiry = async (variables) => {\r\n\t\tconst { id, updateEnquiry, setDetails } = this.props\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tawait updateEnquiry({ variables: { input: variables } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tsetDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ \r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Сохранить не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { dateLocal, orgId, orgDdn, modelId, modelDdn, qty, diff, loading, err, newModelMode } = this.state\r\n\t\tconst { id, setDetails, allOrgsAndModels } = this.props\r\n\t\tconst selectedDate = fromLocalISOString(dateLocal.curVal)\r\n\t\tconst orgs = allOrgsAndModels.orgs\r\n\t\tconst models = allOrgsAndModels.models\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst someFieldHasError = this.fields.some(f => !!this.state[f].err)\r\n\t\treturn (\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<Section\r\n\t\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t\t<DatePicker\r\n\t\t\t\t\t\t\t\t\t\terror={dateLocal.err}\r\n\t\t\t\t\t\t\t\t\t\tselectedDate={selectedDate}\r\n\t\t\t\t\t\t\t\t\t\tselectDay={this.selectDay} />\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t<Form.Field inline error={orgId.err} required>\r\n\t\t\t\t\t\t\t\t\t<Label>Организация</Label>\r\n\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\tloading={!orgs || orgDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={id !== 'new' || !orgs || orgDdn.loading} //org cannot be changed when editing existing enquiry\r\n\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Поиск по наименованию или ИНН'\r\n\t\t\t\t\t\t\t\t\t\toptions={ orgs ? orgs.map(o => ({key:o.id, value: o.id, text: o.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\tvalue={orgId.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.selectOrg}\r\n\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\tsearchQuery={orgDdn.search}\r\n\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleOrgDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\tnoResultsMessage='Если не найдено, введите ИНН, чтобы добавить.'\r\n\t\t\t\t\t\t\t\t\t\tallowAdditions\r\n\t\t\t\t\t\t\t\t\t\tadditionLabel='Добавить по ИНН: '\r\n\t\t\t\t\t\t\t\t\t\tonAddItem={this.createOrg}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t{!newModelMode\r\n\t\t\t\t\t\t\t\t\t? <Form.Field\r\n\t\t\t\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\terror={modelId.err}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label>Изделие</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder='Поиск по наименованию или артикулу'\r\n\t\t\t\t\t\t\t\t\t\t\t\toptions={ models ? models.map(m => ({key:m.id, value: m.id, text: m.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={modelId.curVal}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.selectModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery={modelDdn.search}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleModelDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tnoResultsMessage='Если не найдено, выберите \"Нет в списке\"'\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tml='5px'\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={newModelMode}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.setState({ newModelMode: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t\t: <SecondarySection\r\n\t\t\t\t\t\t\t\t\t\t\ttitle='Новое изделие'\r\n\t\t\t\t\t\t\t\t\t\t\tonClose={this.closeNewModelSection}\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ModelForm\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmodel={undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId={orgId.curVal || undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trefetchQueries={allOrgsAndModels.refetch}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonSubmit={this.submitNewModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t\t<Label>Кол-во</Label>\r\n\t\t\t\t\t\t\t\t\t<Input type='number'\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Введите кол-во шт.' \r\n\t\t\t\t\t\t\t\t\t\tvalue={qty.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleQtyInputChange} />\r\n\t\t\t\t\t\t\t\t\t<Span pl='6px'>шт.</Span>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\thidden={!err.message}\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} />\r\n\t\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\t\tcontent={this.isNewEnquiry ? 'Создать' : 'Сохранить'}\r\n\t\t\t\t\t\t\t\tdisabled={(!this.isNewEnquiry && !diff) || !!err.message || someFieldHasError || !!orgId.loading || requiredIsEmpty}\r\n\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\tonClick={this.submit} />\r\n\t\t\t\t\t\t\t<A cancel \r\n\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? () => setDetails(null)\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tОтмена\r\n\t\t\t\t\t\t\t</A>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(createOrg, { \r\n\t\tname: 'createOrg',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createOrg }}) => {\r\n\t\t\t\tconst query = allOrgsAndModels\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tdata.orgs.push(createOrg)\r\n\t\t\t\tdata.orgs.sort((a, b) => a.name > b.name)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n\tgraphql(allOrgsAndModels, { name: 'allOrgsAndModels' }),\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiry, { \r\n\t\tname: 'createEnquiry',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createEnquiry }}) => {\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tcreateEnquiry.isExpanded = false\r\n\t\t\t\tdata.enquiries.unshift(createEnquiry)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n)(EnquiryEdit)","import React, { Component } from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.err && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nclass LocalDatePicker extends Component {\r\n\thandleDayChange = (pickedDate) => {\r\n\t\t// console.log('pickedDate > ', pickedDate)\r\n\t\tconst { setField, field: { name }} = this.props\r\n\t\tif (!isValidDate(pickedDate)) {\r\n\t\t\tsetField(name, {\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Ошибка ввода даты', \r\n\t\t\t\t\tmessage: 'Дата не соответствует формату ГГГГ-ММ-ДД'\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tsetField(name, {\r\n\t\t\tvalue: toLocalISOString(pickedDate).slice(0, 10)\r\n\t\t})\r\n\t}\r\n\trender() {\r\n\t\tconst { field: {curVal: value, err} } = this.props\r\n\t\treturn (\r\n\t\t\t<PickerDiv err={!!err}>\r\n\t\t\t\t<DayPickerInput\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonDayChange={this.handleDayChange}\r\n\t\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\t\tmonth: fromLocalISOString(value)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</PickerDiv>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default LocalDatePicker\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport NumberFormat from 'react-number-format'\r\n\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Span } from '../styled/styled-semantic'\r\n\r\nclass CurrencyInput extends Component {\r\n\trender() {\r\n\t\tconst { placeholder, field: {name, curVal: value}, setField } = this.props\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<NumberFormat\r\n\t\t\t\t\tcustomInput={Input}\r\n\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tdecimalSeparator=','\r\n\t\t\t\t\tthousandSeparator=' '\r\n\t\t\t\t\tdecimalScale={2}\r\n\t\t\t\t\tallowNegative={false}\r\n\t\t\t\t\tonValueChange={values => setField(name, {value: values.floatValue})}\r\n\t\t\t\t/>\r\n\t\t\t\t<Span pl='6px' fs='1.1rem' c='rgba(0,0,0,.87)'>₽</Span>\r\n\t\t\t\t<Span pl='9px' fs='1.1rem' ws='0.1em'>с НДС</Span>\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default CurrencyInput\r\n","import { Component } from 'react'\r\n\r\nclass SmartForm extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEntity = props.isNewEntity\r\n\t\t// gather original form fields' values from provided object\r\n\t\tconst oriEntity = props.entity\r\n\t\tthis.fields = Object.keys(oriEntity)\r\n\t\tthis.requiredFields = props.requiredFields\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.state = {}\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tname: key,\r\n\t\t\t\tcurVal: oriEntity[key],\r\n\t\t\t\terr: null,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!this.isNewEntity && {\r\n\t\t\t\t\toriVal: oriEntity[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tsetField = (field, {value, err}) => {\r\n\t\t// console.log('field, value, err > ', field, value, err)\r\n\t\tthis.setState({\r\n\t\t\t[field]: {\r\n\t\t\t\t...this.state[field],\r\n\t\t\t\t...value && {\r\n\t\t\t\t\tcurVal: value,\r\n\t\t\t\t\t...!this.isNewEntity && { diff: value !== this.state[field].oriVal },\r\n\t\t\t\t},\r\n\t\t\t\terr: err || null,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst entity = this.fields.reduce((entity, f) => {\r\n\t\t\tentity[f] = this.state[f].curVal\r\n\t\t\treturn entity\r\n\t\t}, {})\r\n\t\tthis.props.submit(entity)\r\n\t}\r\n\trender() {\r\n\t\tconst { children } = this.props\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst diff = this.isNewEntity ? null : this.fields.map(f => this.state[f].diff).includes(true)\r\n\t\tconst err = this.fields.map(f => this.state[f].err).find(err => !!err)\r\n\t\tconst state = {\r\n\t\t\tdisabled: (!this.isNewEntity && !diff) || requiredIsEmpty || !!err,\r\n\t\t\terr: err || this.props.err,\r\n\t\t\tsetField: this.setField,\r\n\t\t\tsubmit: this.submit,\r\n\t\t\tformState: this.state\r\n\t\t}\r\n\t\t// @ts-ignore\r\n\t\treturn children(state)\r\n\t}\r\n}\r\n\r\nexport default SmartForm","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Header, Form, Message, Button, Divider } from 'semantic-ui-react'\r\nimport { Div, A, Label, Section } from '../styled/styled-semantic'\r\n\r\nimport LocalDatePicker from '../common/LocalDatePicker'\r\nimport CurrencyInput from '../common/CurrencyInput'\r\nimport SmartForm from '../common/SmartForm'\r\n\r\nimport { toLocalISOString } from '../../utils/dates'\r\n\r\nclass EnquiryCommercialOffer extends Component {\r\n\trender() {\r\n\t\tconst { cancel, submit, loading } = this.props\r\n\t\tconst isNewCO = this.props.id === 'new'\r\n\t\tconst co = isNewCO\r\n\t\t?   {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tamount: ''\r\n\t\t\t} \r\n\t\t:   {\r\n\t\t\t\tdateLocal: this.props.co.dateLocal,\r\n\t\t\t\tamount: this.props.co.amount\r\n\t\t\t}\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewCO}\r\n\t\t\t\tentity={co}\r\n\t\t\t\trequiredFields={['dateLocal', 'amount']}\r\n\t\t\t\tsubmit={submit}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\thead\r\n\t\t\t\t\t\tminor\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\ttopBorder\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\tКоммерческое предложение\r\n\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Сумма</Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите сумму КП'\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tsmall\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\tcontent={'Создать'}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit} />\r\n\t\t\t\t\t\t<A cancel onClick={cancel}>Отмена</A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Divider fitted/>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default EnquiryCommercialOffer","import React, { Component, Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n// TODO use List instead of entity-table\r\nimport { Table, Tr, Td, InputTd, EditorTd } from '../styled/entity-table'\r\nimport { Header as SHeader, Icon, Label, Form, Comment, \r\n\tMessage, Dropdown } from 'semantic-ui-react'\r\nimport { P, Div, Button, Section } from '../styled/styled-semantic'\r\n\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { enquiryDetails, newEnquiry, createEnquiryEvent, \r\n\tenquiryFragment, allEnquiries, updateEnquiry } from '../../graphql/enquiry'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport WrappedDraftEditor from '../common/WrappedDraftEditor'\r\nimport { sanitize } from 'dompurify'\r\nimport { currency } from '../../utils/format'\r\n\r\nimport EnquiryEdit from './Edit'\r\nimport EnquiryCommercialOffer from './EnquiryCommercialOffer'\r\n\r\nconst SDropdown = styled(Dropdown)`\r\n\t& .active.item {\r\n\t\tdisplay: none !important;\r\n\t}\r\n\t& .selected.item {\r\n\t\tbackground: none !important;\r\n\t}\r\n`\r\n\r\nconst Comments = styled(Comment.Group)`\r\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\r\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\r\n`\r\n\r\nconst CIcon = styled(Icon)`\r\n\t// apply horizontal offset correction for different icons to be vertically alined\r\n  width: ${props => (props.type === 'CREATE') ? '1.73em' : '1.4em' } !important;\r\n\t${props => (props.type === 'CREATE') && 'margin-left: -0.33em !important;'}\r\n  margin-top: .15em !important;\r\n\tfloat: left;\r\n\topacity: 0.6 !important;\r\n`\r\n\r\nconst UserLabel = styled(Label)`\r\n  width: 2em;\r\n  height: 2em;\r\n  margin-left: 0 !important;\r\n  padding: .4em 0em !important;\r\n  float: left;\r\n\ttext-align: center;\r\n\t${props => props.indent && 'margin-left: 42.69px !important;'}\r\n\t// ${props => props.indent && 'margin-left: calc(1.4em + 0.25rem) !important;'}\r\n`\r\n\r\nconst CContent = styled(Comment.Content)`\r\n  margin-left: 6.5em !important;\r\n`\r\n\r\nconst CMetadata = styled(Comment.Metadata)`\r\n\tmargin-left: 0 !important;\r\n  color: rgba(0,0,0,.6) !important;\r\n`\r\n\r\nconst CText = styled(Comment.Text)`\r\n\t& p { margin: 0 !important; }\r\n\t&>table { \r\n\t\twidth: 100%;\r\n\t\tborder-collapse: collapse; \r\n\t}\r\n\t&>table>tbody>tr>td {\r\n\t\tpadding-left: 4px;\r\n\t\tvertical-align: top;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(1) {\r\n\t\twidth: 5px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(2) {\r\n\t\twidth: 25px;\r\n\t\tmin-width: 90px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(3) {\r\n\t\tpadding-left: 10px;\r\n\t\twidth: 1000px;\r\n\t\tmin-width: 240px;\r\n\t}\r\n\t&>table>tbody>tr>td>span {\r\n\t\tmargin-right: 5px;\r\n\t}\r\n`\r\n\r\nconst CMessage = styled(Message)`\r\n\tmargin-left: 6.35em !important;\r\n`\r\n\t\r\nclass EnquiryDetails extends Component {\r\n\tisNewEnquiry = this.props.id === 'new'\r\n\teditorRef = React.createRef()\r\n\tnoteEditorRef = React.createRef()\r\n\tcomponentIsMounted = true\r\n  state = {\r\n\teditMode: this.isNewEnquiry ? true : false,\r\n\t\teditorHasText: false,\r\n\t\tnoteEditorDiff: false,\r\n\t\tnoteKey: 1,\r\n\t\tactiveCO: '',\r\n\t\tloading: false,\r\n\t\tcreatingComment: false,\r\n\t\tchangingStatus: false,\r\n\t\tstatusPending: false,\r\n\t\tsavingNote: false,\r\n\t\terror: ''\r\n\t}\r\n\t// refetchEnquiry = async () => {\r\n\t// \tthis.setState({ loading: true })\r\n\t// \tconst res = await this.props.enquiryQuery.refetch()\r\n\t// \tthis.setState({ loading: false })\r\n\t// }\r\n\tenableEditMode = () => this.setState({ editMode: true })\r\n\texitEditMode = () => this.setState({ editMode: false })\r\n\tsetEditorHasText = (bool) => this.setState({ editorHasText: bool })\r\n\tsetNoteEditorDiff = (bool) => this.setState({ noteEditorDiff: bool })\r\n\tcancelEdit = () => {\r\n\t\tif (this.isNewEnquiry) return this.props.closeDetails()\r\n\t\tthis.exitEditMode()\r\n  }\r\n  createComment = async () => {\r\n\t\ttry {\r\n\t\t\tconst htmlText = this.editorRef.current.exportHtml()\r\n\t\t\t// if (htmlText === '<p><br></p>') return\r\n\t\t\tif (htmlText === null) return\r\n\t\t\tthis.setState({creatingComment: true})\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\thtmlText\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ creatingComment: false, editorHasText: false, error: '' })\r\n\t\t\tthis.editorRef.current.clear()\r\n\t\t} catch(err) {\r\n\t\t\tthis.setState({ creatingComment: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tchangeStatus = async (e, { value, co }) => {\r\n\t\tconst coStatusId = this.props.enquiryQuery.statuses.find(s => s.name === 'Выставлено КП').id\r\n\t\tif (value === coStatusId) {\r\n\t\t\tif (!this.state.statusPending) return this.setState({ statusPending: true, activeCO: 'new' })\r\n\t\t\telse this.setState({ statusPending: false })\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tthis.setState({ changingStatus: true })\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\tstatusId: value,\r\n\t\t\t\t\t...(co && { doc: { ...co } })\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ changingStatus: false, activeCO: '' })\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({ changingStatus: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcancelPendingStatusChange = () => {\r\n\t\tthis.setState({ statusPending: false, activeCO: '' })\r\n\t}\r\n\tsaveNote = async () => {\r\n\t\ttry {\r\n\t\t\tlet htmlNote = this.noteEditorRef.current.exportHtml()\r\n\t\t\tif (htmlNote === this.props.enquiryQuery.enquiry.htmlNote) {\r\n\t\t\t\treturn this.setState({ noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t\t}\r\n\t\t\tthis.setState({ savingNote: true })\r\n\t\t\tawait this.props.updateEnquiry({ \r\n\t\t\t\tvariables: { input: { id: this.props.id, htmlNote } } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: '', noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n  render() { \r\n\t\tconst { editorHasText, creatingComment, changingStatus, statusPending, \r\n\t\t\t\terror, noteEditorDiff, noteKey, savingNote, activeCO } = this.state\r\n\t\tconst { enquiryQuery } = this.props\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tif (enquiryQuery.loading) return <Section>Загрузка...</Section>\r\n\t\tif (enquiryQuery.error) return <Section>Ошибка {enquiryQuery.error.message}</Section>\r\n\t\tconst enquiry = isNewEnquiry ? enquiryQuery.newEnquiry : enquiryQuery.enquiry\r\n\t\tconst { org, model, qty, htmlNote, events } = enquiry\r\n\t\tconst coEvents = events && events.filter(e => e.doc)\r\n\t\tconst curStatus = events && events.filter(e => e.status).pop().status\r\n\t\t// rawStatuses - received from server\r\n\t\tconst rawStatuses = enquiryQuery.statuses.slice()\r\n\t\tconst coStatusId = rawStatuses.find(s => s.name === 'Выставлено КП').id\r\n\t\tconst orderStatusId = rawStatuses.find(s => s.name === 'Заказ').id\r\n\t\tconst refusalStatusIds = rawStatuses.filter(s => ['Нет возможности', 'Отказ'].includes(s.name)).map(s => s.id)\r\n\t\t// sort statuses so that refusal statuses are at the end of their stage block\r\n\t\tconst statuses = rawStatuses.sort((a, b) => a.stage === b.stage && refusalStatusIds.includes(a.id))\r\n\t\tlet stage = 0\r\n\t\tconst eventStatusPresentationHelpers = events && events.reduce((res, e, i) => {\r\n\t\t\tif (!e.status || i === 0) return res = [...res, null]\r\n\t\t\tif (refusalStatusIds.includes(e.status.id)) return [...res, 'refuse']\r\n\t\t\tif (e.status.id === orderStatusId) return [...res, 'order']\r\n\t\t\tres.push(e.status.stage - stage > 0 ? 'up' : 'down')\r\n\t\t\tstage = e.status.stage\r\n\t\t\treturn res\r\n\t\t}, [])\r\n\t\treturn (\r\n\t\t\t<GlobalContext>\r\n\t\t\t\t{({ details, setDetails }) => {\r\n\t\t\t\t\tconst { id, editMode } = details\r\n\t\t\t\t\tconst isNewEnquiry = id === 'new'\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t{ (editMode || isNewEnquiry) &&\r\n\t\t\t\t\t\t\t\t<EnquiryEdit\r\n\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\tenquiry={enquiry}\r\n\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{ !(editMode || isNewEnquiry) && <Fragment>\r\n\t\t\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t\t\t<Table><tbody>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Организация</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{org && org.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Изделие</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{model && model.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Кол-во, шт.</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{qty}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t{ !!coEvents.length &&\r\n\t\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td>КП</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{coEvents.map(({ doc: { id, dateLocal, amount } }) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<P key={id} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfw='normal'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlh='1.21428571em' >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b>{currency(amount)} </b> ( от {dateLocal} )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</P>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tr> }\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Примечания</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={noteKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderless\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tref={this.noteEditorRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitFromHtml={htmlNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetEditorDiff={this.setNoteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdiff={noteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonCtrlEnter={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{noteEditorDiff &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmt='.67857143em'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent='Сохранить примечание'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon='save'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfloated='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Статус</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<SDropdown labeled button className='icon'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={changingStatus}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={changingStatus || statusPending}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={curStatus.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={curStatus.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toptions={statuses\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(s => (s.id === curStatus.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|| Math.abs(s.stage - curStatus.stage) === 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& !(s.stage === 0 && curStatus.stage !== 0))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// && !(s.name === 'Выставлено КП'))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map(s => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: s.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: { \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbasic: true, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: 'ст', \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetail: s.stage, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon:   refusalStatusIds.includes(s.id) ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ts.id === orderStatusId ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`long arrow alternate ${(s.stage - curStatus.stage) > 0 ? 'up' : 'down' }`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.changeStatus} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t</SDropdown>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label basic size='large' content='стадия' detail={ curStatus.stage} />\r\n\t\t\t\t\t\t\t\t\t\t\t</InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t</tbody></Table>\r\n\t\t\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t\t\t{ activeCO && \r\n\t\t\t\t\t\t\t\t\t<EnquiryCommercialOffer \r\n\t\t\t\t\t\t\t\t\t\tid={activeCO} \r\n\t\t\t\t\t\t\t\t\t\tsubmit={(co) => this.changeStatus(null, { value: coStatusId, co })}\r\n\t\t\t\t\t\t\t\t\t\tcancel={this.cancelPendingStatusChange} />}\r\n\t\t\t\t\t\t\t\t<Comments minimal>\r\n\t\t\t\t\t\t\t\t\t<SHeader as='h3' dividing content='Комментарии и события' />\r\n\t\t\t\t\t\t\t\t\t{ events.map((e, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { fName, lName } = e.user.person\r\n\t\t\t\t\t\t\t\t\t\tconst userInitials = (lName ? fName.slice(0,1) : fName.slice(0,2)) + (lName ? lName.slice(0,1) : '')\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<Comment key={e.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ e.type && (e.type !== 'COMMENT') &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CIcon \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' type={e.type}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor={ e.type === 'CREATE' ? 'green' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'blue' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'up' ? 'yellow' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'down' ? 'brown' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'red' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'green' : 'grey'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname ={ e.type === 'CREATE' ? 'plus' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'write square' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' ? `long arrow alternate ${eventStatusPresentationHelpers[i]}` : 'question'} /> }\r\n\t\t\t\t\t\t\t\t\t\t\t\t<UserLabel \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={userInitials}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindent={!e.type || e.type === 'COMMENT' ? 1 : 0} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CMetadata\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={e.datetimeLocal.slice(0,16)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CText dangerouslySetInnerHTML={{__html: sanitize(e.htmlText)}} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t</Comment>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t<Form reply error={!!error}>\r\n\t\t\t\t\t\t\t\t\t\t<Div m='0 0 1em 6.35em'>\r\n\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\tref={this.editorRef} \r\n\t\t\t\t\t\t\t\t\t\t\t\tsetEditorHasText={this.setEditorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSave={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t<CMessage\r\n\t\t\t\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\t\t\t\theader='Коммент добавить не удалось..'\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={error}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Button content='Добавить коммент' labelPosition='left' icon='edit' primary floated='right' \r\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={!editorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={creatingComment}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t\t</Comments>\r\n\t\t\t\t\t\t\t</Fragment> }\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t)\r\n\t\t\t\t}}\r\n\t\t\t</GlobalContext>\r\n\t\t)\r\n  }\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiryEvent, { \r\n\t\tname: 'createEnquiryEvent',\r\n\t\toptions: (props) => ({\r\n\t\t\tupdate: (cache, {data: reponseData}) => {\r\n\t\t\t\tconst newEvent = reponseData.createEnquiryEvent\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst id = `Enquiry:${props.id}`\r\n\t\t\t\tconst fragment = enquiryFragment\r\n\t\t\t\tlet data = cache.readFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment\r\n\t\t\t\t})\r\n\t\t\t\tdata.events.push(newEvent)\r\n\t\t\t\tcache.writeFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment,\r\n\t\t\t\t\tdata\r\n\t\t\t\t})\r\n\t\t\t\t// also update allEnquiries if status changed (for EnquiryTable view update)\r\n\t\t\t\tif (! newEvent.status) return\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tdata = cache.readQuery({ query })\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === props.id)\r\n\t\t\t\tenquiry.status = newEvent.status\r\n\t\t\t\tif (newEvent.doc) enquiry.docs.push(newEvent.doc)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t})\r\n  }),\r\n\tgraphql(newEnquiry, { name: 'enquiryQuery', skip: (props) => props.id !== 'new' }),\r\n\tgraphql(enquiryDetails, { name: 'enquiryQuery', skip: (props) => props.id === 'new' })\r\n)(EnquiryDetails)","import React, { Component, createRef } from 'react'\r\nimport debounce from 'lodash/debounce'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { isNaN } from '../../utils/format'\r\n\r\n// INFO built-in handling of 'int' number type\r\n// TODO think about integrating other input types (currency, etc..)\r\nclass SmartInput extends Component {\r\n\tstate = {\r\n\t\tvalue: (this.props.field && this.props.field.curVal) || ''\r\n\t}\r\n\tinput = createRef()\r\n\tdebouncedSetField = debounce(value => {\r\n    const { field: { name }, setField } = this.props\r\n    setField(name, { value })\r\n\t}, 250)\r\n\twriteVal = (value) => {\r\n\t\tthis.setState({ value })\r\n\t\tthis.debouncedSetField(value)\r\n\t}\r\n\thandleInputChange = ( e, { value } ) => {\r\n\t\tif (value === '') return this.writeVal('')\r\n\t\tconst { type } = this.props\r\n\t\t// block/parse invalid integer input for 'int' input type\r\n\t\tif (type === 'int') {\r\n\t\t\tconst intVal = parseInt(value, 10)\r\n\t\t\treturn intVal && this.writeVal(intVal)\r\n\t\t}\r\n\t\treturn this.writeVal(value)\r\n\t}\r\n\t// onChanged isn't fired on input with type[\"number\"]\r\n\t// when user mixes numbers with symbols -,. for ex -> '234234,,,,,,,234'\r\n\t// so I check valueAsNumber html input attr onBlur and set error\r\n\tonBlur = () => {\r\n\t\tconst { field: { name }, setField } = this.props\r\n\t\tconst { type, valueAsNumber } = this.input.current.children[0] || {}\r\n\t\tif (type === 'number' && isNaN(valueAsNumber)) {\r\n\t\t\tsetField(name, { err: {\r\n\t\t\t\ttitle: 'Ошибка в поле \"Количество\"',\r\n\t\t\t\tmessage: 'Недопустимое значение'\r\n\t\t\t} })\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { field, setField, type, ...rest } = this.props\r\n\t\tconst { value } = this.state\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\t{...rest}\r\n\t\t\t\ttype={type === 'int' ? 'number' : (type || 'text')}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\tonBlur={this.onBlur}\r\n\t\t\t\tref={this.input}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default SmartInput\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Form, Button, Message } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Section } from '../styled/styled-semantic.js'\r\n\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { orderLocal, upsertOrder } from '../../graphql/order'\r\nimport { allEnquiries } from '../../graphql/enquiry'\r\n\r\nimport { toLocalISOString } from '../../utils/dates'\r\n\r\nimport LocalDatePicker from '../common/LocalDatePicker'\r\nimport CurrencyInput from '../common/CurrencyInput'\r\nimport SmartForm from '../common/SmartForm'\r\nimport SmartInput from '../common/SmartInput'\r\n\r\nclass OrderEdit extends Component {\r\n\tcomponentIsMounted = true\r\n\tisNewEntity = this.props.id === 'new'\r\n\tstate = {\r\n\t\tloading: false,\r\n\t\terr: null\r\n\t}\r\n\tsubmit = (entity) => {\r\n\t\tthis.upsertOrder({\r\n\t\t\t...entity,\r\n\t\t\t...this.isNewEntity && {\r\n\t\t\t\tenquiryId: this.props.enquiryId,\r\n\t\t\t},\r\n\t\t\t...!this.isNewEntity && {\r\n\t\t\t\tid: this.props.id,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tupsertOrder = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.upsertOrder({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: null })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Order',\r\n\t\t\t\tid: res.data.upsertOrder.id\r\n\t\t\t})\r\n\t\t\tthis.props.setExpanded({\r\n\t\t\t\tid: res.data.upsertOrder.enquiry.id,\r\n\t\t\t\tvalue: true\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: `${this.isNewEntity ? 'Создать' : 'Сохранить'} не удалось..`,\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { loading } = this.state\r\n\t\tconst { id, closeDetails, setDetails } = this.props\r\n\t\tconst isNewEntity = id === 'new'\r\n\t\tconst order = isNewEntity\r\n\t\t\t? {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tqty: '',\r\n\t\t\t\tamount: ''\r\n\t\t\t}\r\n\t\t\t: this.props.orderLocal.orderLocal\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewEntity}\r\n\t\t\t\tentity={order}\r\n\t\t\t\trequiredFields={['dateLocal', 'qty', 'amount']}\r\n\t\t\t\tsubmit={this.submit}\r\n\t\t\t\terr={this.state.err}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, qty, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Кол-во</Label>\r\n\t\t\t\t\t\t\t\t<SmartInput\r\n\t\t\t\t\t\t\t\t\ttype='number'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите кол-во шт.'\r\n\t\t\t\t\t\t\t\t\tfield={qty}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Span pl='6px'>шт.</Span>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Сумма</Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите сумму заказа'\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\tcontent={this.isNewEntity ? 'Создать' : 'Сохранить'}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<A cancel\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? closeDetails\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tОтмена\r\n\t\t\t\t\t\t</A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(upsertOrder, {\r\n\t\t\tname: 'upsertOrder',\r\n\t\t\toptions: {\r\n\t\t\t\tupdate: (cache, { data: responseData }) => {\r\n\t\t\t\t\tconst upsertedOrder = responseData.upsertOrder\r\n\t\t\t\t\tconst query = allEnquiries\r\n\t\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === upsertedOrder.enquiry.id)\r\n\t\t\t\t\tenquiry.orders = [\r\n\t\t\t\t\t\t...enquiry.orders.filter(o => o.id !== upsertedOrder.id),\r\n\t\t\t\t\t\tupsertedOrder\r\n\t\t\t\t\t].sort((a, b) => a.fullnum > b.fullnum ? 1 : -1)\r\n\t\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}),\r\n\tgraphql(orderLocal, {\r\n\t\tname: 'orderLocal',\r\n\t\tskip: (props) => props.id === 'new'\r\n\t}),\r\n)(OrderEdit)","import React, { forwardRef } from 'react'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\n\r\nexport default forwardRef(({\r\n\tbuttons,\r\n\tsize,\r\n\tnoIndent,\r\n\tbottomBorder,\r\n\ttitle,\r\n\tsubtitle,\r\n\ttitleSize,\r\n\tonClick,\r\n\t// expandable\r\n\texpanded,\r\n}, ref) => {\r\n\treturn (\r\n\t\t<DetailsHeaderContainer\r\n\t\t\tref={ref}\r\n\t\t\texpanded={expanded}\r\n\t\t\tonClick={onClick}\r\n\t\t\tsize={size}\r\n\t\t\tnoIndent={noIndent}\r\n\t\t\tbottomBorder={bottomBorder}\r\n\t\t>\r\n\t\t\t<DetailsHeaderTitle\r\n\t\t\t\ttitle={title}\r\n\t\t\t\tsubtitle={subtitle}\r\n\t\t\t\tsize={titleSize || size}\r\n\t\t\t/>\r\n\t\t\t{ buttons &&\r\n\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t{buttons}\r\n\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t}\r\n\t\t</DetailsHeaderContainer>\r\n\t)\r\n})\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Section, Div } from '../styled/styled-semantic';\r\n\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport posed, { PoseGroup } from 'react-pose'\r\n\r\nconst OuterSection = styled(Section)`\r\n  & {\r\n    width: 100%;\r\n    position: relative;\r\n    padding: 0;\r\n    ${props => props.expanded && `{\r\n      margin-top: -1px;\r\n      border-bottom-color: rgba(34, 36, 38, 0.15);\r\n    }`}\r\n  }\r\n`\r\n\r\nconst PosedDetailsHeader = posed(DetailsHeader)({\r\n  visible: { opacity: 1 },\r\n  invisible: { opacity: 0 }\r\n})\r\n\r\nconst InnerSection = styled(posed(Section)({\r\n  enter: { y: 0 },\r\n  exit: { y: '-100%' },\r\n}))`\r\n  & {\r\n    z-index: -1;\r\n    width: 100%;\r\n    padding: 0;\r\n    margin-bottom: -1px;\r\n  }\r\n`\r\n\r\nexport default ({\r\n  children,\r\n  initiallyExpanded,\r\n  disabled,\r\n  headerInvisible,\r\n  forceExpanded,\r\n  overflowVisible,\r\n  mode,\r\n  ...headerProps,\r\n}) => {\r\n  const [ expanded, expand ] = useState(false)\r\n  useEffect(() => expand(\r\n    !!initiallyExpanded\r\n    || (!disabled && (forceExpanded || this.state.expanded))\r\n  ), [initiallyExpanded, disabled, forceExpanded])\r\n  return (\r\n    <OuterSection\r\n      expanded={expanded ? 1 : 0}\r\n      topBorder={expanded}\r\n      bottomBorder={expanded}\r\n    >\r\n      <PosedDetailsHeader\r\n        {...headerProps}\r\n        expanded={expanded}\r\n        bottomBorder={expanded && 'dark'}\r\n        disabled={forceExpanded}\r\n        titleSize='small'\r\n        onClick={\r\n          !forceExpanded\r\n          && (() => expand(!expanded))\r\n        }\r\n        pose={headerInvisible ? 'invisible' : 'visible'}\r\n      />\r\n      <Div\r\n        oy={overflowVisible ? undefined : 'hidden'}\r\n      >\r\n        <PoseGroup>\r\n          {expanded &&\r\n            <InnerSection\r\n              key={1}\r\n            >\r\n              {children}\r\n            </InnerSection>\r\n          }\r\n        </PoseGroup>\r\n      </Div>\r\n    </OuterSection>\r\n  )\r\n}\r\n\r\n","import _ from 'lodash'\r\n\r\nconst ProdsByDept = ({\r\n    children,\r\n    prods: oriProds,\r\n    // extra\r\n    selectedIds,\r\n    orderId,\r\n    selectLimit,\r\n    // order\r\n    selectedProds = [],\r\n    orderProdsQty,\r\n    diff, //diff mode\r\n    // epxpand\r\n    expandedIds,\r\n    expanded\r\n}) => {\r\n  const modes = {\r\n    ...orderId && { extra: true },\r\n    ...orderId && selectLimit === selectedIds.length && { limitReached: true },\r\n    ...!orderId && { order: true },\r\n    ...diff && { diff: true },\r\n    ...expandedIds && { expand: true },\r\n    ...expanded && { expanded: true },\r\n  }\r\n  const allProds =\r\n    modes['extra'] ? oriProds :\r\n    modes['order'] ? _.unionBy(oriProds, selectedProds, 'id') : []\r\n  const depts = _(allProds)\r\n    .sortBy('dept.type')\r\n    .groupBy('dept.name')\r\n    .reduce(function(depts, prods) {\r\n      let dept = { ...prods[0].dept }\r\n      dept = {\r\n        ...dept,\r\n        count: prods.length,\r\n        readyCount: prods.filter(p => p.progress === 100).length,\r\n        hasDefect: prods.filter(p => p.hasDefect).length,\r\n        isSpoiled: prods.filter(p => p.isSpoiled).length,\r\n        ...modes['expand'] && {\r\n          expanded: expandedIds.some(id => id === dept.id)\r\n        },\r\n        ...modes['expanded'] && {\r\n          expanded: true\r\n        },\r\n        prods: prods.map(p => {\r\n          let prod = {\r\n            ...p,\r\n            ...modes['extra'] && {\r\n              selected: selectedIds.includes(p.id),\r\n              ordered: !!p.order && p.order.id !== orderId\r\n            },\r\n            ...modes['order'] && modes['diff'] && {\r\n              added: !oriProds.some(op => op.id === p.id),\r\n              removed: !selectedProds.some(sp => sp.id === p.id),\r\n            },\r\n          }\r\n          if (modes['extra']) {\r\n            prod = {\r\n              ...prod,\r\n              disabled:\r\n                prod.ordered\r\n                || (modes['limitReached'] && !prod.selected)\r\n            }\r\n          }\r\n          return prod\r\n        }),\r\n      }\r\n      if (modes['extra']) {\r\n        const orderedCount = dept.prods.filter(p => p.ordered).length || 0\r\n        dept = {\r\n          ...dept,\r\n          selectedCount: dept.prods.filter(p => p.selected).length || 0,\r\n          orderedCount,\r\n          availCount: dept.count - orderedCount\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          selected:\r\n            dept.selectedCount === dept.availCount ? true :\r\n            dept.selectedCount === 0 ? false :\r\n            'partly'\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          disabled:\r\n            dept.prods.every(p => p.disabled)\r\n            || (modes['limitReached'] && [false].includes(dept.selected))\r\n        }\r\n      }\r\n      depts.push(dept)\r\n      return depts\r\n    }, [])\r\n  if (modes['order']) {\r\n    const unreservedProdsCount = diff\r\n      ? orderProdsQty - selectedProds.length\r\n      : orderProdsQty - oriProds.length\r\n    if (unreservedProdsCount) {\r\n      depts.unshift({\r\n        id: 'unreserved',\r\n        name: 'Без резерва',\r\n        count: unreservedProdsCount,\r\n        prods: []\r\n      })\r\n    }\r\n  }\r\n  const xor = !!_.xorBy(oriProds, selectedProds, 'id').length\r\n  // console.log('depts > ', depts)\r\n  return children({ depts, xor })\r\n}\r\n\r\nexport default ProdsByDept\r\n","import React, { Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nconst defaultFields = [{\r\n\tname: 'name',\r\n\tpath: 'name',\r\n\ttitle: 'Участок / № Изделия',\r\n\twidth: '170px'\r\n},{\r\n\tname: 'progress',\r\n\tpath: 'progress',\r\n\ttitle: 'Заверш.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'hasDefect',\r\n\tpath: 'hasDefect',\r\n\ttitle: 'Отклон.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'isSpoiled',\r\n\tpath: 'isSpoiled',\r\n\ttitle: 'Брак',\r\n\twidth: '55px'\r\n},{\r\n\tname: 'reserve',\r\n\ttitle: 'Резерв',\r\n\twidth: '75px'\r\n}]\r\n\r\nconst DeptProdTable = ({\r\n\t// data\r\n\tdepts,\r\n\tskipFields = [],\r\n\t// methods\r\n\tselect,\r\n\texpand,\r\n\t// visual\r\n\tindent,\r\n\tnameFieldWidth\r\n}) => {\r\n\tconst fields = cloneDeep(defaultFields)\r\n\tif (nameFieldWidth) fields.find(f => f.name === 'name').width = nameFieldWidth\r\n\treturn (\r\n\t\t<Table\r\n\t\t\tfields={fields.filter(f => !skipFields.includes(f.name))}\r\n\t\t\tindent={indent}\r\n\t\t\tselect={select}\r\n\t\t\texpand={expand}\r\n\t\t>\r\n\t\t\t{({ tableFields }) => <Fragment>\r\n\t\t\t\t{depts.map(dept => {\r\n\t\t\t\t\t\tconst { id, expanded } = dept\r\n\t\t\t\t\t\tif (id === 'unreserved') return (\r\n\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t// bold\r\n\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Fragment\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\texpandFor='prods'\r\n\t\t\t\t\t\t\t\t\texpanded={expanded}\r\n\t\t\t\t\t\t\t\t\texpand={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tonClick={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'readyCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'checkmark',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'green'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'orderedCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'gavel',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'brown'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{\texpanded && dept.prods.map((prod, i) => {\r\n\t\t\t\t\t\t\t\t\tconst { id, progress, order, added, removed } = prod\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === dept.prods.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\tentity={prod}\r\n\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t\t\t...(added || removed) ? [{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'service',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: added ? 'plus' : 'minus',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: added ? 'green' : 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}] : [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'fullnumber'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: progress && progress + '%'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: order && order.fullnum,\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t\t\t// active={}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={select && (() => select(id))}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t</Fragment>}\r\n\t\t</Table>\r\n\t\t// {/* {name} <ProdQtyLabel color='grey' basic content={`${prods.length}шт`} /> */}\r\n\t)\r\n}\r\n\r\nexport default DeptProdTable","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst IconRight = styled(Icon)`\r\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\r\n`\r\n\r\nconst ReserveProdsButton = ({ modelId, orderId, prodIds }) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, setSelectedProdIds }) => (\r\n        <Button compact circular menu\r\n          activeColor='green'\r\n          active={!!extra}\r\n          onClick={e => {\r\n            e.stopPropagation()\r\n            setSelectedProdIds(prodIds)\r\n            setExtra({\r\n              type: 'Store',\r\n              modelId,\r\n              orderId\r\n            })\r\n          }}\r\n        >\r\n          <Icon name='gavel' />\r\n          Резервирование\r\n          <IconRight name='angle right' />\r\n        </Button>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ReserveProdsButton","import gql from 'graphql-tag'\r\n\r\nexport const modelProds = gql`\r\n\tquery ModelProds ($modelId: ID!) {\r\n\t\tmodelProds (modelId: $modelId) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t\torder {\r\n\t\t\t\tid\r\n\t\t\t\tfullnum\r\n\t\t\t\tenquiry {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tnum\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const prodsLocal = gql`\r\n\tquery ProdsLocal ($ids: [ID!]!) {\r\n\t\tprodsLocal (ids: $ids) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n","import { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { prodsLocal } from '../../graphql/prod'\r\n\r\nconst ProdContext = ({\r\n\tchildren,\r\n\tprodsLocal: { prodsLocal }\r\n}) => {\r\n  return children({\r\n\t\tprodsLocal: prodsLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(prodsLocal, { name: 'prodsLocal' }),\r\n)(ProdContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { reserveProds } from '../../graphql/order'\r\n\r\nimport { Section, Button, Message } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport CollapsableSection from '../presentational/CollapsableSection'\r\nimport ProdsByDept from './ProdsByDept';\r\nimport DeptProdTable from './DeptProdTable';\r\nimport ReserveProdsButton from './ReserveProdsButton'\r\n// import ListProvider from './special/ListProvider'\r\nimport ProdContext from '../context/ProdContext'\r\n\r\nconst ModelProdsSection = ({\r\n  order: { id, model, qty, prods }\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, selectedProdIds }) => (\r\n        <CollapsableSection\r\n          forceExpanded={!!extra}\r\n          title={model.name}\r\n          subtitle={qty + 'шт'}\r\n          buttons={\r\n            <ReserveProdsButton\r\n              modelId={model.id}\r\n              orderId={id}\r\n              prodIds={prods.map(p => p.id)}\r\n            />\r\n          }\r\n        >\r\n            <ProdContext\r\n              ids={selectedProdIds}\r\n            >\r\n              {({ prodsLocal: selectedProds }) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedProds={selectedProds}\r\n                  orderProdsQty={qty}\r\n                  expanded\r\n                  diff={!!extra}\r\n                >\r\n                  {({ depts, xor }) =>\r\n                    <Fragment>\r\n                      <DeptProdTable\r\n                        depts={depts}\r\n                        skipFields={['reserve']}\r\n                        expand={() => null}\r\n                        indent='32px'\r\n                        nameFieldWidth='200px'\r\n                      />\r\n                      {extra && \r\n                      <Mutation\r\n                        mutation={reserveProds}\r\n                        variables={{\r\n                          orderId: id,\r\n                          prodIds: selectedProdIds\r\n                        }}\r\n                      >\r\n                        {( reserveProds, { loading, error }) => \r\n                          <Fragment>\r\n                            <Section\r\n                              minor\r\n                              head\r\n                              topBorder='dark'\r\n                            >\r\n                              <Button\r\n                                primary\r\n                                compact\r\n                                circular\r\n                                menu\r\n                                ml='0'\r\n                                content='Резервировать'\r\n                                icon='gavel'\r\n                                loading={loading}\r\n                                disabled={!xor}\r\n                                onClick={() => {\r\n                                  reserveProds()\r\n                                  setExtra(null)\r\n                                }}\r\n                              />\r\n                            </Section>\r\n                            {error &&\r\n                              <Message\r\n                                section\r\n                                error\r\n                                header='Зарезервировать не удалось..'\r\n                                content={error.message}\r\n                              />\r\n                            }\r\n                          </Fragment>\r\n                        }\r\n                      </Mutation>\r\n                      }\r\n                    </Fragment>\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ProdContext>\r\n          {/* {!extra && \r\n            <ListProvider>\r\n              {({ list: selectedIds, setList: setSelectedProdIds}) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedIds={selectedIds}\r\n                  orderProdsQty={qty}\r\n                >\r\n                  {({ depts }) =>\r\n                    <DeptProdTable\r\n                      depts={depts}\r\n                      setSelectedProdIds={setSelectedProdIds}\r\n                      skipFields={['reserve']}\r\n                    />\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ListProvider>\r\n          } */}\r\n        </CollapsableSection>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ModelProdsSection\r\n","import React from 'react'\r\n\r\nimport ModelProdsSection from './ModelProdsSection'\r\n\r\nconst OrderDetails = ({ order }) => {\r\n  return (\r\n    <ModelProdsSection\r\n      order={order}\r\n    />\r\n  )\r\n}\r\n\r\nexport default OrderDetails","import React from 'react'\r\n\r\nimport { SortableElement } from 'react-sortable-hoc'\r\n\r\nimport styled from 'styled-components'\r\nimport posed from 'react-pose'\r\nimport { Icon } from '../../../styled/styled-semantic';\r\n\r\nconst AspectRatioDiv = styled.div`\r\n  position: relative;\r\n  width: 100%;\r\n  padding-top: ${props => 100/props.proportion}%;\r\n  margin-bottom: 3px;\r\n`\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: rgba(0,0,50,.03);\r\n`\r\n\r\nconst ImgSpacer = posed.div({\r\n  shrinked: {\r\n    width:  'calc(100% - 60px)',\r\n    height: ({ proportion }) => `calc(100% - 60px/${proportion})`,\r\n  },\r\n  fullsize: {\r\n    width: '100%',\r\n    height: '100%',\r\n  }\r\n})\r\n\r\nconst Image = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst Mask = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  cursor: pointer;\r\n  transition: background-image .135s cubic-bezier(0.0,0.0,0.2,1);\r\n  :hover {\r\n    background-image: linear-gradient(to bottom,rgba(0,0,0,0.26),transparent 56px,transparent);\r\n  }\r\n  ${props => props.hide && `\r\n    background-image: unset !important;\r\n  `}\r\n  ${props => props.off && `\r\n    display: none;\r\n  `}\r\n`\r\n\r\nconst CheckBox = styled(Icon)`\r\n  position: absolute;\r\n  top: 7px;\r\n  left: 10px;\r\n  color: white;\r\n  &&& {\r\n    opacity: ${props => \r\n      props.active ? '1 !important' :\r\n      props.selectMode ? '.5 !important' : '0'};\r\n  }\r\n  ${Mask}:hover && {\r\n    opacity: ${props => props.selectMode ? '1 !important' : '.5'};\r\n  }\r\n`\r\n\r\nconst Check = styled(Icon)`\r\n  position: absolute;\r\n  left: 5px;\r\n  top: 4px;\r\n  &&& {\r\n    opacity: ${props => props.active ? '.9 !important' : '0'};\r\n    :hover {\r\n      opacity: .5 !important;\r\n    }\r\n  }\r\n  ${Mask}:hover && {\r\n    opacity: ${props => \r\n      props.active ? '.9 !important' :\r\n      props.selectMode ? '.5 !important' : '.2'};\r\n  }\r\n`\r\n\r\nexport default SortableElement(({\r\n  drawing: { id, files },\r\n  toggleSelection,\r\n  selected,\r\n  selectMode,\r\n  sortMode\r\n}) => {\r\n  const oriImage = files.find(f => f.imgFor === 'ORIGINAL')\r\n  const image = files.find(f => f.imgFor === 'FEED_792') || oriImage\r\n  const { path, width, height} = image\r\n  const proportion = width/height\r\n  return (<div>\r\n    <AspectRatioDiv\r\n      proportion={proportion}\r\n    >\r\n      <Container>\r\n        <Mask\r\n          hide={selected}\r\n          off={sortMode}\r\n          onClick={() => {\r\n            // deselect drawing if selected, select if in the selectMode\r\n            if (selected || selectMode) return toggleSelection(id)\r\n            // otherwise open fullsize image in new tab\r\n            const win = window.open(oriImage.path, '_blank')\r\n            win.focus()\r\n          }}\r\n        >\r\n          <CheckBox\r\n            link\r\n            name='square'\r\n            size='big'\r\n            fs='2.2em'\r\n            active={selected}\r\n            d={sortMode ? 'none !important' : undefined}\r\n            selectMode={selectMode}\r\n            color={selected ? 'grey' : undefined}\r\n          >\r\n            <Check\r\n              link\r\n              name='check'\r\n              size='small'\r\n              color='black'\r\n              c={selected ? '#fff !important' : undefined}\r\n              active={selected}\r\n              selectMode={selectMode}\r\n              onClick={e => {\r\n                e.stopPropagation()\r\n                toggleSelection(id)\r\n              }}\r\n            />\r\n          </CheckBox>\r\n        </Mask>\r\n        <ImgSpacer\r\n          pose={(selected || sortMode) ? 'shrinked' : 'fullsize'}\r\n          proportion={proportion}\r\n          onClick={() => selected && toggleSelection(id)}\r\n        >\r\n          <Image\r\n            src={path}\r\n            width={width}\r\n            height={height}\r\n          />\r\n        </ImgSpacer>\r\n      </Container>\r\n    </AspectRatioDiv></div>\r\n  )\r\n})\r\n","import React from 'react'\r\nimport { SortableContainer } from 'react-sortable-hoc'\r\nimport Drawing from './Drawing'\r\n\r\nexport default SortableContainer(({\r\n  drawings,\r\n  toggleDrawingSelection,\r\n  selectedDrawings,\r\n  sortMode\r\n}) => {\r\n  return (\r\n    <div>\r\n      {drawings.map((drw, i) =>\r\n        <Drawing\r\n          key={drw.id}\r\n          index={i}\r\n          drawing={drw}\r\n          toggleSelection={toggleDrawingSelection}\r\n          selected={!!selectedDrawings.includes(drw.id)}\r\n          selectMode={!!selectedDrawings.length}\r\n          sortMode={sortMode}\r\n          disabled={!sortMode}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n})\r\n\r\n","import { Component } from 'react'\r\nimport produce from 'immer'\r\n// import memoize from 'memoize-one'\r\n\r\nexport default class SortedCollectionProvider extends Component {\r\n  // sort = () => {\r\n  //   const { collection, sortBy } = this.props\r\n  //   return collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n  // }\r\n  // sort = memoize(watchedVar => {\r\n  //   const { collection, sortBy } = this.props\r\n  //   return this.setState({\r\n  //     sortedCollection: collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n  //   })\r\n  // })\r\n  state = {\r\n    sortedCollection: []\r\n  }\r\n  static getDerivedStateFromProps(props, state) {\r\n    if( props.collection !== state.prevPropsCollection) {\r\n      console.log(' > getDerivedStateFromProps')\r\n      const { collection, sortBy } = props\r\n      return {\r\n        prevPropsCollection: collection,\r\n        sortedCollection: collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  move = ( oldIndex, newIndex ) => {\r\n    this.setState(produce(draft => {\r\n      const [ removed ] = draft.sortedCollection.splice(oldIndex, 1)\r\n      draft.sortedCollection.splice(newIndex, 0, removed)\r\n    }))\r\n  }\r\n  render() {\r\n    const { children } = this.props\r\n    const { sortedCollection } = this.state\r\n    return children({\r\n      sortedCollection,\r\n      move: this.move\r\n    })\r\n  }\r\n}\r\n","import { Component } from 'react'\r\nimport { produce } from 'immer'\r\n\r\nexport default class StatefulList extends Component {\r\n  state = {\r\n    list: []\r\n  }\r\n  toggle = item => {\r\n    this.setState(produce(draft => {\r\n      console.log('draft > ', draft)\r\n      const index = draft.list.indexOf(item)\r\n      if (index !== -1) draft.list.splice(index, 1)\r\n        else draft.list.push(item)\r\n    }))\r\n  }\r\n  clear = () => this.setState({ list: [] })\r\n  removeMany = items => {\r\n    this.setState(({ list }) => ({\r\n      list: [ ...list.filter(i => !items.includes(i)) ]\r\n    }))\r\n  }\r\n  render() {\r\n    return this.props.children({\r\n      list: this.state.list,\r\n      toggle: this.toggle,\r\n      clear: this.clear,\r\n      removeMany: this.removeMany,\r\n    })\r\n  }\r\n}","import { Component } from 'react'\r\n\r\nexport default class StatefulBool extends Component {\r\n  state = {\r\n    bool: false\r\n  }\r\n  toggle = () => {\r\n    this.setState(({ bool }) => ({ bool: !bool }))\r\n  }\r\n  enable = () => this.setState({ bool: true })\r\n  disable = () => this.setState({ bool: false })\r\n  render() {\r\n    return this.props.children({\r\n      bool: this.state.bool,\r\n      toggle: this.toggle,\r\n      enable: this.enable,\r\n      disable: this.disable,\r\n    })\r\n  }\r\n}","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { createDrawings, deleteDrawings, setDrawingsSortOrder } from '../../../graphql/drawing'\r\n\r\nimport { NotificationsConsumer } from '../../notifications/NotificationsContext'\r\n\r\nimport Dropzone from 'react-dropzone'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport { Loader } from 'semantic-ui-react'\r\nimport { Icon, Button, Span } from '../../styled/styled-semantic'\r\nimport CollapsableSection from '../../presentational/CollapsableSection'\r\nimport SortableDrawingsList from './Drawings/Sortable'\r\nimport SortedCollectionProvider from './Drawings/SortedCollectionProvider'\r\nimport StatefulList from '../../context/StatefulList'\r\nimport StatefulBool from '../../context/StatefulBool'\r\n\r\nconst DropzoneArea = styled.div`\r\n  position: relative;\r\n  :focus {\r\n    outline: none;\r\n  }\r\n`\r\n\r\nconst DropzoneOverlay = styled(posed.div({\r\n  enter: { opacity: 1 },\r\n  exit: { opacity: 0 },\r\n}))`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  z-index: 2;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: rgba(0,0,0,.65);\r\n`\r\n\r\nconst MenuOverlay = styled(posed.div({\r\n  enter: { opacity: 1 },\r\n  exit: { opacity: 0 },\r\n}))`\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 1px;\r\n  right: 0;\r\n  left: 0;\r\n  height: 48px;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: rgba(255,255,255,1);\r\n`\r\n\r\nconst MenuLeftIcon = styled(Icon)`\r\n  &&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\n\r\nexport default class Drawings extends Component {\r\n  render() {\r\n    console.log('> Drawings render')\r\n    const { model, sidebarRef } = this.props\r\n    const { id: modelId, drawings } = model\r\n    return (\r\n      <NotificationsConsumer>\r\n        {({ notify }) =>\r\n          <Mutation\r\n            mutation={createDrawings}\r\n            onCompleted={() => notify({\r\n              type: 'success',\r\n              title: 'Файлы успешно загружены'\r\n            })}\r\n            onError={err => notify({\r\n              type: 'error',\r\n              title: 'Ошибка загрузки файлов',\r\n              content: err.message,\r\n            })}\r\n          >\r\n            {(createDrawings, { loading: creating, client }) =>\r\n              <Mutation\r\n                mutation={deleteDrawings}\r\n                onCompleted={() => notify({\r\n                  type: 'success',\r\n                  title: 'Файлы удалены'\r\n                })}\r\n                onError={err => notify({\r\n                  type: 'error',\r\n                  title: 'Ошибка удаления файлов',\r\n                  content: err.message,\r\n                })}\r\n              >\r\n                {(deleteDrawings, { loading: deleting }) =>\r\n                  <Mutation\r\n                    mutation={setDrawingsSortOrder}\r\n                    onCompleted={() => notify({\r\n                      type: 'success',\r\n                      content: 'Новый порядок чертежей установлен'\r\n                    })}\r\n                    onError={err => notify({\r\n                      type: 'error',\r\n                      title: 'Ошибка сортировки',\r\n                      content: err.message,\r\n                    })}\r\n                  >\r\n                    {(setDrawingsSortOrder, { loading: sorting }) =>\r\n                      <SortedCollectionProvider\r\n                        collection={drawings}\r\n                        sortBy='sortOrder'\r\n                      >\r\n                        {({ sortedCollection: drawings, move: moveDrawing }) =>\r\n                          <StatefulList>\r\n                            {({\r\n                              list: selectedDrawings,\r\n                              toggle: toggleDrawingSelection,\r\n                              clear: deselectAllDrawings,\r\n                              removeMany: deselectManyDrawings\r\n                            }) =>\r\n                              <StatefulBool>\r\n                                {({\r\n                                  bool: sortMode,\r\n                                  enable: enableSortMode,\r\n                                  disable: disableSortMode\r\n                                }) =>\r\n                                  <Dropzone\r\n                                    disabled={sortMode}\r\n                                    onDrop={async (acceptedFiles) => {\r\n                                      console.log('acceptedFiles > ', acceptedFiles)\r\n                                      if (!acceptedFiles.length) return\r\n                                      const res = await createDrawings({\r\n                                        variables: {\r\n                                          modelId,\r\n                                          files: acceptedFiles\r\n                                        }\r\n                                      })\r\n                                      if (!res) return\r\n                                      const { data } = res\r\n                                      client.writeData({\r\n                                        id: `Model:${modelId}`,\r\n                                        data: {\r\n                                          ...model,\r\n                                          drawings: [\r\n                                            ...drawings,\r\n                                            ...data.createDrawings\r\n                                          ]\r\n                                        }\r\n                                      })\r\n                                      this.collapsableSection.expand()\r\n                                    }}\r\n                                    disableClick\r\n                                    accept='image/jpeg, image/png'\r\n                                    onDropRejected={() => notify({\r\n                                      type: 'error',\r\n                                      title: 'Недопустимый формат файла',\r\n                                      content: 'Поддерживаются только изображения .jpeg или .png',\r\n                                    })}\r\n                                  >\r\n                                    {({\r\n                                      getRootProps,\r\n                                      getInputProps,\r\n                                      open: openFileDialog,\r\n                                      isDragActive,\r\n                                    }) =>\r\n                                      <DropzoneArea\r\n                                        isDragActive={isDragActive}\r\n                                        {...getRootProps()}\r\n                                      >\r\n                                        <input {...getInputProps()} />\r\n                                        <PoseGroup>\r\n                                          {isDragActive &&\r\n                                            <DropzoneOverlay key='1'>\r\n                                              <Icon\r\n                                                name='download'\r\n                                                size='large'\r\n                                                c='white'\r\n                                              />\r\n                                            </DropzoneOverlay>\r\n                                          }\r\n                                          {selectedDrawings.length &&\r\n                                            <MenuOverlay key='2' >\r\n                                              <MenuLeftIcon\r\n                                                link\r\n                                                size='large'\r\n                                                name='cancel'\r\n                                                onClick={() => deselectAllDrawings()}\r\n                                              />\r\n                                              <Span\r\n                                                fs='1.1em'\r\n                                                c='rgba(0,0,0,.75)'\r\n                                                fw='700'\r\n                                              >\r\n                                                Выбрано чертежей: {selectedDrawings.length}\r\n                                              </Span>\r\n                                              <Span\r\n                                                m='0 23px 0 auto'\r\n                                              >\r\n                                                <Icon\r\n                                                  link\r\n                                                  d={deleting ? 'none' : undefined}\r\n                                                  activeColor='#db2828'\r\n                                                  name='trash alternate outline'\r\n                                                  size='large'\r\n                                                  onClick={async () => {\r\n                                                    const ids = selectedDrawings\r\n                                                    const res = await deleteDrawings({ variables: { ids }})\r\n                                                    if (!res) return\r\n                                                    client.writeData({\r\n                                                      id: `Model:${modelId}`,\r\n                                                      data: {\r\n                                                        ...model,\r\n                                                        drawings: [ ...drawings.filter(drw => !ids.includes(drw.id)) ]\r\n                                                      }\r\n                                                    })\r\n                                                    deselectManyDrawings(ids)\r\n                                                    console.log('deleted!')\r\n                                                  }}\r\n                                                />\r\n                                                <Loader\r\n                                                  inline\r\n                                                  size='small'\r\n                                                  active={deleting}\r\n                                                />\r\n                                              </Span>\r\n                                              \r\n                                            </MenuOverlay>\r\n                                          }\r\n                                          {sortMode &&\r\n                                            <MenuOverlay key='3' >\r\n                                              <MenuLeftIcon\r\n                                                link\r\n                                                name='check'\r\n                                                size='large'\r\n                                                c='#016936'\r\n                                                onClick={async () => {\r\n                                                  let reordered = false\r\n                                                  drawings.forEach((drw, i) => {\r\n                                                    if (drw.sortOrder !== i) {\r\n                                                      reordered = true\r\n                                                      client.writeData({\r\n                                                        id: `Drawing:${drw.id}`,\r\n                                                        data: {\r\n                                                          ...drw,\r\n                                                          sortOrder: i\r\n                                                        }\r\n                                                      })\r\n                                                    }\r\n                                                  })\r\n                                                  if (reordered) await setDrawingsSortOrder({ variables: {\r\n                                                    ids: drawings.map(drw => drw.id)\r\n                                                  }})\r\n                                                  disableSortMode()\r\n                                                }}\r\n                                              />\r\n                                              <Span\r\n                                                fs='1.1em'\r\n                                                c='rgba(0,0,0,.75)'\r\n                                                fw='700'\r\n                                              >\r\n                                                Сортировка\r\n                                              </Span>\r\n                                              <Span\r\n                                                m='0 23px 0 auto'\r\n                                              >\r\n                                                <Loader\r\n                                                  inline\r\n                                                  size='small'\r\n                                                  active={sorting}\r\n                                                />\r\n                                              </Span>\r\n                                            </MenuOverlay>\r\n                                          }\r\n                                        </PoseGroup>\r\n                                        <CollapsableSection\r\n                                          ref={component => this.collapsableSection = component}\r\n                                          initiallyExpanded={!!drawings.length}\r\n                                          disabled={!drawings.length}\r\n                                          title='Чертеж '\r\n                                          subtitle={\r\n                                            <Span\r\n                                              fs='1.2em'\r\n                                            >\r\n                                              <Icon\r\n                                                name='file image outline'\r\n                                                mr='4px'\r\n                                              />\r\n                                              {drawings.length}\r\n                                            </Span>\r\n                                          }\r\n                                          buttons={<>\r\n                                            <Button compact circular menu\r\n                                              activeColor='green'\r\n                                              icon='plus'\r\n                                              onClick={e => {\r\n                                                e.stopPropagation()\r\n                                                notify({\r\n                                                  type: 'warning',\r\n                                                  content: 'Чтобы загрузить файлы, перетащите их в раздел',\r\n                                                })\r\n                                                openFileDialog()\r\n                                              }}\r\n                                              loading={creating}\r\n                                            />\r\n                                            <Button compact circular menu\r\n                                              icon='sort'\r\n                                              onClick={e => {\r\n                                                e.stopPropagation()\r\n                                                notify({\r\n                                                  type: 'warning',\r\n                                                  content: 'Чтобы изменить порядок, выберите и перетащите нужные чертежи',\r\n                                                })\r\n                                                enableSortMode()\r\n                                              }}\r\n                                            />\r\n                                          </>}\r\n                                        >\r\n                                          <SortableDrawingsList\r\n                                            drawings={drawings}\r\n                                            toggleDrawingSelection={toggleDrawingSelection}\r\n                                            selectedDrawings={selectedDrawings}\r\n                                            sortMode={sortMode}\r\n                                            onSortEnd={({ oldIndex, newIndex }) => moveDrawing( oldIndex, newIndex )}\r\n                                            getContainer={() => sidebarRef}\r\n                                          />\r\n                                        </CollapsableSection>\r\n                                      </DropzoneArea>\r\n                                    }\r\n                                  </Dropzone>\r\n                                }\r\n                              </StatefulBool>\r\n                            }\r\n                          </StatefulList>\r\n                        }\r\n                      </SortedCollectionProvider>\r\n                    }\r\n                  </Mutation>\r\n                }\r\n              </Mutation>\r\n            }\r\n          </Mutation>\r\n        }\r\n      </NotificationsConsumer>\r\n    )\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport Drawings from './Details/Drawings'\r\n\r\nexport default ({\r\n  model,\r\n  sidebarRef\r\n}) => {\r\n  return <>\r\n    <Drawings\r\n      model={model}\r\n      sidebarRef={sidebarRef}\r\n    />\r\n  </>\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport DetailsDataProvider from './DetailsDataProvider'\r\nimport DetailsMainHeader from './DetailsMainHeader'\r\nimport EnquiryDetails from '../Enquiry/EnquiryDetails'\r\nimport OrderEdit from '../Order/OrderEdit'\r\nimport OrderDetails from '../Order/OrderDetails'\r\nimport ModelDetails from '../Model/Details'\r\n\r\nconst Container = styled.div`\r\n\t/* flex-grow: 1; */\r\n\twidth: 60%;  // evaluates to 792px\r\n`\r\n\r\nconst Details = ({ closeDetails, sidebarRef }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId, editMode }, setDetails, setExpanded }) => (\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{/* Should I get rid of Details' components unification? */}\r\n\t\t\t\t\t\t<DetailsDataProvider\r\n\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{({ loading, error, refetch, entity, localEntity }) =>\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<DetailsMainHeader\r\n\t\t\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t\t\tlocalEntity={localEntity}\r\n\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t\t\teditMode={editMode}\r\n\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\trefresh={() => refetch()}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t\t\t? <EnquiryDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t:\tnull\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{type === 'Order' &&\r\n\t\t\t\t\t\t\t\t\t\t(id === 'new' || editMode\r\n\t\t\t\t\t\t\t\t\t\t\t? <OrderEdit\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenquiryId={enquiryId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetExpanded={setExpanded}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t: (entity &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<OrderDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\torder={entity}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{type === 'Model' &&\r\n\t\t\t\t\t\t\t\t\t\t(id === 'new' || editMode\r\n\t\t\t\t\t\t\t\t\t\t\t? <div></div>\r\n\t\t\t\t\t\t\t\t\t\t\t: (entity &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ModelDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodel={entity}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsidebarRef={sidebarRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</DetailsDataProvider>\r\n\t\t\t\t</Container>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default Details\r\n","import { Component } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport without from 'lodash/without'\r\nimport take from 'lodash/take'\r\nimport union from 'lodash/union'\r\nimport difference from 'lodash/difference'\r\nimport find from 'lodash/fp/find'\r\n\r\nclass ProdTableUtils extends Component {\r\n\tselect = (id) => {\r\n\t\tconst {\r\n\t\t\tdepts: propDepts,\r\n\t\t\tsetList,\r\n\t\t\tselectLimit\r\n\t\t} = this.props\r\n\t\tconst depts = cloneDeep(propDepts)\r\n\t\tconst selectedProdIds =\r\n\t\t\tdepts.reduce((list, d) =>\r\n\t\t\t\t[\r\n\t\t\t\t\t...list,\r\n\t\t\t\t\t...d.prods.filter(p => p.selected).map(p => p.id)\r\n\t\t\t\t]\r\n\t\t\t, [])\r\n\t\tconst dept =\r\n\t\t\tfind({ id }, depts)\r\n\t\t\t|| find({ prods: [ { id } ]}, depts)\r\n\t\tconst { prods } = dept\r\n\t\tconst entity =\r\n\t\t\tdept.id === id\r\n\t\t\t\t? dept\r\n\t\t\t\t: find({ id }, prods)\r\n\t\tif (entity.disabled) return null\r\n\t\tlet newList = []\r\n\t\tif (entity.__typename === 'Prod') {\r\n\t\t\tnewList =\r\n\t\t\t\tselectedProdIds.includes(id)\r\n\t\t\t\t\t? without(selectedProdIds, id)\r\n\t\t\t\t\t: [...selectedProdIds, id]\r\n\t\t}\r\n\t\tif (entity.__typename === 'Dept') {\r\n\t\t\tif ([ 'partly', true ].includes(entity.selected))\r\n\t\t\t\tnewList = difference(selectedProdIds, prods.map(p => p.id))\r\n\t\t\tif (entity.selected === false) {\r\n\t\t\t\tconst idsWithinLimit = take(\r\n\t\t\t\t\tprods.filter(p => !p.disabled).map(p => p.id),\r\n\t\t\t\t\tselectLimit - selectedProdIds.length\r\n\t\t\t\t)\r\n\t\t\t\tnewList = union(selectedProdIds, idsWithinLimit)\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetList(newList)\r\n\t}\r\n\trender () {\r\n\t\tconst { children } = this.props\r\n\t\treturn children({\r\n\t\t\tselect: this.select\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport default ProdTableUtils","import { Component } from 'react'\r\n\r\n// deprecated, use SelectableListProvider\r\nexport default class ListProvider extends Component {\r\n\tstate = {\r\n\t\tlist: []\r\n\t}\r\n\tsetList = (list) => this.setState({ list })\r\n\ttoggle = (item) => {\r\n\t\tconst { list } = this.state\r\n\t\tconst newList = \r\n\t\t\tlist.includes(item)\r\n\t\t\t? [ ...list.filter(i => i !== item) ]\r\n\t\t\t: [ ...list, item ]\r\n\t\tthis.setState({ list: newList })\r\n\t}\r\n\trender() {\r\n\t\treturn this.props.children({\r\n\t\t\tlist: this.state.list,\r\n\t\t\tsetList: this.setList,\r\n\t\t\ttoggle: this.toggle,\r\n\t\t})\r\n\t}\r\n}\r\n","import { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { orderLocal } from '../../graphql/order'\r\n\r\nconst OrderContext = ({\r\n\tchildren,\r\n\torderLocal: { orderLocal }\r\n}) => {\r\n  return children({\r\n\t\torderLocal: orderLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(orderLocal, { name: 'orderLocal' }),\r\n)(OrderContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section } from '../styled/styled-semantic'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { modelLocal } from '../../graphql/model'\r\nimport { modelProds } from '../../graphql/prod'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport DetailsHeader from './DetailsHeader'\r\nimport ProdsByDept from '../Order/ProdsByDept'\r\nimport ProdTableUtils from '../Order/ProdTableUtils'\r\nimport DeptProdTable from '../Order/DeptProdTable'\r\nimport ListProvider from '../context/ListProvider';\r\nimport OrderContext from '../context/OrderContext';\r\n\r\nconst Container = styled.div`\r\n\twidth: 40%;\r\n\tmin-height: calc(100vh - 36px);\r\n\theight: fit-content;\r\n\t/* border-left: 1px solid rgb(126, 126, 129); */\r\n\tborder-left: 1px solid rgb(156, 156, 159);\r\n`\r\n\r\nconst DetailsExtra = ({ closeExtra }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ extra, selectedProdIds, setSelectedProdIds }) => (\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{!!extra && \r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelLocal}\r\n\t\t\t\t\t\t\t\tvariables={{ id: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ data: { modelLocal } }) =>\r\n\t\t\t\t\t\t\t\t\t<DetailsHeader\r\n\t\t\t\t\t\t\t\t\t\ttitle={modelLocal.name + ' в наличии'}\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tnoIndent\r\n\t\t\t\t\t\t\t\t\t\tbottomBorder='dark'\r\n\t\t\t\t\t\t\t\t\t\tbuttons={\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon link\r\n\t\t\t\t\t\t\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={closeExtra}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelProds}\r\n\t\t\t\t\t\t\t\tvariables={{ modelId: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ loading, error, data }) => {\r\n\t\t\t\t\t\t\t\t\tif (loading) return <Section noIndent >Загрузка...</Section>\r\n\t\t\t\t\t\t\t\t\tif (error) return <Section noIndent >Ошибка {error.message}</Section>\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<OrderContext\r\n\t\t\t\t\t\t\t\t\t\t\tid={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{({ orderLocal }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{({ list: expandedIds, toggle: toggleExpanded }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdsByDept\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprods={data.modelProds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedIds={selectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torderId={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpandedIds={expandedIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ depts }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdTableUtils\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetList={setSelectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ select }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DeptProdTable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect={select}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpand={toggleExpanded}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdTableUtils>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdsByDept>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</OrderContext>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Container>\r\n\t\t\t\t\t\t\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default DetailsExtra\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar, Ref } from 'semantic-ui-react';\r\nimport Details from './Details'\r\nimport DetailsExtra from './DetailsExtra'\r\n\r\nconst SSidebar = styled(Sidebar)`\r\n\t&&&& {\r\n\t\tdisplay: flex;\r\n\t\twidth: 120%;\r\n\t\tbackground-color: white;\r\n\t\ttransition: all .5s ease;\r\n\t\tmax-width: ${props => \r\n\t\t\tprops.type === 'Enquiry'\r\n\t\t\t? '1000px'\r\n\t\t\t: '1320px'\r\n\t\t};\r\n\t\t${props => !props.extra && `\r\n\t\t\t&.ui.visible.right.overlay.sidebar {\r\n\t\t\t\ttransform: translate3d(40%,0,0);\r\n\t\t\t}\r\n\t\t`}\r\n\t\t${props => props.extra && `\r\n\t\t\twidth: 86%;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nclass DetailsSidebar extends Component {\r\n\tstate = { detailsClosing: false }\r\n\tcloseDetails = () => {\r\n\t\tthis.setState({ detailsClosing: true })\r\n\t\t// set timeout for sidebar to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { input: { details: null, extra: null } }})\r\n\t\t\tthis.setState({ detailsClosing: false })\r\n\t\t}, 300)\r\n\t}\r\n\tcloseExtra = () => {\r\n\t\tthis.props.setLayout({variables: { input: { extra: null } }})\r\n\t}\r\n\trender() {\r\n\t\tconst { detailsClosing } = this.state\r\n\t\tconst { layout: { details, extra } } = this.props\r\n\t\treturn (\r\n\t\t\t<Ref innerRef={node => this.sidebarRef = node}>\r\n\t\t\t\t<SSidebar\r\n\t\t\t\t\tvisible={!!details && !detailsClosing}\r\n\t\t\t\t\textra={!!extra ? 1: 0}\r\n\t\t\t\t\ttype={details && details.type}\r\n\t\t\t\t\tanimation='overlay'\r\n\t\t\t\t\tdirection='right'\r\n\t\t\t\t>\r\n\t\t\t\t\t{details &&\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<Details\r\n\t\t\t\t\t\t\t\tkey={details.type + details.id}\r\n\t\t\t\t\t\t\t\tcloseDetails={this.closeDetails}\r\n\t\t\t\t\t\t\t\tsidebarRef={this.sidebarRef}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<DetailsExtra\r\n\t\t\t\t\t\t\t\textra={extra}\r\n\t\t\t\t\t\t\t\tcloseExtra={this.closeExtra}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t}\r\n\t\t\t\t</SSidebar>\r\n\t\t\t</Ref>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(DetailsSidebar)","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100vh - 36px) !important;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n`\r\n\r\nconst Main = styled.div`\r\n  flex: 1 0 50px;\r\n  min-height: 50px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n`\r\n\r\nconst Panel = styled.div`\r\n  flex: 0 0 0;\r\n  min-height: 387px;\r\n  background: #fff;\r\n  z-index: 10;\r\n  /* box-shadow: 0 0 20px rgba(34,36,38,.15); shadow of semantic-ui Sidebar*/\r\n  box-shadow: 0 0 20px 5px #fff;\r\n  transition: min-height .4s ease-out;\r\n  ${props => !props.panelVisible && `\r\n    min-height: 0;\r\n  `}\r\n`\r\n\r\nexport default class PanelPusher extends Component {\r\n  render() {\r\n    const {\r\n      children,\r\n      panel,\r\n      panelVisible,\r\n      panelRendered\r\n    } = this.props\r\n    return (\r\n      <Container>\r\n        <Main\r\n          panelVisible={panelVisible}\r\n        >\r\n          {children}\r\n        </Main>\r\n        <Panel\r\n          panelVisible={panelVisible}\r\n        >\r\n          { panelRendered &&\r\n            panel\r\n          }\r\n        </Panel>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const telFragment = gql`\r\n\tfragment TelFragment on Tel {\r\n\t\tid\r\n\t\tnumber\r\n\t\ttype\r\n\t\tcountry\r\n\t\tnote\r\n\t\tdefault\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { telFragment } from './tel'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\n// TODO switch to using only amoName in the app\r\nexport const personFragmentBasic = gql`\r\n\tfragment PersonFragmentBasic on Person {\r\n\t\tid\r\n\t\tamoId\r\n\t\tfName\r\n\t\tlName\r\n\t\tmName\r\n\t\tamoName\r\n\t}\r\n`\r\n\r\nexport const personContactsFragment = gql`\r\nfragment PersonContactsFragment on Person {\r\n\t...PersonFragmentBasic\r\n\thtmlNote\r\n\ttels { ...TelFragment }\r\n\tuser {\r\n\t\temail\r\n\t\tconfirmed\r\n\t}\r\n}\r\n${telFragment}\r\n${personFragmentBasic}\r\n`\r\n\r\nexport const personExecFragment = gql`\r\n\tfragment personExecFragment on Person {\r\n\t\tid\r\n\t\tamoName\r\n\t\texec {\r\n\t\t\tid\r\n\t\t\topTypes { ...opTypeFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const persons = gql`\r\n\tquery Persons {\r\n\t\tpersons { ...PersonFragmentBasic }\r\n\t}\r\n\t${personFragmentBasic}\r\n`\r\n\r\nexport const personExecs = gql`\r\n\tquery personExecs {\r\n\t\tpersons { ...personExecFragment }\r\n\t}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const personExec = gql`\r\n\tquery personExec ($id: ID!) {\r\n\t\tperson (id: $id) { ...personExecFragment }\r\n\t}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const upsertPersonExec = gql`\r\n\tmutation upsertPerson2($input: PersonInput!) {\r\n\t\tupsertPerson2(input: $input) {\r\n\t\t\t...personExecFragment\r\n\t\t}\r\n\t}\r\n\t${personExecFragment}\r\n`","import gql from 'graphql-tag'\r\nimport { personContactsFragment } from './person'\r\n\r\nexport const orgEmployees = gql`\r\n\tquery OrgEmployees ($orgId: ID!) {\r\n\t\torgEmployees (orgId: $orgId) {\r\n\t\t\tid\r\n\t\t\tposition\r\n\t\t\tperson { ...PersonContactsFragment }\r\n\t\t}\r\n\t}\r\n\t${personContactsFragment}\r\n`\r\n\r\nexport const upsertEmployee = gql`\r\n\tmutation UpsertEmployee(\r\n\t\t$input: EmployeeInput!\r\n\t) {\r\n\t\tupsertEmployee(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import React from 'react'\r\nimport produce from 'immer'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { orgLocal } from '../../graphql/org'\r\n\r\nimport styled from 'styled-components'\r\nimport { Header, Button, Icon } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst MenuDiv = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n\t/* border-top: 1px solid rgb(180, 181, 182); color of Chrome address section bottom border */\r\n\tborder-top: 1px solid rgb(160, 161, 162);\r\n`\r\n\r\nexport default ({\r\n\tclosePanel\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\tw='30px'\r\n\t\t\t\t\t\tm='0 10px'\r\n\t\t\t\t\t\tlink\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tonClick={closePanel}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Query\r\n\t\t\t\t\t\tquery={orgLocal}\r\n\t\t\t\t\t\tvariables={{id: bottomPanel.orgId}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\t\tif (data && data.orgLocal) return (\r\n\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\tpl='0 !important'\r\n\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\tcontent={`Представители \\u00A0 ${data.orgLocal.name}`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn null\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t// content=''\r\n\t\t\t\t\t\tactive={ !bottomPanel.id }\r\n\t\t\t\t\t\tonClick={() => setBottomPanel(\r\n\t\t\t\t\t\t\tproduce(bottomPanel, draft => { delete draft.id })\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nexport default ({\r\n  tel\r\n}) => {\r\n  return (\r\n    <div>\r\n      {formatTel(tel)}\r\n    </div>\r\n  )\r\n}\r\n","import React, { Fragment } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport Tel from './Tel'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n  flex: 0 0 122px;\r\n  color: rgba(0,0,0,.87);\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n  vertical-align: top;\r\n`\r\n\r\nconst Content = styled.div`\r\n  flex: 1 1 auto;\r\n  min-width: 210px;\r\n  font-size: calc(15rem/14);\r\n  font-weight: bold;\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n`\r\n\r\nexport default ({\r\n  type,\r\n  label,\r\n  content\r\n}) => {\r\n  const component = data =>\r\n    type === 'string' ? data :\r\n    type === 'tel' ? <Tel tel={data} />\r\n    : null\r\n  return (\r\n    <Container>\r\n      <Label>\r\n        {label}\r\n      </Label>\r\n      <Content>\r\n        {Array.isArray(content)\r\n          ? content.map((item, i) => \r\n              <Fragment key={i}>\r\n                {component(item)}\r\n              </Fragment>\r\n            )\r\n          : component(content)\r\n        }\r\n      </Content>\r\n    </Container>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Field from './Field'\r\n\r\nconst renderObj = (obj, objSchema, key) => {\r\n  // obj may be any value\r\n  // objSchema should be either Object or Array with only one schema object element\r\n  const isArray = Array.isArray(objSchema)\r\n  const schema = isArray ? objSchema[0] : objSchema\r\n  const schemaKeys = Object.keys(schema)\r\n  // if objSchema contains 'label' than that's a field\r\n  const isField = schemaKeys.includes('label')\r\n  if (isField) {\r\n    // default type is 'string\r\n    const type = schema.type || 'string'\r\n    return (\r\n      <Field\r\n        key={key}\r\n        type={type}\r\n        label={schema.label}\r\n        content={obj}\r\n      />\r\n    )\r\n  }\r\n  else {\r\n    // when traversing, take only obj keys that are non-empty arrays/values\r\n    return schemaKeys\r\n      .filter(k => Array.isArray(obj[k]) ? obj[k].length : !!obj[k])\r\n      .map((k, i)=> renderObj(obj[k], objSchema[k], i))\r\n  }\r\n}\r\n\r\nexport default ({\r\n  entity,\r\n  schema\r\n}) => renderObj(entity, schema, '0')\r\n","import { lazy, object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tcountry: string()\r\n\t\t.oneOf(['rus', 'notRus'])\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.default('rus')\r\n\t\t),\r\n\tnumber: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string()\r\n\t\t\t.transform(val => val.match(/.*\\d.*/) //if value contains digits\r\n\t\t\t\t? val.match(/\\d+/g).join('') // extract and join digits\r\n\t\t\t\t: val // else pass value through\r\n\t\t\t)\r\n\t\t\t.when('country', {\r\n\t\t\t\tis: 'rus',\r\n\t\t\t\tthen: string().matches(/\\d{10}/, 'российский телефонный номер должен содержать 10 цифр'), \t\t\t\t\t\t\t\t\t// check number of digits for russia (10)\r\n\t\t\t\totherwise: string().matches(/\\d{7,25}/, 'международный телефонный номер должен содержать от 7 до 25 цифр')\t// from 7 to 25 for notRus numbers\r\n\t\t\t})\r\n\t)\r\n})","import { lazy, array, object, string } from 'yup'\r\n\r\nimport { validationSchema as telValidationSchema } from './tel'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tlName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\tfName: string().trim().min(2).max(255)\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required('Пропущено обязательное поле Имя')\r\n\t\t)\r\n  ,\r\n\tmName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\ttels: array().of(telValidationSchema)\r\n})","import { object } from 'yup'\r\n\r\nimport { validationSchema as personValidationSchema } from './person'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  orgId: idValidationType\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required()\r\n\t\t),\r\n  person: personValidationSchema\r\n})\r\n\r\nexport const formikSchema = {\r\n  person: {\r\n    lName: '',\r\n    fName: '',\r\n    mName: '',\r\n    tels: [{\r\n      number: '',\r\n      country: 'rus',\r\n    }]\r\n  }\r\n}\r\n\r\nexport const listSchema = {\r\n  person: {\r\n    lName: {\r\n      label: 'Фамилия'\r\n    },\r\n    fName: {\r\n      label: 'Имя'\r\n    },\r\n    mName: {\r\n      label: 'Отчество'\r\n    },\r\n    tels: [{\r\n      label: 'Телефон',\r\n      type: 'tel'\r\n    }]\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport List from '../list/List'\r\nimport { listSchema } from '../../schema/employee'\r\n\r\nexport default ({\r\n  emp,\r\n  toggleEditMode\r\n}) => {\r\n  return <>\r\n    <DetailsHeader\r\n      title={emp.person.fullname}\r\n      size='small'\r\n      noIndent\r\n      bottomBorder='dark'\r\n      buttons={<>\r\n        <Icon\r\n          link\r\n          name='edit'\r\n          activeColor='blue'\r\n          onClick={toggleEditMode}\r\n        />\r\n      </>}\r\n    />\r\n    <Div\r\n      p='1em'\r\n    >\r\n      <List\r\n        entity={emp}\r\n        schema={listSchema}\r\n      />\r\n    </Div>\r\n  </>\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertEmployee } from '../../graphql/employee'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/employee'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\n// position\r\n// fName\r\n// lName\r\n// mName\r\n// htmlNote\r\n// tels { ...TelFragment }\r\n// user {\r\n//   email\r\n//   confirmed\r\n// }\r\n\r\nexport default class EmployeeForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    let schema = emp ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = emp ? projectEntity(emp, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertEmployee}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertEmployee, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('input > ', input)\r\n              await upsertEmployee({ variables: { input } })\r\n              // const upserted = await upsertEmployee({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return emp\r\n                ? toggleEditMode()\r\n                : this.didMount && resetForm()\r\n            }}\r\n          >\r\n            {({\r\n              values,\r\n              handleChange,\r\n              handleSubmit,\r\n              handleReset,\r\n              setFieldValue\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label='Фамилия'\r\n                  name='person.lName'\r\n                />\r\n                <Field\r\n                  label='Имя'\r\n                  required\r\n                  name='person.fName'\r\n                />\r\n                <Field\r\n                  label='Отчество'\r\n                  name='person.mName'\r\n                />\r\n                <Field\r\n                  label='Телефон'\r\n                  name='person.tels'\r\n                />\r\n                {/* TODO add email input */}\r\n                {/* <Field\r\n                  label='E-mail'\r\n                  name='person.email'\r\n                /> */}\r\n                {!!error &&\r\n                  <Message\r\n                    error\r\n                    header='Не удалось добавить..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  // type=\"submit\"\r\n                  type='button'\r\n                  primary\r\n                  content={emp ? 'Сохранить' : 'Добавить'}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ emp ? toggleEditMode : handleReset}\r\n                >\r\n                  {emp ? 'Отмена' : 'Очистить'}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport EmployeeForm from './Form'\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nexport default class EmployeeEdit extends Component {\r\n  render() {\r\n    const { \r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    return <>\r\n      <DetailsHeader\r\n        title={\r\n          emp\r\n          ? 'Редактировать'\r\n          : 'Добавить представителя'\r\n        }\r\n        size='small'\r\n        noIndent\r\n        bottomBorder='dark'\r\n        buttons={<>\r\n          {/* <Icon\r\n            link\r\n            name='save'\r\n            color='blue'\r\n            onClick={(emp) => console.log('upsert emp -> ', emp)}\r\n          /> */}\r\n        </>}\r\n      />\r\n      <Div\r\n        p='1em'\r\n        oy='auto'\r\n        h='315px'\r\n      >\r\n        <EmployeeForm\r\n          emp={emp}\r\n          orgId={orgId}\r\n          toggleEditMode={toggleEditMode}\r\n          refetchQueries={refetchQueries}\r\n        />\r\n      </Div>\r\n    </>\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nconst fields = [{\r\n\tname: 'fullname',\r\n\ttitle: 'ФИО',\r\n\twidth: '250px'\r\n},{\r\n  name: 'tel',\r\n  title: 'Телефон',\r\n  width: '140px'\r\n}]\r\n\r\nexport default ({\r\n  emps\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<Table\r\n          fields={fields}\r\n          indent='27px'\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\temps.map(emp => {\r\n              const { id, person } = emp\r\n              const { lName, fName, mName, tels } = person || {}\r\n\t\t\t\t\t\t\tconst active = bottomPanel.id === id\r\n\t\t\t\t\t\t\treturn (\r\n                <TableRow\r\n                  key={id}\r\n                  entity={emp}\r\n                  tableFields={tableFields}\r\n                  rowFields={[{\r\n                    name: 'fullname',\r\n                    value: person\r\n                      ? [lName, fName, mName].join(' ')\r\n                      : 'Персональные данные удалены'\r\n                  },{\r\n                    name: 'tel',\r\n                    value: (tels && tels.length && formatTel(tels[0])) || ''\r\n                  }\r\n                  // ,{\r\n                  //   name: 'emps',\r\n                  //   icon: org.employees.length ? 'user' : 'user plus',\r\n                  //   iconColor: 'grey',\r\n                  //   type: 'onHover',\r\n                  //   styles: ['center'],\r\n                  //   value: org.employees.length || ' ',\r\n                  //   onClick: () => {\r\n                  //     setBottomPanel({\r\n                  //       type: 'Employees',\r\n                  //       orgId: org.id\r\n                  //     })\r\n                  //   },\r\n                  //   active: bottomPanel\r\n                  //     && bottomPanel.type === 'Employees'\r\n                  //     && bottomPanel.orgId === org.id\r\n                  // }\r\n                  ]}\r\n                  active={active}\r\n                  onClick={() => {\r\n                    setBottomPanel({\r\n                      ...bottomPanel,\r\n                      editMode: false,\r\n                      id\r\n                    })\r\n                  }}\r\n                />\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport produce from 'immer'\r\nimport { Query } from 'react-apollo'\r\nimport { orgEmployees } from '../../graphql/employee'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { Message } from '../styled/styled-semantic';\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport EmployeesPanelHeader from '../Employee/PanelHeader'\r\nimport EmployeeDetails from '../Employee/Details'\r\nimport EmployeeEdit from '../Employee/Edit'\r\nimport EmployeesTable from '../Employee/Table';\r\n\r\nconst EmployeesPanelBody = styled.div`\r\n  display: flex;\r\n  height: calc(100% - 37px);\r\n`\r\n\r\nconst EmployeesPanelTableSection = styled.div`\r\n  flex: 0 0 600px;\r\n`\r\n\r\nconst EmployeeDetailsSection = styled.div`\r\n  flex: 0 0 480px;\r\n  border: solid rgb(156,156,159);\r\n  border-width: 0 1px;\r\n  min-height: 100%;\r\n`\r\n\r\nconst processEmp = emp =>\r\n  produce(emp, draft => {\r\n    const { lName, fName, mName } = draft.person\r\n    draft.person.fullname = [lName, fName, mName].join(' ')\r\n  })\r\n\r\nexport default ({\r\n  closePanel\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ bottomPanel, setBottomPanel }) => <>\r\n        <EmployeesPanelHeader \r\n          closePanel={closePanel}\r\n        />\r\n        <Query\r\n          query={orgEmployees}\r\n          variables={{ orgId: bottomPanel.orgId }}\r\n        >\r\n          {({ loading, error, data, refetch }) => {\r\n            if (loading) return 'Загрузка..'\r\n            if (error) return `Ошибка ${error.message}`\r\n            const emps = data.orgEmployees\r\n            const activeEmp = bottomPanel.id && data.orgEmployees.find(e => e.id === bottomPanel.id)\r\n            return (\r\n              <EmployeesPanelBody>\r\n                <EmployeesPanelTableSection>\r\n                  {emps.length\r\n                    ? <EmployeesTable\r\n                        emps={emps}\r\n                      />\r\n                    : <Message\r\n                        m='1em'\r\n                        content={<>\r\n                          Добавьте первого представителя<br/>\r\n                          👉\r\n                        </>}\r\n                      />\r\n                  }\r\n                </EmployeesPanelTableSection>\r\n                <EmployeeDetailsSection>\r\n                  {!bottomPanel.id\r\n                    ? <EmployeeEdit \r\n                        orgId={bottomPanel.orgId}\r\n                        refetchQueries={refetch}\r\n                      /> :\r\n                    !activeEmp.person ?\r\n                      null :\r\n                    bottomPanel.editMode\r\n                    ? <EmployeeEdit\r\n                        emp={activeEmp}\r\n                        orgId={bottomPanel.orgId}\r\n                        toggleEditMode={() => setBottomPanel(\r\n                          produce(bottomPanel, draft => { delete draft.editMode })\r\n                        )}\r\n                        refetchQueries={refetch}\r\n                      />\r\n                    : <EmployeeDetails\r\n                        emp={processEmp(activeEmp)}\r\n                        toggleEditMode={() => setBottomPanel({ ...bottomPanel, editMode: true })}\r\n                      />\r\n                  }\r\n                </EmployeeDetailsSection>\r\n              </EmployeesPanelBody>\r\n            )\r\n          }}\r\n        </Query>\r\n      </>}\r\n    </GlobalContext>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { graphql } from 'react-apollo'\r\nimport * as compose from 'lodash.flowright'\r\nimport { allEnquiries } from '../../graphql/enquiry'\r\nimport { setLayout } from '../../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar } from 'semantic-ui-react'\r\n\r\nimport EnquiriesMenu from './EnquiriesMenu'\r\nimport EnquiriesTable from './EnquiriesTable'\r\nimport DetailsSidebar from '../DetailsOld/DetailsSidebar'\r\nimport PanelPusher from '../common/PanelPusher'\r\nimport EnquiriesBottomPanel from './EnquiriesBottomPanel'\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst Pushable = styled(Sidebar.Pushable)`\r\n\tmin-height: calc(100vh - 36px) !important;\r\n`\r\n\r\nexport class EnquiriesPage extends Component {\r\n\t// TODO refactor -> move bottomPanel logic to PanelProvider, switch to Apollo Query components\r\n\tstate = { panelClosing: false }\r\n\tclosePanel = () => {\r\n\t\tthis.setState({ panelClosing: true })\r\n\t\t// set timeout for panel to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { input: { bottomPanel: null } } })\r\n\t\t\tthis.setState({ panelClosing: false })\r\n\t\t}, 430)\r\n\t}\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tallEnquiries: { loading, error, refetch, enquiries },\r\n\t\t} = this.props\r\n\t\tconst { panelClosing } = this.state\r\n\t\treturn <>\r\n\t\t\t<EnquiriesMenu\r\n\t\t\t\trefetchEnquiries={() => refetch()}\r\n\t\t\t\tenquiriesAreLoading={loading}\r\n\t\t\t/>\r\n\t\t\t{loading && \"Загрузка...\"}\r\n\t\t\t{error && `Ошибка ${error.message}`}\r\n\t\t\t{enquiries &&\r\n\t\t\t\t<GlobalContext>\r\n\t\t\t\t\t{({ bottomPanel }) =>\r\n\t\t\t\t\t\t<Pushable>\r\n\t\t\t\t\t\t\t<DetailsSidebar />\r\n\t\t\t\t\t\t\t<Sidebar.Pusher>\r\n\t\t\t\t\t\t\t\t<PanelPusher\r\n\t\t\t\t\t\t\t\t\tpanel={\r\n\t\t\t\t\t\t\t\t\t\t<EnquiriesBottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\tclosePanel={this.closePanel}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpanelRendered={!!bottomPanel}\r\n\t\t\t\t\t\t\t\t\tpanelVisible={!!bottomPanel && !panelClosing}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<EnquiriesTable\r\n\t\t\t\t\t\t\t\t\t\tenquiries={enquiries}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</PanelPusher>\r\n\t\t\t\t\t\t\t</Sidebar.Pusher>\r\n\t\t\t\t\t\t</Pushable>\r\n\t\t\t\t\t}\r\n\t\t\t\t</GlobalContext>\r\n\t\t\t}\r\n\t\t</>\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(allEnquiries, {\r\n\t\tname: 'allEnquiries',\r\n\t\talias: 'allEnquiriesQuery'\r\n\t}),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(EnquiriesPage)","import gql from 'graphql-tag'\r\n\r\nexport const articleFragmentBasic = gql`\r\n\tfragment ArticleFragmentBasic on Article {\r\n\t\tid\r\n\t\trusName\r\n\t\tisIncome\r\n\t\tisLoan\r\n\t}\r\n`\r\n\r\nexport const articleFragmentFull = gql`\r\n\tfragment ArticleFragmentFull on Article {\r\n\t\t...ArticleFragmentBasic\r\n\t\trelations\r\n\t}\r\n\t${articleFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\n\r\nexport const mpProjectFragmentBasic = gql`\r\n\tfragment mpProjectFragmentBasic on MpProject {\r\n\t\tId\r\n\t\tName\r\n\t}\r\n`\r\n\r\nexport const mpProjectFragmentFull = gql`\r\n\tfragment mpProjectFragmentFull on MpProject {\r\n\t\t...mpProjectFragmentBasic\r\n\t\tStatus\r\n\t\tSuperProjectId\r\n\t}\r\n\t${mpProjectFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\n\r\nexport const mdKontragentFragmentBasic = gql`\r\n\tfragment mdKontragentFragmentBasic on MdKontragent {\r\n    Id\r\n    Inn\r\n\t\tName\r\n\t}\r\n`\r\n\r\nexport const createMdKontragent = gql`\r\n\tmutation createMdKontragent($inn: String!) {\r\n\t\tcreateMdKontragent(inn: $inn) {\r\n\t\t\t...mdKontragentFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${mdKontragentFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\nimport { articleFragmentBasic, articleFragmentFull } from './article'\r\nimport { accountFragmentBasic, accountFragmentFull } from './account'\r\nimport { mpProjectFragmentFull } from './mpProject'\r\nimport { mdKontragentFragmentBasic } from './mdKontragent'\r\nimport { orgFragmentBasic } from './org'\r\nimport { personFragmentBasic } from './person'\r\nimport { userFragmentBasic } from './user'\r\n\r\nexport const paymentFragmentBasic = gql`\r\n\tfragment PaymentFragmentBasic on Payment {\r\n\t\tid\r\n\t\tinn\r\n\t\tisIncome\r\n\t\tdateLocal\r\n\t\tamount\r\n\t\tpurpose\r\n\t\taccount { ...accountFragmentBasic }\r\n\t\tarticle { ...ArticleFragmentBasic }\r\n\t\tcreatedBy { ...userFragmentBasic }\r\n\t\tmpProjectId\r\n\t\torg { ...OrgFragmentBasic }\r\n\t\tperson { ...PersonFragmentBasic }\r\n\t\tupdatedBy { ...userFragmentBasic }\r\n\t}\r\n\t${accountFragmentBasic}\r\n\t${articleFragmentBasic}\r\n\t${orgFragmentBasic}\r\n\t${personFragmentBasic}\r\n\t${userFragmentBasic}\r\n`\r\n\r\nexport const payments = gql`\r\n\tquery Payments {\r\n\t\tpayments { ...PaymentFragmentBasic }\r\n\t}\r\n\t${paymentFragmentBasic}\r\n`\r\n\r\n// accounts { ...accountFragmentFull }\r\n// ${accountFragmentFull}\r\nexport const paymentsPage = gql`\r\n\tquery PaymentsPage {\r\n\t\tarticles { ...ArticleFragmentFull }\r\n\t\tmdKontragents { ...mdKontragentFragmentBasic }\r\n\t\tmpProjects { ...mpProjectFragmentFull }\r\n\t\torgs { ...OrgFragmentBasic }\r\n\t\tpayments { ...PaymentFragmentBasic }\r\n\t}\r\n\t${articleFragmentFull}\r\n\t${orgFragmentBasic}\r\n\t${mdKontragentFragmentBasic}\r\n\t${mpProjectFragmentFull}\r\n\t${paymentFragmentBasic}\r\n`\r\n\r\nexport const upsertPayment = gql`\r\n\tmutation UpsertPayment(\r\n\t\t$input: PaymentInput!\r\n\t) {\r\n\t\tupsertPayment(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\t...PaymentFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${paymentFragmentBasic}\r\n`\r\n","import React from 'react'\r\n\r\nimport {\r\n  XAxis,\r\n  YAxis,\r\n  HorizontalGridLines,\r\n  LineSeries,\r\n  VerticalBarSeries,\r\n  FlexibleWidthXYPlot\r\n} from 'react-vis'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n`\r\n\r\nexport default ({\r\n  payments: allPayments\r\n}) => {\r\n  const payments = allPayments\r\n    .filter(p => !p.article || !p.article.isLoan)\r\n  const data = payments.map(p => {\r\n    const isIncome = p.article\r\n      ? p.article.isIncome\r\n      : p.isIncome\r\n    return {\r\n      x: new Date(p.dateLocal.slice(0, 10)).getTime(),\r\n      y: (!!isIncome ? 1 : -1) * p.amount\r\n    }\r\n  })\r\n  const [positive, negative, total] = data\r\n    .reduce((arrs, p) => {\r\n      let length = arrs[0].length\r\n      if (!length || arrs[0][length - 1].x !== p.x) {\r\n        arrs.forEach(arr => arr.push({ x: p.x, y: 0, y0: 0 }))\r\n        length = arrs[0].length\r\n      }\r\n      if (p.y > 0) arrs[0][length - 1].y += p.y\r\n      if (p.y < 0) {\r\n        arrs[1][length - 1].y0 += p.y\r\n      }\r\n      arrs[2][length - 1].y += p.y\r\n      return arrs\r\n    }, [[], [], []])\r\n  let sum = 0\r\n  const lineData = total.reverse().reduce((lineData, p) => {\r\n    const pointIndex = (\r\n      lineData.findIndex(({ x }) => x === p.x) + 1\r\n      || (\r\n          lineData.push({ x: p.x, y: sum })\r\n          && lineData.push({ x: p.x, y: 0 })\r\n        )\r\n    ) - 1\r\n    lineData[pointIndex].y = sum += p.y\r\n    return lineData\r\n  }, [])\r\n  return (\r\n    <Container>\r\n      <FlexibleWidthXYPlot\r\n        height={400}\r\n        margin={{\r\n          left: 60\r\n        }}\r\n        stackBy=\"y\"\r\n      >\r\n        <HorizontalGridLines />\r\n        <XAxis \r\n          tickFormat={(d) => new Date(d).toLocaleDateString()}\r\n        />\r\n        <YAxis />\r\n        <LineSeries\r\n          data={lineData}\r\n        />\r\n        <VerticalBarSeries\r\n          stack={true}\r\n          data={negative}\r\n          color='rgb(255, 152, 51)'\r\n        />\r\n        <VerticalBarSeries\r\n          stack={true}\r\n          data={positive}\r\n          color='#4fb79b'\r\n        />\r\n      </FlexibleWidthXYPlot>\r\n    </Container>\r\n  )\r\n}\r\n","import gql from 'graphql-tag'\r\nimport { personFragmentBasic, personExecFragment } from './person';\r\n\r\nexport const syncWithAmoContacts = gql`\r\n\tmutation SyncWithAmoContacts {\r\n\t\tsyncWithAmoContacts {\r\n\t\t\t...PersonFragmentBasic\r\n\t\t\t...personExecFragment\r\n\t\t}\r\n\t}\r\n\t${personFragmentBasic}\r\n\t${personExecFragment}\r\n`\r\n","import { object, number, string, date } from 'yup'\r\nimport { idValidationType } from './commonTypes'\r\nimport { toLocalISOString } from '../utils/dates';\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  accountId: idValidationType\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('выберите счет для проведения платежа')\r\n    ),\r\n  articleId: idValidationType\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('выберите основание платежа')\r\n    ),\r\n  amount: number()\r\n    .positive('зачение должно быть положительным')\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('введите сумму платежа'),\r\n    ),\r\n  dateLocal: date('неверный формат даты')\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('введите дату и время в формате ГГГГ-ММ-ДДTЧЧ:ММ'),\r\n    ),\r\n    // TODO create proper isValidISODate function to check date\r\n    // .transform(function(value, originalValue) {\r\n    //   return isValidISODate(value) ? value : new Date('');\r\n    // }),\r\n  mpProjectId: number()\r\n    .integer()\r\n    .notRequired(),\r\n  // mpProjectId: idValidationType\r\n  //   .notRequired(),\r\n  personId: idValidationType\r\n    .notRequired(),\r\n    // TODO I'm disappointed with yup. Schema definition rules are not semantic, need to change to something else!\r\n    // .when('id', (id, schema) => id\r\n    //   ? schema.notRequired()\r\n    //   : schema.required('выберите контрагента')\r\n    // ),\r\n  // orgId: idValidationType\r\n  //   .notRequired(),\r\n  inn: string()\r\n    .min(10, 'ИНН может быть 10-ти или 12-ти значным')\r\n    .max(12, 'ИНН может быть 10-ти или 12-ти значным')\r\n    .notRequired(),\r\n  purpose: string()\r\n    .max(250, 'превышено максимальное число символов (250)')\r\n    .notRequired(),\r\n})\r\n\r\nexport const formikSchema = (date, defaultAccountId) => ({\r\n  dateLocal: toLocalISOString(date),\r\n  accountId: defaultAccountId || \"\",\r\n  articleId: '',\r\n  personId: '',\r\n  inn: '',\r\n  purpose: '',\r\n  mpProjectId: '',\r\n  amount: ''\r\n})\r\n","import React, { useState, useEffect } from 'react'\r\nimport produce from 'immer'\r\n\r\nimport { Mutation, Query } from 'react-apollo'\r\nimport { upsertPayment, paymentsPage } from '../../graphql/payment'\r\nimport { syncWithAmoContacts } from '../../graphql/amo'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/payment'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\n\r\nimport styled from 'styled-components'\r\nimport { Button, A, Div } from '../styled/styled-semantic'\r\nimport { persons } from '../../graphql/person'\r\nimport { createMdKontragent } from '../../graphql/mdKontragent'\r\n\r\nconst Container = styled.div`\r\n\tmin-height: content;\r\n\tmax-width: 50%;\r\n\tmin-width: 430px;\r\n\tflex: 0 0 430px;\r\n\tbox-shadow: 0 2px 4px 0 rgba(34,36,38,.12), 0 2px 10px 0 rgba(34,36,38,.15);\r\n\tborder: 1px solid rgba(34,36,38,.15);\r\n\tborder-radius: .28571429rem;\r\n`\r\n\r\nconst Header = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\theight: 52px;\r\n\tpadding: 0 2rem;\r\n\tfont-size: 1.28571429rem;\r\n\tline-height: 1.28571429em;\r\n\tfont-weight: bold;\r\n\tborder-bottom: 1px solid rgba(34,36,38,.15);\r\n`\r\n\r\nconst Fields = styled.div`\r\n\t.fz-formFieldLabel {\r\n\t\t${({ labelWidth }) => labelWidth ? `flex-basis: ${labelWidth} !important;` : ''}\r\n\t}\r\n`\r\n\r\nconst CounterpartyFieldSwitch = ({\r\n\tchildren,\r\n\tpayment\r\n}) => {\r\n\tconst [orgCounterparty, setOrgCounterparty] = useState(!!(payment && payment.org))\r\n\tuseEffect(() => {\r\n\t\tsetOrgCounterparty(!!(payment && payment.org))\r\n\t}, [payment])\r\n\treturn (\r\n\t\tchildren({\r\n\t\t\torgCounterparty,\r\n\t\t\tsetOrgCounterparty\r\n\t\t})\r\n\t)\r\n}\r\n\r\nexport default ({\r\n\taccounts,\r\n\taccountsQuery,\r\n\tclient,\r\n\tarticles,\r\n\tdefaultAccountId,\r\n\tmdKontragents,\r\n\tmpProjects,\r\n\tpayment,\r\n\trefetchAccounts,\r\n\treset,\r\n}) => {\r\n\tlet schema = formikSchema(new Date(), defaultAccountId)\r\n\tlet initialValues = payment ? projectEntity(payment, schema) : schema\r\n\tconst formLabelWidth = '110px'\r\n\tconst accountOptions = accounts\r\n\t\t.filter(a => !a.number)\r\n\t\t.map(a => \r\n\t\t\t({ key: a.id, text: a.name, value: a.id })\r\n\t\t)\r\n\tconst articleOptions = articles.map(a => \r\n\t\t({ key: a.id, text: a.rusName, value: a.id })\r\n\t)\r\n\tconst mpProjectOptions = mpProjects.map(p => \r\n\t\t({ key: p.Id, text: p.Id - 1000000 + '. ' + p.Name, value: p.Id })\r\n\t)\r\n\tconst bankPayment = payment && payment.isIncome !== null\r\n\treturn (\r\n\t\t<NotificationsConsumer>\r\n\t\t\t{({ notify }) =>\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t<Query\r\n\t\t\t\t\t\tquery={persons}\r\n\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\ttitle: 'Ошибка загрузки контактов',\r\n\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{({ loading: personsLoading,\r\n\t\t\t\t\t\t\t\tdata,\r\n\t\t\t\t\t\t\t\trefetch: refetchPersons\r\n\t\t\t\t\t\t\t}) => <>\r\n\t\t\t\t\t\t\t<Mutation\r\n\t\t\t\t\t\t\t\tmutation={syncWithAmoContacts}\r\n\t\t\t\t\t\t\t\tonCompleted={() => {\r\n\t\t\t\t\t\t\t\t\trefetchPersons()\r\n\t\t\t\t\t\t\t\t\tnotify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Контакты синхронизированы'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\ttitle: 'Ошибка синхронизации с Амо',\r\n\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{(syncWithAmoContacts, { loading }) => \r\n\t\t\t\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t\t\t\t{(payment ? 'Изменить' : 'Добавить') + ' платеж'}\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tml='auto'\r\n\t\t\t\t\t\t\t\t\t\t\ticon='sync alternate'\r\n\t\t\t\t\t\t\t\t\t\t\tcontent='Контакты AmoCRM'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => syncWithAmoContacts()}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t<Div\r\n\t\t\t\t\t\t\t\tp='1rem 2rem'\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Mutation\r\n\t\t\t\t\t\t\t\t\tmutation={upsertPayment}\r\n\t\t\t\t\t\t\t\t\tonCompleted={() => notify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Платеж сохранен'\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Ошибка сохранения',\r\n\t\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\tupdate={ async (cache, { data: { upsertPayment } }) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { payments } = cache.readQuery({ query: paymentsPage })\r\n\t\t\t\t\t\t\t\t\t\tcache.writeQuery({\r\n\t\t\t\t\t\t\t\t\t\t\tquery: paymentsPage,\r\n\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tpayments: produce(payments, draft => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst foundIndex = payments.findIndex(p => p.id === upsertPayment.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfoundIndex !== -1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? draft.splice(foundIndex, 1, upsertPayment)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: draft.unshift(upsertPayment)\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\tconst accounts = await client.query({query: accountsQuery, fetchPolicy: 'network-only'})\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('accountsFetched > ', accounts)\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{(upsertPayment, { loading }) =>\r\n\t\t\t\t\t\t\t\t\t\t<Formik\r\n\t\t\t\t\t\t\t\t\t\t\tinitialValues={initialValues}\r\n\t\t\t\t\t\t\t\t\t\t\tenableReinitialize={true}\r\n\t\t\t\t\t\t\t\t\t\t\tvalidationSchema={validationSchema}\r\n\t\t\t\t\t\t\t\t\t\t\tonSubmit={async (values, { resetForm }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// console.log('values, initialValues, schema > ', values, initialValues, schema)\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst input = preparePayload(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalues,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t(payment && payment.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? initialValues\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...schema,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdateLocal: \"\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taccountId: \"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tschema\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t// console.log('input > ', input)\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait upsertPayment({ variables: { input } })\r\n\t\t\t\t\t\t\t\t\t\t\t\t// const accounts = await client.query({query: accountsQuery, fetchPolicy: 'network-only'})\r\n\t\t\t\t\t\t\t\t\t\t\t\t// console.log('accountsFetched > ', accounts)\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn payment ? reset() : resetForm()\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{({\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalues,\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleSubmit,\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleReset,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue,\r\n\t\t\t\t\t\t\t\t\t\t\t}) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Fields\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabelWidth={formLabelWidth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment && <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Дата'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='dateLocal'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='date'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Счет'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='accountId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={accountOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Статья'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='articleId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={articleOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Проект'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='mpProjectId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={mpProjectOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CounterpartyFieldSwitch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={payment}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpayment={payment}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({orgCounterparty, setOrgCounterparty}) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torgCounterparty\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? <Mutation\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmutation={createMdKontragent}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCompleted={(res) => console.log('res > ', res) || notify({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Организация добавлена'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Ошибка. Организация не добавлена',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdate={(cache, { data: { createMdKontragent } }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst { mdKontragents } = cache.readQuery({ query: paymentsPage })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcache.writeQuery({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: paymentsPage,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmdKontragents: produce(mdKontragents, draft => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst foundIndex = mdKontragents.findIndex(o => o.Id === createMdKontragent.Id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfoundIndex !== -1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? draft.splice(foundIndex, 1, createMdKontragent)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: draft.unshift(createMdKontragent)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(createMdKontragent, { loading: orgsLoading }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Контрагент'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='inn'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={mdKontragents\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? mdKontragents.map(k => \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({ key: k.Inn, text: k.Name + ' (ИНН: ' + k.Inn + ')', value: k.Inn })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={orgsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={orgsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowAdditions\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tadditionLabel='Добавить по ИНН: '\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonAddItem={async (e, { value: inn }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst existing = mdKontragents.find(mdk => mdk.Inn === inn)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (existing) return setFieldValue('inn', existing.Inn)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst created = await createMdKontragent({ variables: { inn: inn.toString() } })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('inn', created && created.data && created.data.createMdKontragent.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontentBeforeField={<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tОрганизация или <A\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOrgCounterparty(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('inn', '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>Персона</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: <Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Контрагент'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='personId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={data.persons\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? data.persons.map(p => \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({ key: p.id, text: p.amoName || p.fName, value: p.id })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={personsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={personsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontentBeforeField={<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПерсона или <A\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOrgCounterparty(true)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('personId', '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>Организация</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</CounterpartyFieldSwitch>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment && <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Назначение'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='purpose'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Сумма'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='amount'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tml={formLabelWidth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='button'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={payment ? 'Сохранить' : 'Добавить'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={handleSubmit}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<A cancel\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={payment ? () => reset() : handleReset}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{payment ? 'Отмена' : 'Очистить'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Fields>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</Formik>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t</Container>\r\n\t\t\t}\r\n\t\t</NotificationsConsumer>\r\n\t)\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Statistic } from 'semantic-ui-react'\r\nimport { currency } from '../../utils/format'\r\n\r\nconst Container = styled.div`\r\n\tflex-grow: 1;\r\n\theight: 100%;\r\n\tmargin-left: 30px;\r\n  overflow-y: auto;\r\n\t>div {\r\n\t\twidth: 100%;\r\n\t}\r\n`\r\n\r\nconst SStatistic = styled(Statistic)`\r\n\t&&&&>.value {\r\n\t\t${({ color }) => color && `\r\n\t\t\tcolor: ${\r\n\t\t\t\tcolor === 'green' ? '#016936' :\r\n\t\t\t\tcolor === 'red' ? '#9f3a38' :\r\n\t\t\t\tcolor === 'purple' ? '#9924bf' :\r\n\t\t\t\t// color === 'violet' ? '#5d31bb' :\r\n\t\t\t\tcolor === 'blue' ? '#2185d0' :\r\n\t\t\t\tcolor\r\n\t\t\t};\r\n\t\t`}\r\n\t\ttext-align: unset;\r\n\t}\r\n\t&&&&>.label {\r\n\t\tpadding-left: 2em;\r\n\t\ttext-align: unset;\r\n\t}\r\n`\r\n\r\nexport default ({\r\n\tpayments,\r\n\taccounts,\r\n\tmdKontragents,\r\n\tuserRole,\r\n}) => {\r\n\tconst persons = payments\r\n\t\t.filter(p => !!p.person)\r\n\t\t.map(p => p.person)\r\n\t\t.reduce((uniquePersons, p) => {\r\n\t\t\tif (!uniquePersons.find(up => up.id === p.id))\r\n\t\t\t\tuniquePersons.push(p)\r\n\t\t\treturn uniquePersons\r\n\t\t}, [])\r\n\tconst debtsAndLoans = payments\r\n\t\t.filter(p => !!p.article)\r\n\t\t.filter(p => p.article.isLoan)\r\n\t\t.reduce((debts, p) => {\r\n\t\t\tconst counterparty = debts.find(d => d.id === (p.person && p.person.id) || d.Inn === p.inn)\r\n\t\t\tcounterparty.total += (p.article.isIncome ? 1 : -1) * p.amount\r\n\t\t\treturn debts\r\n\t\t}, [\r\n\t\t\t...persons.map(a => ({ ...a, total: 0 })),\r\n\t\t\t...mdKontragents.map(a => ({ ...a, total: 0 }))\r\n\t\t])\r\n\t\t.reduce((split, d) => {\r\n\t\t\tif (d.total > 0) split[1].push(d)\r\n\t\t\telse if (d.total < 0) split[0].push({ ...d, total: -1*d.total})\r\n\t\t\treturn split\r\n\t\t}, [[],[]])\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Statistic.Group>\r\n\t\t\t\t<SStatistic\r\n\t\t\t\t\tcolor='green'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\tcontent={currency(accounts\r\n\t\t\t\t\t\t\t.filter(a => !a.number) // only cache accounts\r\n\t\t\t\t\t\t\t.reduce((sum, a) => sum + a.balance, 0))}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\tcontent='Касса, в т.ч.'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{accounts\r\n\t\t\t\t\t\t\t.filter(a => !a.number)\r\n\t\t\t\t\t\t\t.map(({ id, name, balance }) =>\r\n\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\tlabel={name}\r\n\t\t\t\t\t\t\t\t\tvalue={currency(balance)} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t</SStatistic>\r\n\t\t\t\t{userRole === 'OWNER' && <>\r\n\t\t\t\t\t<SStatistic\r\n\t\t\t\t\t\tcolor='blue'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\t\tcontent={currency(accounts\r\n\t\t\t\t\t\t\t\t.filter(a => !!a.number) // only bank accounts\r\n\t\t\t\t\t\t\t\t.reduce((sum, a) => sum + a.balance, 0))}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\t\tcontent='Счета, в т.ч.'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{accounts\r\n\t\t\t\t\t\t\t\t.filter(a => !!a.number)\r\n\t\t\t\t\t\t\t\t.map(({ id, name, balance }) =>\r\n\t\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\tlabel={name}\r\n\t\t\t\t\t\t\t\t\t\tvalue={currency(balance)} \r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t\t</SStatistic>\r\n\t\t\t\t\t<SStatistic\r\n\t\t\t\t\t\tcolor='purple'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\t\tcontent={currency(debtsAndLoans[0].reduce((sum, l) => sum + l.total, 0))}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\t\tcontent='Нам должны, в т.ч.'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{debtsAndLoans[0].map(({ id, Id, amoName, name, total, Name }, i) =>\r\n\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\tkey={id || Id}\r\n\t\t\t\t\t\t\t\t\tlabel={!!amoName\r\n\t\t\t\t\t\t\t\t\t\t? amoName.slice(0, amoName.lastIndexOf(' ') + 2) + '.' :\r\n\t\t\t\t\t\t\t\t\t\tName ? Name : name.slice(0, 12) + '...'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvalue={currency(total)} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t\t</SStatistic>\r\n\t\t\t\t\t<SStatistic\r\n\t\t\t\t\t\tcolor='red'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\t\tcontent={currency(-debtsAndLoans[1].reduce((sum, d) => sum + d.total, 0))}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\t\tcontent='Мы должны, в т.ч.'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{debtsAndLoans[1].map(({ id, Id, amoName, name, total, Name }, i) =>\r\n\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\tkey={id || Id}\r\n\t\t\t\t\t\t\t\t\tlabel={!!amoName\r\n\t\t\t\t\t\t\t\t\t\t? amoName.slice(0, amoName.lastIndexOf(' ') + 2) + '.' :\r\n\t\t\t\t\t\t\t\t\t\tName ? Name : name.slice(0, 12) + '...'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvalue={currency(total)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t\t</SStatistic>\r\n\t\t\t\t</>}\r\n\t\t\t</Statistic.Group>\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\n","import React from 'react'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  margin-top: 1rem;\r\n  max-height: 100%;\r\n  border-radius: 0.285714rem;\r\n  .fz-tableHeaderRow {\r\n    border-top: none !important;\r\n  }\r\n`\r\n\r\nconst fields = [{\r\n  name: 'copy',\r\n\twidth: '35px'\r\n},{\r\n  name: 'edit',\r\n\twidth: '35px'\r\n},{\r\n  name: 'dateLocal',\r\n  path: 'dateLocal',\r\n\ttitle: 'Дата и время',\r\n\twidth: '145px'\r\n},{\r\n  name: 'counterparty',\r\n  title: 'Контрагент',\r\n  width: '200px',\r\n  truncated: true\r\n},{\r\n  name: 'project',\r\n\ttitle: 'Проект',\r\n\twidth: '230px',\r\n  truncated: true\r\n},{\r\n  name: 'article',\r\n  path: 'article.rusName',\r\n\ttitle: 'Статья',\r\n\twidth: '200px',\r\n  truncated: true\r\n},{\r\n  name: 'purpose',\r\n  path: 'purpose',\r\n  title: 'Назначение',\r\n  width: '300px',\r\n  truncated: true\r\n},{\r\n  name: 'amount',\r\n  path: 'amount',\r\n  title: 'Сумма',\r\n  width: '140px'\r\n},{\r\n  name: 'account',\r\n  path: 'account',\r\n  title: 'Счет',\r\n  width: '100px'\r\n},{\r\n  name: 'createdBy',\r\n  title: 'Автор',\r\n  width: '100px'\r\n},{\r\n  name: 'updatedBy',\r\n  title: 'Редактор',\r\n  width: '100px'\r\n}]\r\n\r\nexport default function PaymentTable ({\r\n  accounts,\r\n  activePayment,\r\n  mdKontragents,\r\n  mpProjects,\r\n  onClickEdit,\r\n  onClickCopy,\r\n  payments\r\n}) {\r\n  //  TODO add CollectionUtils to support sorting\r\n  return (\r\n    <Container>\r\n      <Table\r\n        fields={fields}\r\n        noServiceField\r\n      >\r\n        {({ tableFields }) => \r\n          payments.map(payment => {\r\n            const { id, dateLocal, amount, person, inn, createdBy, updatedBy } = payment\r\n            const isIncome = payment.article ? payment.article.isIncome : payment.isIncome\r\n            const kontragent = inn ? mdKontragents.find(k => k.Inn === inn) : null\r\n            const account = accounts.find(a => a.id === payment.account.id)\r\n            return (\r\n              <TableRow\r\n                key={id}\r\n                entity={payment}\r\n                tableFields={tableFields}\r\n                rowFields={[\r\n                  {\r\n                    name: 'copy',\r\n                    icon: 'redo alternate',\r\n                    iconColor: 'grey',\r\n                    hoverable: true,\r\n                    hideUnhovered: true,\r\n                    hasEntries: false,\r\n                    value: ' ',\r\n                    onClick: () => onClickCopy(id),\r\n                  },\r\n                  {\r\n                    name: 'edit',\r\n                    icon: 'edit',\r\n                    iconColor: 'grey',\r\n                    hoverable: true,\r\n                    hideUnhovered: true,\r\n                    hasEntries: false,\r\n                    value: ' ',\r\n                    onClick: () => onClickEdit(id),\r\n                    active: activePayment\r\n                      && activePayment.id === id\r\n                  },\r\n                  {\r\n                    name: 'dateLocal',\r\n                    value: dateLocal.slice(0,16).replace('T', ' '),\r\n                  },\r\n                  {\r\n                    name: 'counterparty',\r\n                    value: person && person.amoId !== 77498447\r\n                      ? person.amoName\r\n                      : kontragent\r\n                        ? kontragent.Name\r\n                        : inn,\r\n                    color: (inn && !kontragent) ? '#9f3a38' : undefined\r\n                  },\r\n                  {\r\n                    name: 'project',\r\n                    value: payment.mpProjectId ? mpProjects.find(mp => mp.Id === payment.mpProjectId).Name : '',\r\n                  },\r\n                  {\r\n                    name: 'amount',\r\n                    value: isIncome ? amount : -amount,\r\n                    color: isIncome ? '#016936' : '#9f3a38'\r\n                  },\r\n                  {\r\n                    name: 'account',\r\n                    value: account.name,\r\n                  },\r\n                  {\r\n                    name: 'createdBy',\r\n                    value: createdBy && createdBy.person.amoName.split(' ')[0] || 'авто',\r\n                  },\r\n                  {\r\n                    name: 'updatedBy',\r\n                    value: updatedBy && updatedBy.person.amoName.split(' ')[0],\r\n                  }\r\n                ]}\r\n                // onClick={() => onClickEdit(id)}\r\n              />\r\n            )\r\n          }\r\n        )}\r\n      </Table>\r\n    </Container>\r\n  )\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const syncWithTochkaPayments = gql`\r\n\tmutation SyncWithTochkaPayments {\r\n\t\tsyncWithTochkaPayments {\r\n\t\t\tcount\r\n\t\t}\r\n\t}\r\n`\r\n","import React, { useState, useContext } from 'react'\r\nimport produce from 'immer'\r\n\r\nimport { Query, Mutation } from 'react-apollo'\r\nimport { useQuery } from '../hooks/apolloHooks'\r\nimport { accounts as accountsQuery } from '../../graphql/account'\r\nimport { paymentsPage } from '../../graphql/payment'\r\nimport UserContext from '../context/UserContext'\r\n\r\nimport styled from 'styled-components'\r\nimport PaymentChart from './Chart'\r\nimport PaymentForm from './Form'\r\nimport PaymentStats from './Stats'\r\nimport PaymentTable from './Table'\r\nimport { syncWithTochkaPayments } from '../../graphql/tochka'\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\nimport { Button, Icon } from '../styled/styled-semantic'\r\nimport { Route, Link, matchPath } from 'react-router-dom'\r\nimport Menu from '../Menu'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100% - 36px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n`\r\n\r\nconst TopSection = styled.div`\r\n  flex: 1 0 content;\r\n  min-height: ${368 + 47.5*2}px;\r\n  display: flex;\r\n  border-bottom: 1px solid gray;\r\n`\r\n\r\nconst BottomSection = styled.div`\r\n  /* flex: 1 1 2000px;\r\n  margin-top: 1rem; */\r\n  overflow-y: scroll;\r\n`\r\n\r\nexport default ({\r\n}) => {\r\n  const { me: { role, account: defaultAccount, accounts: accountsAvailable }} = useContext(UserContext)\r\n  const { loading: accountsLoading, error: accountsError, data: { accounts }, refetch: refetchAccounts, client } = useQuery(accountsQuery)\r\n  const [activePayment, setActivePayment] = useState(null)\r\n  return (\r\n    <NotificationsConsumer>\r\n\t\t\t{({ notify }) =>\r\n        <Query\r\n          query={paymentsPage}\r\n          onError={err => notify({\r\n            type: 'error',\r\n            title: 'Ошибка загрузки платежей',\r\n            content: err.message,\r\n          })}\r\n        >\r\n          {({ loading: paymentsLoading,\r\n              error,\r\n              data: {\r\n                articles,\r\n                // accounts,\r\n                mdKontragents,\r\n                mpProjects,\r\n                orgs,\r\n                payments,\r\n              } = {},\r\n              refetch: refetchPayments\r\n            }) => <>\r\n              <Mutation\r\n                mutation={syncWithTochkaPayments}\r\n                onCompleted={({ syncWithTochkaPayments: { count } }) => {\r\n                  refetchPayments()\r\n                  notify({\r\n                    type: 'success',\r\n                    title: 'Платежи синхронизированы с банком. Добавлено: ' + count\r\n                  })\r\n                }}\r\n                onError={err => notify({\r\n                  type: 'error',\r\n                  title: 'Ошибка синхронизации с Точкой',\r\n                  content: err.message,\r\n                })}\r\n              >\r\n                {(syncWithTochkaPayments, { loading }) =>\r\n                  <Menu\r\n                    title='Платежи'\r\n                    titleLinkTo='/pay'\r\n                  >\r\n                    {role === 'OWNER' &&<>\r\n                      <Button compact circular menu\r\n                        w='120px'\r\n                        ml='0'\r\n                        ta='left'\r\n                        activeColor='blue' \r\n                        onClick={syncWithTochkaPayments}\r\n                      >\r\n                        <Icon\r\n                          name='refresh'\r\n                          color={loading ? 'blue' : undefined} \r\n                          loading={loading}\r\n                        />\r\n                        {loading ? 'Загрузка..' : 'Точка Банк'}\r\n                      </Button>\r\n                      <Link to={\r\n                        !!matchPath(\r\n                          window.location.href.replace(/.*#/, ''),\r\n                          '/pay/chart'\r\n                        )\r\n                          ? '/pay'\r\n                          : '/pay/chart'\r\n                      }>\r\n                        <Button compact circular menu\r\n                          activeColor='green'\r\n                          icon='chart bar outline'\r\n                          content='График'\r\n                          active={!!matchPath(\r\n                            window.location.href.replace(/.*#/, ''),\r\n                            '/pay/chart'\r\n                          )}\r\n                        />\r\n                      </Link>\r\n                    </>}\r\n                  </Menu>\r\n                }\r\n              </Mutation>\r\n              <Container>\r\n                { paymentsLoading || accountsLoading ? 'Загрузка...' :\r\n                  error || accountsError ? `Ошибка ${error.message}` : <>\r\n                    <TopSection>\r\n                      <Route\r\n                        exact\r\n                        path=\"/pay\"\r\n                        render={() => (<>\r\n                          <PaymentForm\r\n                            accounts={role === 'OWNER' \r\n                              ? accounts\r\n                              : [\r\n                                defaultAccount,\r\n                                ...accountsAvailable\r\n                              ]\r\n                            }\r\n                            accountsQuery={accountsQuery}\r\n                            articles={articles}\r\n                            client={client}\r\n                            defaultAccountId={defaultAccount.id}\r\n                            mdKontragents={mdKontragents}\r\n                            mpProjects={mpProjects}\r\n                            orgs={orgs}\r\n                            payment={activePayment}\r\n                            refetchAccounts={refetchAccounts}\r\n                            reset={() => setActivePayment(null)}\r\n                          />\r\n                          <PaymentStats\r\n                            accounts={role === 'OWNER' \r\n                              ? accounts\r\n                              : [\r\n                                defaultAccount,\r\n                                ...accountsAvailable\r\n                              ]\r\n                            }\r\n                            mdKontragents={mdKontragents}\r\n                            payments={payments}\r\n                            userRole={role}\r\n                          />\r\n                        </>)}\r\n                      />\r\n                      <Route\r\n                        exact\r\n                        path=\"/pay/chart\"\r\n                        render={() => (\r\n                          <PaymentChart\r\n                            payments={payments}\r\n                          />\r\n                        )}\r\n                      />\r\n                    </TopSection>\r\n                    <BottomSection>\r\n                      <PaymentTable\r\n                        accounts={accounts}\r\n                        activePayment={activePayment}\r\n                        mdKontragents={mdKontragents}\r\n                        mpProjects={mpProjects}\r\n                        onClickEdit={id => setActivePayment(payments.find(p => p.id === id))}\r\n                        onClickCopy={id => setActivePayment(produce(payments.find(p => p.id === id), draft => {\r\n                          delete draft.id\r\n                          delete draft.dateLocal\r\n                        }))}\r\n                        payments={payments}\r\n                      />\r\n                    </BottomSection>\r\n                  </>\r\n                }\r\n              </Container>\r\n            </>\r\n          }\r\n        </Query>\r\n      }\r\n    </NotificationsConsumer>\r\n  )\r\n}\r\n\r\n","import gql from 'graphql-tag'\r\n\r\nexport const dealStatusFragmentBasic = gql`\r\n\tfragment DealStatusFragmentBasic on DealStatus {\r\n    id\r\n    name\r\n    color\r\n    sort\r\n\t}\r\n`\r\n\r\nexport const dealStatusFragmentFull = gql`\r\n\tfragment DealStatusFragmentFull on DealStatus {\r\n\t\t...DealStatusFragmentBasic\r\n    amoId\r\n\t}\r\n\t${dealStatusFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\n\r\nexport const bpStatFragmentBasic = gql`\r\n\tfragment bpStatFragmentBasic on BpStat {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const bpStatFragmentMiddle = gql`\r\n\tfragment bpStatFragmentMiddle on BpStat {\r\n\t\t...bpStatFragmentBasic\r\n\t\tautoPlanCost\r\n\t\tautoPlanLabor\r\n\t\tautoPlanRevenue\r\n\t\tfactCost\r\n\t\tfactLabor\r\n\t\tfactRevenue\r\n\t\tplanCost\r\n\t\tplanLabor\r\n\t\tplanRevenue\r\n\t}\r\n\t${bpStatFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\nimport { orgExecFragment } from './org'\r\nimport { personFragmentBasic, personExecFragment } from './person'\r\n\r\nexport const execFragmentBasic = gql`\r\n\tfragment execFragmentBasic on Exec {\r\n\t\tid\r\n\t\tperson { ...PersonFragmentBasic }\r\n\t}\r\n\t${personFragmentBasic}\r\n`\r\n\r\nexport const orgsAndPersonsExecs = gql`\r\n\tquery orgsAndPersonsExecs {\r\n\t\torgs { ...orgExecFragment }\r\n\t\tpersons { ...personExecFragment }\r\n\t}\r\n\t${orgExecFragment}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const upsertExec = gql`\r\n\tmutation upsertExec($input: ExecInput!) {\r\n\t\tupsertExec(input: $input) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { execFragmentBasic } from './exec'\r\n\r\nexport const taskFragmentBasic = gql`\r\n\tfragment taskFragmentBasic on Task {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const taskFragmentMiddle = gql`\r\n\tfragment taskFragmentMiddle on Task {\r\n\t\t...taskFragmentBasic\r\n    end\r\n\t\tfrom\r\n\t\torder\r\n\t\tstatus\r\n\t\ttext\r\n    to\r\n  }\r\n  ${taskFragmentBasic}\r\n`\r\n\r\nexport const taskFragmentFull = gql`\r\n\tfragment taskFragmentFull on Task {\r\n\t\t...taskFragmentMiddle\r\n    appoint {\r\n\t\t\tid\r\n\t\t\texec { ...execFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${execFragmentBasic}\r\n  ${taskFragmentMiddle}\r\n`\r\n\r\nexport const taskDetails = gql`\r\n\tquery task ($id: ID!) {\r\n\t\ttask (id: $id) { ...taskFragmentFull }\r\n\t}\r\n\t${taskFragmentFull}\r\n`\r\n\r\nexport const tasksDetails = gql`\r\n\tquery tasks {\r\n\t\ttasks { ...taskFragmentFull }\r\n\t}\r\n\t${taskFragmentFull}\r\n`\r\n\r\nexport const upsertTask = gql`\r\n\tmutation upsertTask($input: TaskInput!) {\r\n\t\tupsertTask(input: $input) {\r\n\t\t\t...taskFragmentFull\r\n\t\t}\r\n\t}\r\n\t${taskFragmentFull}\r\n`","import gql from 'graphql-tag'\r\nimport { bpStatFragmentMiddle } from './bpStat'\r\nimport { execFragmentBasic } from './exec'\r\nimport { taskFragmentMiddle } from './task'\r\n\r\nexport const appointFragmentBasic = gql`\r\n\tfragment appointFragmentBasic on Appoint {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const appointFragmentMiddle = gql`\r\n\tfragment appointFragmentMiddle on Appoint {\r\n\t\t...appointFragmentBasic\r\n\t\tlaborCost\r\n\t\tbpStat { ...bpStatFragmentMiddle }\r\n\t\texec { ...execFragmentBasic }\r\n\t\ttasks { ...taskFragmentMiddle }\r\n\t}\r\n\t${bpStatFragmentMiddle}\r\n\t${appointFragmentBasic}\r\n\t${execFragmentBasic}\r\n\t${taskFragmentMiddle}\r\n`\r\n\r\nexport const appointFragmentExec = gql`\r\n\tfragment appointFragmentExec on Appoint {\r\n\t\t...appointFragmentBasic\r\n\t\texec { ...execFragmentBasic }\r\n\t}\r\n\t${appointFragmentBasic}\r\n\t${execFragmentBasic}\r\n`\r\n\r\nexport const appointExecLocal = gql`\r\n\tquery appointExecLocal ($id: ID!) {\r\n\t\tappoint (id: $id) @client {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const upsertAppoint = gql`\r\n\tmutation upsertAppoint($input: AppointInput!) {\r\n\t\tupsertAppoint(input: $input) {\r\n\t\t\t...appointFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${appointFragmentMiddle}\r\n`","import gql from 'graphql-tag'\r\nimport { opTypeFragmentBasic } from './opType'\r\nimport { appointFragmentMiddle } from './appoint'\r\n\r\nexport const opFragmentBasic = gql`\r\n\tfragment opFragmentBasic on Op {\r\n\t\tid\r\n\t\tdealLabor\r\n\t\topType { ...opTypeFragmentBasic }\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const opFragmentMiddle = gql`\r\n\tfragment opFragmentMiddle on Op {\r\n\t\t...opFragmentBasic\r\n\t\tlaborPrice\r\n\t\tappoints { ...appointFragmentMiddle }\r\n\t}\r\n\t${opFragmentBasic}\r\n\t${appointFragmentMiddle}\r\n`\r\n\r\nexport const opFragmentDetails = gql`\r\n\tfragment opFragmentDetails on Op {\r\n\t\t...opFragmentBasic\r\n\t\tdescription\r\n\t}\r\n\t${opFragmentBasic}\r\n`\r\n\r\nexport const upsertOp = gql`\r\n\tmutation upsertOp($input: OpInput!) {\r\n\t\tupsertOp(input: $input) {\r\n\t\t\t...opFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${opFragmentMiddle}\r\n`","import gql from 'graphql-tag'\r\nimport { opFragmentBasic, opFragmentMiddle, opFragmentDetails } from './op'\r\n\r\nexport const procFragmentBasic = gql`\r\n\tfragment procFragmentBasic on Proc {\r\n\t\tid\r\n\t\tname\r\n\t\tops { ...opFragmentBasic }\r\n\t}\r\n\t${opFragmentBasic}\r\n`\r\n\r\nexport const procFragmentMiddle = gql`\r\n\tfragment procFragmentMiddle on Proc {\r\n\t\t...procFragmentBasic\r\n\t\tops { ...opFragmentMiddle }\r\n\t}\r\n\t${procFragmentBasic}\r\n\t${opFragmentMiddle}\r\n`\r\n\r\nexport const procFragmentDetails = gql`\r\n\tfragment procFragmentDetails on Proc {\r\n\t\t...procFragmentBasic\r\n\t\tops { ...opFragmentDetails }\r\n\t}\r\n\t${procFragmentBasic}\r\n\t${opFragmentDetails}\r\n`","import gql from 'graphql-tag'\r\nimport { procFragmentBasic, procFragmentMiddle, procFragmentDetails } from './proc'\r\nimport { opFragmentMiddle } from './op'\r\nimport { bpStatFragmentMiddle } from './bpStat'\r\n\r\nexport const elementFragmentBasic = gql`\r\n\tfragment elementFragmentBasic on Element {\r\n    id\r\n    sort\r\n    proc { ...procFragmentBasic }\r\n  }\r\n  ${procFragmentBasic}\r\n`\r\n\r\nexport const elementFragmentMiddle = gql`\r\n\tfragment elementFragmentMiddle on Element {\r\n\t\t...elementFragmentBasic\r\n\t\top { ...opFragmentMiddle }\r\n\t\tproc { ...procFragmentMiddle }\r\n\t}\r\n\t${elementFragmentBasic}\r\n\t${opFragmentMiddle}\r\n\t${procFragmentMiddle}\r\n`\r\n\r\nexport const elementFragmentDetails = gql`\r\n\tfragment elementFragmentDetails on Element {\r\n\t\t...elementFragmentBasic\r\n\t\tproc { ...procFragmentDetails }\r\n\t}\r\n\t${elementFragmentBasic}\r\n\t${procFragmentDetails}\r\n`","import gql from 'graphql-tag'\r\nimport { drawingFragmentBasic } from './drawing';\r\n\r\nexport const workpieceFragmentBasic = gql`\r\n\tfragment WorkpieceFragmentBasic on Workpiece {\r\n    id\r\n    hardness\r\n    material\r\n    name\r\n\t}\r\n`\r\n\r\nexport const workpieceFragmentWithDrawings = gql`\r\n\tfragment WorkpieceFragmentWithDrawings on Workpiece {\r\n\t\t...WorkpieceFragmentBasic\r\n\t\tdrawing { ...DrawingFragmentBasic }\r\n\t}\r\n\t${workpieceFragmentBasic}\r\n\t${drawingFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\nimport { elementFragmentBasic, elementFragmentMiddle, elementFragmentDetails } from './element'\r\nimport { modelFragmentBasic, modelFragmentWithDrawings } from './model'\r\nimport { procFragmentBasic, procFragmentMiddle, procFragmentDetails } from './proc'\r\nimport { workpieceFragmentWithDrawings } from './workpiece'\r\nimport { opFragmentMiddle } from './op'\r\nimport { bpStatFragmentMiddle } from './bpStat'\r\n\r\nexport const batchFragmentBasic = gql`\r\n\tfragment batchFragmentBasic on Batch {\r\n\t\tid\r\n\t\tqty\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\telements (orderBy: sort_ASC) { ...elementFragmentBasic }\r\n\t\tprocs { ...procFragmentBasic }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${elementFragmentBasic}\r\n\t${procFragmentBasic}\r\n`\r\n\r\nexport const batchFragmentMiddle = gql`\r\n\tfragment batchFragmentMiddle on Batch {\r\n\t\t...batchFragmentBasic\r\n\t\tsort\r\n\t\tbpStat { ...bpStatFragmentMiddle }\r\n\t\telements (orderBy: sort_ASC) { ...elementFragmentMiddle }\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\tops { ...opFragmentMiddle }\r\n\t\tprocs { ...procFragmentMiddle }\r\n\t}\r\n\t${bpStatFragmentMiddle}\r\n\t${batchFragmentBasic}\r\n\t${elementFragmentMiddle}\r\n\t${modelFragmentBasic}\r\n\t${opFragmentMiddle}\r\n\t${procFragmentMiddle}\r\n`\r\n\r\nexport const batchFragmentDetails = gql`\r\n\tfragment batchFragmentDetails on Batch {\r\n\t\t...batchFragmentBasic\r\n\t\tdescript\r\n\t\tinfo\r\n\t\twarning\r\n\t\telements (orderBy: sort_ASC) { ...elementFragmentDetails }\r\n\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\tprocs { ...procFragmentDetails }\r\n\t\tworkpiece { ...WorkpieceFragmentWithDrawings }\r\n\t}\r\n\t${modelFragmentWithDrawings}\r\n\t${batchFragmentBasic}\r\n\t${elementFragmentDetails}\r\n\t${procFragmentDetails}\r\n\t${workpieceFragmentWithDrawings}\r\n`\r\n\r\nexport const batchDetails = gql`\r\n\tquery batch ($id: ID!) {\r\n\t\tbatch (id: $id) {\r\n\t\t\t...batchFragmentDetails\r\n\t\t}\r\n\t}\r\n\t${batchFragmentDetails}\r\n`\r\n\r\nexport const upsertBatch = gql`\r\n\tmutation upsertBatch($input: BatchInput!) {\r\n\t\tupsertBatch(input: $input) {\r\n\t\t\t...batchFragmentMiddle\r\n\t\t\t...batchFragmentDetails\r\n\t\t}\r\n\t}\r\n\t${batchFragmentMiddle}\r\n\t${batchFragmentDetails}\r\n`","import gql from 'graphql-tag'\r\nimport { dealStatusFragmentBasic, dealStatusFragmentFull } from './dealStatus'\r\nimport { orgFragmentBasic } from './org'\r\nimport { batchFragmentMiddle, batchFragmentDetails } from './batch'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\nexport const dealFragmentBasic = gql`\r\n\tfragment DealFragmentBasic on Deal {\r\n    id\r\n    amoId\r\n    name\r\n\t\tstatus { ...DealStatusFragmentBasic }\r\n  }\r\n  ${dealStatusFragmentBasic}\r\n`\r\n\r\nexport const dealFragmentMiddle = gql`\r\n\tfragment DealFragmentMiddle on Deal {\r\n\t\t...DealFragmentBasic\r\n\t\tdate\r\n\t\tbatches (orderBy: sort_ASC) { ...batchFragmentMiddle}\r\n\t\torg { ...OrgFragmentBasic}\r\n  }\r\n  ${dealFragmentBasic}\r\n  ${orgFragmentBasic}\r\n  ${batchFragmentMiddle}\r\n`\r\n\r\nexport const dealFragmentFull = gql`\r\n\tfragment DealFragmentFull on Deal {\r\n\t\t...DealFragmentMiddle\r\n    status { ...DealStatusFragmentFull }\r\n\t}\r\n\t${dealFragmentMiddle}\r\n\t${dealStatusFragmentFull}\r\n`\r\n\r\nexport const dealsPage = gql`\r\n\tquery Deals {\r\n\t\tdeals { ...DealFragmentMiddle }\r\n\t\topTypes { ...opTypeFragmentBasic }\r\n\t}\r\n\t${dealFragmentMiddle}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const dealDetails = gql`\r\n\tquery deal ($id: ID!) {\r\n\t\tdeal (id: $id) {\r\n\t\t\tid\r\n\t\t\tbatches (orderBy: sort_ASC) { ...batchFragmentDetails}\r\n\t\t}\r\n\t}\r\n\t${batchFragmentDetails}\r\n`\r\n\r\nexport const createComOffer = gql`\r\n\tmutation createComOffer($dealId: ID!, $date: String) {\r\n\t\tcreateComOffer(dealId: $dealId, date: $date) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const connectDealToOrg = gql`\r\n\tmutation ConnectDealToOrg($orgId: ID! $dealId: ID!) {\r\n\t\tconnectDealToOrg(orgId: $orgId dealId: $dealId) {\r\n\t\t\t...DealFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${dealFragmentMiddle}\r\n`\r\n\r\nexport const syncDeals = gql`\r\n\tmutation syncDeals {\r\n\t\tsyncDeals {\r\n\t\t\tcount\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const upsertDeal = gql`\r\n\tmutation upsertDeal($input: DealInput!) {\r\n\t\tupsertDeal(input: $input) {\r\n\t\t\t...DealFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${dealFragmentMiddle}\r\n`","import React from 'react'\r\n\r\nexport const DealsContext = React.createContext()\r\n\r\nexport const DealsContextProvider = ({\r\n  children,\r\n  opTypes,\r\n  budgetMode\r\n}) => {\r\n  return (\r\n    <DealsContext.Provider\r\n      value={{\r\n        opTypes,\r\n        budgetMode\r\n      }}\r\n    >\r\n      {children}\r\n    </DealsContext.Provider>\r\n  )\r\n}\r\n\r\n// export const BatchContext = React.createContext()\r\n\r\n// export const BatchContextProvider = ({\r\n//   children,\r\n//   dealId,\r\n//   batchId\r\n// }) => {\r\n//   return (\r\n//     <BatchContext.Provider\r\n//       value={{\r\n//         dealId,\r\n//         batchId\r\n//       }}\r\n//     >\r\n//       {children}\r\n//     </BatchContext.Provider>\r\n//   )\r\n// }","import React from 'react'\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\n// import { Icon } from 'semantic-ui-react'\r\n\r\nexport default props =>\r\n  <Div\r\n    w='55px'\r\n    ta='center'\r\n  >\r\n    <Icon\r\n      link\r\n      {...props}\r\n    />\r\n  </Div>","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\nimport LeftIcon from './LeftIcon'\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\twidth: 100%;\r\n  height: 46px;\r\n\tpadding-right: 1em;\r\n\t/* border-bottom: 1px solid #7e7e81; */\r\n\t/* border-bottom: 1px solid rgba(34,36,38,.15); */\r\n\tborder-bottom: 1px solid rgba(152, 153, 154, 1);\r\n`\r\n\r\nexport const Menu = ({\r\n\ttitle,\r\n\tsubtitle,\r\n\tsetDetails,\r\n\tonSubmit\r\n}) => {\r\n  return (\r\n\t\t<Container>\r\n\t\t\t<LeftIcon\r\n\t\t\t\tsize='big'\r\n\t\t\t\tname='cancel'\r\n\t\t\t\tonClick={() => setDetails(null)}\r\n\t\t\t/>\r\n\t\t\t{title &&\r\n\t\t\t\t<Div\r\n\t\t\t\t\tfs='1.28571429rem'\r\n\t\t\t\t\tfw='bold'\r\n\t\t\t\t>\r\n\t\t\t\t\t{title}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t{subtitle &&\r\n\t\t\t\t<Div\r\n\t\t\t\t\tmt='4px'\r\n\t\t\t\t\tml='10px'\r\n\t\t\t\t\tfs='1rem'\r\n\t\t\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\t\t\tws='0.1em'\r\n\t\t\t\t>\r\n\t\t\t\t\t{subtitle}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t{onSubmit &&\r\n\t\t\t\t<Icon link\r\n\t\t\t\t\tname='check'\r\n\t\t\t\t\tml='auto'\r\n\t\t\t\t\tcolor='green'\r\n\t\t\t\t\tsize='big'\r\n\t\t\t\t\tonClick={onSubmit}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\n\r\n\r\n","import React, { useState } from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { mergeOrg } from '../../../graphql/org'\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nexport default ({\r\n  notify,\r\n  id,\r\n}) => {\r\n  const [ val, setVal ] = useState('')\r\n  return <>\r\n    <Mutation\r\n      mutation={mergeOrg}\r\n      variables={{ id }}\r\n      onCompleted={() => {\r\n        // refetchPersons()\r\n        notify({\r\n          type: 'success',\r\n          title: 'ИНН присвоен'\r\n        })\r\n      }}\r\n      onError={err => notify({\r\n        type: 'error',\r\n        title: 'Ошибка присвоения ИНН',\r\n        content: err.message,\r\n      })}\r\n    >\r\n      {( mergeOrg, { loading } ) =>\r\n        <Div\r\n          p='1em 1em 1em 55px'\r\n        >\r\n          <Input\r\n            value={val}\r\n            onChange={(e, { value }) => setVal(value)}\r\n            placeholder='ИНН'\r\n            onBlur={() => mergeOrg({ variables: { id, inn: val } })}\r\n            loading={loading}\r\n          />\r\n        </Div>\r\n      }\r\n    </Mutation>\r\n  </>\r\n}","import React, { useState } from 'react'\r\n\r\nexport default function Requisites ({\r\n  org\r\n}) {\r\n  const [ val, setVal ] = useState('')\r\n  return <>\r\n  </>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Input = styled.input`\r\n\tcursor: pointer;\r\n\tpadding-left: 67.85px;\r\n\t/* border-color: rgba(34,36,38,0.15); */\r\n`\r\n\r\nexport default ({\r\n\tonChange,\r\n\t...rest\r\n}) => {\r\n\treturn (\r\n\t\t<Input\r\n\t\t\t{...rest}\r\n\t\t\t// type=\"date\"\r\n\t\t\tonChange={({ target: { value }}) => onChange(value)}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Input = styled.input`\r\n\twidth: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport default forwardRef(({\r\n  value: propValue,\r\n  onChange,\r\n  onBlur,\r\n\t...rest\r\n}, ref) => {\r\n  const [ value, setValue ] = useState('')\r\n  useEffect(() => setValue(propValue || ''), [propValue])\r\n  const submit = () => propValue !== value && onChange(value)\r\n\treturn (\r\n\t\t<Input\r\n      {...rest}\r\n      ref={ref}\r\n\t\t\tvalue={value}\r\n      onChange={({ target: { value }}) => setValue(value)}\r\n      onBlur={() => {\r\n        submit()\r\n        if (onBlur) onBlur()\r\n      }}\r\n      onKeyDown={e => e.key === 'Enter' && submit()}\r\n\t\t/>\r\n\t)\r\n})\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport debounce from 'lodash/debounce'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst TextArea = styled.textarea`\r\n\twidth: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport const HtmlTextArea = ({\r\n  value: propValue,\r\n  onChange,\r\n\tdebouncedWrite,  \r\n\t...rest\r\n}) => {\r\n  const input = useRef(null)\r\n  const [ value, setValue ] = useState('')\r\n  useEffect(() => setValue(propValue || ''), [propValue])\r\n  const debouncedOnChange = debounce(onChange, 500)\r\n\treturn (\r\n\t\t<TextArea\r\n      {...rest}\r\n      ref={input}\r\n\t\t\tvalue={value}\r\n      onChange={({ target: { value }}) => {\r\n        setValue(value)\r\n        if (debouncedWrite) debouncedOnChange()\r\n      }}\r\n      onBlur={() => propValue !== value && onChange(value)}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Select = styled.select`\r\n  width: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport default forwardRef(({\r\n  value,\r\n  onChange,\r\n  options,\r\n  undefinedOptionName = '--',\r\n\t...rest\r\n}, ref) => {\r\n\treturn (\r\n    <Select\r\n      {...rest}\r\n      ref={ref}\r\n      value={value}\r\n      onChange={({ target: { value }}) => onChange(value)}\r\n    >\r\n      {[\r\n        // ...hasNoUndefinedOption ? [] : [{ id: -1, name: '--' }],\r\n        { id: -1, name: undefinedOptionName },\r\n        ...options\r\n      ].map(({ key, id, name }) =>\r\n        <option key={key || id} value={id}>{name}</option>\r\n      )}}\r\n    </Select>\r\n\t)\r\n})\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport HtmlDatePicker from '../common/HtmlDatePicker'\r\nimport HtmlInput from '../common/HtmlInput'\r\nimport { HtmlTextArea } from '../common/HtmlTextArea'\r\nimport HtmlSelect from '../common/HtmlSelect';\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\talign-items: center;\r\n\tmargin-bottom: .67857143rem;\r\n\t${props => props.indent && `\r\n\t\tborder-left: 1px solid rgba(34, 36, 38, 0.15);\r\n\t`}\r\n`\r\n\r\nconst Label = styled.div`\r\n\tflex: 0 0 122px;\r\n\t/* padding-top: calc(10.5rem/14); */\r\n\tfont-size: calc(13rem/14);\r\n\t/* font-weight: bold; */\r\n\tline-height: 1.21428571rem;\r\n\t${props => props.required && `\r\n\t\t::after {\r\n\t\t\tcontent: '*';\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tmargin: -.2em 0 0 .2em;\r\n\t\t\tvertical-align: top;\r\n\t\t\tcolor: #db2828;\r\n\t\t}\r\n\t`}\r\n\t${props => props.indent && `\r\n\t\tpadding-left: 10px;\r\n\t`}\r\n`\r\n\r\nconst Content = styled.div`\r\n\tflex: 1 1 auto;\r\n\tmax-width: calc(100% - 122px);\r\n`\r\n\r\nconst InputContainer = styled.div`\r\n\twidth: ${props => props.width || '215px'};\r\n`\r\n\r\nconst Error = styled.div`\r\n\tcolor: ${props => props.theme.colors.error};\r\n`\r\n\r\nexport default ({\r\n\tlabel,\r\n\trequired,\r\n\tindent,\r\n\tinputWidth,\r\n\ttype,\r\n\tcontentBeforeField,\r\n\terror,\r\n\t...rest\r\n}) => {\r\n\treturn (\r\n\t\t<Container\r\n\t\t\tindent={indent}\r\n\t\t>\r\n\t\t\t<Label\r\n\t\t\t\tclassName='fz-formFieldLabel'\r\n\t\t\t\trequired={required}\r\n\t\t\t\tindent={indent}\r\n\t\t\t>\r\n\t\t\t\t{label}\r\n\t\t\t</Label>\r\n\t\t\t<Content>\r\n\t\t\t\t<InputContainer\r\n\t\t\t\t\twidth={inputWidth}\r\n\t\t\t\t>\r\n\t\t\t\t\t{contentBeforeField}\r\n\t\t\t\t\t{\ttype === 'date' || type === 'datetime-local'\r\n\t\t\t\t\t\t? <HtmlDatePicker\r\n\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/> :\r\n\t\t\t\t\t\ttype === 'textarea'\r\n\t\t\t\t\t\t? <HtmlTextArea\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/> :\r\n\t\t\t\t\t\ttype === 'select'\r\n\t\t\t\t\t\t? <HtmlSelect\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t: <HtmlInput\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</InputContainer>\r\n\t\t\t\t{error &&\r\n\t\t\t\t\t<Error>\r\n\t\t\t\t\t\t{error}\r\n\t\t\t\t\t</Error>\r\n\t\t\t\t}\r\n\t\t\t</Content>\r\n\t\t</Container>\r\n\t)\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { createContract } from '../../../graphql/org'\r\nimport styled from 'styled-components'\r\nimport { animated, useTransition } from 'react-spring'\r\nimport CollapsableSection from '../../presentational/CollapsableSection'\r\nimport { Icon, Div } from '../../styled/styled-semantic'\r\nimport LeftIcon from '../../Details/Menu/LeftIcon'\r\nimport Field from '../../form/Field'\r\nimport { toLocalDateString } from '../../../utils/dates'\r\n\r\nconst MenuOverlay = styled(animated.div)`\r\n  position: absolute;\r\n  z-index: 10;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n  height: 48px;\r\n  padding-right: 0.7em;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: rgba(255,255,255,1);\r\n`\r\n\r\nexport default ({\r\n  notify,\r\n  org,\r\n  initiallyExpanded\r\n}) => {\r\n  const [ createMode, setCreateMode ] = useState(false)\r\n  useEffect(() => undefined, [createMode])\r\n  const transitions = useTransition(createMode, null, {\r\n    from: { opacity: 0 }, enter: { opacity: 1 }, leave: { opacity: 0 },\r\n  })\r\n  const [ date, setDate ] = useState(toLocalDateString(new Date()))\r\n  return <>\r\n    <Mutation\r\n      mutation={createContract}\r\n      onCompleted={res => {\r\n        // console.log('res > ', res)\r\n        notify({\r\n          type: 'success',\r\n          title: 'Договор добавлен'\r\n        })\r\n      }}\r\n    >\r\n      {( createContract, { loading } ) =>\r\n        <CollapsableSection\r\n          initiallyExpanded={initiallyExpanded}\r\n          // title='Договор'\r\n          title='Договор'\r\n          overflowVisible\r\n          buttons={<>\r\n            <Icon link\r\n              // circular\r\n              activeColor='green'\r\n              name='plus'\r\n              onClick={e => {\r\n                e.stopPropagation()\r\n                setCreateMode(true)\r\n                // notify({\r\n                //   type: 'warning',\r\n                //   content: 'Чтобы загрузить файлы, перетащите их в раздел',\r\n                // })\r\n              }}\r\n              // loading={creating}\r\n            />\r\n          </>}\r\n        >\r\n          {transitions.map(({ item, key, props }) => \r\n            item && \r\n              <MenuOverlay\r\n                key={key}\r\n                style={props}\r\n              >\r\n                <LeftIcon\r\n                  size='large'\r\n                  name='check'\r\n                  color='green'\r\n                  onClick={async () =>\r\n                    await createContract({ variables: { id: org.id, date } })\r\n                    && setCreateMode(false)\r\n                  }\r\n                />\r\n                <Div\r\n                  fs='1.1em'\r\n                  c='rgba(0,0,0,.75)'\r\n                  fw='700'\r\n                >\r\n                  Создание договора\r\n                </Div>\r\n                <Icon link\r\n                  name='cancel'\r\n                  ml='auto'\r\n                  size='large'\r\n                  onClick={() => setCreateMode(false)}\r\n                />\r\n            </MenuOverlay>\r\n          )}\r\n            \r\n          <Div\r\n            p='1em 1em 1em 55px'\r\n          >\r\n            <Field\r\n              label='Дата договора'\r\n              type='date'\r\n              value={date}\r\n              onChange={date => setDate(date)}\r\n            />\r\n          </Div>\r\n        </CollapsableSection>\r\n\r\n      }\r\n    </Mutation>\r\n  </>\r\n}","import React from 'react'\r\nimport { Menu } from '../../Details/Menu/Menu'\r\nimport { Query } from 'react-apollo'\r\nimport { orgLocal, orgDetails } from '../../../graphql/org'\r\nimport { useNotifications } from '../../notifications/NotificationsContext'\r\nimport InnForm from './InnForm'\r\nimport Requisites from './Requisites'\r\nimport Contract from './Contract'\r\n\r\nexport default function OrgDetails ({\r\n  details: {\r\n\t\torgId: id,\r\n\t\tsection\r\n  },\r\n  setDetails\r\n}) {\r\n  const { notify } = useNotifications()\r\n  return <>\r\n    <Query\r\n      query={orgLocal}\r\n      variables={{ id }}\r\n    >\r\n      {({ data: { orgLocal } }) => orgLocal\r\n        ? <>\r\n            <Menu\r\n              setDetails={setDetails}\r\n              title={orgLocal.name}\r\n              subtitle={orgLocal.inn && `ИНН: ${orgLocal.inn}`}\r\n            />\r\n            {orgLocal.inn\r\n              ? <Query\r\n                  query={orgDetails}\r\n                  variables={{ id }}\r\n                  onError={err => notify({\r\n                    type: 'error',\r\n                    title: 'Ошибка загрузки реквизитов организации',\r\n                    content: err.message,\r\n                  })}\r\n                >\r\n                  {({ data: { orgDetails }, loading }) =>\r\n                    loading ? 'Загрузка..' :\r\n                    orgDetails\r\n                      ?\t<>\r\n                          <Requisites\r\n                            org={orgDetails}\r\n                          />\r\n                          <Contract\r\n                            notify={notify}\r\n                            org={orgDetails}\r\n                            initiallyExpanded={section === 'contract'}\r\n                          />\r\n                        </>\r\n                      : null\r\n                  }\r\n                </Query>\r\n              : <InnForm\r\n                  notify={notify}\r\n                  id={id}\r\n                />\r\n            }\r\n          </>\r\n        : null\r\n      }\r\n\r\n    </Query>\r\n  </>\r\n}","import React from 'react'\r\nimport { useQuery, useMutation } from '../hooks/apolloHooks'\r\nimport { getStructure, produceNested } from '../form/utils'\r\nimport { batchDetails, upsertBatch as uB } from '../../graphql/batch'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\n\r\nexport default function BatchDetails ({\r\n  batch: batchProp,\r\n  bIndex,\r\n  batchId\r\n}) {\r\n  const [ upsertBatch ] = useMutation(uB)\r\n  let loading, data\r\n  if (!batchProp) ({ loading, data } = useQuery(batchDetails, { variables: { id: batchId } }))\r\n  const batch = batchProp || (data && data.batch) || {}\r\n  if (!batchProp && loading)\r\n    return <Dimmer active ><Loader>Загрузка..</Loader></Dimmer>\r\n  const {\r\n    descript,\r\n    info,\r\n    warning,\r\n    model: {\r\n      name,\r\n      drawings: [{ name: drwName } = {}]\r\n    },\r\n    workpiece: wp,\r\n    procs: [{ ops = [] } = {}]\r\n  } = batch\r\n  const {\r\n    name: wpName,\r\n    material,\r\n    hardness,\r\n    drawing: wpDrw\r\n  } = wp || {}\r\n  const {\r\n    name: wpDrwName\r\n  } = wpDrw || {}\r\n  const batchStructure = getStructure(batch)\r\n  return <Div\r\n    p='1em 1em 1em 55px'\r\n  >\r\n    <p><b>{`${bIndex + 1}. ${name}`}</b></p>\r\n    <Div\r\n      pl='10px'\r\n      bl='1px solid rgba(34, 36, 38, 0.15)'\r\n    >\r\n      <Field\r\n        label='Чертеж'\r\n        value={drwName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'model.drawings[0].name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Заготовка'\r\n        value={wpName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Чертеж'\r\n        indent\r\n        value={wpDrwName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.drawing.name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Материал'\r\n        value={material || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.material', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Твердость'\r\n        value={hardness || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.hardness', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Описание'\r\n        type='textarea'\r\n        value={descript || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, `descript`, value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Замечание'\r\n        type='textarea'\r\n        value={info || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, `info`, value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Предупреждение'\r\n        type='textarea'\r\n        value={warning || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, `warning`, value)\r\n        }})}\r\n      />\r\n      {ops\r\n        .filter(op => op.opType.opClass === 'MACHINING')\r\n        .map(({\r\n          id,\r\n          opType,\r\n          description\r\n        } = {}, opIndex) => {\r\n          const { name } = opType || {}\r\n          return <div key={id}>\r\n            <p><b>{`${bIndex + 1}.${opIndex + 1}. ${name}`}</b></p>\r\n            <Field\r\n              label='Описание'\r\n              type='textarea'\r\n              indent\r\n              value={description || ''}\r\n              onChange={value => upsertBatch({ variables: { input:\r\n                produceNested(batchStructure, `procs[0].ops[${opIndex}].description`, value)\r\n              }})}\r\n            />\r\n          </div>\r\n        })}\r\n    </Div>\r\n  </Div>\r\n}","import React from 'react'\r\nimport { useQuery } from '../../hooks/apolloHooks'\r\nimport { dealDetails } from '../../../graphql/deal'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport BatchDetails from '../../Batch/Details'\r\n\r\nexport default function DealDetails ({\r\n  dealId\r\n}) {\r\n  const { loading, data } = useQuery(dealDetails, { variables: { id: dealId } })\r\n  return <>\r\n    { loading ? <Dimmer active ><Loader>Загрузка..</Loader></Dimmer> :\r\n      data && data.deal && data.deal.batches.map((batch, bIndex) =>\r\n        <BatchDetails\r\n          key={batch.id}\r\n          batch={batch}\r\n          bIndex={bIndex}\r\n        />)\r\n    }\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport { useMutation } from '../hooks/apolloHooks'\r\nimport { createComOffer as cCO } from '../../graphql/deal'\r\nimport { toLocalDateString } from '../../utils/dates'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\nimport DealDetails from '../Deals/Details/Details'\r\n\r\nexport default function CreateComOfferDetails ({\r\n  details: { dealId },\r\n  setDetails\r\n}) {\r\n\tconst [ date, setDate ] = useState(toLocalDateString(new Date()))\r\n  const [ createComOffer ] = useMutation(cCO, { variables: { dealId, date } })\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Создать КП'\r\n      onSubmit={() => createComOffer()}\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n\t\t\t<Div\r\n\t\t\t\tp='1em 1em 1em 55px'\r\n\t\t\t>\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Дата'\r\n\t\t\t\t\ttype='date'\r\n\t\t\t\t\tvalue={date}\r\n\t\t\t\t\tonChange={date => setDate(date)}\r\n\t\t\t\t/>\r\n\t\t\t</Div>\r\n\t\t\t<DealDetails\r\n\t\t\t\tdealId={dealId}\r\n\t\t\t/>\r\n\t\t</Div>\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { useMutation } from '../hooks/apolloHooks'\r\nimport { upsertTask as uT } from '../../graphql/task'\r\n\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport { toLocalDatetimeString } from '../../utils/dates'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\nimport BatchDetails from '../Batch/Details'\r\n\r\nexport default function CreateTaskDetails ({\r\n  details: { appointId },\r\n  setDetails\r\n}) {\r\n\tconst [ from, setFrom ] = useState(toLocalDatetimeString(new Date()))\r\n\tconst [ text, setText ] = useState()\r\n\tconst [ upsertTask ] = useMutation(uT, {\r\n\t\tvariables: { input: {\r\n\t\t\tfrom: new Date(from).toISOString(),\r\n\t\t\ttext,\r\n\t\t\tstatus: 'ACTIVE',\r\n\t\t\tappointId\r\n\t\t}}\r\n\t})\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Добавить задачу'\r\n      onSubmit={() => console.log('{ from, text, status: ACTIV, appointId } > ', { from, text, status: 'ACTIVE', appointId }) && upsertTask()}\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n\t\t\t<Div\r\n\t\t\t\tp='1em 1em 1em 55px'\r\n\t\t\t>\r\n        {/* <Field\r\n\t\t\t\t\tlabel='Кому'\r\n\t\t\t\t\ttype='select'\r\n\t\t\t\t\tvalue={date}\r\n\t\t\t\t\tonChange={date => setDate(date)}\r\n\t\t\t\t/> */}\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Дата и время'\r\n\t\t\t\t\ttype='datetime-local'\r\n\t\t\t\t\tvalue={from}\r\n\t\t\t\t\tonChange={date => setFrom(date)}\r\n\t\t\t\t/>\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Задача'\r\n\t\t\t\t\tinputWidth='257px'\r\n\t\t\t\t\ttype='textarea'\r\n\t\t\t\t\tvalue={text}\r\n\t\t\t\t\tonChange={text => setText(text)}\r\n\t\t\t\t/>\r\n\t\t\t</Div>\r\n\t\t\t{/* <BatchDetails\r\n\t\t\t\tdealId={dealId}\r\n\t\t\t/> */}\r\n\t\t</Div>\r\n  </>\r\n}","import { useMutation } from \"./apolloHooks\"\r\nimport produce from \"immer\"\r\nimport { upsertDeal } from \"../../graphql/deal\"\r\nimport { upsertBatch } from \"../../graphql/batch\"\r\nimport { getStructure, assignNested } from \"../form/utils\"\r\nimport { upsertPersonExec } from \"../../graphql/person\"\r\nimport { upsertOrgExec } from \"../../graphql/org\"\r\n\r\nexport default function useUpsert(\r\n  objTypeName, obj, options\r\n) {\r\n  const mutation =\r\n    objTypeName === 'deal' ? upsertDeal :\r\n    objTypeName === 'batch' ? upsertBatch :\r\n    objTypeName === 'personExec' ? upsertPersonExec :\r\n    objTypeName === 'orgExec' ? upsertOrgExec :\r\n    undefined\r\n  const [ mutate ] = useMutation(mutation, options)\r\n  const upsert = async (pathsAndValuesArr, options) => {\r\n    if (pathsAndValuesArr.length % 2 !== 0)\r\n      throw new Error('useUpsert requires first array argument consisting of alternating paths and values')\r\n    return mutate({\r\n      ...options,\r\n      variables: { input:\r\n        produce(getStructure(obj), draft => {\r\n          for (let i = 0; i < pathsAndValuesArr.length; i = i + 2) {\r\n            if (i%2 === 1) continue\r\n            assignNested(draft, pathsAndValuesArr[i], pathsAndValuesArr[i+1], i>0)\r\n          }\r\n        })\r\n      }\r\n    })\r\n  }\r\n  return [ upsert ]\r\n}\r\n\r\nexport function useSpecUpsert(\r\n  objTypeName, options\r\n) {\r\n  const mutation =\r\n    objTypeName === 'deal' ? upsertDeal :\r\n    objTypeName === 'batch' ? upsertBatch :\r\n    objTypeName === 'personExec' ? upsertPersonExec :\r\n    objTypeName === 'orgExec' ? upsertOrgExec :\r\n    undefined\r\n  const [ mutate ] = useMutation(mutation, options)\r\n  const upsert = async (obj, pathsAndValuesArr, options) => {\r\n    if (pathsAndValuesArr.length % 2 !== 0)\r\n      throw new Error('useUpsert requires first array argument consisting of alternating paths and values')\r\n    return mutate({\r\n      ...options,\r\n      variables: { input:\r\n        produce(getStructure(obj), draft => {\r\n          for (let i = 0; i < pathsAndValuesArr.length; i = i + 2) {\r\n            if (i%2 === 1) continue\r\n            assignNested(draft, pathsAndValuesArr[i], pathsAndValuesArr[i+1], i>0)\r\n          }\r\n        })\r\n      }\r\n    })\r\n  }\r\n  return [ upsert ]\r\n}","import React, { useState, useRef, useEffect } from 'react'\r\nimport partition from 'lodash/partition'\r\nimport { useQuery, useMutation } from '../hooks/apolloHooks'\r\nimport { orgsAndPersonsExecs } from '../../graphql/exec'\r\nimport { upsertPerson2 as uP } from '../../graphql/person'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Button, Icon } from '../styled/styled-semantic'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport LeftIcon from '../Details/Menu/LeftIcon'\r\nimport { Dimmer, Loader, Input, Header } from 'semantic-ui-react'\r\nimport produce from 'immer'\r\nimport { assignNested, getStructure } from '../form/utils'\r\nimport { syncWithAmoContacts as sWAC } from '../../graphql/amo'\r\nimport useUpsert, { useSpecUpsert } from '../hooks/useUpsert';\r\n\r\nconst FiltersContainer = styled.div`\r\n\tpadding: 1em 1em 1em 55px;\r\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\tbox-shadow: 0 20px 20px 0 #fff;\r\n`\r\n\r\nconst Lists = styled.div`\r\n\theight: calc(100% - 47px - 67px);\r\n\toverflow-y: scroll;\r\n`\r\n\r\nconst ListTitle = styled.h4`\r\n\tmargin: 0;\r\n\tpadding: 1em 1em 1em 55px;\r\n\t/* :first-child {\r\n\t\tpadding-top: 0;\r\n\t} */\r\n\tdisplay: flex;\r\n`\r\n\r\nconst ListSubTitle = styled(Header)` &&& {\r\n\tmargin: 0 0 1em;\r\n\tpadding: 0 55px;\r\n}`\r\n\r\nconst ListItemContainer = styled.div`\r\n  display: flex;\r\n\tpadding-right: 1em;\r\n\tcursor: pointer;\r\n\tborder-width: 1px 0;\r\n\tborder-style: solid;\r\n\tborder-color: white;\r\n  :hover {\r\n    background: rgb(250, 250, 250);\r\n    color: rgba(0,0,0,.95);\r\n  }\r\n  ${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n\t`}\r\n`\r\n\r\nconst ListItemControl = styled(Icon)`\r\n\t&&& {\r\n\t\topacity: 0;\r\n\t\ttransition: opacity .25s ease;\r\n\t\t${ListItemContainer}:hover & {\r\n\t\t\topacity: .45;\r\n\t\t}\r\n\t}\r\n`\r\n\r\nconst ListItem = ({\r\n  active,\r\n\ttext,\r\n\tonClick,\r\n\tonRemove\r\n}) => <ListItemContainer\r\n\tactive={active}\r\n\tonClick={onClick}\r\n>\r\n  <LeftIcon\r\n    name={active ? 'check square outline' : 'square outline'}\r\n  />\r\n  <Div>\r\n\t\t{text}\r\n  </Div>\r\n\t{onRemove &&\r\n\t\t<ListItemControl\r\n\t\t\tlink\r\n\t\t\tname='close'\r\n\t\t\tml='auto'\r\n\t\t\tcolor='grey'\r\n\t\t\tactiveColor='red'\r\n\t\t\tonClick={e => e.stopPropagation() || onRemove()}\r\n\t\t/>\r\n\t}\r\n</ListItemContainer>\r\n\r\nexport default function SelectExecDetails ({\r\n  details: {\r\n\t\topTypeId,\r\n\t\tonSubmit\r\n\t},\r\n  setDetails,\r\n}) {\r\n\tconst searchInput = useRef(null)\r\n  const { data, loading, error } = useQuery(orgsAndPersonsExecs)\r\n\tconst [ execId, setExecId ] = useState('')\r\n\tconst [ person, setPerson ] = useState(null)\r\n\tconst [ org, setOrg ] = useState('')\r\n\tconst [ search, setSearch ] = useState('')\r\n\tconst orgs = data && data.orgs && data.orgs\r\n\t\t.filter(o => !search || o.name.toLowerCase().indexOf(search.toLowerCase()) !== -1) || []\r\n\tconst persons = data && data.persons && data.persons\r\n\t\t.filter(p => !search || p.amoName.toLowerCase().indexOf(search.toLowerCase()) !== -1) || []\r\n\tconst [ syncWithAmoContacts, { loading: syncingContacts } ] = useMutation(sWAC, {\r\n\t\tsuccessMsg: 'Контакты синхронизированы',\r\n\t\terrMsg: 'Ошибка синхронизации с Амо',\r\n\t\tmark: 'syncWithAmoContacts'\r\n\t})\r\n\tconst [ upsertSpecPerson ] = useSpecUpsert('personExec', {\r\n\t\tsuccessMsg: 'Обновлены данные исполнителя',\r\n\t\terrMsg: 'Ошибка. Данные исполнителя не обновлены',\r\n\t})\r\n\tconst [ upsertSpecOrg ] = useSpecUpsert('orgExec', {\r\n\t\tsuccessMsg: 'Обновлены данные исполнителя',\r\n\t\terrMsg: 'Ошибка. Данные исполнителя не обновлены',\r\n\t})\r\n\t// const upsertSpecPerson = () => {}\r\n\tconst [ suitablePersons, otherPersons ] = partition(persons,\r\n\t\t({ exec }) => exec && exec.opTypes.findIndex(ot => ot.id === opTypeId) > -1\r\n\t)\r\n\tconst [ suitableOrgs, otherOrgs ] = partition(orgs,\r\n\t\t({ exec }) => exec && exec.opTypes.findIndex(ot => ot.id === opTypeId) > -1\r\n\t)\r\n\tuseEffect(() => searchInput.current.focus())\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Выбор исполнителя'\r\n      onSubmit={async () => {\r\n\t\t\t\tif (person) {\r\n\t\t\t\t\tconst { data } = await upsertSpecPerson(person,\r\n\t\t\t\t\t\t[ `exec.opTypes[length]`, { opTypeId } ]\r\n\t\t\t\t\t)\r\n\t\t\t\t\tconst execId = data && data.upsertPerson2.exec.id\r\n\t\t\t\t\tif (execId) onSubmit(execId)\r\n\t\t\t\t}\r\n\t\t\t\tif (org) {\r\n\t\t\t\t\tconst { data } = await upsertSpecOrg(org,\r\n\t\t\t\t\t\t[ `exec.opTypes[length]`, { opTypeId } ]\r\n\t\t\t\t\t)\r\n\t\t\t\t\tconsole.log('data > ', data)\r\n\t\t\t\t\tconst execId = data && data.upsertOrg.exec.id\r\n\t\t\t\t\tif (execId) onSubmit(execId)\r\n\t\t\t\t}\r\n\t\t\t\tif (execId) onSubmit(execId)\r\n\t\t\t\tsetDetails(null)\r\n\t\t\t}}\r\n    />\r\n\t\t<FiltersContainer>\r\n\t\t\t<Input\r\n\t\t\t\tref={searchInput}\r\n\t\t\t\tfluid\r\n\t\t\t\ticon='search'\r\n\t\t\t\tplaceholder='Искать..'\r\n\t\t\t\tvalue={search}\r\n\t\t\t\tonChange={(e, { value }) => setSearch(value)}\r\n\t\t\t/>\r\n\t\t</FiltersContainer>\r\n    <Lists>\r\n\t\t\t{!error && loading ? <Dimmer active ><Loader>Загрузка..</Loader></Dimmer> : <>\r\n\t\t\t\t<ListTitle>Для выбранной категории</ListTitle>\r\n\t\t\t\t{suitablePersons.length > 0 && <ListSubTitle sub > Контакты </ListSubTitle> }\r\n\t\t\t\t{suitablePersons\r\n\t\t\t\t\t.map(p => <ListItem\r\n\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\tactive={p.exec.id === execId}\r\n\t\t\t\t\t\ttext={p.amoName}\r\n\t\t\t\t\t\tonClick={() => setExecId(p.exec.id) || setPerson(null) || setOrg(null)}\r\n\t\t\t\t\t\tonRemove={() => upsertSpecPerson(p,\r\n\t\t\t\t\t\t\t[ `exec.opTypes[id=${opTypeId}]`, { disconnect: true } ]\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t{suitableOrgs.length > 0 && <ListSubTitle sub > Компании </ListSubTitle> }\r\n\t\t\t\t{suitableOrgs\r\n\t\t\t\t\t.map(o => <ListItem\r\n\t\t\t\t\t\tkey={o.id}\r\n\t\t\t\t\t\tactive={o.exec.id === execId}\r\n\t\t\t\t\t\ttext={o.name}\r\n\t\t\t\t\t\tonClick={() => setExecId(o.exec.id) || setPerson(null) || setOrg(null)}\r\n\t\t\t\t\t\tonRemove={() => upsertSpecOrg(o,\r\n\t\t\t\t\t\t\t[ `exec.opTypes[id=${opTypeId}]`, { disconnect: true } ]\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t<ListTitle>Остальные контакты\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tw='180px'\r\n\t\t\t\t\t\tml='auto'\r\n\t\t\t\t\t\tta='left'\r\n\t\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\t\tonClick={syncWithAmoContacts}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\t\tcolor={syncingContacts ? 'blue' : undefined} \r\n\t\t\t\t\t\t\tloading={syncingContacts}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{syncingContacts ? 'Загрузка..' : 'Контакты AmoCRM'}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</ListTitle>\r\n\t\t\t\t{otherPersons\r\n\t\t\t\t\t.map(p => <ListItem\r\n\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\tactive={p === person}\r\n\t\t\t\t\t\ttext={p.amoName}\r\n\t\t\t\t\t\tonClick={() => setPerson(p) || setOrg(null) || setExecId('')}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t<ListTitle>Остальные компании</ListTitle>\r\n\t\t\t\t{otherOrgs\r\n\t\t\t\t\t.map(o => <ListItem\r\n\t\t\t\t\t\tkey={o.id}\r\n\t\t\t\t\t\tactive={o === org}\r\n\t\t\t\t\t\ttext={o.name}\r\n\t\t\t\t\t\tonClick={() => setOrg(o) || setPerson(null) || setExecId('')}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t</>}\r\n\t\t</Lists>\r\n  </>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\nimport { assignNested } from '../form/utils'\r\n\r\nconst Container = styled.div`\r\n  width: 25px;\r\n  margin-left: auto;\r\n  transition: transform 0.25s linear;\r\n`\r\n\r\nconst ContolsContainer = styled.div`\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  opacity: 0;\r\n  transition: opacity 0.25s linear;\r\n`\r\n\r\nexport default function TaskControls ({\r\n  taskId,\r\n  upsertAppoint\r\n}) {\r\n    return <Container\r\n      className='taskControlsContainer'\r\n    >\r\n      <ContolsContainer\r\n        className='taskControls'\r\n      >\r\n        <Icon\r\n          link\r\n          name='trash'\r\n          color='grey'\r\n          activeColor='red'\r\n          onClick={() => upsertAppoint(draft => {\r\n            assignNested(draft, `tasks[id=${taskId}]`, {})\r\n          })}\r\n        />\r\n      </ContolsContainer>\r\n    </Container>\r\n  }","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\nimport TaskControls from './Controls'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  padding: 0 1em 0 55px;\r\n\tcursor: pointer;\r\n\tborder-width: 1px 0;\r\n\tborder-style: solid;\r\n\tborder-color: white;\r\n  :hover {\r\n    background: rgb(250, 250, 250);\r\n    color: rgba(0,0,0,.95);\r\n    .taskControls {\r\n      opacity: 1;\r\n    }\r\n  }\r\n  ${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n  `}\r\n`\r\n\r\nexport function TaskListItem ({\r\n  task: { text, order },\r\n  upsertAppoint\r\n}) {\r\n  return <Container>\r\n    <Div\r\n      w='25px'\r\n    >{order + 1}.</Div>\r\n    <Div>\r\n      {text}\r\n    </Div>\r\n    <TaskControls\r\n      upsertAppoint={upsertAppoint}\r\n    />\r\n  </Container>\r\n}","import React, { useState } from 'react'\r\nimport {\r\n  upsertTask as uT\r\n} from '../../graphql/task'\r\nimport styled from 'styled-components'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\nimport LeftIcon from '../Details/Menu/LeftIcon';\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { useMutation } from '../hooks/apolloHooks'\r\nimport { assignNested } from '../form/utils'\r\nimport { toLocalDatetimeString } from '../../utils/dates'\r\nimport { useApolloClient } from '@apollo/react-hooks'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: baseline;\r\n  padding: 1em 1em 1em 0;\r\n  border-top: 1px solid #2185d0;\r\n  border-bottom: 1px solid #2185d0;\r\n`\r\n\r\nexport function NewTask ({\r\n  task,\r\n  upsertAppoint\r\n}) {\r\n  const [ from, setFrom ] = useState(toLocalDatetimeString(new Date()))\r\n  const [ text, setText ] = useState()\r\n  const client = useApolloClient()\r\n  // const [ upsertTask ] = useMutation(uT, {\r\n\t// \tvariables: { input: {\r\n\t// \t\tfrom: new Date(from).toISOString(),\r\n\t// \t\ttext,\r\n  //     status: 'ACTIVE',\r\n  //     order: newTaskOrder,\r\n\t// \t\tappointId\r\n\t// \t}}\r\n  // })\r\n  return <Container>\r\n    <LeftIcon\r\n      size='big'\r\n      name='plus'\r\n      color='blue'\r\n      disabled={!text}\r\n      onClick={() => upsertAppoint(draft => {\r\n        assignNested(draft, `tasks[length]`, {\r\n          from: new Date(from).toISOString(),\r\n          text,\r\n          status: 'ACTIVE',\r\n          order: draft.tasks && draft.tasks.length || 0,\r\n        })\r\n      }, {\r\n        onCompleted({ appoint }) {\r\n          console.log('appoint > ', appoint)\r\n        }\r\n      })}\r\n    />\r\n    <Field\r\n      label='Новая задача'\r\n      inputWidth='257px'\r\n      type='textarea'\r\n      value={text}\r\n      onChange={text => setText(text)}\r\n      debouncedWrite\r\n    />\r\n    {/* <Field\r\n      label='Дедлайн'\r\n      type='datetime-local'\r\n      value={from}\r\n      onChange={date => setFrom(date)}\r\n    /> */}\r\n  </Container>\r\n}","import React, { useState, useContext } from 'react'\r\nimport groupBy from 'lodash/groupBy'\r\nimport { toLocalDatetimeString } from '../../utils/dates'\r\nimport { useQuery, useMutation } from '../hooks/apolloHooks'\r\nimport {\r\n  tasksDetails,\r\n  upsertTask as uT\r\n} from '../../graphql/task'\r\nimport UserContext from '../context/UserContext'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport { useApolloClient } from '@apollo/react-hooks'\r\nimport { TaskListItem } from './TaskListItem'\r\nimport cuid from 'cuid'\r\nimport { NewTask } from './NewTask';\r\n\r\nconst ListTitle = styled.h4`\r\n\tmargin: 0;\r\n\tpadding: 1em 1em 1em 55px;\r\n\tdisplay: flex;\r\n`\r\n\r\nexport default function TasksDetails ({\r\n  details: { appoint, upsertAnyAppoint, upsertAppoint },\r\n  setDetails\r\n}) {\r\n  const { exec: { id: execId } } = appoint\r\n\t\r\n  const { me: { person: {exec: { id: userExecId } }}} = useContext(UserContext)\r\n  const { data } = useQuery(tasksDetails)\r\n  const tasksByExec = !(data && data.tasks)\r\n    ? {}\r\n    : (() => {\r\n        const grouped = groupBy(data.tasks, 'appoint.exec.id')\r\n        grouped[execId] = grouped[execId] || []\r\n        grouped[execId].push({\r\n          isNew: true,\r\n          appoint,\r\n        })\r\n        return grouped\r\n      })()\r\n  console.log('tasksByExec > ', tasksByExec)\r\n  const execIds = Object.keys(tasksByExec)\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Задачи'\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n      {!execIds.length ? <Dimmer active ><Loader>Загрузка..</Loader></Dimmer> : <>\r\n        <ListTitle>Мои задачи</ListTitle>\r\n\r\n        {execIds\r\n          .filter(execId => execId !== userExecId)\r\n          .map(execId => {\r\n            const tasks = tasksByExec[execId]\r\n            console.log('tasks > ', tasks)\r\n            console.log('tasks[0].appoint.exec.person.amoName > ', tasks[0].appoint.exec.person.amoName)\r\n            return <div\r\n              key={execId}\r\n            > \r\n              <ListTitle>{tasks[0].appoint.exec.person.amoName}</ListTitle>\r\n              {tasks.map(task => task.isNew\r\n                ? <NewTask\r\n                    key={cuid()}\r\n                    task={task}\r\n                    upsertAppoint={upsertAppoint}\r\n                  />\r\n                : <TaskListItem\r\n                    key={task.id}\r\n                    task={task}\r\n                    upsertAppoint={(draftHandler, options) =>\r\n                      upsertAnyAppoint({\r\n                        ...task.appoint,\r\n                        tasks\r\n                      }, draftHandler, options)}\r\n                    // active={p.exec.id === execId}\r\n                    // onClick={() => setPersonId(p.id) || setExecId('')}\r\n                  />\r\n              )}\r\n            </div>\r\n          }\r\n        )}\r\n      </>}\r\n\t\t</Div>\r\n  </>\r\n}","import React, { useState, useMemo } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport OrgDetails from '../Org/Details/Details'\r\nimport CreateComOfferDetails from '../ComOffer/CreateComOfferDetails'\r\nimport CreateTaskDetails from '../Task/CreateTaskDetails'\r\nimport SelectExecDetails from '../Exec/SelectExecDetails'\r\nimport TasksDetails from '../Task/TasksDetails';\r\n\r\nconst Sidebar = styled(posed.div({\r\n  enter: { \r\n    x: 0,\r\n    transition: { ease: 'easeInOut' }\r\n  },\r\n  exit: {\r\n    x: '100%',\r\n    transition: { ease: 'easeInOut' }\r\n  }\r\n}))`\r\n  position: absolute;\r\n  z-index: 12;\r\n  top: 36px;\r\n  right: 0;\r\n  width: ${props =>\r\n    ['CreateComOffer', 'createTask', 'tasks']\r\n      .includes(props.type)\r\n        ? '470px'\r\n        : '600px'\r\n  };\r\n  height: calc(100% - 36px);\r\n\tbackground-color: rgba(255,255,255,1);\r\n\tbox-shadow: 0 0 20px rgba(34,36,38,.15);\r\n`\r\n\r\nconst DetailsContext = React.createContext()\r\nexport default DetailsContext\r\n\r\nexport const DetailsProvider = ({\r\n  children\r\n}) => {\r\n  const [ details, setDetails ] = useState(null)\r\n  const { type } = details || {}\r\n  const providerValue = useMemo(() => ({ setDetails }), [])\r\n  return (\r\n    <DetailsContext.Provider\r\n      value={providerValue}\r\n    >\r\n      <PoseGroup>\r\n        {details &&\r\n          <Sidebar key='1'\r\n            type={type}\r\n          >\r\n            { type === 'Org' ?\t<OrgDetails\r\n                details={details}\r\n                setDetails={setDetails}\r\n              /> :\r\n              type === 'CreateComOffer' ?\t<CreateComOfferDetails\r\n                details={details}\r\n                setDetails={setDetails}\r\n              /> :\r\n              type === 'tasks' ?\t<TasksDetails\r\n                details={details}\r\n                setDetails={setDetails}\r\n                /> :\r\n              type === 'createTask' ?\t<CreateTaskDetails\r\n                details={details}\r\n                setDetails={setDetails}\r\n                /> :\r\n              type === 'SelectExec' ?\t<SelectExecDetails\r\n                details={details}\r\n                setDetails={setDetails}\r\n              />\r\n              : null\r\n            }\r\n          </Sidebar>\r\n        }\r\n      </PoseGroup>\r\n      {children}\r\n    </DetailsContext.Provider>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Dropdown } from 'semantic-ui-react'\r\n\r\nconst MenuButton = styled.div`\r\n  .dropdown {\r\n    width: 30px;\r\n    text-align: center;\r\n  }\r\n  .icon {\r\n    margin: 0;\r\n    color: rgba(50,50,50,.87);\r\n  }\r\n  transition: background .3s ease;\r\n  :hover {\r\n    background: rgba(0,0,0,.12);\r\n    .icon {\r\n      opacity: 1 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport const DropdownMenu = ({ children }) => {\r\n  return <MenuButton>\r\n    <Dropdown\r\n      icon={{\r\n        name: 'bars',\r\n        link: true\r\n      }}\r\n      direction='left'\r\n    >\r\n      <Dropdown.Menu>\r\n        {children}\r\n      </Dropdown.Menu>\r\n    </Dropdown>\r\n  </MenuButton>\r\n}\r\n\r\n","import React, { useContext } from 'react'\r\nimport { useMutation } from '../../hooks/apolloHooks'\r\nimport { createPostEnvelopeAddressInsert as cPEAI } from '../../../graphql/org'\r\nimport DiskContext from '../../context/DiskContext'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport { DropdownMenu } from './DropdownMenu'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n`\r\n\r\nconst Title = styled(Div)`\r\n  ${Container}:hover & {\r\n    width: '80px';\r\n    font-weight: bold;\r\n  }\r\n`\r\n\r\nconst Menu = styled(Div)`\r\n  display: none;\r\n  margin-left: auto;\r\n  ${Container}:hover & {\r\n    display: unset;\r\n  }\r\n`\r\n\r\nexport default React.memo(function Org ({\r\n  dealId,\r\n  org: { id: orgId, name, inn },\r\n  setDetails\r\n}) {\r\n  const { highlightFolder } = useContext(DiskContext)\r\n  const [ createPostEnvelopeAddressInsert ] = useMutation(cPEAI, {\r\n    variables: { orgId },\r\n    successMsg: 'Почтовое вложение создано',\r\n    errMsg: 'Ошибка создания почтового вложения',\r\n    mark: 'Org createPostEnvelopeAddressInsert'\r\n  })\r\n  return <Container>\r\n    <Title\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      whs='nowrap'\r\n      pos='relative'\r\n      pl='6px'\r\n    >\r\n      {name}\r\n    </Title>\r\n    <Menu>\r\n      <DropdownMenu>\r\n        <Dropdown.Item\r\n          icon='folder'\r\n          text='Обнаружить папку'\r\n          onClick={() => highlightFolder({ orgId })}\r\n        />\r\n        <Dropdown.Item\r\n          icon='newspaper outline'\r\n          text='Реквизиты'\r\n          onClick={() => setDetails({ orgId, type: 'Org' })}\r\n        />\r\n        <Dropdown.Item\r\n          icon='file alternate'\r\n          text='Создать КП'\r\n          onClick={() => setDetails({ dealId, type: 'CreateComOffer' })}\r\n        />\r\n        <Dropdown.Item\r\n          icon='file alternate outline'\r\n          text='Создать договор'\r\n          onClick={() => setDetails({ orgId, type: 'Org', section: 'contract' })}\r\n          disabled={!inn}\r\n        />\r\n        <Dropdown.Item\r\n          icon='mail'\r\n          text='Создать почтовое вложение'\r\n          onClick={() => createPostEnvelopeAddressInsert()}\r\n        />\r\n      </DropdownMenu>\r\n    </Menu>\r\n  </Container>\r\n})\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\nimport HtmlInput from '../../common/HtmlInput'\r\n\r\nexport default ({\r\n  deal,\r\n  batch: { id: batchId, isNew: isNewBatch},\r\n  model: { name } = {},\r\n  upsertDeal\r\n}) => {\r\n  const { batches } = deal\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlInput\r\n      ref={inputRef}\r\n      placeholder='Новое Изделие'\r\n      value={name || ''}\r\n      onChange={value => value !== '' && upsertDeal([\r\n        isNewBatch\r\n            ? 'batches[length]'\r\n            : `batches[id=${batchId}].model`,\r\n        isNewBatch\r\n          ? { qty: 1, sort: batches.length, model: { name: value } }\r\n          : { name: value }\r\n      ])}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  else if (isNewBatch)\r\n    return <Icon\r\n      link\r\n      name='plus'\r\n      // c='rgba(50,50,50,.87)'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      fw='bold'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {name}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nconst Input = styled.input`\r\n  width: 40px;\r\n`\r\n\r\nexport default ({\r\n  deal,\r\n  batch: { id: batchId, qty: iniQty },\r\n  upsertDeal\r\n}) => {\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  const [ qty, setQty ] = useState(iniQty)\r\n  return editMode\r\n  ? <Input\r\n      ref={inputRef}\r\n      placeholder='1'\r\n      value={qty}\r\n      onChange={({ target: { value }}) => setQty(value)}\r\n      onBlur={async () => {\r\n        if (qty !== iniQty)\r\n          await upsertDeal([ `batches[id=${batchId}].qty`, qty ])\r\n        setEditMode(false)\r\n      }}\r\n    />\r\n  : <Div\r\n      pl='4px'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {qty} шт\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport HtmlInput from '../../../common/HtmlInput'\r\nimport { currency } from '../../../../utils/format'\r\n\r\nexport default function Stat ({\r\n  value,\r\n  isAuto,\r\n  type,\r\n  onChange,\r\n  onAutoEnable,\r\n}) {\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  return editMode\r\n  ? <HtmlInput\r\n      ref={inputRef}\r\n      placeholder='0'\r\n      value={value || ''}\r\n      onChange={value => onChange(value)}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  : <Div\r\n      pl='2px'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {isAuto === false &&\r\n        <Icon\r\n          link\r\n          activeColor='red'\r\n          name='hand paper'\r\n          size='small'\r\n          fl='left'\r\n          m='2px auto 0 1px'\r\n          color='grey'\r\n          onClick={e => {\r\n            e.stopPropagation()\r\n            onAutoEnable()\r\n          }}\r\n        />\r\n      }\r\n      { type === 'currency'\r\n        ? isAuto !== false && value === 0\r\n          ? '- ₽'\r\n          : currency(value)\r\n        : (\r\n        type === 'labor'\r\n          ? isAuto !== false && !value\r\n            ? '- / - ч '\r\n            : '- /' + value + ' ч'\r\n          : value\r\n        )\r\n      }\r\n    </Div>\r\n}","import React from 'react'\r\nimport { assignNested } from '../../../form/utils'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport Stat from './Stat'\r\n\r\nconst FlexContainer = styled.div`\r\n  display: flex;\r\n`\r\n\r\nexport default function BpStat ({\r\n  bpStat,\r\n  budgetMode,\r\n  upsertParent,\r\n  hideLaborCell\r\n}) {\r\n  const {\r\n\t\tautoPlanCost,\r\n\t\tautoPlanLabor,\r\n\t\tautoPlanRevenue,\r\n    factCost,\r\n\t\tfactLabor,\r\n    factRevenue,\r\n    planCost,\r\n\t\tplanLabor,\r\n    planRevenue\r\n  } = bpStat || {}\r\n  return <FlexContainer>\r\n    {!hideLaborCell &&\r\n      <Div\r\n        w='90px'\r\n        pl='2px'\r\n        c={factLabor || planLabor ? undefined : 'rgba(34,36,38,0.6)'}\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        <Stat\r\n          type='labor'\r\n          value={planLabor}\r\n          isAuto={autoPlanLabor}\r\n          onChange={value => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.planLabor`, value)\r\n              assignNested(draft, `bpStat.autoPlanLabor`, false, true)\r\n            })\r\n          }}\r\n          onAutoEnable={() => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.autoPlanLabor`, true)\r\n            })\r\n          }}\r\n        />\r\n      </Div>\r\n    }\r\n    {budgetMode && <>\r\n      <Div\r\n        w='90px'\r\n        pr='2px'\r\n        c={factRevenue || planRevenue ? undefined : 'rgba(34,36,38,0.6)'}\r\n        ta='right'\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        <Stat\r\n          type='currency'\r\n          value={planRevenue}\r\n          isAuto={autoPlanRevenue}\r\n          onChange={value => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.planRevenue`, value)\r\n              assignNested(draft, `bpStat.autoPlanRevenue`, false, true)\r\n            })\r\n          }}\r\n          onAutoEnable={() => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.autoPlanRevenue`, true)\r\n            })\r\n          }}\r\n        />\r\n      </Div>\r\n      <Div\r\n        w='90px'\r\n        pr='2px'\r\n        c={factCost || planCost ? undefined : 'rgba(34,36,38,0.6)'}\r\n        ta='right'\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        <Stat\r\n          type='currency'\r\n          value={planCost}\r\n          isAuto={autoPlanCost}\r\n          onChange={value => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.planCost`, value)\r\n              assignNested(draft, `bpStat.autoPlanCost`, false, true)\r\n            })\r\n          }}\r\n          onAutoEnable={() => {\r\n            upsertParent(draft => {\r\n              assignNested(draft, `bpStat.autoPlanCost`, true)\r\n            })\r\n          }}\r\n        />\r\n      </Div>\r\n      <Div\r\n        w='500px'\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        ..\r\n      </Div>\r\n    </>}\r\n  </FlexContainer>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\nimport { Icon, Dropdown } from 'semantic-ui-react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport HtmlInput from '../../common/HtmlInput'\r\nimport { assignNested } from '../../form/utils'\r\nimport { DropdownMenu } from './DropdownMenu';\r\n\r\nconst Container = styled(Div)`\r\n  display: flex;\r\n`\r\n\r\nconst Title = styled.div`\r\n  position: relative;\r\n  /* width: 100%; */\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  /* ${Container}:hover & {\r\n    ${props => !props.isNew && 'width: 140px;'}\r\n    ${props => !props.isNew && props.isMachiningClass && 'width: 140px;'}\r\n  } */\r\n`\r\n\r\nconst Menu = styled.div`\r\n  display: none;\r\n  margin-left: auto;\r\n  ${Container}:hover & {\r\n    display: unset;\r\n  }\r\n`\r\n\r\nconst WarningItem = styled(Dropdown.Item)`\r\n  :hover {\r\n    color: #9f3a38 !important;\r\n    .icon {\r\n      color: #9f3a38 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport default function Proc ({\r\n  modelId,\r\n  proc,\r\n  upsertBatch,\r\n  deleteElement\r\n}) {\r\n  const { isNew: isNewProc, name} = proc\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlInput\r\n      ref={inputRef}\r\n      placeholder='Новый техпроцесс'\r\n      value={name || ''}\r\n      onChange={value => {\r\n        upsertBatch(draft => {\r\n          assignNested(draft, 'procs[0]', { name: value, modelId })\r\n        })\r\n      }}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  else if (isNewProc)\r\n    return <Icon\r\n      link\r\n      name='plus'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Container\r\n      w='170px'\r\n    >\r\n      <Title>\r\n        {name}\r\n      </Title>\r\n      <Menu>\r\n        <DropdownMenu>\r\n          <WarningItem\r\n            icon='trash'\r\n            text='Удалить'\r\n            onClick={deleteElement}\r\n          />\r\n        </DropdownMenu>\r\n      </Menu>\r\n    </Container>\r\n}","import React, { useState, useEffect, useRef, useContext } from 'react'\r\n\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport { DealsContext } from '../../context/Context'\r\nimport HtmlSelect from '../../../common/HtmlSelect'\r\nimport { assignNested } from '../../../form/utils'\r\n\r\nexport default function OpType ({\r\n  path,\r\n  isNewOp,\r\n  opClass,\r\n  opType: { id: opTypeId, name, laborPrice } = {},\r\n  upsertBatch\r\n}) {\r\n  const { opTypes } = useContext(DealsContext)\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  const isMachiningClass = opClass === 'MACHINING'\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlSelect\r\n      ref={inputRef}\r\n      value={opTypeId}\r\n      options={opTypes.filter(ot => ot.opClass === opClass)}\r\n      onChange={opTypeId => upsertBatch(draft => {\r\n        const laborPrice = opTypes.find(opt => opt.id === opTypeId).laborPrice\r\n        assignNested(draft, path, {\r\n          opTypeId,\r\n          ...laborPrice && { laborPrice }\r\n        })\r\n      })}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  else if (isNewOp)\r\n    return <Icon\r\n      ml={isMachiningClass ? '6px' : undefined}\r\n\t\t\tc='rgba(50,50,50,.87)'\r\n      link\r\n      name='plus'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n\t\t\tto='ellipsis'\r\n\t\t\tpl={isMachiningClass ? '6px' : undefined}\r\n    >\r\n      {name}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport { assignNested } from '../../../form/utils'\r\nimport HtmlInput from '../../../common/HtmlInput'\r\n\r\nexport default ({\r\n  basePath,\r\n  dealLabor,\r\n  upsertBatch,\r\n}) => {\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  return editMode\r\n  ? <HtmlInput\r\n    ref={inputRef}\r\n    placeholder='0'\r\n    value={dealLabor || ''}\r\n    onChange={value => {\r\n      upsertBatch(draft => {\r\n        assignNested(draft, `${basePath}dealLabor`, value)\r\n      })\r\n    }}\r\n    onBlur={() => setEditMode(false)}\r\n  />\r\n  : <Div\r\n      pl='4px'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {dealLabor} ч\r\n    </Div>\r\n}","import React, { useState, useContext } from 'react'\r\n\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport { assignNested } from '../../../form/utils'\r\nimport DetailsContext from '../../../Details/Provider'\r\n\r\nexport default function ExecName ({\r\n  basePath,\r\n  appoint,\r\n  opIndex,\r\n  opType: { id: opTypeId, laborCost },\r\n  upsertBatch\r\n}) {\r\n  const { isNew: isNewAppoint, exec: { person: { id, amoName } = {} } = {} } = appoint\r\n  const { setDetails } = useContext(DetailsContext)\r\n  const [ addMode, setAddMode ] = useState(false)\r\n  return <Div\r\n    ov='hidden'\r\n    to='ellipsis'\r\n    pl='6px'\r\n  >\r\n    {isNewAppoint\r\n      ? <Icon\r\n          // TODO fix addMode not recognized as truthy\r\n          c={addMode ? 'green' : 'rgba(50,50,50,.87)'}\r\n          link\r\n          name='plus'\r\n          activeColor='green'\r\n          onClick={() => {\r\n            setAddMode(true)\r\n            setDetails({\r\n              type: 'SelectExec',\r\n              opTypeId,\r\n              onSubmit: execId => {\r\n                upsertBatch(draft => {\r\n                  assignNested( draft,\r\n                    basePath + `appoints[length]`,\r\n                    { execId, ...laborCost && { laborCost } }\r\n                  )\r\n                })\r\n              }\r\n            })\r\n          }}\r\n        />\r\n      : amoName\r\n    }\r\n  </Div>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport TaskControls from '../../Task/Controls'\r\n\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  position: relative;\r\n  width: 100%;\r\n  border-top: 1px solid rgba(34,36,38,0.15);\r\n  min-height: calc(1.5em + 1px);\r\n`\r\n\r\nconst TitleContainer = styled.div`\r\n  display: flex;\r\n  .taskControlsContainer {\r\n    border-right: 1px solid rgba(34,36,38,0.15);\r\n    transform: translateX(-100%);\r\n  }\r\n  :hover {\r\n    .taskControlsContainer {\r\n      transform: translateX(0);\r\n    }\r\n    .taskControls {\r\n      opacity: 1;\r\n    }\r\n  }\r\n`\r\n\r\nconst Untruncated = styled.div`\r\n  width: 255px;\r\n  padding-left: 6px;\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\tbox-sizing: content-box;\r\n  color: rgba(0,0,0,.68);\r\n\t/* vertical overlay */\r\n\t:hover {\r\n\t\t/* position: absolute; */\r\n\t\t/* top: 1px; */\r\n\t\t/* left: -4px; */\r\n\t\tz-index: 1;\r\n\t\toverflow: unset;\r\n\t\twhite-space: normal;\r\n\t\t/* background-color: white; */\r\n\t\t/* border: 5px solid rgb(242,242,242); */\r\n    border-top: none;\r\n\t}\r\n`\r\n\r\nconst Title = styled.div`\r\n\r\n`\r\n\r\nexport default function Task ({\r\n  task: { id, text, order },\r\n  upsertAppoint\r\n}) {\r\n  return <Container>\r\n    <TitleContainer>\r\n      <Untruncated>\r\n        {order + 1 + '. ' + text}\r\n      </Untruncated>\r\n      <TaskControls\r\n        taskId={id}\r\n        upsertAppoint={upsertAppoint}\r\n      />\r\n    </TitleContainer>\r\n  </Container>\r\n}","import React, { useState, useContext } from 'react'\r\nimport { useMutation } from '../../../hooks/apolloHooks'\r\nimport { upsertAppoint as uAq } from '../../../../graphql/appoint'\r\nimport { getStructure, assignNested } from '../../../form/utils'\r\nimport produce from 'immer'\r\n\r\nimport DetailsContext from '../../../Details/Provider'\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport { DropdownMenu } from '../DropdownMenu'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport ExecName from '../Exec/Name'\r\nimport Task from '../../Task/Task'\r\nimport BpStat from '../BpStat/BpStat'\r\n\r\nconst Container = styled.div`\r\n  position: relative;\r\n  width: 100%;\r\n  :not(:last-child) {\r\n    border-bottom: 1px solid rgba(34,36,38,0.15);\r\n  }\r\n`\r\n\r\nconst TitleContainer = styled.div`\r\n  display: flex;\r\n  width: 170px;\r\n`\r\n\r\nconst HeaderContainer = styled.div`\r\n  display: flex;\r\n`\r\n\r\nconst Title = styled(Div)`\r\n  width: 100%;\r\n  ${TitleContainer}:hover & {\r\n    width: 139px;\r\n  }\r\n`\r\n\r\nconst Menu = styled.div`\r\n  display: none;\r\n  margin-left: auto;\r\n  ${TitleContainer}:hover & {\r\n    display: unset;\r\n  }\r\n`\r\n\r\nconst WarningItem = styled(Dropdown.Item)`\r\n  :hover {\r\n    color: #9f3a38 !important;\r\n    .icon {\r\n      color: #9f3a38 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport default function Appoint ({\r\n  basePath,\r\n  appoint,\r\n  op,\r\n  opIndex,\r\n  upsertBatch,\r\n  budgetMode\r\n}) {\r\n  // console.log('Appoint > ')\r\n  const { opType } = op\r\n  const { id: appointId, isNew, tasks, bpStat } = appoint\r\n  const { setDetails } = useContext(DetailsContext)\r\n  const [ upsertAppointProto ] = useMutation(uAq)\r\n  const upsertAnyAppoint = (appoint, draftHandler, options = {}) => console.log('options > ', options) ||\r\n    upsertAppointProto({ variables: { input:\r\n      produce(getStructure(appoint), draftHandler)\r\n    }, options})\r\n  const upsertAppoint = (draftHandler, options) =>\r\n    upsertAnyAppoint(appoint, draftHandler, options)\r\n  return <>\r\n    <Container>\r\n      <HeaderContainer>\r\n        <TitleContainer>\r\n          <Title\r\n            whs='nowrap'\r\n            to='ellipsis'\r\n            pos='relative'\r\n          >\r\n            <ExecName\r\n              basePath={basePath}\r\n              appoint={appoint}\r\n              opIndex={opIndex}\r\n              opType={opType}\r\n              upsertBatch={upsertBatch}\r\n            />\r\n          </Title>\r\n              {!isNew &&\r\n            <Menu>\r\n              <DropdownMenu>\r\n                <WarningItem\r\n                  icon='remove'\r\n                  text='Открепить'\r\n                  onClick={() => upsertBatch(draft => {\r\n                    assignNested(draft, `${basePath}appoints[id=${appointId}]`, {})\r\n                  })}\r\n                />\r\n                <Dropdown.Item\r\n                  icon='plus'\r\n                  text='Задача'\r\n                  onClick={() => setDetails({ appoint, upsertAppoint, upsertAnyAppoint, type: 'tasks' })}\r\n                />\r\n              </DropdownMenu>\r\n            </Menu>\r\n          }\r\n        </TitleContainer>\r\n        {!isNew &&\r\n          <BpStat\r\n            bpStat={bpStat}\r\n            budgetMode={budgetMode}\r\n            upsertParent={upsertAppoint}\r\n          />\r\n        }\r\n      </HeaderContainer>\r\n      {tasks && tasks.map(task =>\r\n        <Task\r\n          key={task.id}\r\n          task={task}\r\n          upsertAppoint={upsertAppoint}\r\n        />\r\n      )}\r\n      {/* <Div\r\n        pos='absolute'\r\n        l='170px'\r\n        w='2000px'\r\n        h='100%'\r\n        pe='none'\r\n      >\r\n        {tasks && tasks.map(task =>\r\n          <Task\r\n            key={task.id}\r\n            task={task}\r\n          />\r\n        )}\r\n      </Div> */}\r\n    </Container>\r\n    {/* <Div></Div> */}\r\n  </>\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport OpType from './OpType'\r\nimport DealLabour from './DealLabour'\r\nimport { DropdownMenu } from '../DropdownMenu'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport Appoint from '../Appoint/Appoint'\r\nimport { assignNested } from '../../../form/utils'\r\n\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n`\r\n\r\nconst TitleContainer = styled(Div)`\r\n  display: flex;\r\n`\r\n\r\nconst Title = styled.div`\r\n  position: relative;\r\n  /* width: 100%; */\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  ${TitleContainer}:hover & {\r\n    ${props => !props.isNew && 'width: 140px;'}\r\n    ${props => !props.isNew && props.isMachiningClass && 'width: 140px;'}\r\n  }\r\n`\r\n\r\nconst Menu = styled.div`\r\n  display: none;\r\n  margin-left: auto;\r\n  ${TitleContainer}:hover & {\r\n    display: unset;\r\n  }\r\n`\r\n\r\nconst WarningItem = styled(Dropdown.Item)`\r\n  :hover {\r\n    color: #9f3a38 !important;\r\n    .icon {\r\n      color: #9f3a38 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport const Op = ({\r\n  basePath,\r\n  op,\r\n  opClass,\r\n  opIndex,\r\n  upsertBatch,\r\n  deleteElement,\r\n  budgetMode\r\n}) => {\r\n  const { id, isNew, appoints, opType, dealLabor } = op\r\n  const isMachiningClass = basePath.endsWith('proc.')\r\n  return <Wrapper>\r\n    <TitleContainer\r\n      d='flex'\r\n      w={isMachiningClass ? '125px' : '170px'}\r\n    >\r\n      <Title\r\n        isNew={isNew}\r\n        isMachiningClass={isMachiningClass}\r\n      >\r\n        <OpType\r\n          path={basePath + (isMachiningClass ? `ops[length]` : 'op')}\r\n          opType={opType}\r\n          opClass={opClass}\r\n          isNewOp={isNew}\r\n          upsertBatch={upsertBatch}\r\n        />\r\n      </Title>\r\n      {!isNew &&\r\n        <Menu>\r\n          <DropdownMenu>\r\n            <WarningItem\r\n              icon='trash'\r\n              text='Удалить'\r\n              onClick={isMachiningClass\r\n                ? () => upsertBatch(draft => {\r\n                    assignNested(draft, basePath + `ops[id=${id}]`, {})\r\n                  })\r\n                : deleteElement}\r\n            />\r\n          </DropdownMenu>\r\n        </Menu>\r\n      }\r\n    </TitleContainer>\r\n    {!isNew && isMachiningClass &&\r\n      <Div\r\n        w='45px'\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        <DealLabour\r\n          basePath={`${basePath}ops[id=${id}].`}\r\n          dealLabor={dealLabor}\r\n          opIndex={opIndex}\r\n          upsertBatch={upsertBatch}\r\n        />\r\n      </Div>\r\n    }\r\n    {!isNew &&\r\n      <Div\r\n        // w={`calc(170px + 90px${budgetMode ? ' + 670px' : ''})`}\r\n        // w={budgetMode ? '930px' : '260px'}\r\n        bl='1px solid rgba(34,36,38,0.15)'\r\n      >\r\n        {[\r\n          ...appoints,\r\n          { id: cuid(), isNew: true }\r\n        ].map((appoint, i) =>\r\n          <Appoint\r\n            key={appoint.id}\r\n            basePath={basePath + (isMachiningClass ? `ops[id=${id}].` : 'op.')}\r\n            appoint={appoint}\r\n            appointIndex={i}\r\n            op={op}\r\n            opIndex={opIndex}\r\n            upsertBatch={upsertBatch}\r\n            budgetMode={budgetMode}\r\n          />\r\n        )}\r\n      </Div>\r\n    }\r\n  </Wrapper>\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { Op } from'./Op'\r\n\r\nconst Container = styled.div`\r\n  :not(:last-child) {\r\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\r\n\t}\r\n  background: rgba(0,0,0,.05);\r\n`\r\n\r\nexport const Ops = ({\r\n  basePath,\r\n  ops,\r\n  upsertBatch,\r\n  budgetMode\r\n}) => {\r\n  return [\r\n    ...ops,\r\n    { id: cuid(), isNew: true }\r\n  ].map((op, i) =>\r\n    <Container\r\n      key={op.id}\r\n    >\r\n      <Op\r\n        basePath={basePath}\r\n        op={op}\r\n        opClass='MACHINING'\r\n        opIndex={i}\r\n        upsertBatch={upsertBatch}\r\n        budgetMode={budgetMode}\r\n      />\r\n    </Container>\r\n  )\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport Proc from'../Proc'\r\nimport { Ops } from '../Op/Ops'\r\nimport { Op } from '../Op/Op';\r\nimport { Div } from '../../../styled/styled-semantic'\r\n\r\nconst Container = styled(Div)`\r\n  width: 100%;\r\n  border-bottom: 1px solid rgba(34,36,38,0.15);\r\n  line-height: 1.5em !important;\r\n`\r\n\r\nexport default function Element ({\r\n  element: { id, op, proc },\r\n  upsertBatch,\r\n  deleteElement,\r\n  budgetMode\r\n}) {\r\n  return <Container\r\n    // w={budgetMode ? '1100px' : '430px'}\r\n  >\r\n    {op &&\r\n      <Op\r\n        op={op}\r\n        opClass='SURVEY'\r\n        basePath={`elements[id=${id}].`}\r\n        upsertBatch={upsertBatch}\r\n        deleteElement={deleteElement}\r\n        budgetMode={budgetMode}\r\n      />\r\n    }\r\n    {proc && <>\r\n      <Proc\r\n        proc={proc}\r\n        upsertBatch={upsertBatch}\r\n        deleteElement={deleteElement}\r\n      />\r\n      {!proc.isNew &&\r\n        <Ops\r\n          basePath={`elements[id=${id}].proc.`}\r\n          ops={proc.ops}\r\n          upsertBatch={upsertBatch}\r\n          budgetMode={budgetMode}\r\n        />\r\n      }\r\n    </>}\r\n  </Container>\r\n}","import React, { useState, useEffect, useRef, useContext } from 'react'\r\nimport { DealsContext } from '../../context/Context'\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport HtmlInput from '../../../common/HtmlInput'\r\nimport HtmlSelect from '../../../common/HtmlSelect'\r\nimport { upsertOp } from '../../../../graphql/op';\r\n\r\nexport default function NewElement ({\r\n  modelId,\r\n  opClass,\r\n  upsertBatch,\r\n  newElementIndex\r\n}) {\r\n  const { opTypes } = useContext(DealsContext)\r\n  const inputRef = useRef(null)\r\n  const inputRef2 = useRef(null)\r\n  const inputRef3 = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  const [ elementType, setElementType ] = useState('')\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  useEffect(() => (!!elementType &&\r\n    inputRef2.current &&\r\n    inputRef2.current.focus()) || undefined)\r\n  useEffect(() => (!!elementType &&\r\n    inputRef3.current &&\r\n    inputRef3.current.focus()) || undefined)\r\n  const upsertOp = opTypeId => {\r\n    const laborPrice = opTypes.find(opt => opt.id === opTypeId).laborPrice\r\n      upsertBatch(['elements[length]', {\r\n      op: {\r\n        opTypeId,\r\n        ...laborPrice && { laborPrice },\r\n      },\r\n      sort: newElementIndex\r\n    }])\r\n  }\r\n  if (editMode)\r\n    return <HtmlSelect\r\n      ref={inputRef}\r\n      options={[\r\n        {id: 'op', name: 'Операция'},\r\n        {id: 'supplier', name: 'Поставщик'},\r\n        {id: 'proc', name: 'Техпроцесс'},\r\n      ]}\r\n      onChange={elementType => {\r\n        setEditMode(false)\r\n        if (elementType === 'supplier')\r\n          return upsertOp(opTypes.find(opt => opt.opClass === 'SUPPLIER').id)\r\n        setElementType(elementType)\r\n      }}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  if (elementType === 'op')\r\n    return <HtmlSelect\r\n      ref={inputRef2}\r\n      options={opTypes.filter(ot => ot.opClass === opClass)}\r\n      undefinedOptionName='выберите операцию'\r\n      onChange={opTypeId => upsertOp(opTypeId)}\r\n      onBlur={() => setElementType('')}\r\n    />\r\n  if (elementType === 'proc')\r\n    return <HtmlInput\r\n      ref={inputRef3}\r\n      placeholder='Новый техпроцесс'\r\n      onChange={value =>\r\n        upsertBatch(['elements[length]', {\r\n          proc: {\r\n            name: value,\r\n            modelId,\r\n          },\r\n          sort: newElementIndex\r\n        }]\r\n      )}\r\n      onBlur={() => setElementType('')}\r\n    />\r\n  else\r\n    return <Icon\r\n      link\r\n      name='plus'\r\n      c='rgba(50,50,50,.87)'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\nimport {\r\n  sortableContainer,\r\n  sortableElement,\r\n  sortableHandle,\r\n} from 'react-sortable-hoc'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport Element from './Element'\r\nimport NewElement from './NewElement'\r\nimport useUpsert from '../../../hooks/useUpsert'\r\n\r\nconst SortableItemContainer = styled(Div)`\r\n  :hover {\r\n    .elementDragHandle {\r\n      opacity: 1 !important;\r\n    }\r\n  }\r\n`\r\n\r\nconst SortableContainer = sortableContainer(({children}) => {return <div>{children}</div>})\r\n\r\nconst DragHandle = sortableHandle(() =>\r\n  <Div\r\n    className='elementDragHandle'\r\n    w='19px'\r\n    ml='-19px'\r\n    o='0'\r\n    c='rgba(0,0,0,.6)'\r\n    fw='bold'\r\n    ta='center'\r\n    lh='initial'\r\n    cur='move'\r\n    tr='opacity 0.25s ease-in-out'\r\n  >::</Div>\r\n)\r\n\r\nconst SortableElement = sortableElement(props => (\r\n  <SortableItemContainer\r\n    d='flex'\r\n    z='99'\r\n  >\r\n    <DragHandle />\r\n    <Element {...props} />\r\n  </SortableItemContainer>\r\n))\r\n\r\nexport default function Elements ({\r\n  batch,\r\n  elements,\r\n  upsertBatch: upsertBatchDeprecated,\r\n  modelId,\r\n  budgetMode,\r\n}) {\r\n  const [ upsertBatch ] = useUpsert('batch', batch)\r\n  return <>\r\n    <SortableContainer\r\n      onSortEnd={({oldIndex, newIndex}) => {\r\n        if (oldIndex === newIndex) return\r\n        upsertBatch([\r\n          `elements[id=${elements[oldIndex].id}]`, { sort: newIndex },\r\n          `elements[id=${elements[newIndex].id}]`, { sort: oldIndex }\r\n        ])\r\n      }}\r\n      useDragHandle\r\n    >\r\n      {elements.map((element, index) =>\r\n        <SortableElement\r\n          key={element.id}\r\n          index={index}\r\n          element={element}\r\n          upsertBatch={upsertBatchDeprecated}\r\n          deleteElement={() => {\r\n            const { id } = element\r\n            let modifierArr = [ `elements[id=${id}]`, {} ]\r\n            elements\r\n              .filter(b => b.id !== id)\r\n              .forEach((b, i) => {\r\n                modifierArr = [...modifierArr, `elements[id=${b.id}]`, { sort: i }]\r\n              })\r\n            upsertBatch(modifierArr)\r\n          }}\r\n          budgetMode={budgetMode}\r\n        />\r\n      )}\r\n    </SortableContainer>\r\n    <Div\r\n      w='170px'\r\n    >\r\n      <NewElement\r\n        key={cuid()}\r\n        batch={batch}\r\n        modelId={modelId}\r\n        opClass='SURVEY'\r\n        upsertBatch={upsertBatch}\r\n        newElementIndex={elements.length}\r\n      />\r\n    </Div>\r\n  </>\r\n}","import React, { useContext } from 'react'\r\nimport { useMutation } from '../../hooks/apolloHooks'\r\nimport { upsertBatch as uBq } from '../../../graphql/batch'\r\nimport useUpsert from '../../hooks/useUpsert'\r\nimport { getStructure, assignNested } from '../../form/utils'\r\nimport produce from 'immer'\r\n\r\nimport { DealsContext } from '../context/Context'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\nimport Model from './Model'\r\nimport Qty from './Qty'\r\nimport BpStat from './BpStat/BpStat'\r\nimport Elements from './Element/Elements'\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  border-bottom: 1px solid rgba(34,36,38,0.15);\r\n  line-height: 1.5em !important;\r\n`\r\n\r\nconst TitleContainer = styled.div`\r\n  position: relative;\r\n  width: 311px;\r\n  border-right: 1px solid rgba(34,36,38,0.15);\r\n`\r\n\r\nconst ContolsContainer = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  opacity: 0;\r\n  transition: opacity 0.25s linear;\r\n  ${TitleContainer}:hover & {\r\n    opacity: 1;\r\n  }\r\n`\r\n\r\nexport default React.memo(function Batch ({\r\n  deal,\r\n  batch,\r\n  upsertDeal,\r\n}) {\r\n  const { batches } = deal\r\n  const { budgetMode } = useContext(DealsContext)\r\n  const [ upsertBatchProto ] = useMutation(uBq)\r\n  const upsertBatch = (draftHandler, options) =>\r\n    upsertBatchProto({ variables: { input:\r\n      produce(getStructure(batch), draftHandler)\r\n    }, options})\r\n  const { id, bpStat, elements, model } = produce(batch, draft => {\r\n    const batchAutoStat = {\r\n      planCost: 0,\r\n      planLabor: 0,\r\n      planRevenue: 0,\r\n    }\r\n    const evalOp = (op, batchAutoStat) => {\r\n      for (let ap of op.appoints) {\r\n        if (!ap.bpStat) ap.bpStat = {}\r\n        const { bpStat, laborCost } = ap\r\n        const {\r\n          autoPlanCost,\r\n          autoPlanLabor,\r\n          autoPlanRevenue,\r\n        } = bpStat\r\n        if (autoPlanLabor !== false)\r\n          bpStat.planLabor = op.dealLabor\r\n        if (autoPlanCost !== false)\r\n          if (laborCost && bpStat.planLabor)\r\n            bpStat.planCost = laborCost*bpStat.planLabor\r\n          else bpStat.planCost = undefined\r\n        if (autoPlanRevenue !== false)\r\n          if (op.laborPrice && op.dealLabor)\r\n            bpStat.planRevenue = op.laborPrice*op.dealLabor\r\n          else bpStat.planRevenue = undefined\r\n        for (let key of ['planCost', 'planLabor', 'planRevenue']) {\r\n          if (bpStat[key]) batchAutoStat[key] += bpStat[key]\r\n        }\r\n      }\r\n    }\r\n    for (const { op, proc } of draft.elements) {\r\n      if (op)\r\n        evalOp(op, batchAutoStat)\r\n      if (proc)\r\n        for (let op of proc.ops) evalOp(op, batchAutoStat)\r\n    }\r\n    if (!draft.bpStat) draft.bpStat = batchAutoStat\r\n    else\r\n      for (let key of ['autoPlanCost', 'autoPlanLabor', 'autoPlanRevenue']) {\r\n        if (draft.bpStat[key] !== false)\r\n          draft.bpStat['p'+key.slice(5)] = batchAutoStat['p'+key.slice(5)]\r\n      }\r\n  })\r\n  return <Container>\r\n    <Div\r\n      d='flex'\r\n      bb='1px solid rgba(34, 36, 38, 0.15)'\r\n    >\r\n      <TitleContainer>\r\n        <Model\r\n          batch={batch}\r\n          deal={deal}\r\n          model={model}\r\n          upsertDeal={upsertDeal}\r\n        />\r\n        <ContolsContainer>\r\n          <Icon\r\n            link\r\n            name='trash'\r\n            color='grey'\r\n            activeColor='red'\r\n            onClick={() => {\r\n              let modifierArr = [ `batches[id=${id}]`, {} ]\r\n              batches\r\n                .filter(b => b.id !== id)\r\n                .forEach((b, i) => {\r\n                  modifierArr = [...modifierArr, `batches[id=${b.id}]`, { sort: i }]\r\n                })\r\n              upsertDeal(modifierArr)\r\n            }}\r\n          />\r\n        </ContolsContainer>\r\n      </TitleContainer>\r\n      <Div\r\n        w='50px'\r\n      >\r\n        <Qty\r\n          deal={deal}\r\n          batch={batch}\r\n          upsertDeal={upsertDeal}\r\n        />\r\n      </Div>\r\n      <BpStat\r\n        bpStat={bpStat}\r\n        upsertParent={upsertBatch}\r\n        budgetMode={budgetMode}\r\n      />\r\n    </Div>\r\n    <Div\r\n      pl='19px'\r\n      bl='1px solid rgba(34, 36, 38, 0.15)'\r\n    >\r\n      <Elements\r\n        batch={batch}\r\n        elements={elements}\r\n        upsertBatch={upsertBatch}\r\n        modelId={model.id}\r\n        budgetMode={budgetMode}\r\n      />\r\n    </Div>\r\n  </Container>\r\n})","import React from 'react'\r\nimport cuid from 'cuid'\r\nimport {\r\n  sortableContainer,\r\n  sortableElement,\r\n  sortableHandle,\r\n} from 'react-sortable-hoc'\r\nimport styled from 'styled-components'\r\nimport Batch from'./Batch'\r\nimport Model from './Model'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport useUpsert from '../../hooks/useUpsert'\r\n\r\nconst SortableItemContainer = styled(Div)`\r\n  :hover {\r\n    .dragHandle {\r\n      opacity: 1 !important;\r\n    }\r\n  }\r\n`\r\n\r\nconst SortableContainer = sortableContainer(({children}) => <div>{children}</div>)\r\n\r\nconst DragHandle = sortableHandle(() =>\r\n  <Div\r\n    className='dragHandle'\r\n    w='32px'\r\n    ml='-32px'\r\n    o='0'\r\n    c='rgba(0,0,0,.6)'\r\n    fw='bold'\r\n    ta='center'\r\n    lh='initial'\r\n    cur='move'\r\n    tr='opacity 0.25s ease-in-out'\r\n  >::</Div>\r\n)\r\n\r\nconst SortableBatch = sortableElement(props => (\r\n  <SortableItemContainer\r\n    d='flex'\r\n    z='99'\r\n  >\r\n    <DragHandle />\r\n    <Batch {...props} />\r\n  </SortableItemContainer>\r\n))\r\n\r\nexport default function Batches ({\r\n  deal\r\n}) {\r\n  const { batches } = deal\r\n  const [ upsertDeal ] = useUpsert('deal', deal)\r\n  return <>\r\n    <SortableContainer\r\n      onSortEnd={({oldIndex, newIndex}) => {\r\n        if (oldIndex === newIndex) return\r\n        upsertDeal([\r\n          `batches[id=${batches[oldIndex].id}]`, { sort: newIndex },\r\n          `batches[id=${batches[newIndex].id}]`, { sort: oldIndex }\r\n        ])\r\n      }}\r\n      useDragHandle\r\n    >\r\n      {deal.batches\r\n        .map((batch, index) =>\r\n          <SortableBatch\r\n            key={batch.id}\r\n            index={index}\r\n            deal={deal}\r\n            batch={batch}\r\n            upsertDeal={upsertDeal}\r\n          />)\r\n      }\r\n    </SortableContainer>\r\n    <Model\r\n      key={cuid()}\r\n      batch={{isNew: true}}\r\n      deal={deal}\r\n      upsertDeal={upsertDeal}\r\n    />\r\n  </>\r\n}","import React, { useContext } from 'react'\r\nimport DiskContext from '../../context/DiskContext'\r\nimport styled from 'styled-components'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport { DropdownMenu } from './DropdownMenu'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  position: relative;\r\n  :not(:last-child) {\r\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\r\n\t}\r\n`\r\n\r\nconst Title = styled(Div)`\r\n  ${Container}:hover & {\r\n    width: 150px;\r\n  }\r\n`\r\n\r\nconst Menu = styled.div`\r\n  display: none;\r\n  margin-left: auto;\r\n  ${Container}:hover & {\r\n    display: unset;\r\n  }\r\n`\r\n\r\nexport default ({\r\n  deal: { id: dealId, amoId, name }\r\n}) => {\r\n  const { highlightFolder } = useContext(DiskContext)\r\n  return <Container>\r\n    <Title\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      fw='bold'\r\n    >\r\n      {name}\r\n    </Title>\r\n    <Menu>\r\n      <DropdownMenu>\r\n        <Dropdown.Header>\r\n          <a\r\n            target=\"_blank\" rel=\"noopener noreferrer\" \r\n            href={`https://kolomnatutamailcom.amocrm.ru/leads/detail/${amoId}`}\r\n          >AmoCRM</a>\r\n        </Dropdown.Header>\r\n        <Dropdown.Divider />\r\n        <Dropdown.Item\r\n          icon='folder'\r\n          text='Обнаружить папку'\r\n          onClick={() => highlightFolder({ dealId })}\r\n        />\r\n      </DropdownMenu>\r\n    </Menu>\r\n  </Container>\r\n}\r\n","import React, { useContext } from 'react'\r\n\r\nimport DetailsContext from '../Details/Provider'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\nimport Org from './TableCells/Org'\r\nimport Batches from './TableCells/Batches'\r\nimport Deal from './TableCells/Deal'\r\nimport BpStat from './TableCells/BpStat/BpStat';\r\nimport useTraceUpdate from '../hooks/useTraceUpdate';\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n  line-height: 1.5em;\r\n  :hover {\r\n    background: rgba(0,0,0,.025);\r\n    color: rgba(0,0,0,.95);\r\n  }\r\n`\r\n\r\nexport default React.memo(function Row (props) {\r\n  useTraceUpdate(props)\r\n  const {\r\n    isFirstRow,\r\n    deal,\r\n    budgetMode,\r\n  } = props\r\n  const { amoId, date, batches, status } = deal\r\n  const { setDetails } = useContext(DetailsContext)\r\n  return <Container>\r\n    <Div\r\n      // w='100%'\r\n      w='max-content'\r\n      pos='relative'\r\n      pe='auto'\r\n    >\r\n      <Div //Header\r\n        d='flex'\r\n        bt={isFirstRow ? undefined : '1px solid rgb(125,125,126)'}\r\n        w='max-content'\r\n        pe='auto'\r\n      >\r\n        <Div //Status\r\n          w='22px'\r\n          m='5px'\r\n          bs='border-box'\r\n          bc={status.color}\r\n        />\r\n        <Div //Deal ID\r\n          w='80px'\r\n        >\r\n          {amoId}\r\n        </Div>\r\n        <Div //Deal date\r\n          w='90px'\r\n        >\r\n          {date}\r\n        </Div>\r\n        <Div //Deal name\r\n          w='170px'\r\n          whs='nowrap'\r\n          to='ellipsis'\r\n          pos='relative'\r\n        >\r\n          <Deal\r\n            deal={deal}\r\n            setDetails={setDetails}\r\n          />\r\n        </Div>\r\n        <Div //Counteragent\r\n          w='111px'\r\n        >\r\n          {deal.org &&\r\n            <Org\r\n              dealId={deal.id}\r\n              org={deal.org}\r\n              setDetails={setDetails}\r\n            />\r\n          }\r\n        </Div>\r\n        {!!batches.length\r\n          ? <BpStat\r\n              budgetMode={budgetMode}\r\n              hideLaborCell\r\n            />\r\n          : <Div w='680px' />\r\n        }\r\n      </Div>\r\n      <Div\r\n        pos={!batches.length ? 'absolute' : undefined}\r\n        t={!batches.length ? '0' : undefined}\r\n        l={!batches.length ? '482px' : undefined}\r\n        w={!batches.length ? '260px' : undefined}\r\n        pl={!batches.length ? '5px' : '32px'}\r\n        bt={batches.length ? '1px solid rgba(34,36,38,0.35)' : undefined}\r\n      >\r\n        <Batches\r\n          deal={deal}\r\n        />\r\n      </Div>\r\n      {/* <Els\r\n      /> */}\r\n    </Div>\r\n  </Container>\r\n})\r\n","// https://stackoverflow.com/questions/41004631/trace-why-a-react-component-is-re-rendering\r\nimport { useRef, useEffect } from 'react'\r\n\r\n\r\nexport default function useTraceUpdate(props) {\r\n  const prev = useRef(props);\r\n  useEffect(() => {\r\n    const changedProps = Object.entries(props).reduce((ps, [k, v]) => {\r\n      if (prev.current[k] !== v) {\r\n        ps[k] = [prev.current[k], v];\r\n      }\r\n      return ps;\r\n    }, {});\r\n    if (Object.keys(changedProps).length > 0) {\r\n      console.log('Changed props:', changedProps);\r\n    }\r\n    prev.current = props;\r\n  });\r\n}","import React, { useContext } from 'react'\r\n\r\nimport { Div } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\nimport Row from './Row'\r\nimport { DealsContext } from './context/Context';\r\n\r\nconst TableHeader = styled(Div)`\r\n  position: fixed;\r\n  display: flex;\r\n  /* width: 542px; */\r\n  padding: 0 0 0 32px;\r\n  line-height: 1.5em;\r\n  font-weight: bold;\r\n  background: rgb(233, 234, 235);\r\n  border-top: 1px solid #d4d4d5;\r\n  border-bottom: 1px solid #d4d4d5;\r\n  pointer-events: auto;\r\n  z-index: 15;\r\n  transition: width .5s ease;\r\n`\r\n\r\nconst Background = styled(Div)`\r\n  position: fixed;\r\n  height: 100%;\r\n  background: white;\r\n  z-index: -1;\r\n  transition: width .5s ease;\r\n`\r\n\r\nexport default function DealsTable ({\r\n  deals,\r\n}) {\r\n  const { budgetMode } = useContext(DealsContext)\r\n  return <Div\r\n    pos='absolute'\r\n    // t='23px'\r\n    w='100%'\r\n    // h='calc(100% - 23px)'\r\n    h='100%'\r\n    pe='none'\r\n    z='10'\r\n  >\r\n    <TableHeader\r\n      // w={budgetMode ? '1142px' : '542px'}\r\n      w={budgetMode ? '1142px' : '472px'}\r\n    >\r\n      <Div w='80px'>#</Div>\r\n      <Div w='90px'>Дата</Div>\r\n      <Div w='170px'>Наименование</Div>\r\n      <Div w='100px'>Контрагент</Div>\r\n    </TableHeader>\r\n    <Background\r\n      w={budgetMode ? '1142px' : '372px'}\r\n    />\r\n    <Div\r\n      h='calc(100% - 23px)'\r\n      // h='100%'\r\n      mt='23px'\r\n      // oy='scroll'\r\n    >\r\n      {deals && deals.map((deal, i) =>\r\n        <Row\r\n          key={deal.id}\r\n          isFirstRow={i === 0}\r\n          deal={deal}\r\n          budgetMode={budgetMode}\r\n        />\r\n      )}\r\n      <Div\r\n        h='400px'\r\n        w='472px'\r\n        bc='white'\r\n      />\r\n    </Div>\r\n  </Div>\r\n}\r\n","import React from 'react'\r\nimport { syncDeals as sD } from '../../graphql/deal'\r\nimport { Button, Icon } from '../styled/styled-semantic'\r\nimport Menu from '../Menu'\r\nimport { useMutation } from '../hooks/apolloHooks';\r\n\r\nexport default function DealsMenu ({\r\n  title,\r\n  titleLinkTo,\r\n\trefetchDeals,\r\n\tbudgetMode,\r\n\tsetBudgetMode\r\n}) {\r\n\tconst [syncDeals, { loading }] = useMutation(sD, {\r\n\t\tsuccessMsg: 'Сделки синхронизированы с AmoCRM',\r\n\t\terrMsg: 'Ошибка синхронизации сделок с AmoCRM'\r\n\t})\r\n  return <Menu\r\n\t\ttitle={title}\r\n\t\ttitleLinkTo={titleLinkTo}\r\n\t>\r\n\t\t<Icon\r\n\t\t\tlink\r\n\t\t\tname='ruble sign'\r\n\t\t\tsize='large'\r\n\t\t\tmr='9px'\r\n\t\t\tactiveColor='green'\r\n\t\t\tactive={budgetMode}\r\n\t\t\tonClick={() => setBudgetMode(!budgetMode)}\r\n\t\t/>\r\n\t\t<Button compact circular menu\r\n\t\t\tw='170px'\r\n\t\t\tml='0'\r\n\t\t\tta='left'\r\n\t\t\tactiveColor='blue' \r\n\t\t\tonClick={async () => {\r\n\t\t\t\tawait syncDeals()\r\n\t\t\t\trefetchDeals()\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<Icon\r\n\t\t\t\tname='refresh'\r\n\t\t\t\tcolor={loading ? 'blue' : undefined} \r\n\t\t\t\tloading={loading}\r\n\t\t\t/>\r\n\t\t\t{loading ? 'Загрузка..' : 'Сделки AmoCRM'}\r\n\t\t</Button>\r\n\t</Menu>\r\n}\r\n\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nconst Container = styled(Div)`\r\n  position: fixed;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: linear-gradient(135deg,rgba(0,0,0,.01) 0%,rgba(200,201,202,1) 100%);\r\n  box-shadow: inset 0 0 20px rgba(34,36,38,.15);\r\n  z-index: -1;\r\n  transition: all 0.5s ease;\r\n`\r\n\r\nexport default function Timeline ({\r\n  budgetMode\r\n}) {\r\n  return <Container\r\n    l={budgetMode ? '1142px' : '472px'}\r\n    onClick={()=>console.log('container here!')}\r\n  >\r\n  </Container>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n  height: 23px;\r\n  background: rgb(233, 234, 235);\r\n  border-top: 1px solid #d4d4d5;\r\n  border-bottom: 1px solid #d4d4d5;\r\n`\r\n\r\nexport default function Header ({\r\n  days\r\n}) {\r\n  return <Container\r\n    onClick={()=>console.log('plotHeader here!')}\r\n  >\r\n    {days.map(({ key, day }) =>\r\n      <Div\r\n        key={key}\r\n        w='48px'\r\n        c='rgba(0,0,0,.6)'\r\n        ta='center'\r\n      >\r\n        {day}\r\n      </Div>\r\n    )}\r\n  </Container>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport posed from 'react-pose'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport Header from './Header'\r\n\r\nconst Window = styled(Div)`\r\n  position: fixed;\r\n  left: 472px;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  z-index: 5;\r\n`\r\n\r\nconst Container = styled(posed.div({\r\n  draggable: 'x'\r\n}))`\r\n  position: absolute;\r\n  left: -672px;\r\n  width: 2016px;\r\n  height: calc(100% - 36px);\r\n`\r\n\r\nexport default function TimelinePlot ({\r\n  budgetMode\r\n}) {\r\n  const startDate = new Date(new Date().setDate(new Date().getDate() - 18))\r\n  const currentHalfHour = Math.floor((Date.now() - startDate.setHours(0,0,0,0))/(30*60000))\r\n  let days = []\r\n  for (\r\n    let d = new Date(startDate), i = 0;\r\n    i < 42;\r\n    d.setDate(d.getDate() + 1), i++\r\n  ) {\r\n    days.push({\r\n      key: i,\r\n      day: d.getDate(),\r\n      isWeekend: [6, 0].includes(d.getDay())\r\n      // isWeekend: d.getDay()\r\n    })\r\n  }\r\n  return <Window>\r\n    <Container\r\n      onClick={()=>console.log('plot here!')}\r\n    >\r\n      <Header\r\n        days={days}\r\n      />\r\n      {days\r\n        .filter(d => d.isWeekend)\r\n        .map(({ key }) =>\r\n          <Div\r\n            key={key}\r\n            pos='absolute'\r\n            t='0'\r\n            l={`${key*48}px`}\r\n            w='48px'\r\n            h='100%'\r\n            bc='rgba(0,0,0,.07)'\r\n          />\r\n      )}\r\n      <Div\r\n        pos='absolute'\r\n        t='0'\r\n        l={`${currentHalfHour}px`}\r\n        w='1px'\r\n        h='100%'\r\n        bc='teal'\r\n      />\r\n    </Container>\r\n  </Window>\r\n}","import React, { useState } from 'react'\r\nimport { Query, Mutation } from 'react-apollo'\r\nimport { dealsPage, upsertDeal } from '../../graphql/deal'\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\nimport { DealsContextProvider } from './context/Context'\r\nimport { DetailsProvider } from '../Details/Provider'\r\n\r\nimport DealsTable from './Table'\r\nimport Menu from './Menu'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport Timeline from './Timeline/Timeline'\r\nimport TimelinePlot from './Timeline/Plot/Plot'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport { useQuery } from '../hooks/apolloHooks'\r\n\r\nconst Container = styled.div`\r\n  position: relative;\r\n  /* top: calc(36px); */\r\n  /* top: calc(36px + 23px); */\r\n  width: 100%;\r\n  height: calc(100% - 36px);\r\n  /* height: calc(100% - 36px - 23px); */\r\n  overflow-x: hidden;\r\n  overflow-y: scroll;\r\n  /* z-index: 1; */\r\n`\r\n\r\nconst HeaderBlinder = styled(Div)`\r\n  position: fixed;\r\n  height: 23px;\r\n  overflow: hidden;\r\n  z-index: 20;\r\n  background: rgb(233,234,235);\r\n  border-top: 1px solid #d4d4d5;\r\n  border-bottom: 1px solid #d4d4d5;\r\n  transition: width .5s ease;\r\n`\r\n\r\nexport default function DealsPage () {\r\n  const [ budgetMode, setBudgetMode ] = useState(true)\r\n  const { loading, error, data, refetch } = useQuery(dealsPage)\r\n  return <>\r\n    <Menu\r\n      title='Сделки'\r\n      titleLinkTo='/deals'\r\n      refetchDeals={refetch}\r\n      budgetMode={budgetMode}\r\n      setBudgetMode={setBudgetMode}\r\n    />\r\n    <DetailsProvider>\r\n      <Container>\r\n        {!loading\r\n          ? !error\r\n            ? data && \r\n              <DealsContextProvider\r\n                opTypes={data.opTypes}\r\n                budgetMode={budgetMode}\r\n              >\r\n                <Timeline\r\n                  budgetMode={budgetMode}\r\n                />\r\n                <TimelinePlot\r\n                  budgetMode={budgetMode}\r\n                />\r\n                {/* <HeaderBlinder\r\n                  w={budgetMode ? '1142px' : '472px'}\r\n                /> */}\r\n                <DealsTable\r\n                  deals={data.deals}\r\n                />\r\n              </DealsContextProvider>\r\n            : `Ошибка ${error.message}`\r\n          : <Dimmer\r\n              active\r\n            >\r\n              <Loader>\r\n                Загрузка..\r\n              </Loader>\r\n            </Dimmer>\r\n        }\r\n      </Container>\r\n    </DetailsProvider>\r\n  </>\r\n}\r\n\r\n","import React, { useContext } from 'react'\r\nimport { HashRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\r\n\r\nimport { useQuery } from './hooks/apolloHooks'\r\nimport { me as meQuery } from '../graphql/user'\r\nimport AuthContext from './auth/AuthContext'\r\nimport UserContext from './context/UserContext'\r\n\r\nimport EnquiriesPage from './Enquiry/EnquiriesPage'\r\nimport PaymentsPage from './Payments/Page'\r\nimport DealsPage from './Deals/Page'\r\n\r\nexport default function Root () {\r\n\tconst { refreshToken } = useContext(AuthContext)\r\n\tconst { data, loading, error } = useQuery(meQuery)\r\n\tif (!loading && !error && !data) refreshToken(null)\r\n\tconst me = data && data.me\r\n\treturn <>\r\n\t\t{!error && loading || !me ? 'Загрузка..' :\r\n\t\t\t<UserContext.Provider\r\n\t\t\t\tvalue={{ me }}\r\n\t\t\t>\r\n\t\t\t\t<Router>\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\texact\r\n\t\t\t\t\t\t\tpath=\"/\"\r\n\t\t\t\t\t\t\tcomponent={EnquiriesPage}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\tpath=\"/pay\"\r\n\t\t\t\t\t\t\tcomponent={PaymentsPage}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\tpath=\"/deals\"\r\n\t\t\t\t\t\t\tcomponent={DealsPage}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Redirect to=\"/\" />\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</Router>\r\n\t\t\t</UserContext.Provider>\r\n\t\t}\r\n\t</>\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport 'semantic-ui-css/semantic.min.css'\r\nimport 'react-vis/dist/style.css'\r\nimport * as serviceWorker from './serviceWorker'\r\nimport App from './App'\r\n\r\nReactDOM.render( <App/>, document.getElementById('root'))\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register()  below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n","import React from 'react'\r\nimport { ApolloProvider } from '@apollo/react-hooks'\r\nimport { client } from './apollo/apollo'\r\n\r\nimport { ThemeProvider } from 'styled-components'\r\nimport { theme } from './components/styled/styled-semantic'\r\n\r\nimport { NotificationsProvider } from './components/notifications/NotificationsContext'\r\nimport { DiskProvider } from './components/context/DiskContext'\r\nimport { AuthProvider } from './components/auth/AuthContext'\r\nimport Root from './components/Root'\r\n\r\nexport default function App () {\r\n\treturn (\r\n\t\t<ApolloProvider client={client}>\r\n\t\t\t<NotificationsProvider>\r\n\t\t\t\t<ThemeProvider theme={theme}>\r\n\t\t\t\t\t<DiskProvider>\r\n\t\t\t\t\t\t<AuthProvider apolloClient={client}>\r\n\t\t\t\t\t\t\t<Root />\r\n\t\t\t\t\t\t</AuthProvider>\r\n\t\t\t\t\t</DiskProvider>\r\n\t\t\t\t</ThemeProvider>\r\n\t\t\t</NotificationsProvider>\r\n\t\t</ApolloProvider>\r\n\t)\r\n}\r\n"],"sourceRoot":""}