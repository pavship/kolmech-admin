(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{467:function(t,e,n){t.exports=n(883)},883:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(46),o=n.n(i);n(472),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(10),l=n(19),u=n(408),s=n(418),d=n(33),m=n(453),f=n(414),p=n(903),b="kolmech-token",g={newEnquiry:{__typename:"Enquiry",id:"new"},layout:{__typename:"Layout",details:null,extra:null,bottomPanel:null},lists:{__typename:"Lists",selectedProdIds:[]}},h=n(3),v=n(11),y=n.n(v);function E(){var t=Object(h.a)(["\n\tmutation SetExpanded($args: json) {\n\t\tsetExpanded(args: $args) @client {\n\t\t\targs\n\t\t}\n\t}\n"]);return E=function(){return t},t}function O(){var t=Object(h.a)(["\n\tmutation SetLayout($input: json) {\n\t\tsetLayout(input: $input) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return O=function(){return t},t}function j(){var t=Object(h.a)(["\n\tquery getLayout {\n\t\tlayout @client {\n\t\t\tdetails\n\t\t\textra\n\t\t\tbottomPanel\n\t\t}\n\t}\n"]);return j=function(){return t},t}var x=y()(j()),w={props:function(t){return{layout:t.data.layout||{}}}},k=y()(O()),q=y()(E());function C(){var t=Object(h.a)(["\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return C=function(){return t},t}function F(){var t=Object(h.a)(["\n\tquery OrderDetails ($id: ID!) {\n\t\torder (id: $id) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return F=function(){return t},t}function I(){var t=Object(h.a)(["\n\tquery OrderLocal ($id: ID!) {\n\t\torderLocal (id: $id) {\n\t\t\tid\n\t\t\tfullnum\n\t\t\tdateLocal\n\t\t\tqty\n\t\t\tamount\n\t\t}\n\t}\n"]);return I=function(){return t},t}function S(){var t=Object(h.a)(["\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\n\t\t\t...OrderFragmentBasic\n\t\t\tenquiry {\n\t\t\t\tid\n\t\t\t}\n\t\t\tprods {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return S=function(){return t},t}function D(){var t=Object(h.a)(["\n\tfragment OrderFragmentFull on Order {\n\t\t...OrderFragmentBasic\n\t\thtmlNote\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tprods {\n\t\t\tid\n\t\t\tfullnumber,\n\t\t\thasDefect,\n\t\t\tisSpoiled,\n\t\t\tprogress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return D=function(){return t},t}function M(){var t=Object(h.a)(["\n\tfragment OrderFragmentBasic on Order {\n\t\tid\n\t\tfullnum\n\t\tdateLocal\n\t\tqty\n\t\tamount\n\t}\n"]);return M=function(){return t},t}var L=y()(M()),N=y()(D(),L),P=y()(S(),L),B=y()(I()),$=y()(F(),N),A=y()(C(),N);function z(){var t=Object(h.a)(["\n\tfragment DocFragmentBasic on Doc {\n\t\tid\n\t\ttype\n\t\tdateLocal\n\t\tamount\n\t}\n"]);return z=function(){return t},t}var T=y()(z());function R(){var t=Object(h.a)(["\n\tfragment StatusFragment on Status {\n\t\tid\n    name\n    stage\n\t}\n"]);return R=function(){return t},t}var Q=y()(R());function V(){var t=Object(h.a)(["\n\tfragment FileFragmentFull on File {\n\t\tid\n\t\tpath\n\t\tsize\n\t\tfilename\n\t\tmimetype\n\t\twidth\n\t\theight\n\t\timgFor\n\t}\n"]);return V=function(){return t},t}var H=y()(V());function U(){var t=Object(h.a)(["\n\tmutation SetDrawingsSortOrder( $ids: [ID!]! ) {\n\t\tsetDrawingsSortOrder(ids: $ids) { count }\n\t}\n"]);return U=function(){return t},t}function _(){var t=Object(h.a)(["\n\tmutation DeleteDrawings( $ids: [ID!]! ) {\n\t\tdeleteDrawings(ids: $ids) { count }\n\t}\n"]);return _=function(){return t},t}function W(){var t=Object(h.a)(["\n\tmutation CreateDrawings(\n\t\t$modelId: ID!\n\t\t$files: [Upload!]!\n\t) {\n\t\tcreateDrawings(\n\t\t\tmodelId: $modelId\n\t\t\tfiles: $files\n\t\t) {\n\t\t\t...DrawingFragmentFull\n\t\t}\n\t}\n\t","\n"]);return W=function(){return t},t}function K(){var t=Object(h.a)(["\n\tfragment DrawingFragmentFull on Drawing {\n\t\t...DrawingFragmentBasic\n\t\tfiles { ...FileFragmentFull }\n\t}\n\t","\n\t","\n"]);return K=function(){return t},t}function G(){var t=Object(h.a)(["\n\tfragment DrawingFragmentBasic on Drawing {\n\t\tid\n\t\tsortOrder\n\t}\n"]);return G=function(){return t},t}var J=y()(G()),X=y()(K(),J,H),Y=y()(W(),X),Z=y()(_()),tt=y()(U());function et(){var t=Object(h.a)(["\n\tmutation UpsertModel(\n\t\t$input: ModelInput!\n\t) {\n\t\tupsertModel(\n\t\t\tinput: $input\n\t\t) {\n\t\t\tid\n\t\t}\n\t}\n"]);return et=function(){return t},t}function nt(){var t=Object(h.a)(["\n\tquery ModelDetails ($id: ID!) {\n\t\tmodel (id: $id) {\n\t\t\t...ModelFragmentFull\n\t\t}\n\t}\n\t","\n"]);return nt=function(){return t},t}function rt(){var t=Object(h.a)(["\n\tquery ModelLocal ($id: ID!) {\n\t\tmodelLocal (id: $id) {\n\t\t\t...ModelFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return rt=function(){return t},t}function at(){var t=Object(h.a)(["\n\tfragment ModelFragmentFull on Model {\n\t\t...ModelFragmentBasic\n\t\tdrawings { ...DrawingFragmentFull }\n\t}\n\t","\n\t","\n"]);return at=function(){return t},t}function it(){var t=Object(h.a)(["\n\tfragment ModelFragmentWithDrawings on Model {\n\t\t...ModelFragmentBasic\n\t\tdrawings { ...DrawingFragmentBasic }\n\t}\n\t","\n\t","\n"]);return it=function(){return t},t}function ot(){var t=Object(h.a)(["\n\tfragment ModelFragmentBasic on Model {\n\t\tid\n\t\tname\n\t\tarticle\n\t}\n"]);return ot=function(){return t},t}var ct=y()(ot()),lt=y()(it(),ct,J),ut=y()(at(),ct,X),st=y()(rt(),ct),dt=y()(nt(),ut),mt=y()(et());function ft(){var t=Object(h.a)(["\n\tfragment myEnquiry on Enquiry {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t\thtmlNote\n\t\tisExpanded\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel { ...ModelFragmentBasic }\n\t\tqty\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return ft=function(){return t},t}function pt(){var t=Object(h.a)(["\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdoc { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n"]);return pt=function(){return t},t}function bt(){var t=Object(h.a)(["\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\n\t\tupdateEnquiry(input: $input) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return bt=function(){return t},t}function gt(){var t=Object(h.a)(["\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t\torders {\n\t\t\t\tid\n\t\t\t\tfullnum\n\t\t\t\tdateLocal\n\t\t\t\tqty\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return gt=function(){return t},t}function ht(){var t=Object(h.a)(["\n\tquery {\n\t\tnewEnquiry @client {\n\t\t\tid\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n"]);return ht=function(){return t},t}function vt(){var t=Object(h.a)(["\n\tquery EnquiryLocal ($id: ID!) {\n\t\tenquiryLocal (id: $id) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n"]);return vt=function(){return t},t}function yt(){var t=Object(h.a)(["\n\tquery EnquiryDetails ($id: ID!) {\n\t\tenquiry (id: $id) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentBasic }\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return yt=function(){return t},t}function Et(){var t=Object(h.a)(["\n\tquery AllEnquiries {\n\t\tenquiries {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\temployees {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\torders {\n\t\t\t\t...OrderFragmentBasic\n\t\t\t\tprods {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t\tisExpanded @client\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return Et=function(){return t},t}function Ot(){var t=Object(h.a)(["\n\tfragment EnquiryFragmentBasic on Enquiry {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t}\n"]);return Ot=function(){return t},t}var jt=y()(Ot()),xt=y()(Et(),jt,lt,L,T,Q),wt=y()(yt(),jt,ct,T,Q),kt=y()(vt(),jt,T),qt=y()(ht()),Ct=y()(gt(),jt,lt,T,Q),Ft=y()(bt(),jt,lt,T,Q),It=y()(pt(),T,Q),St=y()(ft(),ct);function Dt(){var t=Object(h.a)(["\n\tmutation SetList($name: String!, $value: [ID!]) {\n\t\tsetList(name: $name, value: $value) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return Dt=function(){return t},t}function Mt(){var t=Object(h.a)(["\n\tquery getLists {\n\t\tlists @client {\n\t\t\tselectedProdIds\n\t\t}\n\t}\n"]);return Mt=function(){return t},t}var Lt=y()(Mt()),Nt=y()(Dt()),Pt=n(267),Bt={Enquiry:{isExpanded:function(){return!1}},Mutation:{setLayout:function(t,e,n){var r=e.input,a=n.cache,i=x,o=a.readQuery({query:i});return o.layout=Object(l.a)({},o.layout,Object(Pt.a)(r)),a.writeQuery({query:i,data:o}),null},setExpanded:function(t,e,n){var r=e.args,a=r.id,i=r.value,o=n.cache,c=xt,l=o.readQuery({query:c});return l.enquiries.find(function(t){return t.id===a}).isExpanded=i,o.writeQuery({query:c,data:l}),null},setList:function(t,e,n){var r=e.name,a=e.value,i=n.cache,o=Lt,c=i.readQuery({query:o});return c.lists[r]=a,i.writeQuery({query:o,data:c}),null}}},$t=new p.a({dataIdFromObject:function(t){switch(t.__typename){case"NewEnquiry":return"NewEnquiry";default:return Object(p.b)(t)}},cacheRedirects:{Query:{orgLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Org",id:e.id})},enquiryLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Enquiry",id:e.id})},orderLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Order",id:e.id})},modelLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Model",id:e.id})},prodsLocal:function(t,e,n){var r=n.getCacheKey;return e.ids.map(function(t){return r({__typename:"Prod",id:t})})}}}}),At=new d.ApolloLink(function(t,e){var n=localStorage.getItem(b)||null;return t.setContext(function(t){var e=t.headers,r=void 0===e?{}:e;return{headers:Object(l.a)({},r,{Authorization:n?"Bearer ".concat(n):""})}}),e(t)}),zt=new u.a({link:d.ApolloLink.from([Object(f.a)(function(t){var e,n=t.graphQLErrors,r=t.networkError;n&&console.log("graphQLErrors!!! > ",n),r&&(console.log("networkError!!! > ",r),console.log("networkError.name > ",r.name),console.log("networkError.message > ",r.message),console.log("Unexpected token I in JSON at position 0"===r.message),"Unexpected token I in JSON at position 0"===r.message&&((e=null)?localStorage.setItem(b,e):(localStorage.removeItem(b),zt.resetStore())))}),At,Object(m.a)({defaults:g,resolvers:Bt,cache:$t}),Object(s.createUploadLink)({uri:"https://node62506-env-1542080.mircloud.ru:11268"})]),cache:$t}),Tt=n(9),Rt=n(419),Qt=n(31),Vt=n(914),Ht=n(411),Ut=n(908),_t=n(906),Wt=n(910),Kt=n(898),Gt=n(899),Jt=n(905),Xt=n(902);function Yt(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return Yt=function(){return t},t}function Zt(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return Zt=function(){return t},t}function te(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return te=function(){return t},t}function ee(){var t=Object(h.a)(["\n\t","\n\twidth: "," !important;\n\tmargin-right: 0 !important;\n"]);return ee=function(){return t},t}function ne(){var t=Object(h.a)(["\n\t&&& {\n\t\t","\n\t}\n"]);return ne=function(){return t},t}function re(){var t=Object(h.a)(["\n\twidth: 100%;\n\tpadding: 1em 1em 1em 55px;\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return re=function(){return t},t}function ae(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return ae=function(){return t},t}function ie(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t&.compact {\n\t\t\tpadding: .5rem 1rem;\n\t\t}\n\t\t","\n\t\t","\n\t}\n"]);return ie=function(){return t},t}function oe(){var t=Object(h.a)(["\n\ttransform: ",";\n\t&&& {\n\t\t","\n\t}\n"]);return oe=function(){return t},t}function ce(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return ce=function(){return t},t}function le(){var t=Object(h.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return le=function(){return t},t}function ue(){var t=Object(h.a)(["\n\tcursor: pointer;\n\t","\n"]);return ue=function(){return t},t}function se(){var t=Object(h.a)(["\n\t","\n"]);return se=function(){return t},t}function de(){var t=Object(h.a)(["\n\t","\n"]);return de=function(){return t},t}function me(){var t=Object(h.a)(["\n\t","\n\t","\n"]);return me=function(){return t},t}var fe={widths:{formLabel:"122px",detailsPL:"55px",extraSidebar:"250px"},colors:{green:"#016936",blue:"#0E6EB8",error:"#9f3a38",errorBorder:"#e0b4b4"}},pe=function(t){return fe.colors[t]||t},be=function(t){var e=t.theme,n=t.bt,r=t.bb,a=t.bc,i=t.bs,o=t.c,c=t.d,l=t.fs,u=t.fw,s=t.h,d=t.lh,m=t.mw,f=t.minw,p=t.m,b=t.mb,g=t.mt,h=t.ml,v=t.mr,y=t.o,E=t.ox,O=t.oy,j=t.p,x=t.pe,w=t.pl,k=t.pr,q=t.pt,C=t.ta,F=t.va,I=t.w,S=t.ws;return"\n\t\t".concat(n?"border-top: ".concat(n,";"):"","\n\t\t").concat(r?"border-bottom: ".concat(r,";"):"","\n\t\t").concat(a?"background-color: ".concat(a,";"):"","\n\t\t").concat(i?"box-sizing: ".concat(i,";"):"","\n\t\t").concat(o?"color: ".concat(o,";"):"","\n\t\t").concat(c?"display: ".concat(c,";"):"","\n\t\t").concat(l?"font-size: ".concat(l,";"):"","\n\t\t").concat(u?"font-weight: ".concat(u,";"):"","\n\t\t").concat(s?"height: ".concat(s,";"):"","\n\t\t").concat(d?"line-height: ".concat(d,";"):"","\n\t\t").concat(m?"max-width: ".concat(m,";"):"","\n\t\t").concat(f?"min-width: ".concat(f,";"):"","\n\t\t").concat(p?"margin: ".concat(p,";"):"","\n\t\t").concat(b?"margin-bottom: ".concat(b,";"):"","\n\t\t").concat(g?"margin-top: ".concat(g,";"):"","\n\t\t").concat(h?"margin-left: ".concat(h,";"):"","\n\t\t").concat(v?"margin-right: ".concat(v,";"):"","\n\t\t").concat(y?"opacity: ".concat(y,";"):"","\n\t\t").concat(E?"overflow-x: ".concat(E,";"):"","\n\t\t").concat(O?"overflow-y: ".concat(O,";"):"","\n\t\t").concat(j?"padding: ".concat(j,";"):"","\n\t\t").concat(w?"padding-left: ".concat(w,";"):"","\n\t\t").concat(x?"pointer-events: ".concat(x,";"):"","\n\t\t").concat(k?"padding-right: ".concat(k,";"):"","\n\t\t").concat(q?"padding-top: ".concat(q,";"):"","\n\t\t").concat(C?"text-align: ".concat(C,";"):"","\n\t\t").concat(F?"vertical-align: ".concat(F,";"):"","\n\t\t").concat(I?"width: ".concat(e.widths&&e.widths[I]||I,";"):"","\n\t\t").concat(S?"word-spacing: ".concat(S,";"):"","\n\t")},ge=Object(Tt.b)(function(t){t.ml,t.w,t.inline;var e=Object(Qt.a)(t,["ml","w","inline"]);return a.a.createElement("div",e)})(me(),function(t){return t.inline&&"display: inline-block;"},function(t){return be(t)}),he=Object(Tt.b)(function(t){var e=Object(Rt.a)({},t);return a.a.createElement("p",e)})(de(),function(t){return be(t)}),ve=Object(Tt.b)(function(t){t.ml;var e=Object(Qt.a)(t,["ml"]);return a.a.createElement("span",e)})(se(),function(t){return be(t)}),ye=Tt.b.a(ue(),function(t){return t.cancel&&"{\n\t\tpadding-left: 15px;\n\t\tcolor: rgba(0,0,0,.87);\n\t\t&:hover {\n\t\t\tcolor: #B03060;\n\t\t}\n\t}"}),Ee=Object(Tt.b)(function(t){t.inline,t.c;var e=Object(Qt.a)(t,["inline","c"]);return a.a.createElement(Vt.a,e)})(le(),function(t){return be(t)},function(t){return t.inline&&"{\n\t\t\tmargin: 0;\n\t\t\tpadding: 0 1rem;\n\t\t}"}),Oe=Object(Tt.b)(function(t){t.active,t.activeColor,t.selectMode;var e=Object(Qt.a)(t,["active","activeColor","selectMode"]);return a.a.createElement(Ht.a,e)})(ce(),function(t){return be(t)},function(t){return t.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t}")}),je=Object(Tt.b)(function(t){t.active,t.disabled;var e=Object(Qt.a)(t,["active","disabled"]);return a.a.createElement(Ht.a,Object.assign({},e,{name:"dropdown"}))})(oe(),function(t){return!t.active&&("large"===t.size?"translateX(0) translateY(0) rotate(-90deg) !important":"translateX(-3px) translateY(3px) rotate(-90deg) !important")},function(t){return t.disabled&&"{\n\t\t\tcolor: rgba(0,0,0,.6);\n\t\t}"}),xe=Object(Tt.b)(function(t){t.activeColor,t.menu;var e=Object(Qt.a)(t,["activeColor","menu"]);return a.a.createElement(Ut.a,e)})(ie(),function(t){return be(t)},function(t){return t.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(pe(t.activeColor)," !important;\n        \t}\n\t\t}")},function(t){return t.menu&&"{\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\n\t\t\tz-index: 3;\n\t\t}"}),we=Object(Tt.b)(function(t){t.section;var e=Object(Qt.a)(t,["section"]);return a.a.createElement(_t.a,e)})(ae(),function(t){return be(t)},function(t){return t.section&&"\n\t\t\tmargin-top: 0;\n\t\t\tpadding-left: ".concat(t.theme.widths.detailsPL,";\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\n\t\t\tborder-radius: 0;\n\t\t")}),ke=a.a.forwardRef(function(t,e){t.head,t.minor,t.small,t.secondary,t.noP,t.noLP,t.noIndent,t.topBorder,t.bottomBorder;var n=t.children,r=t.onClick,i=Object(Qt.a)(t,["head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","onClick"]);return a.a.createElement("div",Object.assign({ref:e},i,{onClick:r||void 0}),n)}),qe=Object(Tt.b)(ke)(re(),function(t){return be(t)},function(t){return t.head&&"{\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding-top: 0;\n\t\tpadding-bottom: 0;\n\t}"},function(t){return t.onClick&&"{\n\t\tcursor: pointer;\n\t}"},function(t){return t.minor&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return!t.size&&t.head&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return"small"===t.size&&"{\n\t\tmin-height: 2.5em;\n\t}"},function(t){return t.secondary&&"{\n\t\tbackground: #f3f4f5;\n\t\tcolor: rgba(0,0,0,.6);\n\t}"},function(t){return t.noLP&&"{\n\t\tpadding-left: 0;\n\t}"},function(t){return t.noIndent&&"{\n\t\tpadding-left: 1em;\n\t}"},function(t){return t.topBorder&&"{\n\t\tborder-top: 1px solid ".concat("dark"===t.topBorder?"rgba(152, 153, 154, 1)":"rgba(34,36,38,.15)",";\n\t}")},function(t){return t.bottomBorder&&"{\n\t\tborder-bottom: 1px solid ".concat("dark"===t.bottomBorder?"rgba(126, 127, 129, 1)":"rgba(34,36,38,.1)",";\n\t}")}),Ce=Object(Tt.b)(function(t){t.showIf;var e=Object(Qt.a)(t,["showIf"]);return a.a.createElement(Wt.a,e)})(ne(),function(t){return!t.showIf&&"{\n\t\t\topacity: 0;\n\t\t}"}),Fe=Tt.b.label(ee(),function(t){return be(t)},function(t){return t.theme.widths.formLabel}),Ie=a.a.forwardRef(function(t,e){t.w;var n=Object(Qt.a)(t,["w"]);return a.a.createElement(Kt.a,{innerRef:e},a.a.createElement(Gt.a,n))}),Se=Object(Tt.b)(Ie)(te(),function(t){return be(t)}),De=(Object(Tt.b)(Jt.a)(Zt(),function(t){return be(t)}),Object(Tt.b)(function(t){t.w;var e=Object(Qt.a)(t,["w"]);return a.a.createElement(Xt.a.Field,e)})(Yt(),function(t){return be(t)}),n(13)),Me=n(14),Le=n(16),Ne=n(15),Pe=n(17),Be=n(47),$e=n(436),Ae=n.n($e),ze=a.a.createContext(),Te=ze,Re=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={messages:[]},n.create=function(t){t.id=Ae()(),t.timerId=setTimeout(function(){n.dismiss(t.id)},5e3),n.setState(Object(Be.a)(function(e){e.messages.push(t)}))},n.dismiss=function(t){return n.setState(Object(Be.a)(function(e){e.messages=e.messages.filter(function(e){return e.id!==t})}))},n.cancelAutoDismiss=function(t){return n.setState(Object(Be.a)(function(e){var n=e.messages.find(function(e){return e.id===t});clearTimeout(n.timerId),delete n.timerId}))},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return a.a.createElement(ze.Provider,{value:{state:this.state,create:this.create,dismiss:this.dismiss,cancelAutoDismiss:this.cancelAutoDismiss}},this.props.children)}}]),e}(r.Component),Qe=function(t){var e=t.children;return a.a.createElement(ze.Consumer,null,function(t){var n=t.create;return a.a.createElement(Ve,{notify:n},e)})},Ve=a.a.memo(function(t){var e=t.notify;return(0,t.children)({notify:e})}),He=n(71),Ue=function(t){var e=t.message,n=e.id,r=e.type,i=e.title,o=e.content,c=e.timerId,l=t.dismissNotification,u=t.cancelAutoDismiss;return a.a.createElement(we,{m:"0 0 2rem 2rem",w:"unset",mw:"550px",pr:"4em",pe:"all",compact:!0,size:"large",icon:"error"===r?"exclamation":"warning"===r?"info":"success"===r?"check":void 0,header:i,content:o,error:"error"===r,info:"info"===r,success:"success"===r,warning:"warning"===r,onDismiss:c?void 0:function(){return l(n)},onMouseEnter:c?function(){return u(n)}:void 0})};function _e(){var t=Object(h.a)(["\n\tposition: fixed;\n  bottom: 0;\n\ttop: 0;\n\tleft: 0;\n  width: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-end;\n\tpointer-events: none;\n  z-index: 1;\n"]);return _e=function(){return t},t}var We=Tt.b.div(_e()),Ke=He.b.div({boobl:{y:200,opacity:0},enter:{y:0,opacity:1},exit:{x:-400,opacity:0}}),Ge=function(t){var e=t.messages,n=t.dismissNotification,r=t.cancelAutoDismiss;return o.a.createPortal(a.a.createElement(We,null,a.a.createElement(He.a,{animateOnMount:!0,preEnterPose:"boobl"},e.map(function(t){return a.a.createElement(Ke,{key:t.id,initialPose:"boobl"},a.a.createElement(Ue,{message:t,dismissNotification:n,cancelAutoDismiss:r}))}))),document.getElementById("kolmech-notifications"))},Je=function(){return a.a.createElement(Te.Consumer,null,function(t){var e=t.state.messages,n=t.dismiss,r=t.cancelAutoDismiss;return a.a.createElement(Ge,{messages:e,dismissNotification:n,cancelAutoDismiss:r})})},Xe=n(909),Ye=n(917),Ze=n(915),tn=n(911),en=n(437),nn=n.n(en);function rn(t){var e=function(t){var e=nn()(t);if(!e.exp)return null;var n=new Date(0);return n.setUTCSeconds(e.exp),n}(t);return null!==e&&!(e.valueOf()>(new Date).valueOf()+0)}function an(){var t=Object(h.a)(["\n\tmutation Login($email: String!, $password: String!) {\n\t\tlogin(email: $email, password: $password) {\n\t\t\ttoken\n\t\t}\n\t}\n"]);return an=function(){return t},t}function on(){var t=Object(h.a)(["\n\tquery MeLocal {\n\t\tme @client {\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return on=function(){return t},t}function cn(){var t=Object(h.a)(["\n\tquery Me {\n\t\tme {\n\t\t\tid\n\t\t\temail\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return cn=function(){return t},t}var ln=y()(cn()),un=y()(on()),sn=y()(an()),dn=n(26),mn=n.n(dn),fn=n(36),pn=n(74),bn=n(912);function gn(){var t=Object(h.a)(["\n\tmax-width: 350px !important;\n\tmargin: auto !important;\n"]);return gn=function(){return t},t}function hn(){var t=Object(h.a)(["\n\tdisplay: inline;\n\tpadding: 0 1rem !important;\n"]);return hn=function(){return t},t}function vn(){var t=Object(h.a)(["\n\tborder-bottom: 1px solid #7e7e81;\n\t// height: 35px;\n"]);return vn=function(){return t},t}var yn=Tt.b.div(vn()),En=Object(Tt.b)(Vt.a)(hn()),On=Object(Tt.b)(bn.a)(gn()),jn=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={email:"",password:"",sendingRequest:!1,error:""},n.handleInputChange=function(t){n.setState(Object(pn.a)({},t,n[t].value))},n.submit=Object(fn.a)(mn.a.mark(function t(){var e,r,a,i,o;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.state,r=e.email,a=e.password,n.setState({sendingRequest:!0}),t.next=5,n.props.login({variables:{email:r,password:a}});case 5:i=t.sent,o=i.data.login.token,n.setState({sendingRequest:!1}),n.props.refreshToken(o),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),n.setState({error:t.t0.message,sendingRequest:!1});case 14:case"end":return t.stop()}},t,this,[[0,11]])})),n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.email,i=e.password,o=e.sendingRequest,c=e.error;return a.a.createElement(r.Fragment,null,a.a.createElement(yn,null,a.a.createElement(En,{size:"large"},a.a.createElement("i",null,"\u041a\u043e\u043b\u043c\u0435\u0445"))),a.a.createElement(On,{basic:!0},a.a.createElement(Xt.a,{error:!!c},a.a.createElement(Xt.a.Field,null,a.a.createElement("label",null,"E-mail"),a.a.createElement("input",{type:"email",placeholder:"E-mail",ref:function(e){return t.email=e},onChange:function(){return t.handleInputChange("email")}})),a.a.createElement(Xt.a.Field,null,a.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),a.a.createElement("input",{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",ref:function(e){return t.password=e},onChange:function(){return t.handleInputChange("password")}})),a.a.createElement(_t.a,{error:!0,header:"\u0412\u043e\u0439\u0442\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:c}),a.a.createElement(Ut.a,{primary:!0,type:"submit",floated:"right",disabled:!n||!i||o,loading:o,onClick:this.submit},"\u0412\u043e\u0439\u0442\u0438"))))}}]),e}(r.Component),xn=Object(c.compose)(Object(c.graphql)(sn,{name:"login",options:{fetchPolicy:"no-cache"}}))(jn),wn=n(913),kn=Object(c.compose)(Object(c.graphql)(x,w),Object(c.graphql)(k,{name:"setLayout"}),Object(c.graphql)(q,{name:"setExpanded"}),Object(c.graphql)(Lt,{props:function(t){return{lists:t.data.lists||{}}}}),Object(c.graphql)(Nt,{name:"setList"}))(function(t){var e=t.children,n=t.layout,r=n.details,a=n.extra,i=n.bottomPanel,o=t.setLayout,c=t.setExpanded,l=t.lists.selectedProdIds,u=t.setList;return e({details:r,extra:a,bottomPanel:i,setDetails:function(t){return o({variables:{input:{details:t,extra:null}}})},setExtra:function(t){return o({variables:{input:{extra:t}}})},setBottomPanel:function(t){return o({variables:{input:{bottomPanel:t}}})},setExpanded:function(t){return c({variables:{args:t}})},selectedProdIds:l,setSelectedProdIds:function(t){return u({variables:{name:"selectedProdIds",value:t}})}})});function qn(){var t=Object(h.a)(["\n\talign-self: stretch;\n\tposition: relative;\n\tmargin-left: 10px;\n\tpadding: 0 1em;\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: #f5f6f7;\n\tborder-top-right-radius: .35rem;\n\tborder-bottom-right-radius: .35rem;\n\t::before {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tleft: 0;\n\t\tbackground-color: #fff;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\n\t}\n\t/* ::after {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tright: 0;\n\t\tbackground-color: #f3f4f5;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\n\t} */\n"]);return qn=function(){return t},t}var Cn=Tt.b.div(qn()),Fn=Object(c.compose)(Object(c.graphql)(k,{name:"setLayout"}),Object(c.graphql)(x,w))(function(){return a.a.createElement(kn,null,function(t){var e=t.details,n=e.type,r=e.id,i=e.enquiryId,o=t.setDetails;return a.a.createElement(c.Query,{query:kt,variables:{id:"Enquiry"===n?r:i}},function(t){var e=t.data;if(e&&e.enquiryLocal){var i=e.enquiryLocal,c=i.num,l=!i.docs.some(function(t){return"CO"===t.type});return a.a.createElement(Cn,null,a.a.createElement(Ee,{inline:!0,c:"rgba(0,0,0,.68)",size:"medium",content:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116".concat(c)}),a.a.createElement(Ce,{position:"bottom left",size:"small",flowing:!0,showIf:l,trigger:a.a.createElement(ge,{inline:!0},a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,ml:"0",activeColor:"green",icon:"plus",content:"\u0417\u0430\u043a\u0430\u0437",active:"Order"===n&&"new"===r,disabled:l,onClick:function(){return o({type:"Order",id:"new",enquiryId:r})}}))},a.a.createElement(Wt.a.Header,{content:"\u041d\u0435 \u0432\u0441\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b"}),a.a.createElement(Wt.a.Content,null,a.a.createElement(Ht.a,{name:"cancel",color:"red"}),"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f")))}return null})})});function In(){var t=Object(h.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tborder-bottom: 1px solid #7e7e81;\n"]);return In=function(){return t},t}var Sn=Tt.b.div(In()),Dn=function(t){var e=t.refetchEnquiries,n=t.enquiriesAreLoading,r=t.refreshToken;return a.a.createElement(kn,null,function(t){var i=t.details,o=t.setDetails;return a.a.createElement(Sn,null,a.a.createElement(Ee,{inline:!0,size:"medium",content:"\u0417\u0430\u044f\u0432\u043a\u0438 \u0438 \u0437\u0430\u043a\u0430\u0437\u044b"}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,w:"118.5px",ml:"0",ta:"left",activeColor:"blue",onClick:e},a.a.createElement(Ht.a,{name:"refresh",color:n?"blue":void 0,loading:n}),n?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",content:"\u0417\u0430\u044f\u0432\u043a\u0430",active:i&&"Enquiry"===i.type&&"new"===i.id,onClick:function(){return o({type:"Enquiry",id:"new"})}}),i&&("Enquiry"===i.type&&"new"!==i.id||"Order"===i.type&&"new"===i.id)&&a.a.createElement(Fn,null),a.a.createElement(c.Query,{query:un},function(t){var e=t.data;if(e&&e.me){var n=e.me.person,r=n.fName,i=n.lName,o=r+" "+(i?"".concat(i.slice(0,1),"."):"");return a.a.createElement(Ee,{inline:!0,ml:"auto",size:"small",content:o})}return null}),a.a.createElement(Ht.a,{link:!0,name:"log out",size:"large",onClick:function(){return r(null)}}))})},Mn=n(34);function Ln(){var t=Object(h.a)(["\n\t/* overflow-y: auto;\n  overflow-x: hidden; */\n"]);return Ln=function(){return t},t}function Nn(){var t=Object(h.a)(["\n\tpadding-right: 4px;\n\t// @ts-ignore\n\t","\n"]);return Nn=function(){return t},t}function Pn(){var t=Object(h.a)(["\n\tcolor: rgba(0,0,0,.8);\n\tline-height: 1.5em;\n\tbackground: rgb(233, 234, 235);\n\tborder-top: 1px solid #d4d4d5;\n\t/* "," */\n\tborder-bottom: 1px solid #d4d4d5;\n\tfont-weight: bold;\n"]);return Pn=function(){return t},t}function Bn(){var t=Object(h.a)(["\n\ttable-layout: fixed;\n\twidth: 100%;\n\tborder-collapse: collapse;\n\t/* TODO Make this table with scrollable tbody (Not trivial css trick) */\n\t/* thead, tbody, tr {\n\t\tdisplay: block;\n\t} */\n"]);return Bn=function(){return t},t}var $n=Tt.b.table(Bn()),An=Tt.b.tr(Pn(),function(t){return t.noTopBorder?"":"border-top: 1px solid #d4d4d5;"}),zn=Tt.b.td(Nn(),function(t){return t.w&&"width: ".concat(t.w,";")}),Tn=Tt.b.tbody(Ln()),Rn=function(t){var e=t.children,n=t.fields,i=t.indent,o=(t.noTopBorder,!!i),c=!!t.select,l=(t.expand,Object(Mn.a)(o?[{name:"indent",width:i}]:[]).concat([{name:"service",width:"28px"}],Object(Mn.a)(c?[{name:"select",width:"28px"}]:[]),Object(Mn.a)(n),[{name:"lastField"}]));return a.a.createElement($n,null,a.a.createElement("thead",null,a.a.createElement(An,{className:"fz-tableHeaderRow"},l.map(function(t){return a.a.createElement(zn,{key:t.name,w:t.width},t.title)}))),a.a.createElement(Tn,null,a.a.createElement(r.Fragment,null,e({tableFields:l.map(function(t){return{name:t.name,path:t.path}})}))))},Qn=n(438),Vn=function(t){var e=t.number;return"rus"===t.country?"+7 "+Object(Qn.conformToMask)(e,["(",/\d/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,"-",/\d/,/\d/],{guide:!1}).conformedValue:"+ "+e},Hn=function(t,e){var n=t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$& ").replace(/\./,",");return e||(n=n.slice(0,-3)),n+" \u20bd"},Un=Number.isNaN||function(t){return t!==t};function _n(){var t=Object(h.a)(["\n\tpadding-right: 4px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n  text-overflow: ellipsis;\n\t","\n\t",":not(:hover) & {\n\t\t","\n\t}\n\t","\n\t","\n"]);return _n=function(){return t},t}function Wn(){var t=Object(h.a)(["\n\tfont-size: 1rem;\n\tcursor: pointer;\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t:hover {\n\t\tbackground: rgba(0,0,0,.05);\n\t\tcolor: rgba(0,0,0,.95);\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return Wn=function(){return t},t}var Kn=Tt.b.tr(Wn(),function(t){return t.lineHeight&&"\n\t\tline-height: ".concat(t.lineHeight,";\n\t")},function(t){return t.secondary&&"\n\t\tbackground: rgba(0,0,50,.02);\n\t\t".concat(t.lastSecondaryRow?"":"border-bottom: none;","\n\t")},function(t){return t.active&&"\n\t\tbackground: rgba(0,0,0,.05);\n\t\tfont-weight: bold;\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t"},function(t){return t.bold&&"\n\t\tfont-weight: bold;\n\t"}),Gn="\n\tbackground: rgba(0,0,0,.12);\n\topacity: 1 !important;\n\t.icon {\n\t\topacity: 1 !important;\n\t}\n",Jn=Tt.b.td(_n(),function(t){return t.service&&"padding-left: 3px;"},Kn,function(t){return t.hoverable&&t.hideUnhovered&&!t.active&&!t.hasEntries&&"\n\t\t\topacity: 0 !important;\n\t\t"},function(t){return t.color&&"color: ".concat(t.color,";")},function(t){return t.hoverable&&"\n\t\ttransition: background .3s ease;\n\t\t".concat(t.hideUnhovered&&"\n\t\t\topacity: 0.8;\n\t\t\tpadding-left: ".concat(t.hasEntries?"5px":"7.5px",";\n\t\t"),";\n\t\t:hover {\n\t\t\t").concat(Gn,"\n\t\t}\n\t\t").concat(t.active?Gn:"","\n\t")}),Xn=function(t){var e=t.tableFields,n=t.rowFields,r=void 0===n?[]:n,i=t.entity,o=t.expandFor,c=t.expanded,u=t.expand,s=t.select,d=Object(Qt.a)(t,["tableFields","rowFields","entity","expandFor","expanded","expand","select"]),m=e.map(function(t){var e=r.find(function(e){return e.name===t.name});return e?Object(l.a)({},t,e):t}),f=i.selected,p=i.disabled;return a.a.createElement(Kn,d,m.map(function(e){if("service"===e.name&&"undefined"!==typeof c&&i[o].length)return a.a.createElement(Jn,{service:!0,key:e.name,onClick:function(t){t.stopPropagation(),u()}},a.a.createElement(je,{active:c?1:0}));if("select"===e.name&&"undefined"!==typeof s)return a.a.createElement(Jn,{key:e.name,service:!0,onClick:function(t){t.stopPropagation(),s()}},a.a.createElement(Ht.a,{disabled:p,name:"partly"===f?"square":f?"check square outline":"square outline"}));var n=e.component,r=e.content,l=e.name,d=e.value,m=e.path,b=e.onClick,g=e.icon,h=e.iconColor,v=Object(Qt.a)(e,["component","content","name","value","path","onClick","icon","iconColor"]);if(n||r)return a.a.createElement(Jn,Object.assign({key:l},v,{onClick:b?function(t){t.stopPropagation(),b()}:void 0}),n?t[n]:null,r||null);var y=d||(m?function(t,e){for(var n=e.split("."),r=0;r<n.length;r++)if(!(t=t[n[r]]))return;return t}(i,m):null);return y&&"amount"===l&&(y=Hn(y)),a.a.createElement(Jn,Object.assign({key:l},v,{onClick:b?function(t){t.stopPropagation(),b()}:void 0}),y&&g&&a.a.createElement(Ht.a,{link:!!b,name:g,color:h||void 0}),y)}))},Yn=[{name:"num",path:"num",title:"\u2116",width:"45px"},{name:"date",path:"dateLocal",title:"\u0414\u0430\u0442\u0430",width:"110px"},{name:"org",path:"org.name",title:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f",width:"225px"},{name:"emps",path:"org.name",width:"50px"},{name:"model",path:"model.name",title:"\u0418\u0437\u0434\u0435\u043b\u0438\u0435",width:"250px"},{name:"qty",path:"qty",title:"\u041a\u043e\u043b.",width:"50px"},{name:"reserved",title:"\u0420\u0435\u0437.",width:"50px"},{name:"amount",title:"\u0421\u0443\u043c\u043c\u0430",width:"105px"},{name:"status",path:"status.name",title:"\u0421\u0442\u0430\u0442\u0443\u0441",width:"130px"}],Zn=function(t){var e=t.enquiries;return a.a.createElement(kn,null,function(t){var n=t.details,i=(t.extra,t.setDetails),o=t.bottomPanel,c=t.setBottomPanel,l=t.setExpanded;return a.a.createElement(Rn,{fields:Yn},function(t){var u=t.tableFields;return e.map(function(t){var e=t.id,s=t.org,d=t.docs,m=t.isExpanded,f=t.model,p=t.orders,b=n&&"Enquiry"===n.type&&e===n.id;return a.a.createElement(r.Fragment,{key:e},a.a.createElement(Xn,{lineHeight:"21px",entity:t,tableFields:u,rowFields:[{name:"amount",value:d.length&&d[d.length-1].amount},{name:"emps",icon:s.employees.length?"user":"user plus",iconColor:"grey",hoverable:!0,hideUnhovered:!0,hasEntries:!!s.employees.length,value:s.employees.length||" ",onClick:function(){c({type:"Employees",orgId:s.id})},active:o&&"Employees"===o.type&&o.orgId===s.id},{name:"model",component:"modelComponent",hoverable:!0,onClick:function(){i({type:"Model",id:f.id})},active:n&&"Model"===n.type&&n.id===f.id},{name:"reserved",value:p.reduce(function(t,e){return t+e.prods.length},0)}],expandFor:"orders",expanded:m,expand:function(){l({id:e,value:!m})},active:b,onClick:function(){i({type:"Enquiry",id:e}),l({id:e,value:!b||!m})},modelComponent:a.a.createElement(ge,{d:"flex"},a.a.createElement(ge,{minw:"215px"},f.name),!!f.drawings.length&&a.a.createElement(Oe,{mr:"5px",o:".6",name:"image outline",color:"grey",size:"large"}))}),m&&p.map(function(e,r){var o=e.id,c=e.prods;return a.a.createElement(Xn,{key:o,secondary:1,lastSecondaryRow:r===t.orders.length-1?1:0,entity:e,tableFields:u,rowFields:[{name:"num",path:"fullnum"},{name:"org",value:t.org.name},{name:"model",value:t.model&&t.model.name},{name:"reserved",value:c.length},{name:"amount",path:"amount"}],active:n&&"Order"===n.type&&o===n.id,onClick:function(){i({type:"Order",id:o})}})}))})})})},tr=Object(c.compose)(Object(c.graphql)(wt,{name:"query1",skip:function(t){return"Enquiry"!==t.type}}),Object(c.graphql)($,{name:"query2",skip:function(t){return"Order"!==t.type}}),Object(c.graphql)(dt,{name:"query3",skip:function(t){return"Model"!==t.type}}),Object(c.graphql)(kt,{name:"localQuery1",skip:function(t){var e=t.type,n=t.id;return"Enquiry"!==e||"new"===n}}),Object(c.graphql)(B,{name:"localQuery2",skip:function(t){var e=t.type,n=t.id;return"Order"!==e||"new"===n}}),Object(c.graphql)(st,{name:"localQuery3",skip:function(t){var e=t.type,n=t.id;return"Model"!==e||"new"===n}}))(function(t){var e=t.children,n=t.type,r=t.id,a=t.query1,i=t.query2,o=t.query3,c=t.localQuery1,l=t.localQuery2,u=t.localQuery3,s=a||i||o,d=c||l||u;return e({loading:s.loading,error:s.error,refetch:s.refetch,entity:"Enquiry"===n?s.enquiry:"Order"===n?s.order:"Model"===n?s.model:null,localEntity:"new"===r?null:"Enquiry"===n?d.enquiryLocal:"Order"===n?d.orderLocal:"Model"===n?d.modelLocal:null})});function er(){var t=Object(h.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return er=function(){return t},t}function nr(){var t=Object(h.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return nr=function(){return t},t}var rr=Object(Tt.b)(Ht.a)(nr()),ar=Object(Tt.b)(je)(er()),ir=function(t){var e=t.children,n=t.size,r=t.bottomBorder,i=t.close,o=t.expanded,c=t.disabled,u=t.onClick,s=t.noIndent,d=Object(l.a)({},i&&{close:!0},"undefined"!==typeof o&&{expand:!0});return a.a.createElement(qe,{bc:"white",head:!0,noLP:!0,noIndent:s,bottomBorder:r||!0,size:n||void 0,onClick:u},d.close?a.a.createElement(rr,{link:!0,size:"big",name:"cancel",onClick:i}):d.expand?a.a.createElement(ar,{size:"large",active:o?1:0,disabled:c}):null,e)},or=function(t){var e=t.content;return a.a.createElement(ve,{ml:"10px",fs:"1rem",c:"rgba(0,0,0,.6)",ws:"0.5em"},e)},cr=function(t){var e=t.title,n=t.subtitle,r=t.size;return a.a.createElement(Ee,{m:"0",size:r||"medium"},e,(n||0===n)&&a.a.createElement(or,{content:n}))},lr=function(t){var e=t.children;return a.a.createElement(ge,{ml:"auto"},e)};function ur(){var t=Object(h.a)(["\n\tpadding: .78571429em !important;\n\t&>i {\n\t\topacity: .9 !important;\n\t\tmargin: 0 !important;\n\t}\n"]);return ur=function(){return t},t}var sr=Object(Tt.b)(xe)(ur()),dr=function(t){var e=t.loading,n=t.onClick;return a.a.createElement(sr,{activeColor:"blue",active:e,onClick:n},a.a.createElement(Ht.a,{name:"refresh",loading:e}))},mr={Enquiry:{titleNew:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u044f\u0432\u043a\u0430",titleExisting:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116"},Order:{titleNew:"\u041d\u043e\u0432\u044b\u0439 \u0437\u0430\u043a\u0430\u0437",titleExisting:"\u0417\u0430\u043a\u0430\u0437 \u2116"},Model:{titleNew:"\u041d\u043e\u0432\u043e\u0435 \u0438\u0437\u0434\u0435\u043b\u0438\u0435",titleExisting:""}},fr=function(t){var e=t.type,n=t.closeDetails,i=t.loading,o=t.refresh,c=t.setDetails,l=t.editMode,u=t.localEntity,s=u||{},d=s.id,m=s.num,f=s.fullnum,p=s.name,b=s.article,g=s.dateLocal;return a.a.createElement(ir,{close:n},!d&&a.a.createElement(cr,{title:mr[e].titleNew}),d&&a.a.createElement(r.Fragment,null,a.a.createElement(cr,{title:"Model"===e?p:mr[e].titleExisting+" "+(m||f),subtitle:"Model"===e?b?"\u0410\u0440\u0442\u0438\u043a\u0443\u043b: ".concat(b):"":"\u043e\u0442 "+g}),a.a.createElement(lr,null,a.a.createElement(dr,{loading:i,onClick:o}),a.a.createElement(xe,{icon:"edit",activeColor:"blue",active:l||!1,onClick:function(){return c({type:e,id:u.id,editMode:!0})}}))))};function pr(){var t=Object(h.a)(["\n\tfont-weight: unset !important;\n\t/* padding-bottom: 0 !important; */\n"]);return pr=function(){return t},t}function br(){var t=Object(h.a)(["\n\tpadding-top: 0 !important;\n"]);return br=function(){return t},t}function gr(){var t=Object(h.a)(["\n  :nth-child(1) {\n\t\twidth: ",";\n\t// color: rgba(0,0,0,.87);\n\t/* font-size: .92857143em; */\n\t/* line-height: 32px; */\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n\t\tvertical-align: top;\n  }\n  :nth-child(2) {\n\t\t// width: 100px;\n\t\tfont-size: 1em;\n\t\tfont-weight: bold;\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n  }\n"]);return gr=function(){return t},t}function hr(){var t=Object(h.a)(["\n  margin: 0 0 1em;\n  line-height: 1.4285em;\n  color: rgba(0,0,0,.87);\n"]);return hr=function(){return t},t}function vr(){var t=Object(h.a)(["\n\t/* table-layout: fixed; */\n\twidth: 100%;\n\tborder-collapse: collapse;\n"]);return vr=function(){return t},t}var yr=Tt.b.table(vr()),Er=Tt.b.tr(hr()),Or=Tt.b.td(gr(),function(t){return t.theme.widths.formLabel}),jr=Object(Tt.b)(Or)(br()),xr=Object(Tt.b)(jr)(pr()),wr=n(904),kr=n(409),qr=n(69),Cr=(n(701),n(439)),Fr=function(t){function e(t){var n,r;if(Object(De.a)(this,e),(n=Object(Le.a)(this,Object(Ne.a)(e).call(this,t))).onChange=function(t){n.setState({editorState:t});var e=t.getCurrentContent(),r=n.props,a=r.setEditorHasText,i=r.setEditorDiff,o=r.setHasFocus;t&&a&&a(e.hasText()),i&&i(e!==n.state.oriContent),o&&o(t.getSelection().getHasFocus())},n.kolmechKeyBindingFn=function(t){return 13===t.keyCode&&qr.KeyBindingUtil.hasCommandModifier(t)?"ctrlEnter":Object(qr.getDefaultKeyBinding)(t)},n.handleKeyCommand=function(t,e){if("ctrlEnter"===t)return n.props.onCtrlEnter(),"handled";var r=qr.RichUtils.handleKeyCommand(e,t);return r?(n.onChange(r),"handled"):"not-handled"},n.clear=function(){return n.setState({editorState:qr.EditorState.push(n.state.editorState,qr.ContentState.createFromText(""),"remove-range")})},n.exportHtml=function(){var t=Object(Cr.stateToHTML)(n.state.editorState.getCurrentContent());return Object(qr.convertFromHTML)(t).contentBlocks?t:null},t.initFromHtml){var a=Object(qr.convertFromHTML)(t.initFromHtml);r=qr.EditorState.createWithContent(qr.ContentState.createFromBlockArray(a.contentBlocks,a.entityMap))}else r=qr.EditorState.createEmpty();return n.state={editorState:r,oriContent:r.getCurrentContent()},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return a.a.createElement(qr.Editor,{editorState:this.state.editorState,onChange:this.onChange,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.kolmechKeyBindingFn,readOnly:this.props.readOnly})}}]),e}(a.a.Component);function Ir(){var t=Object(h.a)(["\n\tpadding: calc(0.678571em - 1px) 1em;\n\tline-height: 1.4285em;\n\tborder: 1px solid rgba(34,36,38,.15);\n\tborder-radius: .28571429rem;\n\ttransition: all .1s ease;\n\t","\n"]);return Ir=function(){return t},t}var Sr=Tt.b.div(Ir(),function(t){var e=t.borderless,n=t.hasFocus,r=t.diff;return e&&!n&&!r&&"\n\t\t\tmargin-left: -1em;\n\t\t\tborder: 1px solid white;\n\t\t\t:hover {\n\t\t\t\tbackground: rgba(0,0,0,.05);\n\t\t\t\tcolor: rgba(0,0,0,.65);\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t"}),Dr=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={hasFocus:!1},n.setHasFocus=function(t){return n.setState({hasFocus:t})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.state.hasFocus,e=this.props,n=e.borderless,r=e.diff,i=e.forwardedRef,o=Object(Qt.a)(e,["borderless","diff","forwardedRef"]);return a.a.createElement(Sr,{borderless:n,hasFocus:t,diff:r},a.a.createElement(Fr,Object.assign({ref:i,setHasFocus:this.setHasFocus},o)))}}]),e}(r.Component),Mr=a.a.forwardRef(function(t,e){return a.a.createElement(Dr,Object.assign({forwardedRef:e},t))}),Lr=n(440),Nr=n(99),Pr=n.n(Nr),Br=function(t,e){var n=!1;if("number"===typeof t?t=t.toString():"string"!==typeof t&&(t=""),t.length)if(/[^0-9]/.test(t))e.code=2,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0446\u0438\u0444\u0440";else if(-1===[10,12].indexOf(t.length))e.code=3,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 10 \u0438\u043b\u0438 12 \u0446\u0438\u0444\u0440";else{var r=function(t,e){var n=0;for(var r in e)n+=e[r]*t[r];return parseInt(n%11%10)};switch(t.length){case 10:r(t,[2,4,10,3,5,9,4,6,8])===parseInt(t[9])&&(n=!0);break;case 12:var a=r(t,[7,2,4,10,3,5,9,4,6,8]),i=r(t,[3,7,2,4,10,3,5,9,4,6,8]);a===parseInt(t[10])&&i===parseInt(t[11])&&(n=!0)}n||(e.code=4,e.message="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0418\u041d\u041d")}else e.code=1,e.message="\u0418\u041d\u041d \u043f\u0443\u0441\u0442";return n},$r=function(t){return t instanceof Date&&!isNaN(t.valueOf())},Ar=6e4*(new Date).getTimezoneOffset(),zr=function(t){return new Date(t.getTime()-Ar).toISOString()},Tr=function(t){return new Date(Date.parse(t)+Ar)};function Rr(){var t=Object(h.a)(["\n\tquery OrgLocal ($id: ID!) {\n\t\torgLocal (id: $id) {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t}\n"]);return Rr=function(){return t},t}function Qr(){var t=Object(h.a)(["\n\tmutation createOrg($inn: String!) {\n\t\tcreateOrg(inn: $inn) {\n\t\t\tid\n\t\t\tinn\n\t\t\tname\n\t\t}\n\t}\n"]);return Qr=function(){return t},t}function Vr(){var t=Object(h.a)(["\n\tquery allOrgs {\n\t\torgs {\n\t\t\tid\n\t\t\tinn\n\t\t\tname\n\t\t}\n\t}\n"]);return Vr=function(){return t},t}function Hr(){var t=Object(h.a)(["\n\tquery org ($id: ID!) {\n\t\torg (id: $id) {\n\t\t\tid\n\t\t\tinn\n\t\t\tname\n\t\t}\n\t}\n"]);return Hr=function(){return t},t}y()(Hr()),y()(Vr());var Ur=y()(Qr()),_r=y()(Rr());function Wr(){var t=Object(h.a)(["\n    query AllOrgsAndModels {\n        orgs {\n            id\n            inn\n            name\n        }\n        models {\n            id\n            article\n            name\n        }\n    }\n"]);return Wr=function(){return t},t}var Kr=y()(Wr()),Gr=n(185),Jr=n.n(Gr);n(368);function Xr(){var t=Object(h.a)(["\n\tdisplay: inline-block;\n\twidth: 180px;\n\t","\n\tinput {\n\t\tcursor: pointer;\n\t\tvertical-align: unset !important;\n\t\tpadding-left: 3.5rem !important;\n\t\t&:focus {\n\t\t\tcursor: text;\n\t\t}\n\t}\n"]);return Xr=function(){return t},t}var Yr=Tt.b.div(Xr(),function(t){return t.err&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),Zr=function(t){var e=t.selectedDate,n=t.selectDay,r=t.error;return a.a.createElement(Yr,{error:r},a.a.createElement(Jr.a,{value:zr(e).slice(0,10),onDayChange:n,dayPickerProps:{firstDayOfWeek:1,month:e}}))},ta=function(t){var e=t.title,n=t.content,r=t.onClose;return a.a.createElement(ge,{m:"0 -1em 1em -55px"},a.a.createElement(qe,{head:!0,minor:!0,secondary:!0,topBorder:!0,bottomBorder:!0,noLP:!!r},!!r&&a.a.createElement(Oe,{bs:"content-box",w:"calc(55px - 1em)",m:"0 0.5em",link:!0,size:"large",name:"close",onClick:r}),a.a.createElement(Ee,{m:"0"},e)),a.a.createElement(qe,{secondary:!0,bottomBorder:!0},n))},ea=n(35),na=function(t,e){var n={};return aa(e,t,n),n},ra=function(t,e,n){var r={};return oa(n,e,t,r),r},aa=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;n.id&&(r.id=n.id),Object.keys(e).forEach(function(a){var i=typeof e[a];return"object"===i&&Array.isArray(e[a])?ia(e[a],n[a],r[a]=[]):"object"===i?t(e[a],n[a],r[a]={}):void(r[a]=n[a]||e[a])})},ia=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if("object"===typeof t[0])return e.length?e.forEach(function(e,r){return aa(t[0],e,n[r]={})}):aa(t[0],{},n[0]={})},oa=function t(e,n,r,a){r.id&&(a.id=r.id),Object.keys(e).forEach(function(i){if(i.endsWith("Id")&&r[i])return a[i]=r[i];var o=typeof e[i];return"object"===o&&Array.isArray(e[i])?ca(e[i],n[i],r[i],a[i]=[]):"object"===o?t(e[i],n[i],r[i],a[i]={}):r[i]!==n[i]?a[i]=r[i]:e[i]?a[i]=e[i]:void 0})},ca=function(t,e,n,r){if("object"===typeof t[0])return n.forEach(function(n,a){return oa(t[0],e[a],n,r[a]={})})},la=n(28),ua=Object(la.string)().matches(/^[a-z0-9]{25}$/),sa=Object(la.object)().shape({id:ua.notRequired(),name:Object(la.string)().trim().min(4).max(255).when("id",function(t,e){return t?e.notRequired():e.required()}),article:Object(la.string)().trim().min(4).max(10).notRequired()}),da={name:"",article:""},ma=n(188),fa=n.n(ma),pa=function(t){var e=t.placeholder,n=t.name,r=t.value,i=t.setField;return a.a.createElement(a.a.Fragment,null,a.a.createElement(fa.a,{customInput:Gt.a,placeholder:e,value:r,decimalSeparator:",",thousandSeparator:" ",decimalScale:2,allowNegative:!1,onValueChange:function(t){return i(n,t.floatValue)}}),a.a.createElement(ve,{pl:"6px",fs:"1.3rem",c:"rgba(0,0,0,.6)"},"\u20bd"))},ba=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.formik,n=t.name,r=t.type,i=t.options,o=Object(Qt.a)(t,["formik","name","type","options"]),c=Object(ea.d)(e.values,n);return i?a.a.createElement(Jt.a,Object.assign({},o,{selection:!0,fluid:!0,search:!0,noResultsMessage:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",value:c,options:i,onChange:function(t,r){var a=r.value;return e.setFieldValue(n,a)}})):n.endsWith("amount")?a.a.createElement(pa,{name:n,value:c,setField:e.setFieldValue}):a.a.createElement(Se,Object.assign({},o,{w:"100%",name:n,value:"date"===r?c.slice(0,16):c,error:Object(ea.d)(e.touched,n)&&!!Object(ea.d)(e.errors,n),onChange:e.handleChange,onBlur:e.handleBlur}))}}]),e}(r.Component),ga=Object(ea.c)(ba),ha=n(444),va=n.n(ha);function ya(){var t=Object(h.a)(["\n  color: ",";\n"]);return ya=function(){return t},t}function Ea(){var t=Object(h.a)(["\n\t&&&&&& {\n    ","\n\t}\n"]);return Ea=function(){return t},t}var Oa=[{key:"rus",text:"+7",value:"rus"},{key:"notRus",text:"+",value:"notRus"}],ja=Object(Tt.b)(function(t){t.inputError;var e=Object(Qt.a)(t,["inputError"]);return a.a.createElement(Jt.a,e)})(Ea(),function(t){return t.inputError&&"\n      border: 1px solid ".concat(t.theme.colors.errorBorder,";\n      border-right-color: transparent;\n    ")}),xa=Tt.b.div(ya(),function(t){return t.theme.colors.error}),wa=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.baseName,n=t.formik,r=Object(Qt.a)(t,["baseName","formik"]),i=Object(ea.d)(n.values,e+".number"),o=Object(ea.d)(n.values,e+".country"),c=Object(ea.d)(n.touched,e+".number"),l=Object(ea.d)(n.errors,e),u=function(){return a.a.createElement(ja,{tabIndex:-1,name:e+".country",value:o,options:Oa,inputError:c&&!!l,onChange:function(t,e){var r=e.name,a=e.value;return n.setFieldValue(r,a)}})};return a.a.createElement(a.a.Fragment,null,"rus"===o?a.a.createElement(va.a,{name:e+".number",mask:"( 999 ) 999-99-99",maskChar:"",value:i,onBlur:n.handleBlur,onChange:n.handleChange},function(t){return a.a.createElement(Se,Object.assign({w:"240px !important",error:c&&!!l,label:u()},r,t))}):a.a.createElement(ga,Object.assign({w:"240px !important",name:e+".number",error:c&&!!l,label:u()},r)),a.a.createElement(xa,null,c&&l&&l.number))}}]),e}(r.Component),ka=Object(ea.c)(wa);function qa(){var t=Object(h.a)(["\n  color: ",";\n"]);return qa=function(){return t},t}function Ca(){var t=Object(h.a)(["\n  max-width: 240px;\n"]);return Ca=function(){return t},t}function Fa(){var t=Object(h.a)(["\n  flex: 1 1 auto;\n  max-width: calc(100% - 122px);\n"]);return Fa=function(){return t},t}function Ia(){var t=Object(h.a)(["\n  flex: 0 0 122px;\n  padding-top: calc(10.5rem/14);\n  font-size: calc(13rem/14);\n  font-weight: bold;\n  line-height: 1.21428571rem;\n  ","\n"]);return Ia=function(){return t},t}function Sa(){var t=Object(h.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: .67857143rem;\n"]);return Sa=function(){return t},t}var Da=Tt.b.div(Sa()),Ma=Tt.b.div(Ia(),function(t){return t.required&&"\n    ::after {\n      content: '*';\n      display: inline-block;\n      margin: -.2em 0 0 .2em;\n      vertical-align: top;\n      color: #db2828;\n    }\n  "}),La=Tt.b.div(Fa()),Na=Tt.b.div(Ca()),Pa=Tt.b.div(qa(),function(t){return t.theme.colors.error}),Ba=Object(ea.c)(function(t){var e=t.label,n=t.required,i=t.name,o=t.type,c=t.formik,l=(t.inputLabel,Object(Qt.a)(t,["label","required","name","type","formik","inputLabel"])),u="person.tels"===i;return a.a.createElement(Da,null,a.a.createElement(Ma,{className:"fz-formFieldLabel",required:n},e),a.a.createElement(La,null,u?a.a.createElement(ea.a,{name:i,render:function(t){return a.a.createElement(a.a.Fragment,null,Object(ea.d)(c.values,i).map(function(t,e){return a.a.createElement(r.Fragment,{key:e},a.a.createElement(ka,{baseName:"".concat(i,".").concat(e)}))}))}}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Na,null,a.a.createElement(ga,Object.assign({},l,{name:i,type:o}))),a.a.createElement(Pa,null,Object(ea.d)(c.touched,i)?Object(ea.d)(c.errors,i):""))))}),$a=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).didMount=!1,n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"componentDidMount",value:function(){this.didMount=!0}},{key:"componentWillUnmount",value:function(){this.didMount=!1}},{key:"render",value:function(){var t=this,e=this.props,n=e.model,r=e.orgId,i=e.toggleEditMode,o=e.refetchQueries,u=e.onSubmit,s=n?da:Object(l.a)({},da,{orgId:r}),d=n?na(n,s):s;return a.a.createElement(c.Mutation,{mutation:mt,onCompleted:function(){return o()}},function(e,r){var o=r.loading,c=r.error;return a.a.createElement(ea.b,{initialValues:d,validationSchema:sa,onSubmit:function(){var r=Object(fn.a)(mn.a.mark(function r(a,o){var c,l;return mn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o.resetForm,c=ra(a,d,s),r.next=4,e({variables:{input:c}});case 4:return l=r.sent,r.abrupt("return",n?i():t.didMount&&u(l.data.upsertModel.id));case 6:case"end":return r.stop()}},r,this)}));return function(t,e){return r.apply(this,arguments)}}()},function(t){var e=t.handleSubmit,r=t.handleReset;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ba,{label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",name:"name",required:!0}),a.a.createElement(Ba,{label:"\u0410\u0440\u0442\u0438\u043a\u0443\u043b",name:"article"}),!!c&&a.a.createElement(we,{d:"block !important",error:!0,header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c..",content:c&&c.message}),a.a.createElement(xe,{ml:"122px",type:"button",primary:!0,content:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:o,onClick:e}),a.a.createElement(ye,{cancel:!0,onClick:n?i:r},n?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})}}]),e}(r.Component);function Aa(){var t=Object(h.a)(["\n\t&&&&&& {\n\t\twidth: 350px;\n\t\t&:hover {\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\n\t\t}\n\t}\n"]);return Aa=function(){return t},t}var za=Object(Tt.b)(Jt.a)(Aa()),Ta=function(t){function e(t){var n;Object(De.a)(this,e),(n=Object(Le.a)(this,Object(Ne.a)(e).call(this,t))).closeNewModelSection=function(){return n.setState({newModelMode:!1})},n.changeFieldValue=function(t,e){var r;console.log("change ",t," to value > ",e);var a=Pr()(n.state[t]);a.curVal=e,a.err=!1,n.isNewEnquiry||(a.diff=a.curVal!==a.oriVal);var i=n.fields.filter(function(e){return e!==t}).map(function(t){return n.state[t].diff}).includes(!0)||a.diff;n.setState((r={},Object(pn.a)(r,t,a),Object(pn.a)(r,"diff",i),Object(pn.a)(r,"err",{message:""}),r))},n.selectDay=function(t){if(!$r(t))return n.setState({dateLocal:Object(l.a)({},n.state.dateLocal,{err:!0}),err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u0437\u0430\u044f\u0432\u043a\u0438 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0434\u0430\u0442"}});n.changeFieldValue("dateLocal",zr(t).slice(0,10))},n.handleOrgDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({orgDdn:{search:r,err:!1}})},n.handleModelDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({modelDdn:{search:r,err:!1}})},n.handleQtyInputChange=function(t,e){var r=e.value,a=parseInt(r,10)||"";n.changeFieldValue("qty",a)},n.selectOrg=function(t,e){var r=e.value;n.setState({orgDdn:{search:"",loading:!1}}),n.changeFieldValue("orgId",r)},n.selectModel=function(t,e){var r=e.value;n.setState({modelDdn:{search:"",loading:!1}}),n.changeFieldValue("modelId",r)},n.submitNewModel=function(t){n.changeFieldValue("modelId",t),n.closeNewModelSection()},n.createOrg=function(){var t=Object(fn.a)(mn.a.mark(function t(e,r){var a,i,o;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,t.prev=1,Br(a,i={})){t.next=6;break}throw new Error(i.message);case 6:return n.setState({orgDdn:{search:a,loading:!0}}),t.next=9,n.props.createOrg({variables:{inn:a}});case 9:if(o=t.sent,n.componentIsMounted){t.next=12;break}return t.abrupt("return");case 12:n.selectOrg(null,{value:o.data.createOrg.id}),t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(1),n.componentIsMounted){t.next=19;break}return t.abrupt("return");case 19:n.setState({err:{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e \u0418\u041d\u041d \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message},orgDdn:{search:a,loading:!1},orgId:Object(l.a)({},n.state.orgId,{err:!0})}),console.log(t.t0);case 21:case"end":return t.stop()}},t,this,[[1,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.submit=function(){var t={};n.fields.forEach(function(e){(n.isNewEnquiry||n.state[e].diff)&&(t[e]=n.state[e].curVal)});var e=Object(l.a)({},t);if(n.isNewEnquiry)return n.createEnquiry(e);e.id=n.props.id,n.updateEnquiry(e)},n.createEnquiry=function(){var t=Object(fn.a)(mn.a.mark(function t(e){var r;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.createEnquiry({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),n.props.setDetails({type:"Enquiry",id:r.data.createEnquiry.id}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(0),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,this,[[0,11]])}));return function(e){return t.apply(this,arguments)}}(),n.updateEnquiry=function(){var t=Object(fn.a)(mn.a.mark(function t(e){var r,a,i,o;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.props,a=r.id,i=r.updateEnquiry,o=r.setDetails,t.prev=1,n.setState({loading:!0}),t.next=5,i({variables:{input:e}});case 5:if(n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),o({type:"Enquiry",id:a}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(1),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,this,[[1,11]])}));return function(e){return t.apply(this,arguments)}}(),n.componentIsMounted=!0,n.isNewEnquiry="new"===t.id;var r=n.isNewEnquiry;n.state={loading:!1,err:{message:""},orgDdn:{search:"",loading:!1},modelDdn:{search:"",loading:!1},newModelMode:!1};var a=Pr()(t.enquiry);return r&&(a.dateLocal=zr(new Date).slice(0,10)),delete a.events,a.orgId=a.org?a.org.id:null,a.modelId=a.model?a.model.id:null,a.qty=a.qty?a.qty:"",n.fields=Object.keys(a).filter(function(t){return!["__typename","id","num","org","model"].includes(t)}),n.requiredFields=["dateLocal","orgId","modelId","qty"],n.fields.forEach(function(t){n.state[t]=Object(l.a)({curVal:a[t],err:!1},n.requiredFields.includes(t)&&{required:!0},!r&&{oriVal:a[t],diff:!1})}),r||(n.state.diff=!1),n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state,n=e.dateLocal,i=e.orgId,o=e.orgDdn,c=e.modelId,l=e.modelDdn,u=e.qty,s=e.diff,d=e.loading,m=e.err,f=e.newModelMode,p=this.props,b=p.id,g=p.setDetails,h=p.allOrgsAndModels,v=Tr(n.curVal),y=h.orgs,E=h.models,O=this.requiredFields.some(function(e){return!t.state[e].curVal}),j=this.fields.some(function(e){return!!t.state[e].err});return a.a.createElement(r.Fragment,null,a.a.createElement(qe,{bottomBorder:!0},a.a.createElement(Xt.a,null,a.a.createElement(Xt.a.Field,{inline:!0},a.a.createElement(Fe,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Zr,{error:n.err,selectedDate:v,selectDay:this.selectDay})),a.a.createElement(Xt.a.Field,{inline:!0,error:i.err,required:!0},a.a.createElement(Fe,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(za,{loading:!y||o.loading,disabled:"new"!==b||!y||o.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0418\u041d\u041d",options:y?y.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:i.curVal,onChange:this.selectOrg,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:o.search,onSearchChange:this.handleOrgDropdownSearchChange,noResultsMessage:"\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041d\u041d, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c.",allowAdditions:!0,additionLabel:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u0418\u041d\u041d: ",onAddItem:this.createOrg})),f?a.a.createElement(ta,{title:"\u041d\u043e\u0432\u043e\u0435 \u0438\u0437\u0434\u0435\u043b\u0438\u0435",onClose:this.closeNewModelSection,content:a.a.createElement($a,{model:void 0,orgId:i.curVal||void 0,refetchQueries:h.refetch,onSubmit:this.submitNewModel})}):a.a.createElement(Xt.a.Field,{inline:!0,required:!0,error:c.err},a.a.createElement(Fe,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(za,{loading:!E||l.loading,disabled:!E||l.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0443",options:E?E.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:c.curVal,onChange:this.selectModel,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:l.search,onSearchChange:this.handleModelDropdownSearchChange,noResultsMessage:'\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 "\u041d\u0435\u0442 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435"'}),a.a.createElement(xe,{ml:"5px",icon:"plus",activeColor:"green",active:f,onClick:function(){return t.setState({newModelMode:!0})}})),a.a.createElement(Xt.a.Field,{inline:!0,required:!0},a.a.createElement(Fe,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(Gt.a,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",value:u.curVal,onChange:this.handleQtyInputChange}),a.a.createElement(ve,{pl:"6px"},"\u0448\u0442.")))),a.a.createElement(qe,null,a.a.createElement(_t.a,{error:!0,hidden:!m.message,header:m.title,content:m.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(xe,{primary:!0,content:this.isNewEnquiry?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:!this.isNewEnquiry&&!s||!!m.message||j||!!i.loading||O,loading:d,onClick:this.submit}),a.a.createElement(ye,{cancel:!0,onClick:"new"===b?function(){return g(null)}:function(){return g({type:"Enquiry",id:b})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))}}]),e}(r.Component),Ra=Object(c.compose)(Object(c.graphql)(Ur,{name:"createOrg",options:{update:function(t,e){var n=e.data.createOrg,r=Kr,a=t.readQuery({query:r});a.orgs.push(n),a.orgs.sort(function(t,e){return t.name>e.name}),t.writeQuery({query:r,data:a})}}}),Object(c.graphql)(Kr,{name:"allOrgsAndModels"}),Object(c.graphql)(Ft,{name:"updateEnquiry"}),Object(c.graphql)(Ct,{name:"createEnquiry",options:{update:function(t,e){var n=e.data.createEnquiry,r=xt,a=t.readQuery({query:r});n.isExpanded=!1,a.enquiries.unshift(n),t.writeQuery({query:r,data:a})}}}))(Ta),Qa=n(900);function Va(){var t=Object(h.a)(["\n\tdisplay: inline-block;\n\twidth: 180px;\n\t","\n\tinput {\n\t\tcursor: pointer;\n\t\tvertical-align: unset !important;\n\t\tpadding-left: 3.5rem !important;\n\t\t&:focus {\n\t\t\tcursor: text;\n\t\t}\n\t}\n"]);return Va=function(){return t},t}var Ha=Tt.b.div(Va(),function(t){return t.err&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),Ua=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).handleDayChange=function(t){var e=n.props,r=e.setField,a=e.field.name;$r(t)?r(a,{value:zr(t).slice(0,10)}):r(a,{err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414"}})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props.field,e=t.curVal,n=t.err;return a.a.createElement(Ha,{err:!!n},a.a.createElement(Jr.a,{value:e,onDayChange:this.handleDayChange,dayPickerProps:{firstDayOfWeek:1,month:Tr(e)}}))}}]),e}(r.Component),_a=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.placeholder,n=t.field,i=n.name,o=n.curVal,c=t.setField;return a.a.createElement(r.Fragment,null,a.a.createElement(fa.a,{customInput:Gt.a,placeholder:e,value:o,decimalSeparator:",",thousandSeparator:" ",decimalScale:2,allowNegative:!1,onValueChange:function(t){return c(i,{value:t.floatValue})}}),a.a.createElement(ve,{pl:"6px",fs:"1.1rem",c:"rgba(0,0,0,.87)"},"\u20bd"),a.a.createElement(ve,{pl:"9px",fs:"1.1rem",ws:"0.1em"},"\u0441 \u041d\u0414\u0421"))}}]),e}(r.Component),Wa=function(t){function e(t){var n;Object(De.a)(this,e),(n=Object(Le.a)(this,Object(Ne.a)(e).call(this,t))).setField=function(t,e){var r=e.value,a=e.err;n.setState(Object(pn.a)({},t,Object(l.a)({},n.state[t],r&&Object(l.a)({curVal:r},!n.isNewEntity&&{diff:r!==n.state[t].oriVal}),{err:a||null})))},n.submit=function(){var t=n.fields.reduce(function(t,e){return t[e]=n.state[e].curVal,t},{});n.props.submit(t)},n.componentIsMounted=!0,n.isNewEntity=t.isNewEntity;var r=t.entity;return n.fields=Object.keys(r),n.requiredFields=t.requiredFields,n.state={},n.fields.forEach(function(t){n.state[t]=Object(l.a)({name:t,curVal:r[t],err:null},n.requiredFields.includes(t)&&{required:!0},!n.isNewEntity&&{oriVal:r[t],diff:!1})}),n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.props.children,n=this.requiredFields.some(function(e){return!t.state[e].curVal}),r=this.isNewEntity?null:this.fields.map(function(e){return t.state[e].diff}).includes(!0),a=this.fields.map(function(e){return t.state[e].err}).find(function(t){return!!t});return e({disabled:!this.isNewEntity&&!r||n||!!a,err:a||this.props.err,setField:this.setField,submit:this.submit,formState:this.state})}}]),e}(r.Component),Ka=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.cancel,n=t.submit,i=t.loading,o="new"===this.props.id,c=o?{dateLocal:zr(new Date).slice(0,10),amount:""}:{dateLocal:this.props.co.dateLocal,amount:this.props.co.amount};return a.a.createElement(Wa,{isNewEntity:o,entity:c,requiredFields:["dateLocal","amount"],submit:n},function(t){var n=t.disabled,o=t.err,c=t.setField,l=t.submit,u=t.formState,s=u.dateLocal,d=u.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(qe,{head:!0,minor:!0,secondary:!0,topBorder:!0,bottomBorder:!0},a.a.createElement(Vt.a,null,"\u041a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")),a.a.createElement(qe,{secondary:!0,bottomBorder:!0},a.a.createElement(Xt.a,null,a.a.createElement(Xt.a.Field,{inline:!0},a.a.createElement(Fe,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Ua,{field:s,setField:c})),a.a.createElement(Xt.a.Field,{inline:!0,required:!0},a.a.createElement(Fe,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(_a,{field:d,setField:c,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u041a\u041f"})))),a.a.createElement(qe,{secondary:!0,small:!0},o&&a.a.createElement(_t.a,{error:!0,header:o.title,content:o.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(Ut.a,{primary:!0,content:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",disabled:n,loading:i,onClick:l}),a.a.createElement(ye,{cancel:!0,onClick:e},"\u041e\u0442\u043c\u0435\u043d\u0430")),a.a.createElement(Qa.a,{fitted:!0}))})}}]),e}(r.Component);function Ga(){var t=Object(h.a)(["\n\tmargin-left: 6.35em !important;\n"]);return Ga=function(){return t},t}function Ja(){var t=Object(h.a)(["\n\t& p { margin: 0 !important; }\n\t&>table { \n\t\twidth: 100%;\n\t\tborder-collapse: collapse; \n\t}\n\t&>table>tbody>tr>td {\n\t\tpadding-left: 4px;\n\t\tvertical-align: top;\n\t}\n\t&>table>tbody>tr>td:nth-child(1) {\n\t\twidth: 5px;\n\t}\n\t&>table>tbody>tr>td:nth-child(2) {\n\t\twidth: 25px;\n\t\tmin-width: 90px;\n\t}\n\t&>table>tbody>tr>td:nth-child(3) {\n\t\tpadding-left: 10px;\n\t\twidth: 1000px;\n\t\tmin-width: 240px;\n\t}\n\t&>table>tbody>tr>td>span {\n\t\tmargin-right: 5px;\n\t}\n"]);return Ja=function(){return t},t}function Xa(){var t=Object(h.a)(["\n\tmargin-left: 0 !important;\n  color: rgba(0,0,0,.6) !important;\n"]);return Xa=function(){return t},t}function Ya(){var t=Object(h.a)(["\n  margin-left: 6.5em !important;\n"]);return Ya=function(){return t},t}function Za(){var t=Object(h.a)(["\n  width: 2em;\n  height: 2em;\n  margin-left: 0 !important;\n  padding: .4em 0em !important;\n  float: left;\n\ttext-align: center;\n\t","\n\t// ","\n"]);return Za=function(){return t},t}function ti(){var t=Object(h.a)(["\n\t// apply horizontal offset correction for different icons to be vertically alined\n  width: "," !important;\n\t","\n  margin-top: .15em !important;\n\tfloat: left;\n\topacity: 0.6 !important;\n"]);return ti=function(){return t},t}function ei(){var t=Object(h.a)(["\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\n"]);return ei=function(){return t},t}function ni(){var t=Object(h.a)(["\n\t& .active.item {\n\t\tdisplay: none !important;\n\t}\n\t& .selected.item {\n\t\tbackground: none !important;\n\t}\n"]);return ni=function(){return t},t}var ri=Object(Tt.b)(Jt.a)(ni()),ai=Object(Tt.b)(wr.a.Group)(ei()),ii=Object(Tt.b)(Ht.a)(ti(),function(t){return"CREATE"===t.type?"1.73em":"1.4em"},function(t){return"CREATE"===t.type&&"margin-left: -0.33em !important;"}),oi=Object(Tt.b)(kr.a)(Za(),function(t){return t.indent&&"margin-left: 42.69px !important;"},function(t){return t.indent&&"margin-left: calc(1.4em + 0.25rem) !important;"}),ci=Object(Tt.b)(wr.a.Content)(Ya()),li=Object(Tt.b)(wr.a.Metadata)(Xa()),ui=Object(Tt.b)(wr.a.Text)(Ja()),si=Object(Tt.b)(_t.a)(Ga()),di=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(i)))).isNewEnquiry="new"===n.props.id,n.editorRef=a.a.createRef(),n.noteEditorRef=a.a.createRef(),n.componentIsMounted=!0,n.state={editMode:!!n.isNewEnquiry,editorHasText:!1,noteEditorDiff:!1,noteKey:1,activeCO:"",loading:!1,creatingComment:!1,changingStatus:!1,statusPending:!1,savingNote:!1,error:""},n.enableEditMode=function(){return n.setState({editMode:!0})},n.exitEditMode=function(){return n.setState({editMode:!1})},n.setEditorHasText=function(t){return n.setState({editorHasText:t})},n.setNoteEditorDiff=function(t){return n.setState({noteEditorDiff:t})},n.cancelEdit=function(){if(n.isNewEnquiry)return n.props.closeDetails();n.exitEditMode()},n.createComment=Object(fn.a)(mn.a.mark(function t(){var e;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null!==(e=n.editorRef.current.exportHtml())){t.next=4;break}return t.abrupt("return");case 4:return n.setState({creatingComment:!0}),t.next=7,n.props.createEnquiryEvent({variables:{enquiryId:n.props.id,htmlText:e}});case 7:n.setState({creatingComment:!1,editorHasText:!1,error:""}),n.editorRef.current.clear(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),n.setState({creatingComment:!1,error:t.t0.message}),console.log(t.t0);case 15:case"end":return t.stop()}},t,this,[[0,11]])})),n.changeStatus=function(){var t=Object(fn.a)(mn.a.mark(function t(e,r){var a,i,o;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,i=r.co,o=n.props.enquiryQuery.statuses.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,a!==o){t.next=8;break}if(n.state.statusPending){t.next=7;break}return t.abrupt("return",n.setState({statusPending:!0,activeCO:"new"}));case 7:n.setState({statusPending:!1});case 8:return t.prev=8,n.setState({changingStatus:!0}),t.next=12,n.props.createEnquiryEvent({variables:Object(l.a)({enquiryId:n.props.id,statusId:a},i&&{doc:Object(l.a)({},i)})});case 12:n.setState({changingStatus:!1,activeCO:""}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(8),n.setState({changingStatus:!1,error:t.t0.message}),console.log(t.t0);case 19:case"end":return t.stop()}},t,this,[[8,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.cancelPendingStatusChange=function(){n.setState({statusPending:!1,activeCO:""})},n.saveNote=Object(fn.a)(mn.a.mark(function t(){var e;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=n.noteEditorRef.current.exportHtml())!==n.props.enquiryQuery.enquiry.htmlNote){t.next=4;break}return t.abrupt("return",n.setState({noteKey:n.state.noteKey+1,noteEditorDiff:!1}));case 4:return n.setState({savingNote:!0}),t.next=7,n.props.updateEnquiry({variables:{input:{id:n.props.id,htmlNote:e}}});case 7:if(n.componentIsMounted){t.next=9;break}return t.abrupt("return");case 9:n.setState({savingNote:!1,error:"",noteKey:n.state.noteKey+1,noteEditorDiff:!1}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({savingNote:!1,error:t.t0.message}),console.log(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,12]])})),n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.editorHasText,i=e.creatingComment,o=e.changingStatus,c=e.statusPending,l=e.error,u=e.noteEditorDiff,s=e.noteKey,d=e.savingNote,m=e.activeCO,f=this.props.enquiryQuery,p=this.isNewEnquiry;if(f.loading)return a.a.createElement(qe,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...");if(f.error)return a.a.createElement(qe,null,"\u041e\u0448\u0438\u0431\u043a\u0430 ",f.error.message);var b=p?f.newEnquiry:f.enquiry,g=b.org,h=b.model,v=b.qty,y=b.htmlNote,E=b.events,O=E&&E.filter(function(t){return t.doc}),j=E&&E.filter(function(t){return t.status}).pop().status,x=f.statuses.slice(),w=x.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,k=x.find(function(t){return"\u0417\u0430\u043a\u0430\u0437"===t.name}).id,q=x.filter(function(t){return["\u041d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","\u041e\u0442\u043a\u0430\u0437"].includes(t.name)}).map(function(t){return t.id}),C=x.sort(function(t,e){return t.stage===e.stage&&q.includes(t.id)}),F=0,I=E&&E.reduce(function(t,e,n){return e.status&&0!==n?q.includes(e.status.id)?Object(Mn.a)(t).concat(["refuse"]):e.status.id===k?Object(Mn.a)(t).concat(["order"]):(t.push(e.status.stage-F>0?"up":"down"),F=e.status.stage,t):Object(Mn.a)(t).concat([null])},[]);return a.a.createElement(kn,null,function(e){var f=e.details,p=e.setDetails,x=f.id,F=f.editMode,S="new"===x;return a.a.createElement(r.Fragment,null,(F||S)&&a.a.createElement(Ra,{id:x,enquiry:b,setDetails:p}),!(F||S)&&a.a.createElement(r.Fragment,null,a.a.createElement(qe,null,a.a.createElement(yr,null,a.a.createElement("tbody",null,a.a.createElement(Er,null,a.a.createElement(Or,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(Or,null,g&&g.name),a.a.createElement(Or,null)),a.a.createElement(Er,null,a.a.createElement(Or,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(Or,null,h&&h.name),a.a.createElement(Or,null)),a.a.createElement(Er,null,a.a.createElement(Or,null,"\u041a\u043e\u043b-\u0432\u043e, \u0448\u0442."),a.a.createElement(Or,null,v),a.a.createElement(Or,null)),!!O.length&&a.a.createElement(Er,null,a.a.createElement(Or,null,"\u041a\u041f"),a.a.createElement(Or,null,O.map(function(t){var e=t.doc,n=e.id,r=e.dateLocal,i=e.amount;return a.a.createElement(he,{key:n,fw:"normal",lh:"1.21428571em"},a.a.createElement("b",null,Hn(i)," ")," ( \u043e\u0442 ",r," )")})),a.a.createElement(Or,null)),a.a.createElement(Er,null,a.a.createElement(Or,null,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),a.a.createElement(xr,null,a.a.createElement(Mr,{key:s,borderless:!0,ref:t.noteEditorRef,initFromHtml:y,setEditorDiff:t.setNoteEditorDiff,diff:u,onCtrlEnter:t.saveNote}),u&&a.a.createElement(xe,{mt:".67857143em",content:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u0435",labelPosition:"left",icon:"save",primary:!0,floated:"left",onClick:t.saveNote,disabled:d,loading:d})),a.a.createElement(Or,null)),a.a.createElement(Er,null,a.a.createElement(Or,null,"\u0421\u0442\u0430\u0442\u0443\u0441"),a.a.createElement(jr,null,a.a.createElement(ri,{labeled:!0,button:!0,className:"icon",loading:o,disabled:o||c,value:j.id,text:j.name,options:C.filter(function(t){return(t.id===j.id||1===Math.abs(t.stage-j.stage))&&!(0===t.stage&&0!==j.stage)}).map(function(t){return{key:t.id,text:t.name,value:t.id,label:{basic:!0,content:"\u0441\u0442",detail:t.stage,icon:q.includes(t.id)?"minus circle":t.id===k?"checkmark":"long arrow alternate ".concat(t.stage-j.stage>0?"up":"down")}}}),onChange:t.changeStatus,selectOnBlur:!1,selectOnNavigation:!1}),a.a.createElement(kr.a,{basic:!0,size:"large",content:"\u0441\u0442\u0430\u0434\u0438\u044f",detail:j.stage})),a.a.createElement(Or,null))))),m&&a.a.createElement(Ka,{id:m,submit:function(e){return t.changeStatus(null,{value:w,co:e})},cancel:t.cancelPendingStatusChange}),a.a.createElement(ai,{minimal:!0},a.a.createElement(Vt.a,{as:"h3",dividing:!0,content:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 \u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"}),E.map(function(t,e){var n=t.user.person,r=n.fName,i=n.lName,o=(i?r.slice(0,1):r.slice(0,2))+(i?i.slice(0,1):"");return a.a.createElement(wr.a,{key:t.id},t.type&&"COMMENT"!==t.type&&a.a.createElement(ii,{size:"big",type:t.type,color:"CREATE"===t.type?"green":"UPDATE"===t.type?"blue":"STATUS"===t.type&&"up"===I[e]?"yellow":"STATUS"===t.type&&"down"===I[e]?"brown":"STATUS"===t.type&&"refuse"===I[e]?"red":"STATUS"===t.type&&"order"===I[e]?"green":"grey",name:"CREATE"===t.type?"plus":"UPDATE"===t.type?"write square":"STATUS"===t.type&&"refuse"===I[e]?"minus circle":"STATUS"===t.type&&"order"===I[e]?"checkmark":"STATUS"===t.type?"long arrow alternate ".concat(I[e]):"question"}),a.a.createElement(oi,{size:"big",content:o,indent:t.type&&"COMMENT"!==t.type?0:1}),a.a.createElement(ci,null,a.a.createElement(li,{content:t.datetimeLocal.slice(0,16)}),a.a.createElement(ui,{dangerouslySetInnerHTML:{__html:Object(Lr.sanitize)(t.htmlText)}})))}),a.a.createElement(Xt.a,{reply:!0,error:!!l},a.a.createElement(ge,{m:"0 0 1em 6.35em"},a.a.createElement(Mr,{ref:t.editorRef,setEditorHasText:t.setEditorHasText,onSave:t.createComment})),a.a.createElement(si,{error:!0,header:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:l}),a.a.createElement(xe,{content:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442",labelPosition:"left",icon:"edit",primary:!0,floated:"right",onClick:t.createComment,disabled:!n,loading:i})))))})}}]),e}(r.Component),mi=Object(c.compose)(Object(c.graphql)(Ft,{name:"updateEnquiry"}),Object(c.graphql)(It,{name:"createEnquiryEvent",options:function(t){return{update:function(e,n){var r=n.data.createEnquiryEvent,a="Enquiry:".concat(t.id),i=St,o=e.readFragment({id:a,fragment:i});if(o.events.push(r),e.writeFragment({id:a,fragment:i,data:o}),r.status){var c=xt,l=(o=e.readQuery({query:c})).enquiries.find(function(e){return e.id===t.id});l.status=r.status,r.doc&&l.docs.push(r.doc),e.writeQuery({query:c,data:o})}}}}}),Object(c.graphql)(qt,{name:"enquiryQuery",skip:function(t){return"new"!==t.id}}),Object(c.graphql)(wt,{name:"enquiryQuery",skip:function(t){return"new"===t.id}}))(di),fi=n(445),pi=n.n(fi),bi=function(t){function e(){var t,n;Object(De.a)(this,e);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(i)))).state={value:n.props.field.curVal||""},n.input=Object(r.createRef)(),n.debouncedSetField=pi()(function(t){var e=n.props,r=e.field.name;(0,e.setField)(r,{value:t})},250),n.writeVal=function(t){n.setState({value:t}),n.debouncedSetField(t)},n.handleInputChange=function(t,e){var r=e.value;if(""===r)return n.writeVal("");if("int"===n.props.type){var a=parseInt(r,10);return a&&n.writeVal(a)}return n.writeVal(r)},n.onBlur=function(){var t=n.props,e=t.field.name,r=t.setField,a=n.input.current.children[0]||{},i=a.type,o=a.valueAsNumber;"number"===i&&Un(o)&&r(e,{err:{title:'\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u043e\u043b\u0435 "\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"',message:"\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=(t.field,t.setField,t.type),n=Object(Qt.a)(t,["field","setField","type"]),r=this.state.value;return a.a.createElement(Se,Object.assign({},n,{type:"int"===e?"number":e||"text",value:r,onChange:this.handleInputChange,onBlur:this.onBlur,ref:this.input}))}}]),e}(r.Component),gi=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).componentIsMounted=!0,n.isNewEntity="new"===n.props.id,n.state={loading:!1,err:null},n.submit=function(t){n.upsertOrder(Object(l.a)({},t,n.isNewEntity&&{enquiryId:n.props.enquiryId},!n.isNewEntity&&{id:n.props.id}))},n.upsertOrder=function(){var t=Object(fn.a)(mn.a.mark(function t(e){var r;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.upsertOrder({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:null}),n.props.setDetails({type:"Order",id:r.data.upsertOrder.id}),n.props.setExpanded({id:r.data.upsertOrder.enquiry.id,value:!0}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({loading:!1,err:{title:"".concat(n.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"," \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c.."),message:t.t0.message}}),console.log(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,12]])}));return function(e){return t.apply(this,arguments)}}(),n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state.loading,n=this.props,i=n.id,o=n.closeDetails,c=n.setDetails,l="new"===i,u=l?{dateLocal:zr(new Date).slice(0,10),qty:"",amount:""}:this.props.orderLocal.orderLocal;return a.a.createElement(Wa,{isNewEntity:l,entity:u,requiredFields:["dateLocal","qty","amount"],submit:this.submit,err:this.state.err},function(n){var l=n.disabled,u=n.err,s=n.setField,d=n.submit,m=n.formState,f=m.dateLocal,p=m.qty,b=m.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(qe,{bottomBorder:!0},a.a.createElement(Xt.a,null,a.a.createElement(Xt.a.Field,{inline:!0},a.a.createElement(Fe,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Ua,{field:f,setField:s})),a.a.createElement(Xt.a.Field,{inline:!0,required:!0},a.a.createElement(Fe,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(bi,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",field:p,setField:s}),a.a.createElement(ve,{pl:"6px"},"\u0448\u0442.")),a.a.createElement(Xt.a.Field,{inline:!0,required:!0},a.a.createElement(Fe,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(_a,{field:b,setField:s,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u0437\u0430\u043a\u0430\u0437\u0430"})))),a.a.createElement(qe,null,u&&a.a.createElement(_t.a,{error:!0,header:u.title,content:u.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(Ut.a,{primary:!0,content:t.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:l,loading:e,onClick:d}),a.a.createElement(ye,{cancel:!0,onClick:"new"===i?o:function(){return c({type:"Order",id:i})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))})}}]),e}(r.Component),hi=Object(c.compose)(Object(c.graphql)(P,{name:"upsertOrder",options:{update:function(t,e){var n=e.data.upsertOrder,r=xt,a=t.readQuery({query:r}),i=a.enquiries.find(function(t){return t.id===n.enquiry.id});i.orders=Object(Mn.a)(i.orders.filter(function(t){return t.id!==n.id})).concat([n]).sort(function(t,e){return t.fullnum>e.fullnum?1:-1}),t.writeQuery({query:r,data:a})}}}),Object(c.graphql)(B,{name:"orderLocal",skip:function(t){return"new"===t.id}}))(gi),vi=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.buttons,n=t.size,r=t.noIndent,i=t.bottomBorder,o=t.title,c=t.subtitle,l=t.titleSize,u=t.onClick,s=t.expanded;return a.a.createElement(ir,{expanded:s,onClick:u,size:n,noIndent:r,bottomBorder:i},a.a.createElement(cr,{title:o,subtitle:c,size:l||n}),e&&a.a.createElement(lr,null,e))}}]),e}(r.Component);function yi(){var t=Object(h.a)(["\n  & {\n    z-index: -1;\n    width: 100%;\n    padding: 0;\n    margin-bottom: -1px;\n  }\n"]);return yi=function(){return t},t}function Ei(){var t=Object(h.a)(["\n  & {\n    width: 100%;\n    padding: 0;\n    ","\n  }\n"]);return Ei=function(){return t},t}var Oi=Object(Tt.b)(qe)(Ei(),function(t){return t.expanded&&"{\n      margin-top: -1px;\n      border-bottom-color: rgba(34, 36, 38, 0.15);\n    }"}),ji=Object(Tt.b)(Object(He.b)(qe)({enter:{y:0},exit:{y:"-100%"}}))(yi()),xi=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={expanded:!!n.props.initiallyExpanded},n.expand=function(){return n.setState({expanded:!0})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.children,r=e.disabled,i=e.forceExpanded,o=Object(Qt.a)(e,["children","disabled","forceExpanded"]),c=!r&&(i||this.state.expanded);return a.a.createElement(Oi,{expanded:c?1:0,topBorder:c,bottomBorder:c},a.a.createElement(vi,Object.assign({},o,{expanded:c,bottomBorder:c&&"dark",disabled:i,titleSize:"small",onClick:!i&&function(){return t.setState({expanded:!t.state.expanded})}})),a.a.createElement(ge,{oy:"hidden"},a.a.createElement(He.a,null,c&&a.a.createElement(ji,{key:1},n))))}}]),e}(r.Component),wi=n(195),ki=n.n(wi),qi=function(t){var e=t.children,n=t.prods,r=t.selectedIds,a=t.orderId,i=t.selectLimit,o=t.selectedProds,c=void 0===o?[]:o,u=t.orderProdsQty,s=t.diff,d=t.expandedIds,m=t.expanded,f=Object(l.a)({},a&&{extra:!0},a&&i===r.length&&{limitReached:!0},!a&&{order:!0},s&&{diff:!0},d&&{expand:!0},m&&{expanded:!0}),p=f.extra?n:f.order?ki.a.unionBy(n,c,"id"):[],b=ki()(p).sortBy("dept.type").groupBy("dept.name").reduce(function(t,e){var i=Object(l.a)({},e[0].dept);if(i=Object(l.a)({},i,{count:e.length,readyCount:e.filter(function(t){return 100===t.progress}).length,hasDefect:e.filter(function(t){return t.hasDefect}).length,isSpoiled:e.filter(function(t){return t.isSpoiled}).length},f.expand&&{expanded:d.some(function(t){return t===i.id})},f.expanded&&{expanded:!0},{prods:e.map(function(t){var e=Object(l.a)({},t,f.extra&&{selected:r.includes(t.id),ordered:!!t.order&&t.order.id!==a},f.order&&f.diff&&{added:!n.some(function(e){return e.id===t.id}),removed:!c.some(function(e){return e.id===t.id})});return f.extra&&(e=Object(l.a)({},e,{disabled:e.ordered||f.limitReached&&!e.selected})),e})}),f.extra){var o=i.prods.filter(function(t){return t.ordered}).length||0;i=Object(l.a)({},i,{selectedCount:i.prods.filter(function(t){return t.selected}).length||0,orderedCount:o,availCount:i.count-o}),i=Object(l.a)({},i,{selected:i.selectedCount===i.availCount||0!==i.selectedCount&&"partly"}),i=Object(l.a)({},i,{disabled:i.prods.every(function(t){return t.disabled})||f.limitReached&&[!1].includes(i.selected)})}return t.push(i),t},[]);if(f.order){var g=s?u-c.length:u-n.length;g&&b.unshift({id:"unreserved",name:"\u0411\u0435\u0437 \u0440\u0435\u0437\u0435\u0440\u0432\u0430",count:g,prods:[]})}return e({depts:b,xor:!!ki.a.xorBy(n,c,"id").length})},Ci=[{name:"name",path:"name",title:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a / \u2116 \u0418\u0437\u0434\u0435\u043b\u0438\u044f",width:"170px"},{name:"progress",path:"progress",title:"\u0417\u0430\u0432\u0435\u0440\u0448.",width:"65px"},{name:"hasDefect",path:"hasDefect",title:"\u041e\u0442\u043a\u043b\u043e\u043d.",width:"65px"},{name:"isSpoiled",path:"isSpoiled",title:"\u0411\u0440\u0430\u043a",width:"55px"},{name:"reserve",title:"\u0420\u0435\u0437\u0435\u0440\u0432",width:"75px"}],Fi=function(t){var e=t.depts,n=t.skipFields,i=void 0===n?[]:n,o=t.select,c=t.expand,l=t.indent,u=t.nameFieldWidth,s=Pr()(Ci);return u&&(s.find(function(t){return"name"===t.name}).width=u),a.a.createElement(Rn,{fields:s.filter(function(t){return!i.includes(t.name)}),indent:l,select:o,expand:c},function(t){var n=t.tableFields;return a.a.createElement(r.Fragment,null,e.map(function(t){var e=t.id,i=t.expanded;return"unreserved"===e?a.a.createElement(Xn,{key:e,entity:t,tableFields:n,rowFields:[{name:"name",value:t.name+" ("+t.count+")"}]}):a.a.createElement(r.Fragment,{key:e},a.a.createElement(Xn,{entity:t,tableFields:n,expandFor:"prods",expanded:i,expand:function(){return c(e)},onClick:function(){return c(e)},select:function(){return o(e)},rowFields:[{name:"name",value:t.name+" ("+t.count+")"},{name:"progress",path:"readyCount",icon:"checkmark",iconColor:"green"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",path:"orderedCount",icon:"gavel",iconColor:"brown"}]}),i&&t.prods.map(function(e,r){var i=e.id,c=e.progress,l=e.order,u=e.added,s=e.removed;return a.a.createElement(Xn,{secondary:1,lastSecondaryRow:r===t.prods.length-1?1:0,key:i,entity:e,tableFields:n,select:function(){return o(i)},rowFields:Object(Mn.a)(u||s?[{name:"service",value:!0,icon:u?"plus":"minus",iconColor:u?"green":"red"}]:[]).concat([{name:"name",path:"fullnumber"},{name:"progress",value:c&&c+"%"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",value:l&&l.fullnum}]),onClick:o&&function(){return o(i)}})}))}))})};function Ii(){var t=Object(h.a)(["\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\n"]);return Ii=function(){return t},t}var Si=Object(Tt.b)(Ht.a)(Ii()),Di=function(t){var e=t.modelId,n=t.orderId,r=t.prodIds;return a.a.createElement(kn,null,function(t){var i=t.extra,o=t.setExtra,c=t.setSelectedProdIds;return a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",active:!!i,onClick:function(t){t.stopPropagation(),c(r),o({type:"Store",modelId:e,orderId:n})}},a.a.createElement(Ht.a,{name:"gavel"}),"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",a.a.createElement(Si,{name:"angle right"}))})};function Mi(){var t=Object(h.a)(["\n\tquery ProdsLocal ($ids: [ID!]!) {\n\t\tprodsLocal (ids: $ids) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t}\n"]);return Mi=function(){return t},t}function Li(){var t=Object(h.a)(["\n\tquery ModelProds ($modelId: ID!) {\n\t\tmodelProds (modelId: $modelId) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t\torder {\n\t\t\t\tid\n\t\t\t\tfullnum\n\t\t\t\tenquiry {\n\t\t\t\t\tid\n\t\t\t\t\tnum\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]);return Li=function(){return t},t}var Ni=y()(Li()),Pi=y()(Mi()),Bi=Object(c.compose)(Object(c.graphql)(Pi,{name:"prodsLocal"}))(function(t){return(0,t.children)({prodsLocal:t.prodsLocal.prodsLocal||[]})}),$i=function(t){var e=t.order,n=e.id,i=e.model,o=e.qty,l=e.prods;return a.a.createElement(kn,null,function(t){var e=t.extra,u=t.setExtra,s=t.selectedProdIds;return a.a.createElement(xi,{forceExpanded:!!e,title:i.name,subtitle:o+"\u0448\u0442",buttons:a.a.createElement(Di,{modelId:i.id,orderId:n,prodIds:l.map(function(t){return t.id})})},a.a.createElement(Bi,{ids:s},function(t){var i=t.prodsLocal;return a.a.createElement(qi,{prods:l,selectedProds:i,orderProdsQty:o,expanded:!0,diff:!!e},function(t){var i=t.depts,o=t.xor;return a.a.createElement(r.Fragment,null,a.a.createElement(Fi,{depts:i,skipFields:["reserve"],expand:function(){return null},indent:"32px",nameFieldWidth:"200px"}),e&&a.a.createElement(c.Mutation,{mutation:A,variables:{orderId:n,prodIds:s}},function(t,e){var n=e.loading,i=e.error;return a.a.createElement(r.Fragment,null,a.a.createElement(qe,{minor:!0,head:!0,topBorder:"dark"},a.a.createElement(xe,{primary:!0,compact:!0,circular:!0,menu:!0,ml:"0",content:"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c",icon:"gavel",loading:n,disabled:!o,onClick:function(){t(),u(null)}})),i&&a.a.createElement(we,{section:!0,error:!0,header:"\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:i.message}))}))})}))})},Ai=function(t){var e=t.order;return a.a.createElement($i,{order:e})},zi=n(454),Ti=n(901),Ri=n(189);function Qi(){var t=Object(h.a)(["\n  position: absolute;\n  left: 5px;\n  top: 4px;\n  &&& {\n    opacity: ",";\n    :hover {\n      opacity: .5 !important;\n    }\n  }\n  ",":hover && {\n    opacity: ",";\n  }\n"]);return Qi=function(){return t},t}function Vi(){var t=Object(h.a)(["\n  position: absolute;\n  top: 7px;\n  left: 10px;\n  color: white;\n  &&& {\n    opacity: ",";\n  }\n  ",":hover && {\n    opacity: ",";\n  }\n"]);return Vi=function(){return t},t}function Hi(){var t=Object(h.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  cursor: pointer;\n  transition: background-image .135s cubic-bezier(0.0,0.0,0.2,1);\n  :hover {\n    background-image: linear-gradient(to bottom,rgba(0,0,0,0.26),transparent 56px,transparent);\n  }\n  ","\n  ","\n"]);return Hi=function(){return t},t}function Ui(){var t=Object(h.a)(["\n  width: 100%;\n  height: 100%;\n"]);return Ui=function(){return t},t}function _i(){var t=Object(h.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0,0,50,.03);\n"]);return _i=function(){return t},t}function Wi(){var t=Object(h.a)(["\n  position: relative;\n  width: 100%;\n  padding-top: ","%;\n  margin-bottom: 3px;\n"]);return Wi=function(){return t},t}var Ki=Tt.b.div(Wi(),function(t){return 100/t.proportion}),Gi=Tt.b.div(_i()),Ji=He.b.div({shrinked:{width:"calc(100% - 60px)",height:function(t){var e=t.proportion;return"calc(100% - 60px/".concat(e,")")}},fullsize:{width:"100%",height:"100%"}}),Xi=Tt.b.img(Ui()),Yi=Tt.b.div(Hi(),function(t){return t.hide&&"\n    background-image: unset !important;\n  "},function(t){return t.off&&"\n    display: none;\n  "}),Zi=Object(Tt.b)(Oe)(Vi(),function(t){return t.active?"1 !important":t.selectMode?".5 !important":"0"},Yi,function(t){return t.selectMode?"1 !important":".5"}),to=Object(Tt.b)(Oe)(Qi(),function(t){return t.active?".9 !important":"0"},Yi,function(t){return t.active?".9 !important":t.selectMode?".5 !important":".2"}),eo=Object(Ri.SortableElement)(function(t){var e=t.drawing,n=e.id,r=e.files,i=t.toggleSelection,o=t.selected,c=t.selectMode,l=t.sortMode,u=r.find(function(t){return"ORIGINAL"===t.imgFor}),s=r.find(function(t){return"FEED_792"===t.imgFor})||u,d=s.path,m=s.width,f=s.height,p=m/f;return a.a.createElement("div",null,a.a.createElement(Ki,{proportion:p},a.a.createElement(Gi,null,a.a.createElement(Yi,{hide:o,off:l,onClick:function(){if(o||c)return i(n);window.open(u.path,"_blank").focus()}},a.a.createElement(Zi,{link:!0,name:"square",size:"big",fs:"2.2em",active:o,d:l?"none !important":void 0,selectMode:c,color:o?"grey":void 0},a.a.createElement(to,{link:!0,name:"check",size:"small",color:"black",c:o?"#fff !important":void 0,active:o,selectMode:c,onClick:function(t){t.stopPropagation(),i(n)}}))),a.a.createElement(Ji,{pose:o||l?"shrinked":"fullsize",proportion:p,onClick:function(){return o&&i(n)}},a.a.createElement(Xi,{src:d,width:m,height:f})))))}),no=Object(Ri.SortableContainer)(function(t){var e=t.drawings,n=t.toggleDrawingSelection,r=t.selectedDrawings,i=t.sortMode;return a.a.createElement("div",null,e.map(function(t,e){return a.a.createElement(eo,{key:t.id,index:e,drawing:t,toggleSelection:n,selected:!!r.includes(t.id),selectMode:!!r.length,sortMode:i,disabled:!i})}))}),ro=n(452),ao=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={sortedCollection:[]},n.move=function(t,e){n.setState(Object(Be.a)(function(n){var r=n.sortedCollection.splice(t,1),a=Object(ro.a)(r,1)[0];n.sortedCollection.splice(e,0,a)}))},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return(0,this.props.children)({sortedCollection:this.state.sortedCollection,move:this.move})}}],[{key:"getDerivedStateFromProps",value:function(t,e){if(t.collection!==e.prevPropsCollection){console.log(" > getDerivedStateFromProps");var n=t.collection,r=t.sortBy;return{prevPropsCollection:n,sortedCollection:n.sort(function(t,e){return t[r]<e[r]?-1:1})}}return null}}]),e}(r.Component),io=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={list:[]},n.toggle=function(t){n.setState(Object(Be.b)(function(e){console.log("draft > ",e);var n=e.list.indexOf(t);-1!==n?e.list.splice(n,1):e.list.push(t)}))},n.clear=function(){return n.setState({list:[]})},n.removeMany=function(t){n.setState(function(e){var n=e.list;return{list:Object(Mn.a)(n.filter(function(e){return!t.includes(e)}))}})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return this.props.children({list:this.state.list,toggle:this.toggle,clear:this.clear,removeMany:this.removeMany})}}]),e}(r.Component),oo=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={bool:!1},n.toggle=function(){n.setState(function(t){return{bool:!t.bool}})},n.enable=function(){return n.setState({bool:!0})},n.disable=function(){return n.setState({bool:!1})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return this.props.children({bool:this.state.bool,toggle:this.toggle,enable:this.enable,disable:this.disable})}}]),e}(r.Component);function co(){var t=Object(h.a)(["\n  &&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return co=function(){return t},t}function lo(){var t=Object(h.a)(["\n  position: absolute;\n  z-index: 1;\n  top: 1px;\n  right: 0;\n  left: 0;\n  height: 48px;\n  display: flex;\n  align-items: center;\n  background-color: rgba(255,255,255,1);\n"]);return lo=function(){return t},t}function uo(){var t=Object(h.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 2;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0,0,0,.65);\n"]);return uo=function(){return t},t}function so(){var t=Object(h.a)(["\n  position: relative;\n  :focus {\n    outline: none;\n  }\n"]);return so=function(){return t},t}var mo=Tt.b.div(so()),fo=Object(Tt.b)(He.b.div({enter:{opacity:1},exit:{opacity:0}}))(uo()),po=Object(Tt.b)(He.b.div({enter:{opacity:1},exit:{opacity:0}}))(lo()),bo=Object(Tt.b)(Oe)(co()),go=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this;console.log("> Drawings render");var e=this.props,n=e.model,r=e.sidebarRef,i=n.id,o=n.drawings;return a.a.createElement(Qe,null,function(e){var u=e.notify;return a.a.createElement(c.Mutation,{mutation:Y,onCompleted:function(){return u({type:"success",title:"\u0424\u0430\u0439\u043b\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"})},onError:function(t){return u({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432",content:t.message})}},function(e,s){var d=s.loading,m=s.client;return a.a.createElement(c.Mutation,{mutation:Z,onCompleted:function(){return u({type:"success",title:"\u0424\u0430\u0439\u043b\u044b \u0443\u0434\u0430\u043b\u0435\u043d\u044b"})},onError:function(t){return u({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432",content:t.message})}},function(s,f){var p=f.loading;return a.a.createElement(c.Mutation,{mutation:tt,onCompleted:function(){return u({type:"success",content:"\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0447\u0435\u0440\u0442\u0435\u0436\u0435\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d"})},onError:function(t){return u({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438",content:t.message})}},function(c,f){var b=f.loading;return a.a.createElement(ao,{collection:o,sortBy:"sortOrder"},function(o){var f=o.sortedCollection,g=o.move;return a.a.createElement(io,null,function(o){var h=o.list,v=o.toggle,y=o.clear,E=o.removeMany;return a.a.createElement(oo,null,function(o){var O=o.bool,j=o.enable,x=o.disable;return a.a.createElement(zi.a,{disabled:O,onDrop:function(){var r=Object(fn.a)(mn.a.mark(function r(a){var o,c;return mn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("acceptedFiles > ",a),a.length){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,e({variables:{modelId:i,files:a}});case 5:if(o=r.sent){r.next=8;break}return r.abrupt("return");case 8:c=o.data,m.writeData({id:"Model:".concat(i),data:Object(l.a)({},n,{drawings:Object(Mn.a)(f).concat(Object(Mn.a)(c.createDrawings))})}),t.collapsableSection.expand();case 11:case"end":return r.stop()}},r,this)}));return function(t){return r.apply(this,arguments)}}(),disableClick:!0,accept:"image/jpeg, image/png",onDropRejected:function(){return u({type:"error",title:"\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0444\u0430\u0439\u043b\u0430",content:"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f .jpeg \u0438\u043b\u0438 .png"})}},function(e){var o=e.getRootProps,w=e.getInputProps,k=e.open,q=e.isDragActive;return a.a.createElement(mo,Object.assign({isDragActive:q},o()),a.a.createElement("input",w()),a.a.createElement(He.a,null,q&&a.a.createElement(fo,{key:"1"},a.a.createElement(Oe,{name:"download",size:"large",c:"white"})),h.length&&a.a.createElement(po,{key:"2"},a.a.createElement(bo,{link:!0,size:"large",name:"cancel",onClick:function(){return y()}}),a.a.createElement(ve,{fs:"1.1em",c:"rgba(0,0,0,.75)",fw:"700"},"\u0412\u044b\u0431\u0440\u0430\u043d\u043e \u0447\u0435\u0440\u0442\u0435\u0436\u0435\u0439: ",h.length),a.a.createElement(ve,{m:"0 23px 0 auto"},a.a.createElement(Oe,{link:!0,d:p?"none":void 0,activeColor:"#db2828",name:"trash alternate outline",size:"large",onClick:Object(fn.a)(mn.a.mark(function t(){var e;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=h,t.next=3,s({variables:{ids:e}});case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:m.writeData({id:"Model:".concat(i),data:Object(l.a)({},n,{drawings:Object(Mn.a)(f.filter(function(t){return!e.includes(t.id)}))})}),E(e),console.log("deleted!");case 9:case"end":return t.stop()}},t,this)}))}),a.a.createElement(Ti.a,{inline:!0,size:"small",active:p}))),O&&a.a.createElement(po,{key:"3"},a.a.createElement(bo,{link:!0,name:"check",size:"large",c:"#016936",onClick:Object(fn.a)(mn.a.mark(function t(){var e;return mn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!1,f.forEach(function(t,n){t.sortOrder!==n&&(e=!0,m.writeData({id:"Drawing:".concat(t.id),data:Object(l.a)({},t,{sortOrder:n})}))}),!e){t.next=5;break}return t.next=5,c({variables:{ids:f.map(function(t){return t.id})}});case 5:x();case 6:case"end":return t.stop()}},t,this)}))}),a.a.createElement(ve,{fs:"1.1em",c:"rgba(0,0,0,.75)",fw:"700"},"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430"),a.a.createElement(ve,{m:"0 23px 0 auto"},a.a.createElement(Ti.a,{inline:!0,size:"small",active:b})))),a.a.createElement(xi,{ref:function(e){return t.collapsableSection=e},initiallyExpanded:!!f.length,disabled:!f.length,title:"\u0427\u0435\u0440\u0442\u0435\u0436 ",subtitle:a.a.createElement(ve,{fs:"1.2em"},a.a.createElement(Oe,{name:"file image outline",mr:"4px"}),f.length),buttons:a.a.createElement(a.a.Fragment,null,a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",onClick:function(t){t.stopPropagation(),u({type:"warning",content:"\u0427\u0442\u043e\u0431\u044b \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b, \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b"}),k()},loading:d}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,icon:"sort",onClick:function(t){t.stopPropagation(),u({type:"warning",content:"\u0427\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u043d\u0443\u0436\u043d\u044b\u0435 \u0447\u0435\u0440\u0442\u0435\u0436\u0438"}),j()}}))},a.a.createElement(no,{drawings:f,toggleDrawingSelection:v,selectedDrawings:h,sortMode:O,onSortEnd:function(t){var e=t.oldIndex,n=t.newIndex;return g(e,n)},getContainer:function(){return r}})))})})})})})})})})}}]),e}(r.Component),ho=function(t){var e=t.model,n=t.sidebarRef;return a.a.createElement(a.a.Fragment,null,a.a.createElement(go,{model:e,sidebarRef:n}))};function vo(){var t=Object(h.a)(["\n\t/* flex-grow: 1; */\n\twidth: 60%;  // evaluates to 792px\n"]);return vo=function(){return t},t}var yo=Tt.b.div(vo()),Eo=function(t){var e=t.closeDetails,n=t.sidebarRef;return a.a.createElement(kn,null,function(t){var r=t.details,i=r.type,o=r.id,c=r.enquiryId,l=r.editMode,u=t.setDetails,s=t.setExpanded;return a.a.createElement(yo,null,a.a.createElement(tr,{type:i,id:o},function(t){var r=t.loading,d=(t.error,t.refetch),m=t.entity,f=t.localEntity;return a.a.createElement(a.a.Fragment,null,a.a.createElement(fr,{type:i,localEntity:f,closeDetails:e,setDetails:u,editMode:l,loading:r,refresh:function(){return d()}}),"Enquiry"===i?a.a.createElement(mi,{id:o,closeDetails:e}):null,"Order"===i&&("new"===o||l?a.a.createElement(hi,{id:o,enquiryId:c,closeDetails:e,setDetails:u,setExpanded:s}):m&&a.a.createElement(Ai,{order:m})),"Model"===i&&("new"===o||l?a.a.createElement("div",null):m&&a.a.createElement(ho,{model:m,sidebarRef:n})))}))})},Oo=n(447),jo=n.n(Oo),xo=n(448),wo=n.n(xo),ko=n(449),qo=n.n(ko),Co=n(450),Fo=n.n(Co),Io=n(196),So=n.n(Io),Do=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).select=function(t){var e=n.props,r=e.depts,a=e.setList,i=e.selectLimit,o=Pr()(r),c=o.reduce(function(t,e){return Object(Mn.a)(t).concat(Object(Mn.a)(e.prods.filter(function(t){return t.selected}).map(function(t){return t.id})))},[]),l=So()({id:t},o)||So()({prods:[{id:t}]},o),u=l.prods,s=l.id===t?l:So()({id:t},u);if(s.disabled)return null;var d=[];if("Prod"===s.__typename&&(d=c.includes(t)?jo()(c,t):Object(Mn.a)(c).concat([t])),"Dept"===s.__typename&&(["partly",!0].includes(s.selected)&&(d=Fo()(c,u.map(function(t){return t.id}))),!1===s.selected)){var m=wo()(u.filter(function(t){return!t.disabled}).map(function(t){return t.id}),i-c.length);d=qo()(c,m)}a(d)},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return(0,this.props.children)({select:this.select})}}]),e}(r.Component),Mo=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={list:[]},n.setList=function(t){return n.setState({list:t})},n.toggle=function(t){var e=n.state.list,r=e.includes(t)?Object(Mn.a)(e.filter(function(e){return e!==t})):Object(Mn.a)(e).concat([t]);n.setState({list:r})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){return this.props.children({list:this.state.list,setList:this.setList,toggle:this.toggle})}}]),e}(r.Component),Lo=Object(c.compose)(Object(c.graphql)(B,{name:"orderLocal"}))(function(t){return(0,t.children)({orderLocal:t.orderLocal.orderLocal||[]})});function No(){var t=Object(h.a)(["\n\twidth: 40%;\n\tmin-height: calc(100vh - 36px);\n\theight: fit-content;\n\t/* border-left: 1px solid rgb(126, 126, 129); */\n\tborder-left: 1px solid rgb(156, 156, 159);\n"]);return No=function(){return t},t}var Po=Tt.b.div(No()),Bo=function(t){var e=t.closeExtra;return a.a.createElement(kn,null,function(t){var n=t.extra,i=t.selectedProdIds,o=t.setSelectedProdIds;return a.a.createElement(Po,null,!!n&&a.a.createElement(r.Fragment,null,a.a.createElement(c.Query,{query:st,variables:{id:n.modelId}},function(t){var n=t.data.modelLocal;return a.a.createElement(vi,{title:n.name+" \u0432 \u043d\u0430\u043b\u0438\u0447\u0438\u0438",size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(Ht.a,{link:!0,name:"cancel",onClick:e})})}),a.a.createElement(c.Query,{query:Ni,variables:{modelId:n.modelId}},function(t){var e=t.loading,r=t.error,c=t.data;return e?a.a.createElement(qe,{noIndent:!0},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."):r?a.a.createElement(qe,{noIndent:!0},"\u041e\u0448\u0438\u0431\u043a\u0430 ",r.message):a.a.createElement(Lo,{id:n.orderId},function(t){var e=t.orderLocal;return a.a.createElement(Mo,null,function(t){var r=t.list,l=t.toggle;return a.a.createElement(qi,{prods:c.modelProds,selectedIds:i,orderId:n.orderId,selectLimit:e.qty,expandedIds:r},function(t){var n=t.depts;return a.a.createElement(Do,{depts:n,setList:o,selectLimit:e.qty},function(t){var e=t.select;return a.a.createElement(Fi,{depts:n,select:e,expand:l})})})})})})))})};function $o(){var t=Object(h.a)(["\n\t&&&& {\n\t\tdisplay: flex;\n\t\twidth: 120%;\n\t\tbackground-color: white;\n\t\ttransition: all .5s ease;\n\t\tmax-width: ",";\n\t\t","\n\t\t","\n\t}\n"]);return $o=function(){return t},t}var Ao=Object(Tt.b)(wn.a)($o(),function(t){return"Enquiry"===t.type?"1000px":"1320px"},function(t){return!t.extra&&"\n\t\t\t&.ui.visible.right.overlay.sidebar {\n\t\t\t\ttransform: translate3d(40%,0,0);\n\t\t\t}\n\t\t"},function(t){return t.extra&&"\n\t\t\twidth: 86%;\n\t\t"}),zo=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={detailsClosing:!1},n.closeDetails=function(){n.setState({detailsClosing:!0}),setTimeout(function(){n.props.setLayout({variables:{input:{details:null,extra:null}}}),n.setState({detailsClosing:!1})},300)},n.closeExtra=function(){n.props.setLayout({variables:{input:{extra:null}}})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.state.detailsClosing,n=this.props.layout,i=n.details,o=n.extra;return a.a.createElement(Kt.a,{innerRef:function(e){return t.sidebarRef=e}},a.a.createElement(Ao,{visible:!!i&&!e,extra:o?1:0,type:i&&i.type,animation:"overlay",direction:"right"},i&&a.a.createElement(r.Fragment,null,a.a.createElement(Eo,{key:i.type+i.id,closeDetails:this.closeDetails,sidebarRef:this.sidebarRef}),a.a.createElement(Bo,{extra:o,closeExtra:this.closeExtra}))))}}]),e}(r.Component),To=Object(c.compose)(Object(c.graphql)(x,w),Object(c.graphql)(k,{name:"setLayout"}))(zo);function Ro(){var t=Object(h.a)(["\n  flex: 0 0 0;\n  min-height: 387px;\n  background: #fff;\n  z-index: 10;\n  /* box-shadow: 0 0 20px rgba(34,36,38,.15); shadow of semantic-ui Sidebar*/\n  box-shadow: 0 0 20px 5px #fff;\n  transition: min-height .4s ease-out;\n  ","\n"]);return Ro=function(){return t},t}function Qo(){var t=Object(h.a)(["\n  flex: 1 0 50px;\n  min-height: 50px;\n  overflow-y: auto;\n  overflow-x: hidden;\n"]);return Qo=function(){return t},t}function Vo(){var t=Object(h.a)(["\n  height: calc(100vh - 36px) !important;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n"]);return Vo=function(){return t},t}var Ho=Tt.b.div(Vo()),Uo=Tt.b.div(Qo()),_o=Tt.b.div(Ro(),function(t){return!t.panelVisible&&"\n    min-height: 0;\n  "}),Wo=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.children,n=t.panel,r=t.panelVisible,i=t.panelRendered;return a.a.createElement(Ho,null,a.a.createElement(Uo,{panelVisible:r},e),a.a.createElement(_o,{panelVisible:r},i&&n))}}]),e}(r.Component);function Ko(){var t=Object(h.a)(["\n\tfragment TelFragment on Tel {\n\t\tid\n\t\tnumber\n\t\ttype\n\t\tcountry\n\t\tnote\n\t\tdefault\n\t}\n"]);return Ko=function(){return t},t}var Go=y()(Ko());function Jo(){var t=Object(h.a)(["\n\tquery Persons {\n\t\tpersons { ...PersonFragmentBasic }\n\t}\n\t","\n"]);return Jo=function(){return t},t}function Xo(){var t=Object(h.a)(["\n\tfragment PersonContactsFragment on Person {\n\t\t...PersonFragmentBasic\n\t\thtmlNote\n\t\ttels { ...TelFragment }\n\t\tuser {\n\t\t\temail\n\t\t\tconfirmed\n\t\t}\n\t}\n\t","\n\t","\n"]);return Xo=function(){return t},t}function Yo(){var t=Object(h.a)(["\n\tfragment PersonFragmentBasic on Person {\n\t\tid\n\t\tamoId\n\t\tfName\n\t\tlName\n\t\tmName\n\t\tamoName\n\t}\n"]);return Yo=function(){return t},t}var Zo=y()(Yo()),tc=y()(Xo(),Go,Zo),ec=y()(Jo(),Zo);function nc(){var t=Object(h.a)(["\n\tmutation UpsertEmployee(\n\t\t$input: EmployeeInput!\n\t) {\n\t\tupsertEmployee(\n\t\t\tinput: $input\n\t\t) {\n\t\t\tid\n\t\t}\n\t}\n"]);return nc=function(){return t},t}function rc(){var t=Object(h.a)(["\n\tquery OrgEmployees ($orgId: ID!) {\n\t\torgEmployees (orgId: $orgId) {\n\t\t\tid\n\t\t\tposition\n\t\t\tperson { ...PersonContactsFragment }\n\t\t}\n\t}\n\t","\n"]);return rc=function(){return t},t}var ac=y()(rc(),tc),ic=y()(nc());function oc(){var t=Object(h.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tborder-bottom: 1px solid #7e7e81;\n\t/* border-top: 1px solid rgb(180, 181, 182); color of Chrome address section bottom border */\n\tborder-top: 1px solid rgb(160, 161, 162);\n"]);return oc=function(){return t},t}var cc=Tt.b.div(oc()),lc=function(t){var e=t.closePanel;return a.a.createElement(kn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(cc,null,a.a.createElement(Oe,{w:"30px",m:"0 10px",link:!0,name:"cancel",size:"large",onClick:e}),a.a.createElement(c.Query,{query:_r,variables:{id:n.orgId}},function(t){var e=t.data;return e&&e.orgLocal?a.a.createElement(Ee,{inline:!0,pl:"0 !important",size:"medium",content:"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u0438 \xa0 ".concat(e.orgLocal.name)}):null}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",active:!n.id,onClick:function(){return r(Object(Be.a)(n,function(t){delete t.id}))}}))})},uc=function(t){var e=t.tel;return a.a.createElement("div",null,Vn(e))};function sc(){var t=Object(h.a)(["\n  flex: 1 1 auto;\n  min-width: 210px;\n  font-size: calc(15rem/14);\n  font-weight: bold;\n  line-height: 1.21428571rem;\n  padding-top: .67857143rem;\n"]);return sc=function(){return t},t}function dc(){var t=Object(h.a)(["\n  flex: 0 0 122px;\n  color: rgba(0,0,0,.87);\n  line-height: 1.21428571rem;\n  padding-top: .67857143rem;\n  vertical-align: top;\n"]);return dc=function(){return t},t}function mc(){var t=Object(h.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: .67857143rem;\n"]);return mc=function(){return t},t}var fc=Tt.b.div(mc()),pc=Tt.b.div(dc()),bc=Tt.b.div(sc()),gc=function(t){var e=t.type,n=t.label,i=t.content,o=function(t){return"string"===e?t:"tel"===e?a.a.createElement(uc,{tel:t}):null};return a.a.createElement(fc,null,a.a.createElement(pc,null,n),a.a.createElement(bc,null,Array.isArray(i)?i.map(function(t,e){return a.a.createElement(r.Fragment,{key:e},o(t))}):o(i)))},hc=function(t){return function t(e,n,r){var i=Array.isArray(n)?n[0]:n,o=Object.keys(i);if(o.includes("label")){var c=i.type||"string";return a.a.createElement(gc,{key:r,type:c,label:i.label,content:e})}return o.filter(function(t){return Array.isArray(e[t])?e[t].length:!!e[t]}).map(function(r,a){return t(e[r],n[r],a)})}(t.entity,t.schema,"0")},vc=Object(la.object)().shape({id:ua.notRequired(),country:Object(la.string)().oneOf(["rus","notRus"]).when("id",function(t,e){return t?e.notRequired():e.default("rus")}),number:Object(la.lazy)(function(t){return t?Object(la.string)().transform(function(t){return t.match(/.*\d.*/)?t.match(/\d+/g).join(""):t}).when("country",{is:"rus",then:Object(la.string)().matches(/\d{10}/,"\u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c 10 \u0446\u0438\u0444\u0440"),otherwise:Object(la.string)().matches(/\d{7,25}/,"\u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043e\u0442 7 \u0434\u043e 25 \u0446\u0438\u0444\u0440")}):Object(la.string)()})}),yc=Object(la.object)().shape({id:ua.notRequired(),lName:Object(la.lazy)(function(t){return t?Object(la.string)().trim().min(2).max(255):Object(la.string)()}),fName:Object(la.string)().trim().min(2).max(255).when("id",function(t,e){return t?e.notRequired():e.required("\u041f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435 \u0418\u043c\u044f")}),mName:Object(la.lazy)(function(t){return t?Object(la.string)().trim().min(2).max(255):Object(la.string)()}),tels:Object(la.array)().of(vc)}),Ec=Object(la.object)().shape({id:ua.notRequired(),orgId:ua.when("id",function(t,e){return t?e.notRequired():e.required()}),person:yc}),Oc={person:{lName:"",fName:"",mName:"",tels:[{number:"",country:"rus"}]}},jc={person:{lName:{label:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"},fName:{label:"\u0418\u043c\u044f"},mName:{label:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"},tels:[{label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel"}]}},xc=function(t){var e=t.emp,n=t.toggleEditMode;return a.a.createElement(a.a.Fragment,null,a.a.createElement(vi,{title:e.person.fullname,size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(a.a.Fragment,null,a.a.createElement(Oe,{link:!0,name:"edit",activeColor:"blue",onClick:n}))}),a.a.createElement(ge,{p:"1em"},a.a.createElement(hc,{entity:e,schema:jc})))},wc=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).didMount=!1,n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"componentDidMount",value:function(){this.didMount=!0}},{key:"componentWillUnmount",value:function(){this.didMount=!1}},{key:"render",value:function(){var t=this,e=this.props,n=e.emp,r=e.orgId,i=e.toggleEditMode,o=e.refetchQueries,u=n?Oc:Object(l.a)({},Oc,{orgId:r}),s=n?na(n,u):u;return a.a.createElement(c.Mutation,{mutation:ic,onCompleted:function(){return o()}},function(e,r){var o=r.loading,c=r.error;return a.a.createElement(ea.b,{initialValues:s,validationSchema:Ec,onSubmit:function(){var r=Object(fn.a)(mn.a.mark(function r(a,o){var c,l;return mn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=o.resetForm,l=ra(a,s,u),r.next=4,e({variables:{input:l}});case 4:return r.abrupt("return",n?i():t.didMount&&c());case 5:case"end":return r.stop()}},r,this)}));return function(t,e){return r.apply(this,arguments)}}()},function(t){t.values,t.handleChange;var e=t.handleSubmit,r=t.handleReset;t.setFieldValue;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ba,{label:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",name:"person.lName"}),a.a.createElement(Ba,{label:"\u0418\u043c\u044f",required:!0,name:"person.fName"}),a.a.createElement(Ba,{label:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",name:"person.mName"}),a.a.createElement(Ba,{label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",name:"person.tels"}),!!c&&a.a.createElement(we,{error:!0,header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c..",content:c&&c.message}),a.a.createElement(xe,{ml:"122px",type:"button",primary:!0,content:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:o,onClick:e}),a.a.createElement(ye,{cancel:!0,onClick:n?i:r},n?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})}}]),e}(r.Component),kc=function(t){function e(){return Object(De.a)(this,e),Object(Le.a)(this,Object(Ne.a)(e).apply(this,arguments))}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this.props,e=t.emp,n=t.orgId,r=t.toggleEditMode,i=t.refetchQueries;return a.a.createElement(a.a.Fragment,null,a.a.createElement(vi,{title:e?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044f",size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(a.a.Fragment,null)}),a.a.createElement(ge,{p:"1em",oy:"auto",h:"315px"},a.a.createElement(wc,{emp:e,orgId:n,toggleEditMode:r,refetchQueries:i})))}}]),e}(r.Component),qc=[{name:"fullname",title:"\u0424\u0418\u041e",width:"250px"},{name:"tel",title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",width:"140px"}],Cc=function(t){var e=t.emps;return a.a.createElement(kn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(Rn,{fields:qc,indent:"27px"},function(t){var i=t.tableFields;return e.map(function(t){var e=t.id,o=t.person,c=o||{},u=c.lName,s=c.fName,d=c.mName,m=c.tels,f=n.id===e;return a.a.createElement(Xn,{key:e,entity:t,tableFields:i,rowFields:[{name:"fullname",value:o?[u,s,d].join(" "):"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u044b"},{name:"tel",value:m&&m.length&&Vn(m[0])||""}],active:f,onClick:function(){r(Object(l.a)({},n,{editMode:!1,id:e}))}})})})})};function Fc(){var t=Object(h.a)(["\n  flex: 0 0 480px;\n  border: solid rgb(156,156,159);\n  border-width: 0 1px;\n  min-height: 100%;\n"]);return Fc=function(){return t},t}function Ic(){var t=Object(h.a)(["\n  flex: 0 0 600px;\n"]);return Ic=function(){return t},t}function Sc(){var t=Object(h.a)(["\n  display: flex;\n  height: calc(100% - 37px);\n"]);return Sc=function(){return t},t}var Dc=Tt.b.div(Sc()),Mc=Tt.b.div(Ic()),Lc=Tt.b.div(Fc()),Nc=function(t){var e=t.closePanel;return a.a.createElement(kn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(a.a.Fragment,null,a.a.createElement(lc,{closePanel:e}),a.a.createElement(c.Query,{query:ac,variables:{orgId:n.orgId}},function(t){var e=t.loading,i=t.error,o=t.data,c=t.refetch;if(e)return"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..";if(i)return"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(i.message);var u,s=o.orgEmployees,d=n.id&&o.orgEmployees.find(function(t){return t.id===n.id});return a.a.createElement(Dc,null,a.a.createElement(Mc,null,s.length?a.a.createElement(Cc,{emps:s}):a.a.createElement(we,{m:"1em",content:a.a.createElement(a.a.Fragment,null,"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044f",a.a.createElement("br",null),"\ud83d\udc49")})),a.a.createElement(Lc,null,n.id?d.person?n.editMode?a.a.createElement(kc,{emp:d,orgId:n.orgId,toggleEditMode:function(){return r(Object(Be.a)(n,function(t){delete t.editMode}))},refetchQueries:c}):a.a.createElement(xc,{emp:(u=d,Object(Be.a)(u,function(t){var e=t.person,n=e.lName,r=e.fName,a=e.mName;t.person.fullname=[n,r,a].join(" ")})),toggleEditMode:function(){return r(Object(l.a)({},n,{editMode:!0}))}}):null:a.a.createElement(kc,{orgId:n.orgId,refetchQueries:c})))}))})};function Pc(){var t=Object(h.a)(["\n\tmin-height: calc(100vh - 36px) !important;\n"]);return Pc=function(){return t},t}var Bc=Object(Tt.b)(wn.a.Pushable)(Pc()),$c=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={panelClosing:!1},n.closePanel=function(){n.setState({panelClosing:!0}),setTimeout(function(){n.props.setLayout({variables:{input:{bottomPanel:null}}}),n.setState({panelClosing:!1})},430)},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.allEnquiries,r=n.loading,i=n.error,o=n.refetch,c=n.enquiries,l=e.refreshToken,u=this.state.panelClosing;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Dn,{refetchEnquiries:function(){return o()},enquiriesAreLoading:r,refreshToken:l}),r&&"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",i&&"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(i.message),c&&a.a.createElement(kn,null,function(e){var n=e.bottomPanel;return a.a.createElement(Bc,null,a.a.createElement(To,null),a.a.createElement(wn.a.Pusher,null,a.a.createElement(Wo,{panel:a.a.createElement(Nc,{closePanel:t.closePanel}),panelRendered:!!n,panelVisible:!!n&&!u},a.a.createElement(Zn,{enquiries:c}))))}))}}]),e}(r.Component),Ac=Object(c.compose)(Object(c.graphql)(xt,{name:"allEnquiries",alias:"allEnquiriesQuery"}),Object(c.graphql)(k,{name:"setLayout"}))($c),zc=n(451);function Tc(){var t=Object(h.a)(["\n\tfragment ArticleFragmentFull on Article {\n\t\t...ArticleFragmentBasic\n\t\trelations\n\t}\n\t","\n"]);return Tc=function(){return t},t}function Rc(){var t=Object(h.a)(["\n\tfragment ArticleFragmentBasic on Article {\n\t\tid\n\t\trusName\n\t\tisIncome\n\t\tisLoan\n\t}\n"]);return Rc=function(){return t},t}var Qc=y()(Rc()),Vc=y()(Tc(),Qc);function Hc(){var t=Object(h.a)(["\n\tfragment AccountFragmentFull on Account {\n\t\t...AccountFragmentBasic\n\t\tname\n\t}\n\t","\n"]);return Hc=function(){return t},t}function Uc(){var t=Object(h.a)(["\n\tfragment AccountFragmentBasic on Account {\n\t\tid\n\t}\n"]);return Uc=function(){return t},t}var _c=y()(Uc()),Wc=y()(Hc(),_c);function Kc(){var t=Object(h.a)(["\n\tfragment EquipmentFragmentFull on Equipment {\n\t\t...EquipmentFragmentBasic\n\t}\n\t","\n"]);return Kc=function(){return t},t}function Gc(){var t=Object(h.a)(["\n\tfragment EquipmentFragmentBasic on Equipment {\n\t\tid\n\t\tname\n\t}\n"]);return Gc=function(){return t},t}var Jc=y()(Gc());y()(Kc(),Jc);function Xc(){var t=Object(h.a)(["\n\tmutation UpsertPayment(\n\t\t$input: PaymentInput!\n\t) {\n\t\tupsertPayment(\n\t\t\tinput: $input\n\t\t) {\n\t\t\t...PaymentFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return Xc=function(){return t},t}function Yc(){var t=Object(h.a)(["\n\tquery PaymentsPage {\n\t\taccounts { ...AccountFragmentFull }\n\t\tarticles { ...ArticleFragmentFull }\n\t\tequipments { ...EquipmentFragmentBasic }\n\t\tpayments { ...PaymentFragmentBasic }\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return Yc=function(){return t},t}function Zc(){var t=Object(h.a)(["\n\tquery Payments {\n\t\tpayments { ...PaymentFragmentBasic }\n\t}\n\t","\n"]);return Zc=function(){return t},t}function tl(){var t=Object(h.a)(["\n\tfragment PaymentFragmentBasic on Payment {\n\t\tid\n\t\tdateLocal\n\t\tamount\n\t\tpurpose\n\t\taccount { ...AccountFragmentBasic }\n\t\tarticle { ...ArticleFragmentBasic }\n\t\tequipment { ...EquipmentFragmentBasic }\n\t\tperson { ...PersonFragmentBasic }\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return tl=function(){return t},t}var el=y()(tl(),_c,Qc,Jc,Zo),nl=(y()(Zc(),el),y()(Yc(),Wc,Vc,Jc,el)),rl=y()(Xc(),el);function al(){var t=Object(h.a)(["\n\tmutation SyncWithAmoContacts {\n\t\tsyncWithAmoContacts {\n\t\t\tcount\n\t\t}\n\t}\n"]);return al=function(){return t},t}var il=y()(al()),ol=Object(la.object)().shape({id:ua.notRequired(),amount:Object(la.number)().positive("\u0437\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c").required("\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443"),articleId:ua.when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430")}),dateLocal:Object(la.date)("\u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u0442\u044b").required("\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414T\u0427\u0427:\u041c\u041c"),equipmentId:ua.notRequired(),personId:ua.when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442\u0430")}),purpose:Object(la.string)().max(250,"\u043f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (250)").notRequired()});function cl(){var t=Object(h.a)(["\n\t.fz-formFieldLabel {\n\t\t","\n\t}\n"]);return cl=function(){return t},t}function ll(){var t=Object(h.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\theight: 52px;\n\tpadding: 0 2rem;\n\tfont-size: 1.28571429rem;\n\tline-height: 1.28571429em;\n\tfont-weight: bold;\n\tborder-bottom: 1px solid rgba(34,36,38,.15);\n"]);return ll=function(){return t},t}function ul(){var t=Object(h.a)(["\n\tmin-height: content;\n\tmax-width: 50%;\n\tflex: 1 1 500px;\n\tbox-shadow: 0 2px 4px 0 rgba(34,36,38,.12), 0 2px 10px 0 rgba(34,36,38,.15);\n\tborder: 1px solid rgba(34,36,38,.15);\n\tborder-radius: .28571429rem;\n"]);return ul=function(){return t},t}var sl=Tt.b.div(ul()),dl=Tt.b.div(ll()),ml=Tt.b.div(cl(),function(t){var e=t.labelWidth;return e?"flex-basis: ".concat(e," !important;"):""}),fl=function(t){var e,n=t.payment,r=t.articles,i=t.equipment,o=(e=new Date,{dateLocal:zr(e),articleId:"",equipmentId:"",personId:"",purpose:"",amount:""}),l=n?na(n,o):o,u=r.map(function(t){return{key:t.id,text:t.rusName,value:t.id}});return a.a.createElement(Qe,null,function(t){var e=t.notify;return a.a.createElement(sl,null,a.a.createElement(c.Query,{query:ec,onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432",content:t.message})}},function(t){var s=t.loading,d=t.data,m=t.refetch;return a.a.createElement(a.a.Fragment,null,a.a.createElement(c.Mutation,{mutation:il,onCompleted:function(){m(),e({type:"success",title:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441 \u0410\u043c\u043e",content:t.message})}},function(t,e){var n=e.loading;return a.a.createElement(dl,null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u0442\u0435\u0436",a.a.createElement(xe,{ml:"auto",icon:"sync alternate",content:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b AmoCRM",onClick:function(){return t()},loading:n}))}),a.a.createElement(ge,{p:"1rem 2rem"},a.a.createElement(c.Mutation,{mutation:rl,onCompleted:function(){return e({type:"success",title:"\u041f\u043b\u0430\u0442\u0435\u0436 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f",content:t.message})},update:function(t,e){var n=e.data.upsertPayment,r=t.readQuery({query:nl}).payments;t.writeQuery({query:nl,data:{payments:Object(Be.a)(r,function(t){t.unshift(n)})}})}},function(t,e){var c=e.loading;return a.a.createElement(ea.b,{initialValues:l,validationSchema:ol,onSubmit:function(){var e=Object(fn.a)(mn.a.mark(function e(r,a){var i,c,l;return mn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.resetForm,c=n?na(n,o):o,l=ra(r,c,o),e.next=5,t({variables:{input:l}});case 5:return e.abrupt("return",i());case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},function(t){var e=t.values,o=t.handleSubmit,l=t.handleReset;return a.a.createElement(ml,{labelWidth:"110px"},a.a.createElement(Ba,{label:"\u0414\u0430\u0442\u0430",required:!0,name:"dateLocal",type:"date"}),a.a.createElement(Ba,{label:"\u0421\u0442\u0430\u0442\u044c\u044f",required:!0,name:"articleId",options:u}),a.a.createElement(Ba,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",required:!0,name:"personId",options:d.persons?d.persons.map(function(t){return{key:t.id,text:t.amoName||t.fName,value:t.id}}):void 0,loading:s,disabled:s}),e.articleId&&r.find(function(t){return t.id===e.articleId}).relations&&r.find(function(t){return t.id===e.articleId}).relations.includes("EQUIPMENT")&&a.a.createElement(Ba,{label:"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435",required:!0,name:"equipmentId",options:i.map(function(t){return{key:t.id,text:t.name,value:t.id}})}),a.a.createElement(Ba,{label:"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",name:"purpose"}),a.a.createElement(Ba,{label:"\u0421\u0443\u043c\u043c\u0430",required:!0,name:"amount"}),a.a.createElement(xe,{ml:"110px",type:"button",primary:!0,content:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:c,onClick:o}),a.a.createElement(ye,{cancel:!0,onClick:l},n?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})))}))})},pl=n(907);function bl(){var t=Object(h.a)(["\n\t&&&&>.value {\n\t\t","\n\t\ttext-align: unset;\n\t}\n\t&&&&>.label {\n\t\tpadding-left: 2em;\n\t\ttext-align: unset;\n\t}\n"]);return bl=function(){return t},t}var gl=Object(Tt.b)(pl.a)(bl(),function(t){var e=t.color;return e&&"\n\t\t\tcolor: ".concat("green"===e?"#016936":"red"===e?"#9f3a38":"purple"===e?"#9924bf":"",";\n\t\t")}),hl=function(t){var e=t.payments,n=t.accounts,r=e.reduce(function(t,e){return t.find(function(t){return t.id===e.account.id}).total+=(e.article.isIncome?1:-1)*e.amount,t},n.map(function(t){return Object(l.a)({},t,{total:0})})),i=e.map(function(t){return t.person}).reduce(function(t,e){return t.find(function(t){return t.id===e.id})||t.push(e),t},[]),o=e.filter(function(t){return t.article.isLoan}).reduce(function(t,e){return t.find(function(t){return t.id===e.person.id}).total+=(e.article.isIncome?1:-1)*e.amount,t},i.map(function(t){return Object(l.a)({},t,{total:0})})).reduce(function(t,e){return e.total>0?t[1].push(e):e.total<0&&t[0].push(Object(l.a)({},e,{total:-1*e.total})),t},[[],[]]);return a.a.createElement(ge,{m:"0 30px"},a.a.createElement(pl.a.Group,null,a.a.createElement(gl,{color:"green"},a.a.createElement(pl.a.Value,{content:Hn(r.reduce(function(t,e){return t+e.total},0))}),a.a.createElement(pl.a.Label,{content:"\u041a\u0430\u0441\u0441\u0430, \u0432 \u0442.\u0447."}),a.a.createElement(pl.a.Group,{horizontal:!0},r.map(function(t){var e=t.id,n=t.name,r=t.total;return a.a.createElement(pl.a,{key:e,label:n,value:Hn(r)})}))),a.a.createElement(gl,{color:"purple"},a.a.createElement(pl.a.Value,{content:Hn(o[0].reduce(function(t,e){return t+e.total},0))}),a.a.createElement(pl.a.Label,{content:"\u041d\u0430\u043c \u0434\u043e\u043b\u0436\u043d\u044b, \u0432 \u0442.\u0447."}),a.a.createElement(pl.a.Group,{horizontal:!0,size:"small"},o[0].map(function(t){var e=t.id,n=t.amoName,r=t.total;return a.a.createElement(pl.a,{key:e,label:n,value:Hn(r)})}))),a.a.createElement(gl,{color:"red"},a.a.createElement(pl.a.Value,{content:Hn(-o[1].reduce(function(t,e){return t+e.total},0))}),a.a.createElement(pl.a.Label,{content:"\u041c\u044b \u0434\u043e\u043b\u0436\u043d\u044b, \u0432 \u0442.\u0447."}),a.a.createElement(pl.a.Group,{horizontal:!0,size:"small"},o[1].map(function(t){var e=t.id,n=t.amoName,r=t.total;return a.a.createElement(pl.a,{key:e,label:n,value:Hn(r)})})))))};function vl(){var t=Object(h.a)(["\n  margin-top: 1rem;\n  max-height: 100%;\n  border: 1px solid rgba(34,36,38,.15);\n  border-radius: 0.285714rem;\n  .fz-tableHeaderRow {\n    border-top: none !important;\n  }\n"]);return vl=function(){return t},t}var yl=Tt.b.div(vl()),El=[{name:"dateLocal",path:"dateLocal",title:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043c\u044f",width:"145px"},{name:"article",path:"article.rusName",title:"\u0421\u0442\u0430\u0442\u044c\u044f",width:"180px"},{name:"person",path:"person.amoName",title:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",width:"200px"},{name:"equipment",path:"equipment.name",title:"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435",width:"170px"},{name:"purpose",path:"purpose",title:"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",width:"270px"},{name:"amount",path:"amount",title:"\u0421\u0443\u043c\u043c\u0430",width:"140px"}],Ol=function(t){var e=t.payments;return a.a.createElement(yl,null,a.a.createElement(Rn,{fields:El},function(t){var n=t.tableFields;return e.map(function(t){var e=t.id,r=t.dateLocal,i=t.amount,o=t.article.isIncome;return a.a.createElement(Xn,{key:e,entity:t,tableFields:n,rowFields:[{name:"dateLocal",value:r.slice(0,16).replace("T"," ")},{name:"amount",value:o?i:-i,color:o?"#016936":"#9f3a38"}]})})}))};function jl(){var t=Object(h.a)(["\n  flex: 1 1 2000px;\n  margin-top: 1rem;\n"]);return jl=function(){return t},t}function xl(){var t=Object(h.a)(["\n  flex: 1 0 content;\n  min-height: ","px;\n  display: flex;\n"]);return xl=function(){return t},t}function wl(){var t=Object(h.a)(["\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n"]);return wl=function(){return t},t}var kl=Tt.b.div(wl()),ql=Tt.b.div(xl(),403),Cl=Tt.b.div(jl()),Fl=function(t){return Object(zc.a)(t),a.a.createElement(c.Query,{query:nl},function(t){var e=t.loading,n=t.error,r=t.data,i=r.payments,o=r.articles,c=r.accounts,l=r.equipments;return a.a.createElement(kl,null,e?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":n?"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(n.message):a.a.createElement(a.a.Fragment,null,a.a.createElement(ql,null,a.a.createElement(fl,{articles:o,equipment:l}),a.a.createElement(hl,{payments:i,accounts:c})),a.a.createElement(Cl,null,a.a.createElement(Ol,{payments:i}))))})},Il=function(t){function e(){var t,n;Object(De.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(Le.a)(this,(t=Object(Ne.a)(e)).call.apply(t,[this].concat(a)))).state={token:n.props.token},n.bootStrapData=function(){try{var t=localStorage.getItem(b);if(null!==t&&void 0!==t)rn(t)?n.refreshToken(null):n.setState({token:t})}catch(e){console.log("")}},n.refreshToken=function(t){t?localStorage.setItem(b,t):(localStorage.removeItem(b),n.props.client.resetStore()),n.setState({token:t})},n}return Object(Pe.a)(e,t),Object(Me.a)(e,[{key:"componentDidMount",value:function(){this.bootStrapData()}},{key:"render",value:function(){var t=this,e=this.state.token;return a.a.createElement(Xe.a,null,e?a.a.createElement(c.Query,{query:ln,displayName:"meQuery"},function(e){var n=e.loading,r=e.error,i=e.data;return n?null:r?"Error!: ".concat(r.message):a.a.createElement(Ye.a,null,a.a.createElement(Ze.a,{exact:!0,path:"/",render:function(){return a.a.createElement(Ac,{refreshToken:t.refreshToken,me:i.me})}}),a.a.createElement(Ze.a,{exact:!0,path:"/pay",render:function(){return a.a.createElement(Fl,{refreshToken:t.refreshToken,me:i.me})}}),a.a.createElement(tn.a,{to:"/pay"}))}):a.a.createElement(xn,{refreshToken:this.refreshToken}))}}]),e}(r.Component),Sl=function(t){var e=t.client;return a.a.createElement(Re,null,a.a.createElement(Je,null),a.a.createElement(Tt.a,{theme:fe},a.a.createElement(Il,{client:e})))};o.a.render(a.a.createElement(c.ApolloProvider,{client:zt},a.a.createElement(Sl,{client:zt})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[467,2,1]]]);
//# sourceMappingURL=main.706323f8.chunk.js.map