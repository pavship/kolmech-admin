(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{386:function(t,e,n){t.exports=n(707)},707:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(53),o=n.n(i);n(392),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(373),l=n.n(c),u=n(225),d=n(10),s="kolmech-token",m={newEnquiry:{__typename:"Enquiry",id:"new"},layout:{__typename:"Layout",details:null,extra:null},lists:{__typename:"Lists",selectedProdIds:[]}},f=n(30),p=n(6),b=n(15),g=n.n(b);function h(){var t=Object(p.a)(["\n\tmutation SetExpanded($args: json) {\n\t\tsetExpanded(args: $args) @client {\n\t\t\targs\n\t\t}\n\t}\n"]);return h=function(){return t},t}function v(){var t=Object(p.a)(["\n\tmutation SetLayout($details: json, $extra: json) {\n\t\tsetLayout(details: $details, extra: $extra) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return v=function(){return t},t}function y(){var t=Object(p.a)(["\n\tquery getLayout {\n\t\tlayout @client {\n\t\t\tdetails\n\t\t\textra\n\t\t}\n\t}\n"]);return y=function(){return t},t}var E=g()(y()),O={props:function(t){return{layout:t.data.layout||{}}}},j=g()(v()),x=g()(h());function q(){var t=Object(p.a)(["\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return q=function(){return t},t}function w(){var t=Object(p.a)(["\n\tquery OrderDetails ($id: ID!) {\n\t\torder (id: $id) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return w=function(){return t},t}function k(){var t=Object(p.a)(["\n\tquery OrderLocal ($id: ID!) {\n\t\torderLocal (id: $id) {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\tqty\n\t\t\tamount\n\t\t}\n\t}\n"]);return k=function(){return t},t}function C(){var t=Object(p.a)(["\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\n\t\t\t...OrderFragmentBasic\n\t\t\tenquiry {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return C=function(){return t},t}function S(){var t=Object(p.a)(["\n\tfragment OrderFragmentFull on Order {\n\t\t...OrderFragmentBasic\n\t\thtmlNote\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tprods {\n\t\t\tid\n\t\t\tfullnumber,\n\t\t\thasDefect,\n\t\t\tisSpoiled,\n\t\t\tprogress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return S=function(){return t},t}function I(){var t=Object(p.a)(["\n\tfragment OrderFragmentBasic on Order {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t\tqty\n\t\tamount\n\t}\n"]);return I=function(){return t},t}var F=g()(I()),D=g()(S(),F),L=g()(C(),F),N=g()(k()),$=g()(w(),D),T=g()(q(),D);function M(){var t=Object(p.a)(["\n\tfragment DocFragmentBasic on Doc {\n\t\tid\n\t\ttype\n\t\tdateLocal\n\t\tamount\n\t}\n"]);return M=function(){return t},t}var B=g()(M());function P(){var t=Object(p.a)(["\n\tfragment StatusFragment on Status {\n\t\tid\n    name\n    stage\n\t}\n"]);return P=function(){return t},t}var z=g()(P());function Q(){var t=Object(p.a)(["\n\tfragment myEnquiry on Enquiry {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t\thtmlNote\n\t\tisExpanded\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel {\n\t\t\tid\n\t\t\tarticle\n\t\t\tname\n\t\t}\n\t\tqty\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n"]);return Q=function(){return t},t}function A(){var t=Object(p.a)(["\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdoc { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n"]);return A=function(){return t},t}function R(){var t=Object(p.a)(["\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\n\t\tupdateEnquiry(input: $input) {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel {\n\t\t\t\tid\n\t\t\t\tarticle\n\t\t\t\tname\n\t\t\t}\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n"]);return R=function(){return t},t}function V(){var t=Object(p.a)(["\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel {\n\t\t\t\tid\n\t\t\t\tarticle\n\t\t\t\tname\n\t\t\t}\n\t\t\tqty\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t\torders {\n\t\t\t\tid\n\t\t\t\tnum\n\t\t\t\tdateLocal\n\t\t\t\tqty\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n"]);return V=function(){return t},t}function H(){var t=Object(p.a)(["\n\tquery {\n\t\tnewEnquiry @client {\n\t\t\tid\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n"]);return H=function(){return t},t}function _(){var t=Object(p.a)(["\n\tquery EnquiryLocal ($id: ID!) {\n\t\tenquiryLocal (id: $id) {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n"]);return _=function(){return t},t}function K(){var t=Object(p.a)(["\n\tquery EnquiryDetails ($id: ID!) {\n\t\tenquiry (id: $id) {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel {\n\t\t\t\tid\n\t\t\t\tarticle\n\t\t\t\tname\n\t\t\t}\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n"]);return K=function(){return t},t}function U(){var t=Object(p.a)(["\n\tquery AllEnquiries {\n\t\tenquiries {\n\t\t\tid\n\t\t\tnum\n\t\t\tdateLocal\n\t\t\thtmlNote\n\t\t\tisExpanded @client\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel {\n\t\t\t\tid\n\t\t\t\tarticle\n\t\t\t\tname\n\t\t\t}\n\t\t\tqty\n\t\t\torders {\n\t\t\t\t...OrderFragmentBasic\n\t\t\t\tprods {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n\t","\n"]);return U=function(){return t},t}var W=g()(U(),F,B,z),X=g()(K(),B,z),Y=g()(_(),B),J=g()(H()),G=g()(V(),B,z),Z=g()(R(),B,z),tt=g()(A(),B,z),et=g()(Q());function nt(){var t=Object(p.a)(["\n\tmutation SetList($name: String!, $value: [ID!]) {\n\t\tsetList(name: $name, value: $value) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return nt=function(){return t},t}function rt(){var t=Object(p.a)(["\n\tquery getLists {\n\t\tlists @client {\n\t\t\tselectedProdIds\n\t\t}\n\t}\n"]);return rt=function(){return t},t}var at=g()(rt()),it=g()(nt()),ot={Enquiry:{isExpanded:function(){return!1}},Mutation:{setLayout:function(t,e,n){var r=n.cache,a=E,i=r.readQuery({query:a});return i.layout=Object(f.a)({},i.layout,e),r.writeQuery({query:a,data:i}),null},setExpanded:function(t,e,n){var r=e.args,a=r.id,i=r.value,o=n.cache,c=W,l=o.readQuery({query:c});return l.enquiries.find(function(t){return t.id===a}).isExpanded=i,o.writeQuery({query:c,data:l}),null},setList:function(t,e,n){var r=e.name,a=e.value,i=n.cache,o=at,c=i.readQuery({query:o});return c.lists[r]=a,i.writeQuery({query:o,data:c}),null}}},ct=n(9),lt=n(353),ut=n(35),dt=n(727),st=n(344),mt=n(725),ft=n(724),pt=n(726),bt=n(723);function gt(){var t=Object(p.a)(["\n\t&&&&&& {\n\t\twidth: 350px;\n\t\t&:hover {\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\n\t\t}\n\t}\n"]);return gt=function(){return t},t}function ht(){var t=Object(p.a)(["\n\t&&& {\n\t\t","\n\t}\n"]);return ht=function(){return t},t}function vt(){var t=Object(p.a)(["\n\twidth: 100%;\n\tpadding: 1em 1em 1em 55px;\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return vt=function(){return t},t}function yt(){var t=Object(p.a)(["\n\t&&& {\n\t\t","\n\t}\n"]);return yt=function(){return t},t}function Et(){var t=Object(p.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t&.compact {\n\t\t\tpadding: .5rem 1rem;\n\t\t}\n\t\t","\n\t\t","\n\t}\n"]);return Et=function(){return t},t}function Ot(){var t=Object(p.a)(["\n\ttransform: ",";\n\t&&& {\n\t\t","\n\t}\n"]);return Ot=function(){return t},t}function jt(){var t=Object(p.a)(["\n\twidth: "," !important;\n\tmargin-right: 0 !important;\n"]);return jt=function(){return t},t}function xt(){var t=Object(p.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return xt=function(){return t},t}function qt(){var t=Object(p.a)(["\n\tcursor: pointer;\n\t","\n"]);return qt=function(){return t},t}function wt(){var t=Object(p.a)(["\n\t","\n"]);return wt=function(){return t},t}function kt(){var t=Object(p.a)(["\n\t","\n"]);return kt=function(){return t},t}function Ct(){var t=Object(p.a)(["\n\t","\n\t","\n"]);return Ct=function(){return t},t}var St={widths:{formLabel:"122px",detailsPL:"55px",extraSidebar:"250px"},colors:{green:"#016936",blue:"#0E6EB8"}},It=function(t){return St.colors[t]||t},Ft=function(t){var e=t.theme,n=t.w,r=t.m,a=t.mt,i=t.ml,o=t.pl,c=t.fs,l=t.fw,u=t.c,d=t.lh,s=t.ta,m=t.ws;return"\n\t\t".concat(n?"width: ".concat(e.widths[n]||n,";"):"","\n\t\t").concat(r?"margin: ".concat(r,";"):"","\n\t\t").concat(a?"margin-top: ".concat(a,";"):"","\n\t\t").concat(i?"margin-left: ".concat(i,";"):"","\n\t\t").concat(o?"padding-left: ".concat(o,";"):"","\n\t\t").concat(c?"font-size: ".concat(c,";"):"","\n\t\t").concat(l?"font-weight: ".concat(l,";"):"","\n\t\t").concat(u?"color: ".concat(u,";"):"","\n\t\t").concat(d?"line-height: ".concat(d,";"):"","\n\t\t").concat(s?"text-align: ".concat(s,";"):"","\n\t\t").concat(m?"word-spacing: ".concat(m,";"):"","\n\t")},Dt=Object(ct.b)(function(t){t.ml,t.inline;var e=Object(ut.a)(t,["ml","inline"]);return a.a.createElement("div",e)})(Ct(),function(t){return t.inline&&"display: inline-block;"},function(t){return Ft(t)}),Lt=Object(ct.b)(function(t){var e=Object(lt.a)({},t);return a.a.createElement("p",e)})(kt(),function(t){return Ft(t)}),Nt=Object(ct.b)(function(t){t.ml;var e=Object(ut.a)(t,["ml"]);return a.a.createElement("span",e)})(wt(),function(t){return Ft(t)}),$t=ct.b.a(qt(),function(t){return t.cancel&&"{\n\t\tpadding-left: 15px;\n\t\tcolor: rgba(0,0,0,.87);\n\t\t&:hover {\n\t\t\tcolor: #B03060;\n\t\t}\n\t}"}),Tt=Object(ct.b)(function(t){t.inline,t.c;var e=Object(ut.a)(t,["inline","c"]);return a.a.createElement(dt.a,e)})(xt(),function(t){return Ft(t)},function(t){return t.inline&&"{\n\t\t\tmargin: 0;\n\t\t\tpadding: 0 1rem;\n\t\t}"}),Mt=ct.b.label(jt(),function(t){return t.theme.widths.formLabel}),Bt=Object(ct.b)(function(t){t.active,t.disabled;var e=Object(ut.a)(t,["active","disabled"]);return a.a.createElement(st.a,Object.assign({},e,{name:"dropdown"}))})(Ot(),function(t){return!t.active&&("large"===t.size?"translateX(0) translateY(0) rotate(-90deg) !important":"translateX(-3px) translateY(3px) rotate(-90deg) !important")},function(t){return t.disabled&&"{\n\t\t\tcolor: rgba(0,0,0,.6);\n\t\t}"}),Pt=Object(ct.b)(function(t){t.activeColor,t.menu;var e=Object(ut.a)(t,["activeColor","menu"]);return a.a.createElement(mt.a,e)})(Et(),function(t){return Ft(t)},function(t){return t.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(It(t.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(It(t.activeColor)," !important;\n        \t}\n\t\t}")},function(t){return t.menu&&"{\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\n\t\t\tz-index: 3;\n\t\t}"}),zt=Object(ct.b)(function(t){t.section;var e=Object(ut.a)(t,["section"]);return a.a.createElement(ft.a,e)})(yt(),function(t){return t.section&&"\n\t\t\tmargin-top: 0;\n\t\t\tpadding-left: ".concat(t.theme.widths.detailsPL,";\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\n\t\t\tborder-radius: 0;\n\t\t")}),Qt=Object(ct.b)(function(t){t.head,t.minor,t.small,t.secondary,t.noP,t.noLP,t.noIndent,t.topBorder,t.bottomBorder;var e=t.children,n=t.onClick,r=Object(ut.a)(t,["head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","onClick"]);return a.a.createElement("div",Object.assign({},r,{onClick:n||void 0}),e)})(vt(),function(t){return t.head&&"{\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding-top: 0;\n\t\tpadding-bottom: 0;\n\t}"},function(t){return t.onClick&&"{\n\t\tcursor: pointer;\n\t}"},function(t){return t.minor&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return!t.size&&t.head&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return"small"===t.size&&"{\n\t\tmin-height: 2.5em;\n\t}"},function(t){return t.secondary&&"{\n\t\tbackground: #f3f4f5;\n\t\tcolor: rgba(0,0,0,.6);\n\t}"},function(t){return t.noLP&&"{\n\t\tpadding-left: 0;\n\t}"},function(t){return t.noIndent&&"{\n\t\tpadding-left: 1em;\n\t}"},function(t){return t.topBorder&&"{\n\t\tborder-top: 1px solid ".concat("dark"===t.topBorder?"rgba(152, 153, 154, 1)":"rgba(34,36,38,.15)",";\n\t}")},function(t){return t.bottomBorder&&"{\n\t\tborder-bottom: 1px solid ".concat("dark"===t.bottomBorder?"rgba(126, 127, 129, 1)":"rgba(34,36,38,.1)",";\n\t}")}),At=Object(ct.b)(function(t){t.showIf;var e=Object(ut.a)(t,["showIf"]);return a.a.createElement(pt.a,e)})(ht(),function(t){return!t.showIf&&"{\n\t\t\topacity: 0;\n\t\t}"}),Rt=Object(ct.b)(bt.a)(gt()),Vt=n(19),Ht=n(20),_t=n(22),Kt=n(21),Ut=n(23),Wt=n(367),Xt=n.n(Wt);function Yt(t){var e=function(t){var e=Xt()(t);if(!e.exp)return null;var n=new Date(0);return n.setUTCSeconds(e.exp),n}(t);return null!==e&&!(e.valueOf()>(new Date).valueOf()+0)}function Jt(){var t=Object(p.a)(["\n\tmutation Login($email: String!, $password: String!) {\n\t\tlogin(email: $email, password: $password) {\n\t\t\ttoken\n\t\t}\n\t}\n"]);return Jt=function(){return t},t}function Gt(){var t=Object(p.a)(["\n\tquery MeLocal {\n\t\tme @client {\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return Gt=function(){return t},t}function Zt(){var t=Object(p.a)(["\n\tquery Me {\n\t\tme {\n\t\t\tid\n\t\t\temail\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t}\n\t\t}\n\t}\n"]);return Zt=function(){return t},t}var te=g()(Zt()),ee=g()(Gt()),ne=g()(Jt()),re=n(31),ae=n.n(re),ie=n(49),oe=n(57),ce=n(729),le=n(721);function ue(){var t=Object(p.a)(["\n\tmax-width: 350px !important;\n\tmargin: auto !important;\n"]);return ue=function(){return t},t}function de(){var t=Object(p.a)(["\n\tdisplay: inline;\n\tpadding: 0 1rem !important;\n"]);return de=function(){return t},t}function se(){var t=Object(p.a)(["\n\tborder-bottom: 1px solid #7e7e81;\n\t// height: 35px;\n"]);return se=function(){return t},t}var me=ct.b.div(se()),fe=Object(ct.b)(dt.a)(de()),pe=Object(ct.b)(ce.a)(ue()),be=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={email:"",password:"",sendingRequest:!1,error:""},n.handleInputChange=function(t){n.setState(Object(oe.a)({},t,n[t].value))},n.submit=Object(ie.a)(ae.a.mark(function t(){var e,r,a,i,o;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.state,r=e.email,a=e.password,n.setState({sendingRequest:!0}),t.next=5,n.props.login({variables:{email:r,password:a}});case 5:i=t.sent,o=i.data.login.token,n.setState({sendingRequest:!1}),n.props.refreshToken(o),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),n.setState({error:t.t0.message,sendingRequest:!1});case 14:case"end":return t.stop()}},t,this,[[0,11]])})),n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.email,i=e.password,o=e.sendingRequest,c=e.error;return a.a.createElement(r.Fragment,null,a.a.createElement(me,null,a.a.createElement(fe,{size:"large"},a.a.createElement("i",null,"\u041a\u043e\u043b\u043c\u0435\u0445"))),a.a.createElement(pe,{basic:!0},a.a.createElement(le.a,{error:!!c},a.a.createElement(le.a.Field,null,a.a.createElement("label",null,"E-mail"),a.a.createElement("input",{type:"email",placeholder:"E-mail",ref:function(e){return t.email=e},onChange:function(){return t.handleInputChange("email")}})),a.a.createElement(le.a.Field,null,a.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),a.a.createElement("input",{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",ref:function(e){return t.password=e},onChange:function(){return t.handleInputChange("password")}})),a.a.createElement(ft.a,{error:!0,header:"\u0412\u043e\u0439\u0442\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:c}),a.a.createElement(mt.a,{primary:!0,type:"submit",floated:"right",disabled:!n||!i||o,loading:o,onClick:this.submit},"\u0412\u043e\u0439\u0442\u0438"))))}}]),e}(r.Component),ge=Object(d.compose)(Object(d.graphql)(ne,{name:"login",options:{fetchPolicy:"no-cache"}}))(be),he=n(728),ve=Object(d.compose)(Object(d.graphql)(E,O),Object(d.graphql)(j,{name:"setLayout"}),Object(d.graphql)(x,{name:"setExpanded"}),Object(d.graphql)(at,{props:function(t){return{lists:t.data.lists||{}}}}),Object(d.graphql)(it,{name:"setList"}))(function(t){var e=t.children,n=t.layout,r=n.details,a=n.extra,i=t.setLayout,o=t.setExpanded,c=t.lists.selectedProdIds,l=t.setList;return e({details:r,extra:a,setDetails:function(t){i({variables:{details:t,extra:null}})},setExtra:function(t){return i({variables:{extra:t}})},setExpanded:function(t){return o({variables:{args:t}})},selectedProdIds:c,setSelectedProdIds:function(t){return l({variables:{name:"selectedProdIds",value:t}})}})});function ye(){var t=Object(p.a)(["\n\talign-self: stretch;\n\tposition: relative;\n\tmargin-left: 10px;\n\tpadding: 0 1em;\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: #f5f6f7;\n\tborder-top-right-radius: .35rem;\n\tborder-bottom-right-radius: .35rem;\n\t::before {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tleft: 0;\n\t\tbackground-color: #fff;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\n\t}\n\t/* ::after {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tright: 0;\n\t\tbackground-color: #f3f4f5;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\n\t} */\n"]);return ye=function(){return t},t}var Ee=ct.b.div(ye()),Oe=Object(d.compose)(Object(d.graphql)(j,{name:"setLayout"}),Object(d.graphql)(E,O))(function(){return a.a.createElement(ve,null,function(t){var e=t.details,n=e.type,r=e.id,i=e.enquiryId,o=t.setDetails;return a.a.createElement(d.Query,{query:Y,variables:{id:"Enquiry"===n?r:i}},function(t){var e=t.data;if(e&&e.enquiryLocal){var i=e.enquiryLocal,c=i.num,l=!i.docs.some(function(t){return"CO"===t.type});return a.a.createElement(Ee,null,a.a.createElement(Tt,{inline:!0,c:"rgba(0,0,0,.68)",size:"medium",content:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116".concat(c)}),a.a.createElement(At,{position:"bottom left",size:"small",flowing:!0,showIf:l,trigger:a.a.createElement(Dt,{inline:!0},a.a.createElement(Pt,{compact:!0,circular:!0,menu:!0,ml:"0",activeColor:"green",icon:"plus",content:"\u0417\u0430\u043a\u0430\u0437",active:"Order"===n&&"new"===r,disabled:l,onClick:function(){return o({type:"Order",id:"new",enquiryId:r})}}))},a.a.createElement(pt.a.Header,{content:"\u041d\u0435 \u0432\u0441\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b"}),a.a.createElement(pt.a.Content,null,a.a.createElement(st.a,{name:"cancel",color:"red"}),"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f")))}return null})})});function je(){var t=Object(p.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tborder-bottom: 1px solid #7e7e81;\n"]);return je=function(){return t},t}var xe=ct.b.div(je()),qe=function(t){var e=t.refetchEnquiries,n=t.enquiriesAreLoading,r=t.refreshToken;return a.a.createElement(ve,null,function(t){var i=t.details,o=t.setDetails;return a.a.createElement(xe,null,a.a.createElement(Tt,{inline:!0,size:"medium",content:"\u0417\u0430\u044f\u0432\u043a\u0438 \u0438 \u0437\u0430\u043a\u0430\u0437\u044b"}),a.a.createElement(Pt,{compact:!0,circular:!0,menu:!0,w:"118.5px",ml:"0",ta:"left",activeColor:"blue",onClick:e},a.a.createElement(st.a,{name:"refresh",color:n?"blue":void 0,loading:n}),n?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"),a.a.createElement(Pt,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",content:"\u0417\u0430\u044f\u0432\u043a\u0430",active:i&&"Enquiry"===i.type&&"new"===i.id,onClick:function(){return o({type:"Enquiry",id:"new"})}}),i&&("Enquiry"===i.type&&"new"!==i.id||"Order"===i.type&&"new"===i.id)&&a.a.createElement(Oe,null),a.a.createElement(d.Query,{query:ee},function(t){var e=t.data;if(e&&e.me){var n=e.me.person,r=n.fName,i=n.lName,o=r+" "+(i?"".concat(i.slice(0,1),"."):"");return a.a.createElement(Tt,{inline:!0,ml:"auto",size:"small",content:o})}return null}),a.a.createElement(st.a,{link:!0,name:"log out",size:"large",onClick:function(){return r(null)}}))})},we=n(32);function ke(){var t=Object(p.a)(["\n\tpadding-right: 4px;\n\t// @ts-ignore\n\t","\n"]);return ke=function(){return t},t}function Ce(){var t=Object(p.a)(["\n\tcolor: rgba(0,0,0,.8);\n\tline-height: 1.5em;\n\t/* background: #f3f4f5; */\n\tbackground: rgb(233, 234, 235);\n\tborder-top: 1px solid #d4d4d5;\n\tborder-bottom: 1px solid #d4d4d5;\n\tfont-weight: bold;\n"]);return Ce=function(){return t},t}function Se(){var t=Object(p.a)(["\n\ttable-layout: fixed;\n\twidth: 100%;\n\tborder-collapse: collapse;\n"]);return Se=function(){return t},t}var Ie=ct.b.table(Se()),Fe=ct.b.tr(Ce()),De=ct.b.td(ke(),function(t){return t.w&&"width: ".concat(t.w,";")}),Le=function(t){var e=t.children,n=t.fields,i=t.indent,o=!!i,c=!!t.select,l=(t.expand,Object(we.a)(o?[{name:"indent",width:i}]:[]).concat([{name:"service",width:"23px"}],Object(we.a)(c?[{name:"select",width:"25px"}]:[]),Object(we.a)(n),[{name:"lastField"}]));return a.a.createElement(Ie,null,a.a.createElement("tbody",null,a.a.createElement(r.Fragment,null,a.a.createElement(Fe,null,l.map(function(t){return a.a.createElement(De,{key:t.name,w:t.width},t.title)})),e({tableFields:l.map(function(t){return{name:t.name,path:t.path}})}))))},Ne=function(t,e){var n=t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$& ").replace(/\./,",");return e||(n=n.slice(0,-3)),n+" \u20bd"};function $e(){var t=Object(p.a)(["\n\tpadding-right: 4px;\n\t","\n"]);return $e=function(){return t},t}function Te(){var t=Object(p.a)(["\n\tfont-size: 1rem;\n\tcursor: pointer;\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t:hover {\n\t\tbackground: rgba(0,0,0,.05);\n\t\tcolor: rgba(0,0,0,.95);\n\t}\n\t","\n\t","\n\t","\n"]);return Te=function(){return t},t}var Me=ct.b.tr(Te(),function(t){return t.secondary&&"\n\t\tbackground: rgba(0,0,50,.02);\n\t\t".concat(t.lastSecondaryRow?"":"border-bottom: none;","\n\t")},function(t){return t.active&&"\n\t\tbackground: rgba(0,0,0,.05);\n\t\tfont-weight: bold;\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t"},function(t){return t.bold&&"\n\t\tfont-weight: bold;\n\t"}),Be=ct.b.td($e(),function(t){return t.service&&"\n\t\tpadding-left: 3px;\n\t"}),Pe=function(t){var e=t.tableFields,n=t.rowFields,r=void 0===n?[]:n,i=t.entity,o=t.expandFor,c=t.expanded,l=t.expand,u=t.select,d=Object(ut.a)(t,["tableFields","rowFields","entity","expandFor","expanded","expand","select"]),s=e.map(function(t){return r.find(function(e){return e.name===t.name})||t}),m=i.selected,f=i.disabled;return a.a.createElement(Me,d,s.map(function(t){if("service"===t.name&&"undefined"!==typeof c&&i[o].length)return a.a.createElement(Be,{service:!0,key:t.name,onClick:function(t){t.stopPropagation(),l()}},a.a.createElement(Bt,{active:c?1:0}));if("select"===t.name&&"undefined"!==typeof u)return a.a.createElement(Be,{key:t.name,service:!0,onClick:function(t){t.stopPropagation(),u()}},a.a.createElement(st.a,{disabled:f,name:"partly"===m?"square":m?"check square outline":"square outline"}));if(t.content)return a.a.createElement(Be,{key:t.name},t.content);var e=t.value||(t.path?function(t,e){for(var n=e.split("."),r=0;r<n.length;r++)if(!(t=t[n[r]]))return;return t}(i,t.path):null);return e&&"amount"===t.name&&(e=Ne(e)),a.a.createElement(Be,{key:t.name},e&&t.icon&&a.a.createElement(st.a,{name:t.icon,color:t.iconColor||!1}),e)}))},ze=[{name:"num",path:"num",title:"\u2116",width:"40px"},{name:"date",path:"dateLocal",title:"\u0414\u0430\u0442\u0430",width:"110px"},{name:"org",path:"org.name",title:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f",width:"260px"},{name:"model",path:"model.name",title:"\u0418\u0437\u0434\u0435\u043b\u0438\u0435",width:"250px"},{name:"qty",path:"qty",title:"\u041a\u043e\u043b.",width:"50px"},{name:"reserved",title:"\u0420\u0435\u0437.",width:"50px"},{name:"amount",title:"\u0421\u0443\u043c\u043c\u0430",width:"105px"},{name:"status",path:"status.name",title:"\u0421\u0442\u0430\u0442\u0443\u0441",width:"130px"}],Qe=function(t){var e=t.enquiries;return a.a.createElement(ve,null,function(t){var n=t.details,i=t.setDetails,o=t.setExpanded;return a.a.createElement(Le,{fields:ze},function(t){var c=t.tableFields;return e.map(function(t){var e=t.id,l=t.isExpanded,u=t.docs;return a.a.createElement(r.Fragment,{key:e},a.a.createElement(Pe,{entity:t,tableFields:c,rowFields:[{name:"amount",value:u.length&&u[u.length-1].amount}],expandFor:"orders",expanded:l,expand:function(){o({id:e,value:!l})},active:n&&"Enquiry"===n.type&&e===n.id,onClick:function(){i({type:"Enquiry",id:e}),o({id:e,value:!l})}}),l&&t.orders.map(function(e,r){var o=e.id,l=e.num,u=e.prods;return a.a.createElement(Pe,{secondary:1,lastSecondaryRow:r===t.orders.length-1?1:0,key:o,entity:e,tableFields:c,rowFields:[{name:"num",value:t.num+"-"+l},{name:"org",value:t.org.name},{name:"model",value:t.model&&t.model.name},{name:"reserved",value:u.length},{name:"amount",path:"amount"}],active:n&&"Order"===n.type&&o===n.id,onClick:function(){i({type:"Order",id:o})}})}))})})})};function Ae(){var t=Object(p.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Ae=function(){return t},t}function Re(){var t=Object(p.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Re=function(){return t},t}var Ve=Object(ct.b)(st.a)(Re()),He=Object(ct.b)(Bt)(Ae()),_e=function(t){var e=t.children,n=t.size,r=t.bottomBorder,i=t.close,o=t.expanded,c=t.disabled,l=t.onClick,u=t.noIndent,d=Object(f.a)({},i&&{close:!0},"undefined"!==typeof o&&{expand:!0});return a.a.createElement(Qt,{head:!0,noLP:!0,noIndent:u,bottomBorder:r||!0,size:n||void 0,onClick:l},d.close?a.a.createElement(Ve,{link:!0,size:"big",name:"cancel",onClick:i}):d.expand?a.a.createElement(He,{size:"large",active:o?1:0,disabled:c}):null,e)},Ke=function(t){var e=t.text;return a.a.createElement(Nt,{ml:"10px",fs:"1rem",c:"rgba(0,0,0,.6)",ws:"0.5em"},e)},Ue=function(t){var e=t.title,n=t.subtitle,r=t.size;return a.a.createElement(Tt,{m:"0",size:r||"medium"},e,n&&a.a.createElement(Ke,{text:n}))},We=function(t){var e=t.children;return a.a.createElement(Dt,{ml:"auto"},e)};function Xe(){var t=Object(p.a)(["\n\tpadding: .78571429em !important;\n\t&>i {\n\t\topacity: .9 !important;\n\t\tmargin: 0 !important;\n\t}\n"]);return Xe=function(){return t},t}var Ye=Object(ct.b)(Pt)(Xe()),Je=function(t){var e=t.loading,n=t.onClick;return a.a.createElement(Ye,{activeColor:"blue",active:e,onClick:n},a.a.createElement(st.a,{name:"refresh",loading:e}))},Ge={Enquiry:{titleNew:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u044f\u0432\u043a\u0430",titleExisting:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116"},Order:{titleNew:"\u041d\u043e\u0432\u044b\u0439 \u0437\u0430\u043a\u0430\u0437",titleExisting:"\u0417\u0430\u043a\u0430\u0437 \u2116"}},Ze=function(t){var e=t.type,n=t.closeDetails,i=t.loading,o=t.refresh,c=t.setDetails,l=t.editMode,u=t.localEntity,d=void 0===u?{}:u,s=d.id,m=d.num,f=d.dateLocal;return a.a.createElement(_e,{close:n},!s&&a.a.createElement(Ue,{title:Ge[e].titleNew}),s&&a.a.createElement(r.Fragment,null,a.a.createElement(Ue,{title:Ge[e].titleExisting+m,subtitle:"\u043e\u0442 "+f}),a.a.createElement(We,null,a.a.createElement(Je,{loading:i,onClick:o}),a.a.createElement(Pt,{icon:"edit",activeColor:"blue",active:l||!1,onClick:function(){return c({type:e,id:d.id,editMode:!0})}}))))},tn=n(722),en=n(343),nn=n(46),rn=(n(596),n(369)),an=function(t){function e(t){var n,r;if(Object(Vt.a)(this,e),(n=Object(_t.a)(this,Object(Kt.a)(e).call(this,t))).onChange=function(t){n.setState({editorState:t});var e=t.getCurrentContent(),r=n.props,a=r.setEditorHasText,i=r.setEditorDiff,o=r.setHasFocus;t&&a&&a(e.hasText()),i&&i(e!==n.state.oriContent),o&&o(t.getSelection().getHasFocus())},n.kolmechKeyBindingFn=function(t){return 13===t.keyCode&&nn.KeyBindingUtil.hasCommandModifier(t)?"kolmech-enter":Object(nn.getDefaultKeyBinding)(t)},n.handleKeyCommand=function(t,e){if("kolmech-enter"===t)return n.props.onSave(),"handled";var r=nn.RichUtils.handleKeyCommand(e,t);return r?(n.onChange(r),"handled"):"not-handled"},n.clear=function(){return n.setState({editorState:nn.EditorState.push(n.state.editorState,nn.ContentState.createFromText(""),"remove-range")})},n.exportHtml=function(){var t=Object(rn.stateToHTML)(n.state.editorState.getCurrentContent());return Object(nn.convertFromHTML)(t).contentBlocks?t:null},t.initFromHtml){var a=Object(nn.convertFromHTML)(t.initFromHtml);r=nn.EditorState.createWithContent(nn.ContentState.createFromBlockArray(a.contentBlocks,a.entityMap))}else r=nn.EditorState.createEmpty();return n.state={editorState:r,oriContent:r.getCurrentContent()},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){return a.a.createElement(nn.Editor,{editorState:this.state.editorState,onChange:this.onChange,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.kolmechKeyBindingFn,readOnly:this.props.readOnly})}}]),e}(a.a.Component);function on(){var t=Object(p.a)(["\n\tpadding: calc(0.678571em - 1px) 1em;\n\tline-height: 1.4285em;\n\tborder: 1px solid rgba(34,36,38,.15);\n\tborder-radius: .28571429rem;\n\ttransition: all .1s ease;\n\t","\n"]);return on=function(){return t},t}var cn=ct.b.div(on(),function(t){var e=t.borderless,n=t.hasFocus,r=t.diff;return e&&!n&&!r&&"\n\t\t\tmargin-left: -1em;\n\t\t\tborder: 1px solid white;\n\t\t\t:hover {\n\t\t\t\tbackground: rgba(0,0,0,.05);\n\t\t\t\tcolor: rgba(0,0,0,.65);\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t"}),ln=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={hasFocus:!1},n.setHasFocus=function(t){return n.setState({hasFocus:t})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.state.hasFocus,e=this.props,n=e.borderless,r=e.diff,i=e.forwardedRef,o=Object(ut.a)(e,["borderless","diff","forwardedRef"]);return a.a.createElement(cn,{borderless:n,hasFocus:t,diff:r},a.a.createElement(an,Object.assign({ref:i,setHasFocus:this.setHasFocus},o)))}}]),e}(r.Component),un=a.a.forwardRef(function(t,e){return a.a.createElement(ln,Object.assign({forwardedRef:e},t))}),dn=n(370),sn=n(719),mn=n(163),fn=n.n(mn),pn=(n(315),function(t){return t instanceof Date&&!isNaN(t.valueOf())}),bn=6e4*(new Date).getTimezoneOffset(),gn=function(t){return new Date(t.getTime()-bn).toISOString()},hn=function(t){return new Date(Date.parse(t)+bn)};function vn(){var t=Object(p.a)(["\n\tdisplay: inline-block;\n\t","\n"]);return vn=function(){return t},t}var yn=ct.b.div(vn(),function(t){return t.error&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),En=function(t){var e=t.selectedDate,n=t.selectDay,r=t.error;return a.a.createElement(yn,{error:r},a.a.createElement(fn.a,{value:gn(e).slice(0,10),onDayChange:n,dayPickerProps:{firstDayOfWeek:1,month:e}}))};function On(){var t=Object(p.a)(["\n    mutation createOrg($inn: String!) {\n        createOrg(inn: $inn) {\n            id\n\t\t\tinn\n            name\n        }\n    }\n"]);return On=function(){return t},t}function jn(){var t=Object(p.a)(["\n    query allOrgs {\n        orgs {\n            id\n            inn\n            name\n        }\n    }\n"]);return jn=function(){return t},t}function xn(){var t=Object(p.a)(["\n    query org ($id: ID!) {\n        org (id: $id) {\n            id\n            inn\n            name\n        }\n    }\n"]);return xn=function(){return t},t}g()(xn()),g()(jn());var qn=g()(On());function wn(){var t=Object(p.a)(["\n    query AllOrgsAndModels {\n        orgs {\n            id\n            inn\n            name\n        }\n        models {\n            id\n            article\n            name\n        }\n    }\n"]);return wn=function(){return t},t}var kn=g()(wn()),Cn=n(89),Sn=n.n(Cn),In=function(t,e){var n=!1;if("number"===typeof t?t=t.toString():"string"!==typeof t&&(t=""),t.length)if(/[^0-9]/.test(t))e.code=2,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0446\u0438\u0444\u0440";else if(-1===[10,12].indexOf(t.length))e.code=3,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 10 \u0438\u043b\u0438 12 \u0446\u0438\u0444\u0440";else{var r=function(t,e){var n=0;for(var r in e)n+=e[r]*t[r];return parseInt(n%11%10)};switch(t.length){case 10:r(t,[2,4,10,3,5,9,4,6,8])===parseInt(t[9])&&(n=!0);break;case 12:var a=r(t,[7,2,4,10,3,5,9,4,6,8]),i=r(t,[3,7,2,4,10,3,5,9,4,6,8]);a===parseInt(t[10])&&i===parseInt(t[11])&&(n=!0)}n||(e.code=4,e.message="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0418\u041d\u041d")}else e.code=1,e.message="\u0418\u041d\u041d \u043f\u0443\u0441\u0442";return n},Fn=function(t){function e(t){var n;Object(Vt.a)(this,e),(n=Object(_t.a)(this,Object(Kt.a)(e).call(this,t))).changeFieldValue=function(t,e){var r;console.log("change ",t," to value > ",e);var a=Sn()(n.state[t]);a.curVal=e,a.err=!1,n.isNewEnquiry||(a.diff=a.curVal!==a.oriVal);var i=n.fields.filter(function(e){return e!==t}).map(function(t){return n.state[t].diff}).includes(!0)||a.diff;n.setState((r={},Object(oe.a)(r,t,a),Object(oe.a)(r,"diff",i),Object(oe.a)(r,"err",{message:""}),r))},n.selectDay=function(t){if(!pn(t))return n.setState({dateLocal:Object(f.a)({},n.state.dateLocal,{err:!0}),err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u0437\u0430\u044f\u0432\u043a\u0438 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0434\u0430\u0442"}});n.changeFieldValue("dateLocal",gn(t).slice(0,10))},n.handleOrgDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({orgDdn:{search:r,err:!1}})},n.handleModelDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({modelDdn:{search:r,err:!1}})},n.handleQtyInputChange=function(t,e){var r=e.value,a=parseInt(r,10)||"";n.changeFieldValue("qty",a)},n.selectOrg=function(t,e){var r=e.value;n.setState({orgDdn:{search:"",loading:!1}}),n.changeFieldValue("orgId",r)},n.selectModel=function(t,e){var r=e.value;n.setState({modelDdn:{search:"",loading:!1}}),n.changeFieldValue("modelId",r)},n.createOrg=function(){var t=Object(ie.a)(ae.a.mark(function t(e,r){var a,i,o;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,t.prev=1,In(a,i={})){t.next=6;break}throw new Error(i.message);case 6:return n.setState({orgDdn:{search:a,loading:!0}}),t.next=9,n.props.createOrg({variables:{inn:a}});case 9:if(o=t.sent,n.componentIsMounted){t.next=12;break}return t.abrupt("return");case 12:n.selectOrg(null,{value:o.data.createOrg.id}),t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(1),n.componentIsMounted){t.next=19;break}return t.abrupt("return");case 19:n.setState({err:{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e \u0418\u041d\u041d \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message},orgDdn:{search:a,loading:!1},orgId:Object(f.a)({},n.state.orgId,{err:!0})}),console.log(t.t0);case 21:case"end":return t.stop()}},t,this,[[1,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.submit=function(){var t={};n.fields.forEach(function(e){(n.isNewEnquiry||n.state[e].diff)&&(t[e]=n.state[e].curVal)});var e=Object(f.a)({},t);if(n.isNewEnquiry)return n.createEnquiry(e);e.id=n.props.id,n.updateEnquiry(e)},n.createEnquiry=function(){var t=Object(ie.a)(ae.a.mark(function t(e){var r;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.createEnquiry({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),n.props.setDetails({type:"Enquiry",id:r.data.createEnquiry.id}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(0),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,this,[[0,11]])}));return function(e){return t.apply(this,arguments)}}(),n.updateEnquiry=function(){var t=Object(ie.a)(ae.a.mark(function t(e){var r,a,i,o;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.props,a=r.id,i=r.updateEnquiry,o=r.setDetails,t.prev=1,n.setState({loading:!0}),t.next=5,i({variables:{input:e}});case 5:if(n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),o({type:"Enquiry",id:a}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(1),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,this,[[1,11]])}));return function(e){return t.apply(this,arguments)}}(),n.componentIsMounted=!0,n.isNewEnquiry="new"===t.id;var r=n.isNewEnquiry;n.state={loading:!1,err:{message:""},orgDdn:{search:"",loading:!1},modelDdn:{search:"",loading:!1}};var a=Sn()(t.enquiry);return r&&(a.dateLocal=gn(new Date).slice(0,10)),delete a.events,a.orgId=a.org?a.org.id:null,a.modelId=a.model?a.model.id:null,a.qty=a.qty?a.qty:"",n.fields=Object.keys(a).filter(function(t){return!["__typename","id","num","org","model"].includes(t)}),n.requiredFields=["dateLocal","orgId","modelId","qty"],n.fields.forEach(function(t){n.state[t]=Object(f.a)({curVal:a[t],err:!1},n.requiredFields.includes(t)&&{required:!0},!r&&{oriVal:a[t],diff:!1})}),r||(n.state.diff=!1),n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state,n=e.dateLocal,i=e.orgId,o=e.orgDdn,c=e.modelId,l=e.modelDdn,u=e.qty,d=e.diff,s=e.loading,m=e.err,f=this.props,p=f.id,b=f.setDetails,g=f.allOrgsAndModels,h=hn(n.curVal),v=g.orgs,y=g.models,E=this.requiredFields.some(function(e){return!t.state[e].curVal}),O=this.fields.some(function(e){return!!t.state[e].err});return a.a.createElement(r.Fragment,null,a.a.createElement(Qt,{bottomBorder:!0},a.a.createElement(le.a,null,a.a.createElement(le.a.Field,{inline:!0},a.a.createElement(Mt,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(En,{error:n.err,selectedDate:h,selectDay:this.selectDay})),a.a.createElement(le.a.Field,{inline:!0,error:i.err,required:!0},a.a.createElement(Mt,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(Rt,{loading:!v||o.loading,disabled:!v||o.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0418\u041d\u041d",options:v?v.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:i.curVal,onChange:this.selectOrg,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:o.search,onSearchChange:this.handleOrgDropdownSearchChange,noResultsMessage:"\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041d\u041d, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c.",allowAdditions:!0,additionLabel:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u0418\u041d\u041d: ",onAddItem:this.createOrg})),a.a.createElement(le.a.Field,{inline:!0,error:c.err,required:!0},a.a.createElement(Mt,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(Rt,{loading:!y||l.loading,disabled:!y||l.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0443",options:y?y.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:c.curVal,onChange:this.selectModel,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:l.search,onSearchChange:this.handleModelDropdownSearchChange,noResultsMessage:'\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 "\u041d\u0435\u0442 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435"'})),a.a.createElement(le.a.Field,{inline:!0,required:!0},a.a.createElement(Mt,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(sn.a,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",value:u.curVal,onChange:this.handleQtyInputChange}),a.a.createElement(Nt,{pl:"6px"},"\u0448\u0442.")))),a.a.createElement(Qt,null,a.a.createElement(ft.a,{error:!0,hidden:!m.message,header:m.title,content:m.message}),a.a.createElement(Dt,{inline:!0,w:"formLabel"}),a.a.createElement(mt.a,{primary:!0,content:this.isNewEnquiry?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:!this.isNewEnquiry&&!d||!!m.message||O||!!i.loading||E,loading:s,onClick:this.submit}),a.a.createElement($t,{cancel:!0,onClick:"new"===p?function(){return b(null)}:function(){return b({type:"Enquiry",id:p})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))}}]),e}(r.Component),Dn=Object(d.compose)(Object(d.graphql)(qn,{name:"createOrg",options:{update:function(t,e){var n=e.data.createOrg,r=kn,a=t.readQuery({query:r});a.orgs.push(n),a.orgs.sort(function(t,e){return t.name>e.name}),t.writeQuery({query:r,data:a})}}}),Object(d.graphql)(kn,{name:"allOrgsAndModels"}),Object(d.graphql)(Z,{name:"updateEnquiry"}),Object(d.graphql)(G,{name:"createEnquiry",options:{update:function(t,e){var n=e.data.createEnquiry,r=W,a=t.readQuery({query:r});n.isExpanded=!1,a.enquiries.unshift(n),t.writeQuery({query:r,data:a})}}}))(Fn),Ln=n(720);function Nn(){var t=Object(p.a)(["\n\tdisplay: inline-block;\n\t","\n"]);return Nn=function(){return t},t}var $n=ct.b.div(Nn(),function(t){return t.err&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),Tn=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).handleDayChange=function(t){var e=n.props,r=e.setField,a=e.field.name;pn(t)?r(a,{value:gn(t).slice(0,10)}):r(a,{err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414"}})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.props.field,e=t.curVal,n=t.err;return a.a.createElement($n,{err:!!n},a.a.createElement(fn.a,{value:e,onDayChange:this.handleDayChange,dayPickerProps:{firstDayOfWeek:1,month:hn(e)}}))}}]),e}(r.Component),Mn=n(371),Bn=n.n(Mn),Pn=function(t){function e(){return Object(Vt.a)(this,e),Object(_t.a)(this,Object(Kt.a)(e).apply(this,arguments))}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.props,e=t.placeholder,n=t.field,i=n.name,o=n.curVal,c=t.setField;return a.a.createElement(r.Fragment,null,a.a.createElement(Bn.a,{customInput:sn.a,placeholder:e,value:o,decimalSeparator:",",thousandSeparator:" ",decimalScale:2,allowNegative:!1,onValueChange:function(t){return c(i,{value:t.floatValue})}}),a.a.createElement(Nt,{pl:"6px",fs:"1.1rem",c:"rgba(0,0,0,.87)"},"\u20bd"),a.a.createElement(Nt,{pl:"9px",fs:"1.1rem",ws:"0.1em"},"\u0441 \u041d\u0414\u0421"))}}]),e}(r.Component),zn=function(t){function e(t){var n;Object(Vt.a)(this,e),(n=Object(_t.a)(this,Object(Kt.a)(e).call(this,t))).setField=function(t,e){var r=e.value,a=e.err;n.setState(Object(oe.a)({},t,Object(f.a)({},n.state[t],r&&Object(f.a)({curVal:r},!n.isNewEntity&&{diff:r!==n.state[t].oriVal}),{err:a||null})))},n.submit=function(){var t=n.fields.reduce(function(t,e){return t[e]=n.state[e].curVal,t},{});n.props.submit(t)},n.componentIsMounted=!0,n.isNewEntity=t.isNewEntity;var r=t.entity;return n.fields=Object.keys(r),n.requiredFields=t.requiredFields,n.state={},n.fields.forEach(function(t){n.state[t]=Object(f.a)({name:t,curVal:r[t],err:null},n.requiredFields.includes(t)&&{required:!0},!n.isNewEntity&&{oriVal:r[t],diff:!1})}),n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this,e=this.props.children,n=this.requiredFields.some(function(e){return!t.state[e].curVal}),r=this.isNewEntity?null:this.fields.map(function(e){return t.state[e].diff}).includes(!0),a=this.fields.map(function(e){return t.state[e].err}).find(function(t){return!!t});return e({disabled:!this.isNewEntity&&!r||n||!!a,err:a||this.props.err,setField:this.setField,submit:this.submit,formState:this.state})}}]),e}(r.Component),Qn=function(t){function e(){return Object(Vt.a)(this,e),Object(_t.a)(this,Object(Kt.a)(e).apply(this,arguments))}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.props,e=t.cancel,n=t.submit,i=t.loading,o="new"===this.props.id,c=o?{dateLocal:gn(new Date).slice(0,10),amount:""}:{dateLocal:this.props.co.dateLocal,amount:this.props.co.amount};return a.a.createElement(zn,{isNewEntity:o,entity:c,requiredFields:["dateLocal","amount"],submit:n},function(t){var n=t.disabled,o=t.err,c=t.setField,l=t.submit,u=t.formState,d=u.dateLocal,s=u.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(Qt,{head:!0,minor:!0,secondary:!0,topBorder:!0,bottomBorder:!0},a.a.createElement(dt.a,null,"\u041a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")),a.a.createElement(Qt,{secondary:!0,bottomBorder:!0},a.a.createElement(le.a,null,a.a.createElement(le.a.Field,{inline:!0},a.a.createElement(Mt,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Tn,{field:d,setField:c})),a.a.createElement(le.a.Field,{inline:!0,required:!0},a.a.createElement(Mt,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(Pn,{field:s,setField:c,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u041a\u041f"})))),a.a.createElement(Qt,{secondary:!0,small:!0},o&&a.a.createElement(ft.a,{error:!0,header:o.title,content:o.message}),a.a.createElement(Dt,{inline:!0,w:"formLabel"}),a.a.createElement(mt.a,{primary:!0,content:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",disabled:n,loading:i,onClick:l}),a.a.createElement($t,{cancel:!0,onClick:e},"\u041e\u0442\u043c\u0435\u043d\u0430")),a.a.createElement(Ln.a,{fitted:!0}))})}}]),e}(r.Component);function An(){var t=Object(p.a)(["\n\tmargin-left: 6.35em !important;\n"]);return An=function(){return t},t}function Rn(){var t=Object(p.a)(["\n\t& p { margin: 0 !important; }\n\t&>table { \n\t\twidth: 100%;\n\t\tborder-collapse: collapse; \n\t}\n\t&>table>tbody>tr>td {\n\t\tpadding-left: 4px;\n\t\tvertical-align: top;\n\t}\n\t&>table>tbody>tr>td:nth-child(1) {\n\t\twidth: 5px;\n\t}\n\t&>table>tbody>tr>td:nth-child(2) {\n\t\twidth: 25px;\n\t\tmin-width: 90px;\n\t}\n\t&>table>tbody>tr>td:nth-child(3) {\n\t\tpadding-left: 10px;\n\t\twidth: 1000px;\n\t\tmin-width: 240px;\n\t}\n\t&>table>tbody>tr>td>span {\n\t\tmargin-right: 5px;\n\t}\n"]);return Rn=function(){return t},t}function Vn(){var t=Object(p.a)(["\n\tmargin-left: 0 !important;\n  color: rgba(0,0,0,.6) !important;\n"]);return Vn=function(){return t},t}function Hn(){var t=Object(p.a)(["\n  margin-left: 6.5em !important;\n"]);return Hn=function(){return t},t}function _n(){var t=Object(p.a)(["\n  width: 2em;\n  height: 2em;\n  margin-left: 0 !important;\n  padding: .4em 0em !important;\n  float: left;\n\ttext-align: center;\n\t","\n\t// ","\n"]);return _n=function(){return t},t}function Kn(){var t=Object(p.a)(["\n\t// apply horizontal offset correction for different icons to be vertically alined\n  width: "," !important;\n\t","\n  margin-top: .15em !important;\n\tfloat: left;\n\topacity: 0.6 !important;\n"]);return Kn=function(){return t},t}function Un(){var t=Object(p.a)(["\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\n"]);return Un=function(){return t},t}function Wn(){var t=Object(p.a)(["\n\t& .active.item {\n\t\tdisplay: none !important;\n\t}\n\t& .selected.item {\n\t\tbackground: none !important;\n\t}\n"]);return Wn=function(){return t},t}function Xn(){var t=Object(p.a)(["\n\tfont-weight: unset !important;\n\t/* padding-bottom: 0 !important; */\n"]);return Xn=function(){return t},t}function Yn(){var t=Object(p.a)(["\n\tpadding-top: 0 !important;\n"]);return Yn=function(){return t},t}function Jn(){var t=Object(p.a)(["\n  :nth-child(1) {\n\t\twidth: ",";\n\t// color: rgba(0,0,0,.87);\n\t/* font-size: .92857143em; */\n\t/* line-height: 32px; */\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n\t\tvertical-align: top;\n  }\n  :nth-child(2) {\n\t\t// width: 100px;\n\t\tfont-size: 1em;\n\t\tfont-weight: bold;\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n  }\n"]);return Jn=function(){return t},t}function Gn(){var t=Object(p.a)(["\n  margin: 0 0 1em;\n  line-height: 1.4285em;\n  color: rgba(0,0,0,.87);\n"]);return Gn=function(){return t},t}function Zn(){var t=Object(p.a)(["\n\t/* table-layout: fixed; */\n\twidth: 100%;\n\tborder-collapse: collapse;\n"]);return Zn=function(){return t},t}var tr=ct.b.table(Zn()),er=ct.b.tr(Gn()),nr=ct.b.td(Jn(),function(t){return t.theme.widths.formLabel}),rr=nr.extend(Yn()),ar=rr.extend(Xn()),ir=Object(ct.b)(bt.a)(Wn()),or=Object(ct.b)(tn.a.Group)(Un()),cr=Object(ct.b)(st.a)(Kn(),function(t){return"CREATE"===t.type?"1.73em":"1.4em"},function(t){return"CREATE"===t.type&&"margin-left: -0.33em !important;"}),lr=Object(ct.b)(en.a)(_n(),function(t){return t.indent&&"margin-left: 42.69px !important;"},function(t){return t.indent&&"margin-left: calc(1.4em + 0.25rem) !important;"}),ur=Object(ct.b)(tn.a.Content)(Hn()),dr=Object(ct.b)(tn.a.Metadata)(Vn()),sr=Object(ct.b)(tn.a.Text)(Rn()),mr=Object(ct.b)(ft.a)(An()),fr=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(i)))).isNewEnquiry="new"===n.props.id,n.editorRef=a.a.createRef(),n.noteEditorRef=a.a.createRef(),n.componentIsMounted=!0,n.state={editMode:!!n.isNewEnquiry,editorHasText:!1,noteEditorDiff:!1,noteKey:1,activeCO:"",loading:!1,creatingComment:!1,changingStatus:!1,statusPending:!1,savingNote:!1,error:""},n.enableEditMode=function(){return n.setState({editMode:!0})},n.exitEditMode=function(){return n.setState({editMode:!1})},n.setEditorHasText=function(t){return n.setState({editorHasText:t})},n.setNoteEditorDiff=function(t){return n.setState({noteEditorDiff:t})},n.cancelEdit=function(){if(n.isNewEnquiry)return n.props.closeDetails();n.exitEditMode()},n.createComment=Object(ie.a)(ae.a.mark(function t(){var e;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null!==(e=n.editorRef.current.exportHtml())){t.next=4;break}return t.abrupt("return");case 4:return n.setState({creatingComment:!0}),t.next=7,n.props.createEnquiryEvent({variables:{enquiryId:n.props.id,htmlText:e}});case 7:n.setState({creatingComment:!1,editorHasText:!1,error:""}),n.editorRef.current.clear(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),n.setState({creatingComment:!1,error:t.t0.message}),console.log(t.t0);case 15:case"end":return t.stop()}},t,this,[[0,11]])})),n.changeStatus=function(){var t=Object(ie.a)(ae.a.mark(function t(e,r){var a,i,o;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,i=r.co,o=n.props.enquiryQuery.statuses.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,a!==o){t.next=8;break}if(n.state.statusPending){t.next=7;break}return t.abrupt("return",n.setState({statusPending:!0,activeCO:"new"}));case 7:n.setState({statusPending:!1});case 8:return t.prev=8,n.setState({changingStatus:!0}),t.next=12,n.props.createEnquiryEvent({variables:Object(f.a)({enquiryId:n.props.id,statusId:a},i&&{doc:Object(f.a)({},i)})});case 12:n.setState({changingStatus:!1,activeCO:""}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(8),n.setState({changingStatus:!1,error:t.t0.message}),console.log(t.t0);case 19:case"end":return t.stop()}},t,this,[[8,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.cancelPendingStatusChange=function(){n.setState({statusPending:!1,activeCO:""})},n.saveNote=Object(ie.a)(ae.a.mark(function t(){var e;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=n.noteEditorRef.current.exportHtml())!==n.props.enquiryQuery.enquiry.htmlNote){t.next=4;break}return t.abrupt("return",n.setState({noteKey:n.state.noteKey+1,noteEditorDiff:!1}));case 4:return n.setState({savingNote:!0}),t.next=7,n.props.updateEnquiry({variables:{input:{id:n.props.id,htmlNote:e}}});case 7:if(n.componentIsMounted){t.next=9;break}return t.abrupt("return");case 9:n.setState({savingNote:!1,error:"",noteKey:n.state.noteKey+1,noteEditorDiff:!1}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({savingNote:!1,error:t.t0.message}),console.log(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,12]])})),n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.editorHasText,i=e.creatingComment,o=e.changingStatus,c=e.statusPending,l=e.error,u=e.noteEditorDiff,d=e.noteKey,s=e.savingNote,m=e.activeCO,f=this.props.enquiryQuery,p=this.isNewEnquiry;if(f.loading)return a.a.createElement(Qt,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...");if(f.error)return a.a.createElement(Qt,null,"\u041e\u0448\u0438\u0431\u043a\u0430 ",f.error.message);var b=p?f.newEnquiry:f.enquiry,g=b.org,h=b.model,v=b.qty,y=b.htmlNote,E=b.events,O=E&&E.filter(function(t){return t.doc}),j=E&&E.filter(function(t){return t.status}).pop().status,x=f.statuses.slice(),q=x.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,w=x.find(function(t){return"\u0417\u0430\u043a\u0430\u0437"===t.name}).id,k=x.filter(function(t){return["\u041d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","\u041e\u0442\u043a\u0430\u0437"].includes(t.name)}).map(function(t){return t.id}),C=x.sort(function(t,e){return t.stage===e.stage&&k.includes(t.id)}),S=0,I=E&&E.reduce(function(t,e,n){return e.status&&0!==n?k.includes(e.status.id)?Object(we.a)(t).concat(["refuse"]):e.status.id===w?Object(we.a)(t).concat(["order"]):(t.push(e.status.stage-S>0?"up":"down"),S=e.status.stage,t):Object(we.a)(t).concat([null])},[]);return a.a.createElement(ve,null,function(e){var f=e.details,p=e.setDetails,x=f.id,S=f.editMode,F="new"===x;return a.a.createElement(r.Fragment,null,(S||F)&&a.a.createElement(Dn,{id:x,enquiry:b,setDetails:p}),!(S||F)&&a.a.createElement(r.Fragment,null,a.a.createElement(Qt,null,a.a.createElement(tr,null,a.a.createElement("tbody",null,a.a.createElement(er,null,a.a.createElement(nr,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(nr,null,g&&g.name),a.a.createElement(nr,null)),a.a.createElement(er,null,a.a.createElement(nr,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(nr,null,h&&h.name),a.a.createElement(nr,null)),a.a.createElement(er,null,a.a.createElement(nr,null,"\u041a\u043e\u043b-\u0432\u043e, \u0448\u0442."),a.a.createElement(nr,null,v),a.a.createElement(nr,null)),!!O.length&&a.a.createElement(er,null,a.a.createElement(nr,null,"\u041a\u041f"),a.a.createElement(nr,null,O.map(function(t){var e=t.doc,n=e.id,r=e.dateLocal,i=e.amount;return a.a.createElement(Lt,{key:n,fw:"normal",lh:"1.21428571em"},a.a.createElement("b",null,Ne(i)," ")," ( \u043e\u0442 ",r," )")})),a.a.createElement(nr,null)),a.a.createElement(er,null,a.a.createElement(nr,null,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),a.a.createElement(ar,null,a.a.createElement(un,{key:d,borderless:!0,ref:t.noteEditorRef,initFromHtml:y,setEditorDiff:t.setNoteEditorDiff,diff:u,onSave:t.saveNote}),u&&a.a.createElement(Pt,{mt:".67857143em",content:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u0435",labelPosition:"left",icon:"save",primary:!0,floated:"left",onClick:t.saveNote,disabled:s,loading:s})),a.a.createElement(nr,null)),a.a.createElement(er,null,a.a.createElement(nr,null,"\u0421\u0442\u0430\u0442\u0443\u0441"),a.a.createElement(rr,null,a.a.createElement(ir,{labeled:!0,button:!0,className:"icon",loading:o,disabled:o||c,value:j.id,text:j.name,options:C.filter(function(t){return(t.id===j.id||1===Math.abs(t.stage-j.stage))&&!(0===t.stage&&0!==j.stage)}).map(function(t){return{key:t.id,text:t.name,value:t.id,label:{basic:!0,content:"\u0441\u0442",detail:t.stage,icon:k.includes(t.id)?"minus circle":t.id===w?"checkmark":"long arrow alternate ".concat(t.stage-j.stage>0?"up":"down")}}}),onChange:t.changeStatus,selectOnBlur:!1,selectOnNavigation:!1}),a.a.createElement(en.a,{basic:!0,size:"large",content:"\u0441\u0442\u0430\u0434\u0438\u044f",detail:j.stage})),a.a.createElement(nr,null))))),m&&a.a.createElement(Qn,{id:m,submit:function(e){return t.changeStatus(null,{value:q,co:e})},cancel:t.cancelPendingStatusChange}),a.a.createElement(or,{minimal:!0},a.a.createElement(dt.a,{as:"h3",dividing:!0,content:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 \u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"}),E.map(function(t,e){var n=t.user.person,r=n.fName,i=n.lName,o=(i?r.slice(0,1):r.slice(0,2))+(i?i.slice(0,1):"");return a.a.createElement(tn.a,{key:t.id},t.type&&"COMMENT"!==t.type&&a.a.createElement(cr,{size:"big",type:t.type,color:"CREATE"===t.type?"green":"UPDATE"===t.type?"blue":"STATUS"===t.type&&"up"===I[e]?"yellow":"STATUS"===t.type&&"down"===I[e]?"brown":"STATUS"===t.type&&"refuse"===I[e]?"red":"STATUS"===t.type&&"order"===I[e]?"green":"grey",name:"CREATE"===t.type?"plus":"UPDATE"===t.type?"write square":"STATUS"===t.type&&"refuse"===I[e]?"minus circle":"STATUS"===t.type&&"order"===I[e]?"checkmark":"STATUS"===t.type?"long arrow alternate ".concat(I[e]):"question"}),a.a.createElement(lr,{size:"big",content:o,indent:t.type&&"COMMENT"!==t.type?0:1}),a.a.createElement(ur,null,a.a.createElement(dr,{content:t.datetimeLocal.slice(0,16)}),a.a.createElement(sr,{dangerouslySetInnerHTML:{__html:Object(dn.sanitize)(t.htmlText)}})))}),a.a.createElement(le.a,{reply:!0,error:!!l},a.a.createElement(Dt,{m:"0 0 1em 6.35em"},a.a.createElement(un,{ref:t.editorRef,setEditorHasText:t.setEditorHasText,onSave:t.createComment})),a.a.createElement(mr,{error:!0,header:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:l}),a.a.createElement(Pt,{content:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442",labelPosition:"left",icon:"edit",primary:!0,floated:"right",onClick:t.createComment,disabled:!n,loading:i})))))})}}]),e}(r.Component),pr=Object(d.compose)(Object(d.graphql)(Z,{name:"updateEnquiry"}),Object(d.graphql)(tt,{name:"createEnquiryEvent",options:function(t){return{update:function(e,n){var r=n.data.createEnquiryEvent,a="Enquiry:".concat(t.id),i=et,o=e.readFragment({id:a,fragment:i});if(o.events.push(r),e.writeFragment({id:a,fragment:i,data:o}),r.status){var c=W,l=(o=e.readQuery({query:c})).enquiries.find(function(e){return e.id===t.id});l.status=r.status,r.doc&&l.docs.push(r.doc),e.writeQuery({query:c,data:o})}}}}}),Object(d.graphql)(J,{name:"enquiryQuery",skip:function(t){return"new"!==t.id}}),Object(d.graphql)(X,{name:"enquiryQuery",skip:function(t){return"new"===t.id}}))(fr),br=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).handleInputChange=function(t,e){var r=e.value,a=n.props,i=a.field.name;(0,a.setField)(i,{value:parseInt(r,10)||""})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.props,e=t.field.curVal,n=(t.setField,Object(ut.a)(t,["field","setField"]));return a.a.createElement(sn.a,Object.assign({},n,{value:e,onChange:this.handleInputChange}))}}]),e}(r.Component),gr=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).componentIsMounted=!0,n.isNewEntity="new"===n.props.id,n.state={loading:!1,err:null},n.submit=function(t){n.upsertOrder(Object(f.a)({},t,n.isNewEntity&&{enquiryId:n.props.enquiryId},!n.isNewEntity&&{id:n.props.id}))},n.upsertOrder=function(){var t=Object(ie.a)(ae.a.mark(function t(e){var r;return ae.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.upsertOrder({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:null}),n.props.setDetails({type:"Order",id:r.data.upsertOrder.id}),n.props.setExpanded({id:r.data.upsertOrder.id,value:!0}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({loading:!1,err:{title:"".concat(n.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"," \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c.."),message:t.t0.message}}),console.log(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,12]])}));return function(e){return t.apply(this,arguments)}}(),n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state.loading,n=this.props,i=n.id,o=n.closeDetails,c=n.setDetails,l="new"===i,u=l?{dateLocal:gn(new Date).slice(0,10),qty:"",amount:""}:this.props.orderLocal.orderLocal;return a.a.createElement(zn,{isNewEntity:l,entity:u,requiredFields:["dateLocal","qty","amount"],submit:this.submit,err:this.state.err},function(n){var l=n.disabled,u=n.err,d=n.setField,s=n.submit,m=n.formState,f=m.dateLocal,p=m.qty,b=m.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(Qt,{bottomBorder:!0},a.a.createElement(le.a,null,a.a.createElement(le.a.Field,{inline:!0},a.a.createElement(Mt,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Tn,{field:f,setField:d})),a.a.createElement(le.a.Field,{inline:!0,required:!0},a.a.createElement(Mt,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(br,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",field:p,setField:d}),a.a.createElement(Nt,{pl:"6px"},"\u0448\u0442.")),a.a.createElement(le.a.Field,{inline:!0,required:!0},a.a.createElement(Mt,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(Pn,{field:b,setField:d,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u0437\u0430\u043a\u0430\u0437\u0430"})))),a.a.createElement(Qt,null,u&&a.a.createElement(ft.a,{error:!0,header:u.title,content:u.message}),a.a.createElement(Dt,{inline:!0,w:"formLabel"}),a.a.createElement(mt.a,{primary:!0,content:t.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:l,loading:e,onClick:s}),a.a.createElement($t,{cancel:!0,onClick:"new"===i?o:function(){return c({type:"Order",id:i})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))})}}]),e}(r.Component),hr=Object(d.compose)(Object(d.graphql)(L,{name:"upsertOrder",options:{update:function(t,e){var n=e.data.upsertOrder;console.log("this > ",void 0);var r=W,a=t.readQuery({query:r}),i=a.enquiries.find(function(t){return t.id===n.enquiry.id});i.orders=Object(we.a)(i.orders.filter(function(t){return t.id!==n.id})).concat([n]).sort(function(t,e){return t.num>e.num}),t.writeQuery({query:r,data:a})}}}),Object(d.graphql)(N,{name:"orderLocal",skip:function(t){return"new"===t.id}}))(gr),vr=function(t){function e(){return Object(Vt.a)(this,e),Object(_t.a)(this,Object(Kt.a)(e).apply(this,arguments))}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.props,e=t.buttons,n=t.size,r=t.noIndent,i=t.bottomBorder,o=t.title,c=t.subtitle,l=t.titleSize,u=t.onClick,d=t.expanded;return a.a.createElement(_e,{expanded:d,onClick:u,size:n,noIndent:r,bottomBorder:i},a.a.createElement(Ue,{title:o,subtitle:c,size:l||n}),e&&a.a.createElement(We,null,e))}}]),e}(r.Component);function yr(){var t=Object(p.a)(["\n  & {\n    padding: 0;\n    margin-bottom: -1px;\n  }\n"]);return yr=function(){return t},t}function Er(){var t=Object(p.a)(["\n  & { \n    padding: 0;\n    ","\n  }\n"]);return Er=function(){return t},t}var Or=Object(ct.b)(Qt)(Er(),function(t){return t.expanded&&"{\n      margin-top: -1px;\n      border-bottom-color: rgba(34, 36, 38, 0.15);\n    }"}),jr=Object(ct.b)(Qt)(yr()),xr=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={expanded:!1},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.children,r=e.forceExpanded,i=Object(ut.a)(e,["children","forceExpanded"]),o=this.state.expanded||r;return a.a.createElement(Or,{expanded:o?1:0,topBorder:o,bottomBorder:o},a.a.createElement(vr,Object.assign({},i,{expanded:o,bottomBorder:o&&"dark",disabled:r,titleSize:"small",onClick:!r&&function(){return t.setState({expanded:!t.state.expanded})}})),o&&a.a.createElement(jr,null,n))}}]),e}(r.Component),qr=n(164),wr=n.n(qr),kr=function(t){var e=t.children,n=t.prods,r=t.selectedIds,a=t.orderId,i=t.selectLimit,o=t.selectedProds,c=void 0===o?[]:o,l=t.orderProdsQty,u=t.diff,d=t.expandedIds,s=t.expanded,m=Object(f.a)({},a&&{extra:!0},a&&i===r.length&&{limitReached:!0},!a&&{order:!0},u&&{diff:!0},d&&{expand:!0},s&&{expanded:!0}),p=m.extra?n:m.order?wr.a.unionBy(n,c,"id"):[],b=wr()(p).sortBy("dept.type").groupBy("dept.name").reduce(function(t,e){var i=Object(f.a)({},e[0].dept);if(i=Object(f.a)({},i,{count:e.length,readyCount:e.filter(function(t){return 100===t.progress}).length,hasDefect:e.filter(function(t){return t.hasDefect}).length,isSpoiled:e.filter(function(t){return t.isSpoiled}).length},m.expand&&{expanded:d.some(function(t){return t===i.id})},m.expanded&&{expanded:!0},{prods:e.map(function(t){var e=Object(f.a)({},t,m.extra&&{selected:r.includes(t.id),ordered:!!t.order&&t.order.id!==a},m.order&&m.diff&&{added:!n.some(function(e){return e.id===t.id}),removed:!c.some(function(e){return e.id===t.id})});return m.extra&&(e=Object(f.a)({},e,{disabled:e.ordered||m.limitReached&&!e.selected})),e})}),m.extra){var o=i.prods.filter(function(t){return t.ordered}).length||0;i=Object(f.a)({},i,{selectedCount:i.prods.filter(function(t){return t.selected}).length||0,orderedCount:o,availCount:i.count-o}),i=Object(f.a)({},i,{selected:i.selectedCount===i.availCount||0!==i.selectedCount&&"partly"}),i=Object(f.a)({},i,{disabled:i.prods.every(function(t){return t.disabled})||m.limitReached&&[!1].includes(i.selected)})}return t.push(i),t},[]);if(m.order){var g=u?l-c.length:l-n.length;g&&b.unshift({id:"unreserved",name:"\u0411\u0435\u0437 \u0440\u0435\u0437\u0435\u0440\u0432\u0430",count:g,prods:[]})}return e({depts:b,xor:!!wr.a.xorBy(n,c,"id").length})},Cr=[{name:"name",path:"name",title:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a / \u2116 \u0418\u0437\u0434\u0435\u043b\u0438\u044f",width:"170px"},{name:"progress",path:"progress",title:"\u0417\u0430\u0432\u0435\u0440\u0448.",width:"65px"},{name:"hasDefect",path:"hasDefect",title:"\u041e\u0442\u043a\u043b\u043e\u043d.",width:"65px"},{name:"isSpoiled",path:"isSpoiled",title:"\u0411\u0440\u0430\u043a",width:"55px"},{name:"reserve",title:"\u0420\u0435\u0437\u0435\u0440\u0432",width:"75px"}],Sr=function(t){var e=t.depts,n=t.skipFields,i=void 0===n?[]:n,o=t.select,c=t.expand,l=t.indent,u=t.nameFieldWidth,d=Sn()(Cr);return u&&(d.find(function(t){return"name"===t.name}).width=u),a.a.createElement(Le,{fields:d.filter(function(t){return!i.includes(t.name)}),indent:l,select:o,expand:c},function(t){var n=t.tableFields;return a.a.createElement(r.Fragment,null,e.map(function(t){var e=t.id,i=t.expanded;return"unreserved"===e?a.a.createElement(Pe,{key:e,entity:t,tableFields:n,rowFields:[{name:"name",value:t.name+" ("+t.count+")"}]}):a.a.createElement(r.Fragment,{key:e},a.a.createElement(Pe,{entity:t,tableFields:n,expandFor:"prods",expanded:i,expand:function(){return c(e)},onClick:function(){return c(e)},select:function(){return o(e)},rowFields:[{name:"name",value:t.name+" ("+t.count+")"},{name:"progress",path:"readyCount",icon:"checkmark",iconColor:"green"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",path:"orderedCount",icon:"gavel",iconColor:"brown"}]}),i&&t.prods.map(function(e,r){var i=e.id,c=e.progress,l=e.order,u=e.added,d=e.removed;return a.a.createElement(Pe,{secondary:1,lastSecondaryRow:r===t.prods.length-1?1:0,key:i,entity:e,tableFields:n,select:function(){return o(i)},rowFields:Object(we.a)(u||d?[{name:"service",value:!0,icon:u?"plus":"minus",iconColor:u?"green":"red"}]:[]).concat([{name:"name",path:"fullnumber"},{name:"progress",value:c&&c+"%"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",value:l&&l.enquiry.num+"-"+l.num}]),onClick:o&&function(){return o(i)}})}))}))})};function Ir(){var t=Object(p.a)(["\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\n"]);return Ir=function(){return t},t}var Fr=Object(ct.b)(st.a)(Ir()),Dr=function(t){var e=t.modelId,n=t.orderId,r=t.prodIds;return a.a.createElement(ve,null,function(t){var i=t.extra,o=t.setExtra,c=t.setSelectedProdIds;return a.a.createElement(Pt,{compact:!0,circular:!0,menu:!0,activeColor:"green",active:!!i,onClick:function(t){t.stopPropagation(),c(r),o({type:"Store",modelId:e,orderId:n})}},a.a.createElement(st.a,{name:"gavel"}),"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",a.a.createElement(Fr,{name:"angle right"}))})};function Lr(){var t=Object(p.a)(["\n\tquery ProdsLocal ($ids: [ID!]!) {\n\t\tprodsLocal (ids: $ids) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t}\n"]);return Lr=function(){return t},t}function Nr(){var t=Object(p.a)(["\n\tquery ModelProds ($modelId: ID!) {\n\t\tmodelProds (modelId: $modelId) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t\torder {\n\t\t\t\tid\n\t\t\t\tnum\n\t\t\t\tenquiry {\n\t\t\t\t\tid\n\t\t\t\t\tnum\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]);return Nr=function(){return t},t}var $r=g()(Nr()),Tr=g()(Lr()),Mr=Object(d.compose)(Object(d.graphql)(Tr,{name:"prodsLocal"}))(function(t){return(0,t.children)({prodsLocal:t.prodsLocal.prodsLocal||[]})}),Br=function(t){var e=t.order,n=e.id,i=e.model,o=e.qty,c=e.prods;return console.log("id, model, qty, prods > ",n,i,o,c),a.a.createElement(ve,null,function(t){var e=t.extra,l=t.setExtra,u=t.selectedProdIds;return a.a.createElement(xr,{forceExpanded:!!e,title:i.name,subtitle:o+"\u0448\u0442",buttons:a.a.createElement(Dr,{modelId:i.id,orderId:n,prodIds:c.map(function(t){return t.id})})},a.a.createElement(Mr,{ids:u},function(t){var i=t.prodsLocal;return a.a.createElement(kr,{prods:c,selectedProds:i,orderProdsQty:o,expanded:!0,diff:!!e},function(t){var i=t.depts,o=t.xor;return a.a.createElement(r.Fragment,null,a.a.createElement(Sr,{depts:i,skipFields:["reserve"],expand:function(){return null},indent:"32px",nameFieldWidth:"200px"}),e&&a.a.createElement(d.Mutation,{mutation:T,variables:{orderId:n,prodIds:u}},function(t,e){var n=e.loading,i=e.error;return a.a.createElement(r.Fragment,null,a.a.createElement(Qt,{minor:!0,head:!0,topBorder:"dark"},a.a.createElement(Pt,{primary:!0,compact:!0,circular:!0,menu:!0,ml:"0",content:"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c",icon:"gavel",loading:n,disabled:!o,onClick:function(){t(),l(null)}})),i&&a.a.createElement(zt,{section:!0,error:!0,header:"\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:i.message}))}))})}))})},Pr=function(t){var e=t.order;return a.a.createElement(Br,{order:e})},zr=Object(d.compose)(Object(d.graphql)(X,{name:"query1",skip:function(t){return"Enquiry"!==t.type}}),Object(d.graphql)($,{name:"query2",skip:function(t){return"Order"!==t.type}}),Object(d.graphql)(Y,{name:"localQuery1",skip:function(t){return"Enquiry"!==t.type}}),Object(d.graphql)(N,{name:"localQuery2",skip:function(t){return"Order"!==t.type}}))(function(t){var e=t.children,n=t.type,r=t.query1,a=t.query2,i=t.localQuery1,o=t.localQuery2,c=r||a,l=i||o;return e({loading:c.loading,error:c.error,refetch:c.refetch,entity:"Enquiry"===n?c.enquiry:"Order"===n?c.order:null,localEntity:"Enquiry"===n?l.enquiryLocal:"Order"===n?l.orderLocal:null})});function Qr(){var t=Object(p.a)(["\n\t/* flex-grow: 1; */\n\twidth: 60%;\n"]);return Qr=function(){return t},t}var Ar=ct.b.div(Qr()),Rr=function(t){var e=t.closeDetails;return a.a.createElement(ve,null,function(t){var n=t.details,r=n.type,i=n.id,o=n.enquiryId,c=n.editMode,l=t.setDetails,u=t.setExpanded;return a.a.createElement(zr,{type:r,id:i},function(t){var n=t.loading,d=(t.error,t.refetch),s=t.entity,m=t.localEntity;return a.a.createElement(Ar,null,a.a.createElement(Ze,{type:r,localEntity:m,closeDetails:e,setDetails:l,editMode:c,loading:n,refresh:function(){return d()}}),"Enquiry"===r?a.a.createElement(pr,{id:i,closeDetails:e}):null,"Order"===r&&("new"===i||c?a.a.createElement(hr,{id:i,enquiryId:o,closeDetails:e,setDetails:l,setExpanded:u}):s&&a.a.createElement(Pr,{order:s})))})})};function Vr(){var t=Object(p.a)(["\n\tquery ModelLocal ($id: ID!) {\n\t\tmodelLocal (id: $id) {\n\t\t\tname\n      article\n\t\t}\n\t}\n"]);return Vr=function(){return t},t}var Hr=g()(Vr()),_r=n(44),Kr=n.n(_r),Ur=n(372),Wr=n.n(Ur),Xr=n(123),Yr=n.n(Xr),Jr=n(237),Gr=n.n(Jr),Zr=n(165),ta=n.n(Zr),ea=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).select=function(t){var e=n.props,r=e.depts,a=e.setList,i=e.selectLimit,o=Sn()(r),c=o.reduce(function(t,e){return Object(we.a)(t).concat(Object(we.a)(e.prods.filter(function(t){return t.selected}).map(function(t){return t.id})))},[]),l=ta()({id:t},o)||ta()({prods:[{id:t}]},o),u=l.prods,d=l.id===t?l:ta()({id:t},u);if(d.disabled)return null;var s=[];if("Prod"===d.__typename&&(s=c.includes(t)?Kr()(c,t):Object(we.a)(c).concat([t])),"Dept"===d.__typename&&(["partly",!0].includes(d.selected)&&(s=Gr()(c,u.map(function(t){return t.id}))),!1===d.selected)){var m=Wr()(u.filter(function(t){return!t.disabled}).map(function(t){return t.id}),i-c.length);s=Yr()(c,m)}a(s)},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){return(0,this.props.children)({select:this.select})}}]),e}(r.Component),na=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={list:[]},n.setList=function(t){return n.setState({list:t})},n.toggle=function(t){var e=n.state.list,r=e.includes(t)?Object(we.a)(e.filter(function(e){return e!==t})):Object(we.a)(e).concat([t]);n.setState({list:r})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){return this.props.children({list:this.state.list,setList:this.setList,toggle:this.toggle})}}]),e}(r.Component),ra=Object(d.compose)(Object(d.graphql)(N,{name:"orderLocal"}))(function(t){return(0,t.children)({orderLocal:t.orderLocal.orderLocal||[]})});function aa(){var t=Object(p.a)(["\n\twidth: 40%;\n\tmin-height: calc(100vh - 36px);\n\theight: fit-content;\n\t/* border-left: 1px solid rgb(126, 126, 129); */\n\tborder-left: 1px solid rgb(156, 156, 159);\n"]);return aa=function(){return t},t}var ia=ct.b.div(aa()),oa=function(t){var e=t.closeExtra;return a.a.createElement(ve,null,function(t){var n=t.extra,i=t.selectedProdIds,o=t.setSelectedProdIds;return a.a.createElement(ia,null,!!n&&a.a.createElement(r.Fragment,null,a.a.createElement(d.Query,{query:Hr,variables:{id:n.modelId}},function(t){var n=t.data.modelLocal;return a.a.createElement(vr,{title:n.name+" \u0432 \u043d\u0430\u043b\u0438\u0447\u0438\u0438",size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(st.a,{link:!0,name:"cancel",onClick:e})})}),a.a.createElement(d.Query,{query:$r,variables:{modelId:n.modelId}},function(t){var e=t.loading,r=t.error,c=t.data;return e?a.a.createElement(Qt,{noIndent:!0},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."):r?a.a.createElement(Qt,{noIndent:!0},"\u041e\u0448\u0438\u0431\u043a\u0430 ",r.message):a.a.createElement(ra,{id:n.orderId},function(t){var e=t.orderLocal;return a.a.createElement(na,null,function(t){var r=t.list,l=t.toggle;return a.a.createElement(kr,{prods:c.modelProds,selectedIds:i,orderId:n.orderId,selectLimit:e.qty,expandedIds:r},function(t){var n=t.depts;return a.a.createElement(ea,{depts:n,setList:o,selectLimit:e.qty},function(t){var e=t.select;return a.a.createElement(Sr,{depts:n,select:e,expand:l})})})})})})))})};function ca(){var t=Object(p.a)(["\n\t&&&& {\n\t\tdisplay: flex;\n\t\twidth: 120%;\n\t\tbackground-color: white;\n\t\ttransition: all .5s ease;\n\t\tmax-width: ",";\n\t\t","\n\t\t","\n\t}\n"]);return ca=function(){return t},t}var la=Object(ct.b)(he.a)(ca(),function(t){return"Enquiry"===t.type?"1000px":"1200px"},function(t){return!t.extra&&"\n\t\t\t&.ui.visible.right.overlay.sidebar {\n\t\t\t\ttransform: translate3d(40%,0,0);\n\t\t\t}\n\t\t"},function(t){return t.extra&&"\n\t\t\twidth: 86%;\n\t\t"}),ua=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={detailsClosing:!1},n.closeDetails=function(){n.setState({detailsClosing:!0}),setTimeout(function(){n.props.setLayout({variables:{details:null,extra:null}}),n.setState({detailsClosing:!1})},300)},n.closeExtra=function(){n.props.setLayout({variables:{extra:null}})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"render",value:function(){var t=this.state.detailsClosing,e=this.props.layout,n=e.details,i=e.extra;return a.a.createElement(la,{visible:!!n&&!t,extra:i?1:0,type:n&&n.type,animation:"overlay",direction:"right"},n&&a.a.createElement(r.Fragment,null,a.a.createElement(Rr,{key:n.type+n.id,closeDetails:this.closeDetails}),a.a.createElement(oa,{extra:i,closeExtra:this.closeExtra})))}}]),e}(r.Component),da=Object(d.compose)(Object(d.graphql)(E,O),Object(d.graphql)(j,{name:"setLayout"}))(ua);function sa(){var t=Object(p.a)(["\n\tmin-height: calc(100vh - 36px) !important;\n"]);return sa=function(){return t},t}var ma=Object(ct.b)(he.a.Pushable)(sa()),fa=Object(d.compose)(Object(d.graphql)(W,{name:"allEnquiries"}))(function(t){var e=t.allEnquiries,n=e.loading,i=e.error,o=e.refetch,c=(e.networkStatus,e.enquiries),l=t.refreshToken;return a.a.createElement(r.Fragment,null,a.a.createElement(qe,{refetchEnquiries:function(){return o()},enquiriesAreLoading:n,refreshToken:l}),n&&"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",i&&"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(i.message),c&&a.a.createElement(ma,null,a.a.createElement(da,null),a.a.createElement(he.a.Pusher,null,a.a.createElement(Qe,{enquiries:c}))))}),pa=function(t){function e(){var t,n;Object(Vt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(_t.a)(this,(t=Object(Kt.a)(e)).call.apply(t,[this].concat(a)))).state={token:n.props.token},n.bootStrapData=function(){try{var t=localStorage.getItem(s);if(null!==t&&void 0!==t)Yt(t)?n.refreshToken(null):n.setState({token:t})}catch(e){console.log("")}},n.refreshToken=function(t){t?localStorage.setItem(s,t):(localStorage.removeItem(s),n.props.client.resetStore()),n.setState({token:t})},n}return Object(Ut.a)(e,t),Object(Ht.a)(e,[{key:"componentDidMount",value:function(){this.bootStrapData()}},{key:"render",value:function(){var t=this,e=this.state.token;return a.a.createElement(r.Fragment,null,e?a.a.createElement(d.Query,{query:te},function(e){var n=e.loading,r=e.error,i=e.data;return n?null:r?"Error!: ".concat(r.message):a.a.createElement(fa,{refreshToken:t.refreshToken,me:i.me})}):a.a.createElement(ge,{refreshToken:this.refreshToken}))}}]),e}(r.Component),ba=function(t){var e=t.token,n=t.client;return a.a.createElement(ct.a,{theme:St},a.a.createElement(pa,{token:e,client:n}))},ga=new l.a({uri:"https://env-1542080.mircloud.ru",request:function(t){var e=localStorage.getItem(s);t.setContext({headers:{Authorization:e?"Bearer ".concat(e):""}})},clientState:{defaults:m,resolvers:ot,typeDefs:"\n\ttype Details {\n\t\ttype: String\n\t\tid: ID\n\t\tenquiryId: ID\n\t\teditMode: Boolean\n\t\tclosing: Boolean\n\t}\n"},cache:new u.a({dataIdFromObject:function(t){switch(t.__typename){case"NewEnquiry":return"NewEnquiry";default:return Object(u.b)(t)}},cacheRedirects:{Query:{enquiryLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Enquiry",id:e.id})},orderLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Order",id:e.id})},modelLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Model",id:e.id})},prodsLocal:function(t,e,n){var r=n.getCacheKey;return e.ids.map(function(t){return r({__typename:"Prod",id:t})})}}}})}),ha=localStorage.getItem(s);o.a.render(a.a.createElement(d.ApolloProvider,{client:ga},a.a.createElement(ba,{token:ha,client:ga})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[386,2,1]]]);
//# sourceMappingURL=main.a7d01a43.chunk.js.map