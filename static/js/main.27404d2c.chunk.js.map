{"version":3,"sources":["serviceWorker.js","constants.js","apollo/defaults.js","graphql/layout.js","graphql/order.js","graphql/doc.js","graphql/status.js","graphql/file.js","graphql/drawing.js","graphql/model.js","graphql/enquiry.js","graphql/lists.js","apollo/resolvers.js","apollo/apollo.js","components/styled/styled-semantic.js","components/notifications/NotificationsContext.js","components/notifications/Notification.js","components/notifications/Notifications.js","components/notifications/NotificationsViewer.js","graphql/disk.js","components/context/DiskContext.js","utils/jwtHelper.js","graphql/user.js","components/LoginPage.js","components/Menu.js","components/context/GlobalContext.js","components/Enquiry/EnquiriesSubmenu.js","components/Enquiry/EnquiriesMenu.js","components/common/Table.js","utils/format.js","components/common/TableRow.js","utils/object.js","components/Enquiry/EnquiriesTable.js","components/DetailsOld/DetailsDataProvider.js","components/DetailsOld/DetailsHeaderContainer.js","components/DetailsOld/DetailsHeaderSubitle.js","components/DetailsOld/DetailsHeaderTitle.js","components/DetailsOld/DetailsHeaderButtons.js","components/common/RefreshButton.js","components/DetailsOld/DetailsMainHeader.js","components/styled/entity-table.js","components/common/DraftEditor.js","components/common/WrappedDraftEditor.js","utils/validateInn.js","utils/dates.js","graphql/opType.js","graphql/org.js","graphql/combinedQueries.js","components/common/DatePicker.js","components/presentational/SecondarySection.js","components/form/utils.js","schema/commonTypes.js","schema/model.js","components/form/FormikCurrency.js","components/form/FormikInput.js","components/form/FormikTel.js","components/form/FormikField.js","components/Model/Form.js","components/Enquiry/Edit.js","components/common/LocalDatePicker.js","components/common/CurrencyInput.js","components/common/SmartForm.js","components/Enquiry/EnquiryCommercialOffer.js","components/Enquiry/EnquiryDetails.js","components/common/SmartInput.js","components/Order/OrderEdit.js","components/DetailsOld/DetailsHeader.js","components/presentational/CollapsableSection.js","components/Order/ProdsByDept.js","components/Order/DeptProdTable.js","components/Order/ReserveProdsButton.js","graphql/prod.js","components/context/ProdContext.js","components/Order/ModelProdsSection.js","components/Order/OrderDetails.js","components/Model/Details/Drawings/Drawing.js","components/Model/Details/Drawings/Sortable.js","components/Model/Details/Drawings/SortedCollectionProvider.js","components/context/StatefulList.js","components/context/StatefulBool.js","components/Model/Details/Drawings.js","components/Model/Details.js","components/DetailsOld/Details.js","components/Order/ProdTableUtils.js","components/context/ListProvider.js","components/context/OrderContext.js","components/DetailsOld/DetailsExtra.js","components/DetailsOld/DetailsSidebar.js","components/common/PanelPusher.js","graphql/tel.js","graphql/person.js","graphql/employee.js","components/Employee/PanelHeader.js","components/list/Tel.js","components/list/Field.js","components/list/List.js","schema/tel.js","schema/person.js","schema/employee.js","components/Employee/Details.js","components/Employee/Form.js","components/Employee/Edit.js","components/Employee/Table.js","components/Enquiry/EnquiriesBottomPanel.js","components/Enquiry/EnquiriesPage.js","graphql/article.js","graphql/account.js","graphql/equipment.js","graphql/payment.js","components/Payments/Chart.js","graphql/amo.js","schema/payment.js","components/Payments/Form.js","components/Payments/Stats.js","components/Payments/Table.js","graphql/tochka.js","components/Payments/Page.js","graphql/dealStatus.js","graphql/exec.js","graphql/task.js","graphql/appoint.js","graphql/op.js","graphql/proc.js","graphql/workpiece.js","graphql/batch.js","graphql/deal.js","components/Deals/context/Context.js","components/Details/Menu/LeftIcon.js","components/Details/Menu/Menu.js","components/Org/Details/InnForm.js","components/Org/Details/Requisites.js","components/common/HtmlDatePicker.js","components/common/HtmlInput.js","components/common/HtmlTextArea.js","components/common/HtmlSelect.js","components/form/Field.js","components/Org/Details/Contract.js","components/Org/Details/Details.js","components/hooks/apolloHooks.js","components/Batch/Details.js","components/Deals/Details/Details.js","components/ComOffer/CreateComOfferDetails.js","components/Task/CreateTaskDetails.js","components/Exec/SelectExecDetails.js","components/Details/Provider.js","components/Deals/TableCells/Model.js","components/Deals/TableCells/Qty.js","components/Deals/TableCells/Proc.js","components/Deals/TableCells/Op/OpType.js","components/Deals/TableCells/Op/DealLabour.js","components/Deals/TableCells/DropdownMenu.js","components/Deals/TableCells/Exec/Name.js","components/Deals/TableCells/Appoint/Appoint.js","components/Deals/TableCells/Op/Op.js","components/Deals/TableCells/Op/Ops.js","components/Deals/TableCells/ProcOps.js","components/Deals/TableCells/Batch.js","components/Deals/TableCells/Batches.js","components/Deals/TableCells/Org.js","components/Deals/TableCells/Deal.js","components/Deals/Table.js","components/Deals/Menu.js","components/Deals/Page.js","components/Root.js","App.js","index.js"],"names":["Boolean","window","location","hostname","match","AUTH_TOKEN","defaults","newEnquiry","__typename","id","layout","details","extra","bottomPanel","lists","selectedProdIds","getLayout","gql","_templateObject","getLayoutOptions","props","_ref","data","setLayout","_templateObject2","setExpanded","_templateObject3","orderFragmentBasic","order_templateObject","orderFragmentFull","order_templateObject2","upsertOrder","order_templateObject3","orderLocal","_templateObject4","orderDetails","_templateObject5","reserveProds","_templateObject6","docFragmentBasic","doc_templateObject","statusFragment","status_templateObject","fileFragmentFull","file_templateObject","drawingFragmentBasic","drawing_templateObject","drawingFragmentFull","drawing_templateObject2","createDrawings","drawing_templateObject3","deleteDrawings","drawing_templateObject4","setDrawingsSortOrder","drawing_templateObject5","modelFragmentBasic","model_templateObject","modelFragmentWithDrawings","model_templateObject2","modelFragmentFull","model_templateObject3","modelLocal","model_templateObject4","modelDetails","model_templateObject5","upsertModel","model_templateObject6","enquiryFragmentBasic","enquiry_templateObject","allEnquiries","enquiry_templateObject2","enquiryDetails","enquiry_templateObject3","enquiryLocal","enquiry_templateObject4","enquiry_templateObject5","createEnquiry","enquiry_templateObject6","updateEnquiry","_templateObject7","createEnquiryEvent","_templateObject8","enquiryFragment","_templateObject9","getLists","lists_templateObject","setList","lists_templateObject2","resolvers","Enquiry","isExpanded","Mutation","_","_ref2","input","cache","query","readQuery","Object","objectSpread","cloneDeep","writeQuery","_ref3","_ref4","_ref3$args","args","enquiryId","value","enquiries","find","e","_ref5","_ref6","name","InMemoryCache","dataIdFromObject","object","defaultDataIdFromObject","cacheRedirects","Query","dealLocal","getCacheKey","orgLocal","prodsLocal","ids","map","authMiddleware","ApolloLink","operation","forward","token","localStorage","getItem","setContext","_ref7","_ref7$headers","headers","Authorization","concat","client","ApolloClient","link","from","onError","_ref8","graphQLErrors","networkError","console","log","message","setItem","removeItem","resetStore","withClientState","createUploadLink","uri","theme","widths","formLabel","detailsPL","extraSidebar","colors","green","blue","error","errorBorder","getThemeColor","color","baseSet","bt","bb","bc","bl","br","bs","c","d","fs","fw","h","l","lh","mw","minw","m","mb","mt","ml","mr","o","ov","ox","oy","p","pb","pe","pos","pl","pr","pt","t","ta","to","va","w","whs","ws","z","Div","styled","inline","rest","objectWithoutProperties","react_default","a","createElement","styled_semantic_templateObject","P","esm_extends","styled_semantic_templateObject2","Span","styled_semantic_templateObject3","A","styled_semantic_templateObject4","cancel","Header","styled_semantic_templateObject5","Icon","active","activeColor","selectMode","styled_semantic_templateObject6","Caret","disabled","assign","styled_semantic_templateObject7","size","Button","menu","styled_semantic_templateObject8","Message","_ref9","section","styled_semantic_templateObject9","SectionPropFiltered","React","forwardRef","_ref10","ref","head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","onClick","undefined","Section","_templateObject10","Popup","_ref11","showIf","_templateObject11","Label","label","_templateObject12","InputPropFilter","_ref12","Ref","innerRef","Input","_templateObject13","SDropdown","_templateObject14","_ref13","Form","Field","_templateObject15","NotificationsContext","createContext","NotificationsProvider","_Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","length","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","state","messages","create","cuid","timerId","setTimeout","dismiss","setState","produce","draft","push","messageId","filter","cancelAutoDismiss","clearTimeout","inherits","createClass","key","Provider","notify","Component","NotificationsConsumer","Consumer","PureChild","memo","useNotifications","useContext","useCallback","msg","Notification","_ref$message","type","title","content","dismissNotification","styled_semantic_Message","compact","icon","header","info","success","warning","onDismiss","onMouseEnter","NotificationsHolder","div","Notifications_templateObject","PosedItem","posed","boobl","y","opacity","enter","exit","x","Notifications","reactDom","createPortal","react_pose_es","animateOnMount","preEnterPose","initialPose","document","getElementById","NotificationsViewer","notifications_NotificationsContext","highlightFolder","disk_templateObject","DiskContext","DiskProvider","react_apollo_browser_umd","mutation","orgId","dealId","variables","isTokenExpired","date","decoded","decode","exp","Date","setUTCSeconds","getTokenExpirationDate","valueOf","offsetSeconds","me","user_templateObject","meLocal","user_templateObject2","login","user_templateObject3","MenuDiv","LoginPage_templateObject","MenuHeader","LoginPage_templateObject2","SSegment","Segment","LoginPage_templateObject3","LoginPage","email","password","sendingRequest","handleInputChange","attr","defineProperty","submit","_callee","_this$state","result","regenerator_default","wrap","_context","prev","next","sent","refreshToken","t0","stop","_this2","_this$state2","react","basic","placeholder","onChange","primary","floated","loading","compose","graphql","options","fetchPolicy","Container","Menu_templateObject","components_Menu","titleLinkTo","Link","preventDefault","styled_semantic_Header","_data$me$person","person","fName","lName","menuNameTitle","slice","_ref$layout","setDetails","setExtra","setBottomPanel","setSelectedProdIds","SubmenuDiv","EnquiriesSubmenu_templateObject","context_GlobalContext","_ref$details","_data$enquiryLocal","num","addNewOrderForbidden","docs","some","styled_semantic_Popup","position","flowing","trigger","styled_semantic_Button","circular","Content","EnquiriesMenu","refetchEnquiries","enquiriesAreLoading","Enquiry_EnquiriesSubmenu","STable","table","Table_templateObject","TableHeaderRow","tr","Table_templateObject2","noTopBorder","Td","td","Table_templateObject3","TBody","tbody","Table_templateObject4","Table","fields","indent","modes","select","fieldsExtended","expand","toConsumableArray","width","className","f","tableFields","field","formatTel","number","country","conformToMask","guide","conformedValue","currency","trailing","curNum","toFixed","replace","isNaN","Number","Row","TableRow_templateObject","noRowHover","lightRowHower","lineHeight","lastSecondaryRow","bold","tdActiveStyle","TableRow_templateObject2","truncated","service","hoverable","hideUnhovered","hasEntries","Untruncated","TableRow_templateObject3","TableRow","_props$rowFields","rowFields","entity","expandFor","expanded","rowField","rf","selected","TableRow_Td","stopPropagation","component","path","iconColor","val","obj","pathArr","split","i","getObjProp","EnquiriesTable","common_Table","enquiry","org","model","orders","common_TableRow","amount","employees","drawings","styled_semantic_Icon","reduce","res","prods","order","skip","query1","query2","query3","localQuery1","localQuery2","localQuery3","localQuery","refetch","localEntity","SIcon","DetailsHeaderContainer_templateObject","SCaret","DetailsHeaderContainer_templateObject2","close","DetailsHeaderSubitle","DetailsHeaderTitle","subtitle","DetailsOld_DetailsHeaderSubitle","DetailsHeaderButtons","SButton","RefreshButton_templateObject","RefreshButton","settings","titleNew","titleExisting","Order","Model","DetailsMainHeader","closeDetails","refresh","editMode","fullnum","article","dateLocal","DetailsHeaderContainer","DetailsOld_DetailsHeaderTitle","Fragment","DetailsOld_DetailsHeaderButtons","common_RefreshButton","entity_table_templateObject","Tr","entity_table_templateObject2","entity_table_templateObject3","InputTd","entity_table_templateObject4","EditorTd","entity_table_templateObject5","DraftEditor","editorState","newContent","getCurrentContent","_this$props","setEditorHasText","setEditorDiff","setHasFocus","hasText","oriContent","getSelection","getHasFocus","kolmechKeyBindingFn","keyCode","KeyBindingUtil","hasCommandModifier","getDefaultKeyBinding","handleKeyCommand","command","onCtrlEnter","newState","RichUtils","clear","EditorState","ContentState","createFromText","exportHtml","html","stateToHTML","convertFromHTML","contentBlocks","initFromHtml","blocksFromHTML","createWithContent","createFromBlockArray","entityMap","createEmpty","Draft","keyBindingFn","readOnly","EditorWrapper","WrappedDraftEditor_templateObject","borderless","hasFocus","diff","WrappedDraftEditor","forwardedRef","common_DraftEditor","WrappedDraftEditor_WrappedDraftEditor","validateInn","inn","toString","test","code","indexOf","checkDigit","coefficients","n","parseInt","n11","n12","isValidDate","isValidDateString","dateString","parse","tz","getTimezoneOffset","toLocalISOString","getTime","toISOString","toLocalDateString","toLocalDatetimeString","fromLocalISOString","string","opTypeFragmentBasic","opType_templateObject","orgFragmentBasic","org_templateObject","orgFragmentFull","org_templateObject2","orgExecFragment","org_templateObject3","createContract","org_templateObject4","org_templateObject5","org_templateObject6","createOrg","org_templateObject7","mergeOrg","org_templateObject8","org_templateObject9","orgDetails","org_templateObject10","org_templateObject11","allOrgsAndModels","combinedQueries_templateObject","PickerDiv","DatePicker_templateObject","DatePicker","selectedDate","selectDay","inputRef","useRef","_useState","useState","_useState2","slicedToArray","setDate","_useState3","_useState4","setInput","_useState5","_useState6","err","setErr","useEffect","DayPickerInput_default","onDayChange","current","onDayPickerHide","dayPickerProps","firstDayOfWeek","month","SecondarySection","onClose","projectEntity","schema","handleObj","preparePayload","values","initialValues","handlePayloadObj","objSchema","keys","forEach","k","isArray","handleArr","endsWith","arrSchema","arr","resultArr","initialObj","handlePayloadArr","initialArr","getStructure","getSkeleton","getArrSkeleton","item","analysePath","acc","dotPos","braketPos","last","closingBraketPos","array","arrayItem","assignNested","preserveKeys","produceNested","idValidationType","matches","validationSchema","shape","notRequired","trim","min","max","when","required","formikSchema","FormikCurrency","setField","number_format_default","customInput","decimalSeparator","thousandSeparator","decimalScale","allowNegative","onValueChange","floatValue","FormikInput","formik","getIn","Dropdown","selection","fluid","search","noResultsMessage","setFieldValue","styled_semantic_Input","touched","errors","handleChange","onBlur","handleBlur","connect","countryOtions","text","inputError","FormikTel_templateObject","Error","FormikTel_templateObject2","Tel","baseName","renderDropdown","FormikTel_Dropdown","tabIndex","react_input_mask_default","mask","maskChar","inputProps","form_FormikInput","FormikTel_Error","FormikField_templateObject","FormikField_templateObject2","FormikField_templateObject3","InputContainer","FormikField_templateObject4","FormikField_templateObject5","contentBeforeField","inputLabel","FormikField_Container","FormikField_Label","formik_esm","render","arrayHelpers","FormikTel","FormikField_Error","ModelForm","didMount","toggleEditMode","refetchQueries","onSubmit","onCompleted","asyncToGenerator","mark","upserted","resetForm","abrupt","_x","_x2","handleSubmit","handleReset","FormikField","Edit_templateObject","EnquiryEdit","closeNewModelSection","newModelMode","changeFieldValue","newVal","_this$setState","fieldObj","curVal","isNewEnquiry","oriVal","includes","pickedDate","handleOrgDropdownSearchChange","searchQuery","orgDdn","handleModelDropdownSearchChange","modelDdn","handleQtyInputChange","selectOrg","selectModel","submitNewModel","modelId","componentIsMounted","_callee2","_context2","_x3","_callee3","_context3","_x4","oriEnquiry","events","qty","requiredFields","_this$props2","orgs","models","requiredIsEmpty","someFieldHasError","Edit_Dropdown","selectOnBlur","selectOnNavigation","onSearchChange","allowAdditions","additionLabel","onAddItem","Form_ModelForm","hidden","update","sort","b","unshift","LocalDatePicker_templateObject","LocalDatePicker","handleDayChange","_this$props$field","LocalDatePicker_PickerDiv","CurrencyInput","SmartForm","isNewEntity","oriEntity","formState","EnquiryCommercialOffer","isNewCO","co","common_SmartForm","_ref$formState","common_LocalDatePicker","common_CurrencyInput","Divider","fitted","EnquiryDetails_templateObject","Comments","Comment","Group","EnquiryDetails_templateObject2","CIcon","EnquiryDetails_templateObject3","UserLabel","EnquiryDetails_templateObject4","CContent","EnquiryDetails_templateObject5","CMetadata","Metadata","EnquiryDetails_templateObject6","CText","Text","EnquiryDetails_templateObject7","CMessage","EnquiryDetails_templateObject8","EnquiryDetails","editorRef","createRef","noteEditorRef","editorHasText","noteEditorDiff","noteKey","activeCO","creatingComment","changingStatus","statusPending","savingNote","enableEditMode","exitEditMode","bool","setNoteEditorDiff","cancelEdit","createComment","htmlText","changeStatus","coStatusId","enquiryQuery","statuses","s","statusId","doc","cancelPendingStatusChange","saveNote","htmlNote","coEvents","curStatus","status","pop","rawStatuses","orderStatusId","refusalStatusIds","stage","eventStatusPresentationHelpers","Edit","entity_table_Table","entity_table_Td","_ref6$doc","common_WrappedDraftEditor","labelPosition","labeled","button","Math","abs","detail","Label_Label","Enquiry_EnquiryCommercialOffer","minimal","as","dividing","_e$user$person","user","userInitials","datetimeLocal","dangerouslySetInnerHTML","__html","sanitize","reply","onSave","newEvent","fragment","readFragment","writeFragment","SmartInput","debouncedSetField","debounce","writeVal","intVal","valueAsNumber","_this$props3","OrderEdit","_ref2$formState","common_SmartInput","upsertedOrder","buttons","titleSize","OuterSection","CollapsableSection_templateObject","PosedDetailsHeader","DetailsHeader","visible","invisible","InnerSection","CollapsableSection_templateObject2","CollapsableSection","initiallyExpanded","headerInvisible","forceExpanded","overflowVisible","headerProps","mode","pose","ProdsByDept","oriProds","selectedIds","orderId","selectLimit","_ref$selectedProds","selectedProds","orderProdsQty","expandedIds","limitReached","allProds","unionBy","depts","sortBy","groupBy","dept","count","readyCount","progress","hasDefect","isSpoiled","prod","ordered","added","op","removed","sp","orderedCount","selectedCount","availCount","every","unreservedProdsCount","xor","xorBy","defaultFields","DeptProdTable","_ref$skipFields","skipFields","nameFieldWidth","IconRight","ReserveProdsButton_templateObject","ReserveProdsButton","prodIds","modelProds","prod_templateObject","prod_templateObject2","ModelProdsSection","_ref$order","Order_ReserveProdsButton","context_ProdContext","Order_ProdsByDept","Order_DeptProdTable","OrderDetails","Order_ModelProdsSection","AspectRatioDiv","Drawing_templateObject","proportion","Drawing_templateObject2","ImgSpacer","shrinked","height","fullsize","Image","img","Drawing_templateObject3","Mask","Drawing_templateObject4","hide","off","CheckBox","Drawing_templateObject5","Check","Drawing_templateObject6","SortableElement","_ref2$drawing","drawing","files","toggleSelection","sortMode","oriImage","imgFor","image","Drawing_Container","open","focus","src","SortableContainer","toggleDrawingSelection","selectedDrawings","drw","Drawing","index","SortedCollectionProvider","sortedCollection","move","oldIndex","newIndex","_draft$sortedCollecti","splice","collection","prevPropsCollection","StatefulList","list","toggle","removeMany","items","StatefulBool","enable","disable","DropzoneArea","Drawings_templateObject","DropzoneOverlay","Drawings_templateObject2","MenuOverlay","Drawings_templateObject3","MenuLeftIcon","Drawings_templateObject4","Drawings","sidebarRef","NotificationsContext_NotificationsConsumer","creating","deleting","sorting","SortedCollectionProvider_SortedCollectionProvider","moveDrawing","StatefulList_StatefulList","deselectAllDrawings","deselectManyDrawings","StatefulBool_StatefulBool","enableSortMode","disableSortMode","es","onDrop","acceptedFiles","writeData","collapsableSection","disableClick","accept","onDropRejected","getRootProps","getInputProps","openFileDialog","isDragActive","Loader","reordered","sortOrder","Sortable","onSortEnd","getContainer","Model_Details","Drawings_Drawings","Details_templateObject","Details","_ref2$details","Details_Container","DetailsOld_DetailsDataProvider","DetailsOld_DetailsMainHeader","Enquiry_EnquiryDetails","Order_OrderEdit","Order_OrderDetails","ProdTableUtils","propDepts","newList","without","difference","idsWithinLimit","take","union","ListProvider","DetailsExtra_templateObject","DetailsExtra","closeExtra","DetailsExtra_Container","context_OrderContext","ListProvider_ListProvider","toggleExpanded","Order_ProdTableUtils","SSidebar","Sidebar","DetailsSidebar_templateObject","DetailsSidebar","detailsClosing","_this$props$layout","node","animation","direction","DetailsOld_Details","DetailsOld_DetailsExtra","PanelPusher_templateObject","Main","PanelPusher_templateObject2","Panel","PanelPusher_templateObject3","panelVisible","PanelPusher","panel","panelRendered","PanelPusher_Container","telFragment","tel_templateObject","personFragmentBasic","person_templateObject","personContactsFragment","person_templateObject2","personExecFragment","person_templateObject3","persons","person_templateObject4","upsertPerson2","person_templateObject5","person_templateObject6","person_templateObject7","orgEmployees","employee_templateObject","upsertEmployee","employee_templateObject2","PanelHeader_templateObject","PanelHeader","closePanel","PanelHeader_MenuDiv","list_Tel","tel","Field_templateObject","Field_templateObject2","Field_templateObject3","list_Field","Field_Container","Field_Label","Field_Content","List","renderObj","schemaKeys","oneOf","default","lazy","transform","join","is","then","otherwise","mName","tels","of","telValidationSchema","personValidationSchema","listSchema","Employee_Details","emp","fullname","EmployeeForm","EmployeeEdit","Form_EmployeeForm","Employee_Table","emps","EmployeesPanelBody","EnquiriesBottomPanel_templateObject","EmployeesPanelTableSection","EnquiriesBottomPanel_templateObject2","EmployeeDetailsSection","EnquiriesBottomPanel_templateObject3","EnquiriesBottomPanel","activeEmp","Edit_EmployeeEdit","_draft$person","Pushable","EnquiriesPage_templateObject","EnquiriesPage","panelClosing","_this$props$allEnquir","Enquiry_EnquiriesMenu","DetailsOld_DetailsSidebar","Pusher","PanelPusher_PanelPusher","Enquiry_EnquiriesTable","alias","articleFragmentBasic","article_templateObject","articleFragmentFull","article_templateObject2","accountFragmentBasic","account_templateObject","accountFragmentFull","account_templateObject2","equipmentFragmentBasic","equipment_templateObject","equipment_templateObject2","paymentFragmentBasic","payment_templateObject","paymentsPage","payment_templateObject2","payment_templateObject3","upsertPayment","payment_templateObject4","Chart_templateObject","Chart","_data$reduce","payments","isLoan","isIncome","arrs","y0","_data$reduce2","positive","negative","total","sum","lineData","reverse","pointIndex","findIndex","Chart_Container","react_vis_es","margin","left","stackBy","tickFormat","toLocaleDateString","stack","syncWithAmoContacts","amo_templateObject","articleId","equipmentId","personId","purpose","Form_templateObject","Form_templateObject2","Fields","Form_templateObject3","labelWidth","CounterpartyFieldSwitch","payment","orgCounterparty","setOrgCounterparty","Payments_Form","reset","articles","equipment","articleOptions","rusName","bankPayment","Form_Container","personsLoading","refetchPersons","Form_Header","foundIndex","enableReinitialize","Form_CounterpartyFieldSwitch","_ref14","orgsLoading","_ref16","_ref15","created","amoName","relations","Stats_templateObject","SStatistic","Statistic","Stats_templateObject2","Stats","accounts","accountsStats","account","uniquePersons","up","debtsAndLoans","debts","Stats_Container","Value","horizontal","lastIndexOf","Payments_Table_templateObject","Payments_Table","activePayment","onClickRow","Table_Container","syncWithTochkaPayments","tochka_templateObject","Page_templateObject","TopSection","Page_templateObject2","BottomSection","Page_templateObject3","Page","setActivePayment","paymentsLoading","_ref3$data","equipments","refetchPayments","matchPath","href","Page_Container","Route","exact","dealStatusFragmentBasic","dealStatus_templateObject","dealStatusFragmentFull","dealStatus_templateObject2","execFragmentBasic","exec_templateObject","orgsAndPersonsExecs","exec_templateObject2","exec_templateObject3","taskFragmentBasic","task_templateObject","taskFragmentMiddle","task_templateObject2","taskFragmentFull","task_templateObject3","upsertTask","task_templateObject4","task_templateObject5","appointFragmentBasic","appoint_templateObject","appointFragmentMiddle","appoint_templateObject2","appoint_templateObject3","opFragmentBasic","op_templateObject","opFragmentMiddle","op_templateObject2","opFragmentDetails","op_templateObject3","op_templateObject4","procFragmentBasic","proc_templateObject","procFragmentMiddle","proc_templateObject2","procFragmentDetails","proc_templateObject3","workpieceFragmentBasic","workpiece_templateObject","workpieceFragmentWithDrawings","workpiece_templateObject2","batchFragmentBasic","batch_templateObject","batchFragmentMiddle","batch_templateObject2","batchFragmentDetails","batch_templateObject3","batchDetails","batch_templateObject4","upsertBatch","batch_templateObject5","dealFragmentBasic","deal_templateObject","dealFragmentMiddle","deal_templateObject2","dealsPage","deal_templateObject3","deal_templateObject4","dealDetails","deal_templateObject5","createComOffer","deal_templateObject6","syncDeals","deal_templateObject7","deal_templateObject8","upsertDeal","deal_templateObject9","DealsContext","DealsContextProvider","opTypes","LeftIcon","Menu_Menu_templateObject","Menu","Menu_Container","InnForm","setVal","Requisites","HtmlDatePicker_templateObject","HtmlDatePicker","HtmlDatePicker_Input","target","HtmlInput_templateObject","propValue","setValue","HtmlInput_Input","onKeyDown","TextArea","textarea","HtmlTextArea_templateObject","HtmlTextArea","Select","HtmlSelect_templateObject","form_Field_templateObject","form_Field_templateObject2","form_Field_templateObject3","Field_templateObject4","Field_templateObject5","form_Field","form_Field_Container","form_Field_Label","form_Field_Content","Field_InputContainer","HtmlTextArea_HtmlTextArea","HtmlSelect","HtmlInput","Field_Error","animated","Contract_templateObject","Contract","createMode","setCreateMode","transitions","useTransition","leave","Contract_MenuOverlay","style","OrgDetails","Menu_Menu","useQuery","errMsg","successMsg","_useQueryProto","useQueryProto","useMutation","setLoading","called","setCalled","setError","_useState7","_useState8","setData","mutate","useHookMutation","_data","_args","BatchDetails","batchProp","batch","bIndex","batchId","_useMutation","uB","_useQuery","Dimmer","_batch$model","_batch$model$drawings2","drwName","wp","workpiece","_batch$procs$","procs","_batch$procs$$ops","ops","wpName","material","hardness","wpDrwName","batchStructure","opType","opClass","description","opIndex","DealDetails","deal","batches","CreateComOfferDetails","cCO","execId","setFrom","setText","uT","opId","ListTitle","h4","SelectExecDetails_templateObject","ListItemContainer","SelectExecDetails_templateObject2","ListItem","SelectExecDetails","opTypeId","setExecId","setPersonId","sWAC","_useMutation2","syncingContacts","_useMutation3","uP","upsertPersonProto","_execId","exec","ot","SelectExecDetails_ListItem","Provider_templateObject","MainContentContainer","Provider_templateObject2","transition","ease","Provider_templateObject3","DetailsContext","DetailsProvider","Provider_Container","Provider_Sidebar","Details_OrgDetails","CreateTaskDetails_CreateComOfferDetails","_ref$batch","isNewBatch","isNew","_ref$deal","_ref$model","setEditMode","Qty_templateObject","Qty","iniQty","setQty","Qty_Input","Proc","proc","isNewProc","OpType","basePath","isNewOp","_ref$opType","DealLabour","dealLabor","MenuButton","DropdownMenu_templateObject","DropdownMenu","ExecName","appoint","isNewAppoint","_appoint$exec","_appoint$exec$person","addMode","setAddMode","FlexContainer","Appoint_templateObject","WarningItem","Item","Appoint_templateObject2","Appoint","appointIndex","isHovered","setIsHovered","onMouseLeave","DropdownMenu_DropdownMenu","Op_templateObject","Op_templateObject2","Op","_ref$basePath","appoints","isMachiningClass","startsWith","Op_FlexContainer","Op_WarningItem","Ops_templateObject","Ops","Ops_Container","Op_Op","ProcOps_templateObject","ProcOps","ProcOps_Container","Ops_Ops","BatchContainer","Batch_templateObject","Batch","uBq","upsertBatchProto","draftHandler","Batches","Org","upsertingDeal","Deal","amoId","rel","TableHeader","Deals_Table_templateObject","Deals_Table_templateObject2","DealsTable","deals","Table_Row","Deals_Menu","refetchDeals","Deals_Page","Provider_DetailsProvider","Context_DealsContextProvider","Root","bootStrapData","HashRouter","displayName","Switch","Enquiry_EnquiriesPage","Redirect","components_LoginPage","App","NotificationsContext_NotificationsProvider","styled_components_browser_esm","DiskContext_DiskProvider","components_Root","ReactDOM","ApolloContext","src_App","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.27404d2c.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n\r\n              // Execute callback\r\n              if (config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","export const AUTH_TOKEN = 'kolmech-token'\r\n","const defaults = {\r\n\tnewEnquiry: {\r\n\t\t__typename: 'Enquiry',\r\n\t\tid: 'new'\r\n\t},\r\n\tlayout: {\r\n\t\t__typename: 'Layout',\r\n\t\tdetails: null,\r\n\t\textra: null,\r\n\t\tbottomPanel: null\r\n\t},\r\n\tlists: {\r\n\t\t__typename: 'Lists',\r\n\t\tselectedProdIds: [],\r\n\t},\r\n}\r\n\r\nexport default defaults","import gql from 'graphql-tag'\r\n\r\nexport const getLayout = gql`\r\n\tquery getLayout {\r\n\t\tlayout @client {\r\n\t\t\tdetails\r\n\t\t\textra\r\n\t\t\tbottomPanel\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getLayoutOptions = ({\r\n\tprops: ({ data: { layout } }) => {\r\n\t\treturn {\r\n\t\t\tlayout: layout || {}\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport const setLayout = gql`\r\n\tmutation SetLayout($input: json) {\r\n\t\tsetLayout(input: $input) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const setExpanded = gql`\r\n\tmutation SetExpanded($args: json) {\r\n\t\tsetExpanded(args: $args) @client {\r\n\t\t\targs\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const orderFragmentBasic = gql`\r\n\tfragment OrderFragmentBasic on Order {\r\n\t\tid\r\n\t\tfullnum\r\n\t\tdateLocal\r\n\t\tqty\r\n\t\tamount\r\n\t}\r\n`\r\n\r\nexport const orderFragmentFull = gql`\r\n\tfragment OrderFragmentFull on Order {\r\n\t\t...OrderFragmentBasic\r\n\t\thtmlNote\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tprods {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n\t\t\thasDefect,\r\n\t\t\tisSpoiled,\r\n\t\t\tprogress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\n\r\nexport const upsertOrder = gql`\r\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\r\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\r\n\t\t\t...OrderFragmentBasic\r\n\t\t\tenquiry {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tprods {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\nexport const orderLocal = gql`\r\n\tquery OrderLocal ($id: ID!) {\r\n\t\torderLocal (id: $id) {\r\n\t\t\tid\r\n\t\t\tfullnum\r\n\t\t\tdateLocal\r\n\t\t\tqty\r\n\t\t\tamount\r\n\t\t}\r\n\t}\r\n`\r\nexport const orderDetails = gql`\r\n\tquery OrderDetails ($id: ID!) {\r\n\t\torder (id: $id) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`\r\nexport const reserveProds = gql`\r\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\r\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const docFragmentBasic = gql`\r\n\tfragment DocFragmentBasic on Doc {\r\n\t\tid\r\n\t\ttype\r\n\t\tdateLocal\r\n\t\tamount\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const statusFragment = gql`\r\n\tfragment StatusFragment on Status {\r\n\t\tid\r\n    name\r\n    stage\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const fileFragmentFull = gql`\r\n\tfragment FileFragmentFull on File {\r\n\t\tid\r\n\t\tpath\r\n\t\tsize\r\n\t\tfilename\r\n\t\tmimetype\r\n\t\twidth\r\n\t\theight\r\n\t\timgFor\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { fileFragmentFull } from './file'\r\n\r\nexport const drawingFragmentBasic = gql`\r\n\tfragment DrawingFragmentBasic on Drawing {\r\n\t\tid\r\n\t\tname\r\n\t\tsortOrder\r\n\t}\r\n`\r\n\r\nexport const drawingFragmentFull = gql`\r\n\tfragment DrawingFragmentFull on Drawing {\r\n\t\t...DrawingFragmentBasic\r\n\t\tfiles { ...FileFragmentFull }\r\n\t}\r\n\t${drawingFragmentBasic}\r\n\t${fileFragmentFull}\r\n`\r\n\r\nexport const createDrawings = gql`\r\n\tmutation CreateDrawings(\r\n\t\t$modelId: ID!\r\n\t\t$files: [Upload!]!\r\n\t) {\r\n\t\tcreateDrawings(\r\n\t\t\tmodelId: $modelId\r\n\t\t\tfiles: $files\r\n\t\t) {\r\n\t\t\t...DrawingFragmentFull\r\n\t\t}\r\n\t}\r\n\t${drawingFragmentFull}\r\n`\r\n\r\nexport const deleteDrawings = gql`\r\n\tmutation DeleteDrawings( $ids: [ID!]! ) {\r\n\t\tdeleteDrawings(ids: $ids) { count }\r\n\t}\r\n`\r\n\r\nexport const setDrawingsSortOrder = gql`\r\n\tmutation SetDrawingsSortOrder( $ids: [ID!]! ) {\r\n\t\tsetDrawingsSortOrder(ids: $ids) { count }\r\n\t}\r\n`\r\n","import gql from 'graphql-tag'\r\nimport { drawingFragmentBasic, drawingFragmentFull } from './drawing';\r\n\r\nexport const modelFragmentBasic = gql`\r\n\tfragment ModelFragmentBasic on Model {\r\n\t\tid\r\n\t\tname\r\n\t\tarticle\r\n\t}\r\n`\r\n\r\nexport const modelFragmentWithDrawings = gql`\r\n\tfragment ModelFragmentWithDrawings on Model {\r\n\t\t...ModelFragmentBasic\r\n\t\tdrawings { ...DrawingFragmentBasic }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${drawingFragmentBasic}\r\n`\r\n\r\nexport const modelFragmentFull = gql`\r\n\tfragment ModelFragmentFull on Model {\r\n\t\t...ModelFragmentBasic\r\n\t\tdrawings { ...DrawingFragmentFull }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${drawingFragmentFull}\r\n`\r\n\r\nexport const modelLocal = gql`\r\n\tquery ModelLocal ($id: ID!) {\r\n\t\tmodelLocal (id: $id) {\r\n\t\t\t...ModelFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${modelFragmentBasic}\r\n`\r\n\r\nexport const modelDetails = gql`\r\n\tquery ModelDetails ($id: ID!) {\r\n\t\tmodel (id: $id) {\r\n\t\t\t...ModelFragmentFull\r\n\t\t}\r\n\t}\r\n\t${modelFragmentFull}\r\n`\r\n\r\nexport const upsertModel = gql`\r\n\tmutation UpsertModel(\r\n\t\t$input: ModelInput!\r\n\t) {\r\n\t\tupsertModel(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { orderFragmentBasic } from './order'\r\nimport { docFragmentBasic } from './doc'\r\nimport { statusFragment } from './status'\r\nimport { modelFragmentWithDrawings, modelFragmentBasic } from './model';\r\n\r\nexport const enquiryFragmentBasic = gql`\r\n\tfragment EnquiryFragmentBasic on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t}\r\n`\r\n\r\nexport const allEnquiries = gql`\r\n\tquery AllEnquiries {\r\n\t\tenquiries {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\temployees {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\torders {\r\n\t\t\t\t...OrderFragmentBasic\r\n\t\t\t\tprods {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tisExpanded @client\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${orderFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryDetails = gql`\r\n\tquery EnquiryDetails ($id: ID!) {\r\n\t\tenquiry (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentBasic }\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryLocal = gql`\r\n\tquery EnquiryLocal ($id: ID!) {\r\n\t\tenquiryLocal (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n`\r\nexport const newEnquiry = gql`\r\n\tquery {\r\n\t\tnewEnquiry @client {\r\n\t\t\tid\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const createEnquiry = gql`\r\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\r\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t\torders {\r\n\t\t\t\tid\r\n\t\t\t\tfullnum\r\n\t\t\t\tdateLocal\r\n\t\t\t\tqty\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const updateEnquiry = gql`\r\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\r\n\t\tupdateEnquiry(input: $input) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${modelFragmentWithDrawings}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const createEnquiryEvent = gql`\r\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\r\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const enquiryFragment = gql`\r\n\tfragment myEnquiry on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t\thtmlNote\r\n\t\tisExpanded\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\tqty\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${modelFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const getLists = gql`\r\n\tquery getLists {\r\n\t\tlists @client {\r\n\t\t\tselectedProdIds\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getListsOptions = ({\r\n\tprops: ({ data: { lists } }) => ({\r\n    lists: lists || {}\r\n\t})\r\n})\r\n\r\nexport const setList = gql`\r\n\tmutation SetList($name: String!, $value: [ID!]) {\r\n\t\tsetList(name: $name, value: $value) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`","import { getLayout } from '../graphql/layout'\r\nimport { allEnquiries } from '../graphql/enquiry'\r\nimport { getLists } from '../graphql/lists'\r\nimport { cloneDeep } from 'apollo-utilities'\r\n\r\nconst resolvers = {\r\n\tEnquiry: {\r\n\t\tisExpanded: () => false\r\n\t},\r\n\tMutation: {\r\n\t\tsetLayout: (_, { input }, { cache }) => {\r\n\t\t\tconst query = getLayout\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.layout = {\r\n\t\t\t\t...data.layout,\r\n\t\t\t\t...cloneDeep(input)\r\n\t\t\t}\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetExpanded: (_, { args: { id: enquiryId, value } }, { cache }) => {\r\n\t\t\tconst query = allEnquiries\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tconst enquiry = data.enquiries.find(e => e.id === enquiryId)\r\n\t\t\tenquiry.isExpanded = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetList: (_, { name, value }, { cache }) => {\r\n\t\t\tconst query = getLists\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.lists[name] = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t}\r\n}\r\n\r\nexport default resolvers","import { ApolloClient } from 'apollo-client'\r\n// import { HttpLink } from 'apollo-link-http'\r\nimport { createUploadLink } from 'apollo-upload-client'\r\nimport { ApolloLink } from 'apollo-link'\r\n// import { ApolloLink, Observable, split } from 'apollo-link'\r\nimport { withClientState } from 'apollo-link-state'\r\nimport { onError } from 'apollo-link-error'\r\nimport { InMemoryCache, defaultDataIdFromObject } from 'apollo-cache-inmemory'\r\n// import { WebSocketLink } from 'apollo-link-ws'\r\nimport { AUTH_TOKEN } from '../constants'\r\n\r\nimport defaults from './defaults'\r\nimport resolvers from './resolvers'\r\n// import typeDefs from './typeDefs'\r\n\r\n// init with Apollo Client:\r\nconst cache = new InMemoryCache({\r\n\tdataIdFromObject: object => {\r\n\t\tswitch (object.__typename) {\r\n\t\t\tcase 'NewEnquiry': return 'NewEnquiry'\r\n\t\t\tdefault: return defaultDataIdFromObject(object)\r\n\t\t}\r\n\t},\r\n\tcacheRedirects: {\r\n\t\tQuery: {\r\n\t\t\tdealLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Deal', id: args.id }),\r\n\t\t\torgLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Org', id: args.id }),\r\n\t\t\tenquiryLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Enquiry', id: args.id }),\r\n\t\t\torderLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Order', id: args.id }),\r\n\t\t\tmodelLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\tgetCacheKey({ __typename: 'Model', id: args.id }),\r\n\t\t\tprodsLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\targs.ids.map(id =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Prod', id: id }))\r\n\t\t}\r\n\t}\r\n})\r\n\r\nconst authMiddleware = new ApolloLink((operation, forward) => {\r\n\tconst token = localStorage.getItem(AUTH_TOKEN) || null\r\n  operation.setContext(({ headers = {} }) => ({\r\n    headers: {\r\n      ...headers,\r\n      Authorization: token ? `Bearer ${token}` : '',\r\n    }\r\n  }))\r\n  return forward(operation)\r\n})\r\n\r\n// NOT WORKING!!! TODO find solution to redirect to Login page when token has expired\r\nconst refreshToken = (token) => {\r\n\tif (token) {\r\n\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t} else {\r\n\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\tclient.resetStore()\r\n\t}\r\n}\r\n\r\n// @ts-ignore\r\nexport const client = new ApolloClient({\r\n\tlink: ApolloLink.from([\r\n\t\tonError(({ graphQLErrors, networkError }) => {\r\n\t\t\tif (graphQLErrors) {\r\n\t\t\t\tconsole.log('graphQLErrors!!! > ', graphQLErrors)\r\n\t\t\t}\r\n\t\t\tif (networkError) {\r\n\t\t\t\tconsole.log('networkError!!! > ', networkError)\r\n\t\t\t\tconsole.log('networkError.name > ', networkError.name)\r\n\t\t\t\tconsole.log('networkError.message > ', networkError.message)\r\n\t\t\t\tconsole.log(networkError.message === 'Unexpected token I in JSON at position 0')\r\n\t\t\t\tif (networkError.message === 'Unexpected token I in JSON at position 0') refreshToken(null)\r\n\t\t\t\t// logoutUser();\r\n\t\t\t}\r\n\t\t}),\r\n\t\tauthMiddleware,\r\n\t\twithClientState({\r\n      defaults,\r\n\t\t\tresolvers,\r\n\t\t\t// typeDefs,\r\n      cache\r\n\t\t}),\r\n\t\t// new HttpLink({ uri: 'http://localhost:4000' })\r\n\t\tcreateUploadLink({\r\n\t\t\t// uri: 'http://localhost:4000',\r\n\t\t\t// uri: 'https://now-advanced.now.sh',\r\n\t\t\turi: 'https://env-1542080.mircloud.ru',\r\n\t\t})\r\n\t]),\r\n\tcache\r\n})\r\n\r\n// const httpLink = new HttpLink({ uri: 'https://now-advanced.now.sh' })\r\n\r\n// // authenticated httplink\r\n// const httpLinkAuth = middlewareAuthLink.concat(httpLink)\r\n\r\n// const wsLink = new WebSocketLink({\r\n//     uri: `ws://now-advanced.now.sh`,\r\n//     options: {\r\n//         reconnect: true,\r\n//         connectionParams: {\r\n//         Authorization: `Bearer ${localStorage.getItem(AUTH_TOKEN)}`,\r\n//         },\r\n//     },\r\n// })\r\n  \r\n// const link = split(\r\n//     // split based on operation type\r\n//     ({ query }) => {\r\n//         const { kind, operation } = getMainDefinition(query)\r\n//         return kind === 'OperationDefinition' && operation === 'subscription'\r\n//     },\r\n//     wsLink,\r\n//     httpLinkAuth,\r\n// )\r\n\r\n// const client = new ApolloClient({\r\n//     cache,\r\n//     link: ApolloLink.from([\r\n//         stateLink,\r\n//         httpLinkAuth\r\n//     ]),\r\n//     connectToDevTools: true,\r\n// })\r\n\r\n// client.cache.reset()\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\n// S prefix is used throughout the App just to have flexebility (two names for each component)\r\n// N prefix stands for NativeCssImplementation of a component (When html element is styled instead of semantic ui component) \r\n\r\nimport {\r\n    Header as SHeader,\r\n    // Label as SLabel,\r\n    Icon as SIcon,\r\n    Button as SButton,\r\n    Message as SMessage,\r\n    Popup as SPopup,\r\n    Input as SInput,\r\n    Dropdown as SDropdown,\r\n    Form as SForm,\r\n    Ref\r\n} from 'semantic-ui-react';\r\n\r\nexport const theme = {\r\n\twidths: {\r\n\t\tformLabel: '122px', //required calc(110px + 0.857143em)\r\n\t\tdetailsPL: '55px',\r\n\t\textraSidebar: '250px'\r\n\t},\r\n\tcolors: {\r\n\t\tgreen: '#016936',\r\n\t\tblue: '#0E6EB8',\r\n\t\terror: '#9f3a38',\r\n\t\terrorBorder: '#e0b4b4'\r\n\t}\r\n}\r\nconst getThemeColor = (color) => theme.colors[color] || color\r\nconst baseSet = ({ theme, bt, bb, bc, bl, br, bs, c, d, fs, fw, h, l, lh, mw, minw, m, mb, mt, ml, mr, o, ov, ox, oy, p, pb, pe, pos, pl, pr, pt, t, ta, to, va, w, whs, ws, z }) => {\r\n\treturn `\r\n\t\t${bt \t? `border-top: ${bt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bb \t? `border-bottom: ${bb};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bc \t? `background-color: ${bc};`\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bl \t? `border-left: ${bl};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${br \t? `border-right: ${br};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bs \t? `box-sizing: ${bs};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${c \t? `color: ${theme.colors && theme.colors[c] || c};`\t: ''}\r\n\t\t${d \t? `display: ${d};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fs \t? `font-size: ${fs};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fw \t? `font-weight: ${fw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${h \t? `height: ${h};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${l \t? `left: ${l};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${lh \t? `line-height: ${lh};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mw \t? `max-width: ${mw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${minw? `min-width: ${minw};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${m \t? `margin: ${m};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mb \t? `margin-bottom: ${mb};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mt \t? `margin-top: ${mt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ml \t? `margin-left: ${ml};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mr \t? `margin-right: ${mr};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${o  \t? `opacity: ${o};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ov  ? `overflow: ${ov};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ox  ? `overflow-x: ${ox};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${oy  ? `overflow-y: ${oy};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${p \t? `padding: ${p};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pb \t? `padding-bottom: ${pb};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pl \t? `padding-left: ${pl};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pe \t? `pointer-events: ${pe};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pos ? `position: ${pos};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pr \t? `padding-right: ${pr};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pt \t? `padding-top: ${pt};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${t \t? `top: ${t};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ta \t? `text-align: ${ta};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${to \t? `text-overflow: ${to};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${va \t? `vertical-align: ${va};`\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${w \t? `width: ${(theme.widths && theme.widths[w]) || w};`\t\t: ''}\r\n\t\t${whs ? `white-space: ${whs};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ws \t? `word-spacing: ${ws};`\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${z \t? `z-index: ${z};`\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t`\r\n}\r\n\r\nconst DivPropFilter = ({ ml, w, inline, ...rest }) => (\r\n\t<div {...rest} />\r\n)\r\nexport const Div = styled(DivPropFilter)`\r\n\t${props => props.inline && `display: inline-block;`}\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst PPropFilter = ({ ...rest }) => (\r\n\t<p {...rest} />\r\n)\r\nexport const P = styled(PPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst SpanPropFilter = ({ ml, ...rest }) => (\r\n\t<span {...rest} />\r\n)\r\nexport const Span = styled(SpanPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nexport const A = styled.a`\r\n\tcursor: pointer;\r\n\t${props => props.cancel && `{\r\n\t\tpadding-left: 15px;\r\n\t\tcolor: rgba(0,0,0,.87);\r\n\t\t&:hover {\r\n\t\t\tcolor: #B03060;\r\n\t\t}\r\n\t}`}\r\n`\r\n\r\nconst HeaderPropFilter = ({ inline, c, ...rest }) => (\r\n\t<SHeader {...rest} />\r\n)\r\nexport const Header = styled(HeaderPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.inline && `{\r\n\t\t\tmargin: 0;\r\n\t\t\tpadding: 0 1rem;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst IconPropFilter = ({\r\n\tactive,\r\n\tactiveColor,\r\n\tselectMode,\r\n\t...rest\r\n}) => (\r\n\t<SIcon {...rest} />\r\n)\r\nexport const Icon = styled(IconPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t${props.active && `color: ${getThemeColor(props.activeColor)} !important;`}\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst DropdownIcon = ({active, disabled, ...rest}) => (\r\n\t<SIcon {...rest}\r\n\t\tname='dropdown'\r\n\t/>\r\n)\r\nexport const Caret = styled(DropdownIcon)`\r\n\ttransform: ${\r\n\t\tprops => !props.active && (\r\n\t\t\tprops.size === 'large'\r\n\t\t\t? 'translateX(0) translateY(0) rotate(-90deg) !important'\r\n\t\t\t: 'translateX(-3px) translateY(3px) rotate(-90deg) !important'\r\n\t\t)\r\n\t};\r\n\t&&& {\r\n\t\t${props => props.disabled && `{\r\n\t\t\tcolor: rgba(0,0,0,.6);\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst ButtonPropFilter = ({ activeColor, menu, ...rest }) => (\r\n\t<SButton {...rest} />\r\n)\r\nexport const Button = styled(ButtonPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t&.compact {\r\n\t\t\tpadding: .5rem 1rem;\r\n\t\t}\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n        \t}\r\n\t\t}`}\r\n\t\t${props => props.menu && `{\r\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\r\n\t\t\tz-index: 3;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst MessagePropFilter = ({\r\n\tsection,\r\n\t...rest\r\n}) => (\r\n\t<SMessage {...rest} />\r\n)\r\nexport const Message = styled(MessagePropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.section && `\r\n\t\t\tmargin-top: 0;\r\n\t\t\tpadding-left: ${props.theme.widths.detailsPL};\r\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\r\n\t\t\tborder-radius: 0;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nconst SectionPropFiltered = React.forwardRef(({\r\n\thead,\r\n\tminor,\r\n\tsmall,\r\n\tsecondary,\r\n\tnoP,\r\n\tnoLP,\r\n\tnoIndent,\r\n\ttopBorder,\r\n\tbottomBorder,\r\n\tchildren,\r\n\tonClick,\r\n\t...rest\r\n}, ref) => (\r\n\t\t<div\r\n\t\t\tref={ref}\r\n\t\t\t{...rest}\r\n\t\t\tonClick={onClick || undefined}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</div>\r\n))\r\nexport const Section = styled(SectionPropFiltered)`\r\n\twidth: 100%;\r\n\tpadding: 1em 1em 1em 55px;\r\n\t${props => baseSet(props)}\r\n\t${props => props.head && `{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding-top: 0;\r\n\t\tpadding-bottom: 0;\r\n\t}`}\r\n\t${props => props.onClick && `{\r\n\t\tcursor: pointer;\r\n\t}`}\r\n\t${props => props.minor && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => !props.size && props.head && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => props.size === 'small' && `{\r\n\t\tmin-height: 2.5em;\r\n\t}`}\r\n\t${props => props.secondary && `{\r\n\t\tbackground: #f3f4f5;\r\n\t\tcolor: rgba(0,0,0,.6);\r\n\t}`}\r\n\t${props => props.noLP && `{\r\n\t\tpadding-left: 0;\r\n\t}`}\r\n\t${props => props.noIndent && `{\r\n\t\tpadding-left: 1em;\r\n\t}`}\r\n\t${props => props.topBorder && `{\r\n\t\tborder-top: 1px solid ${props.topBorder === 'dark' ? 'rgba(152, 153, 154, 1)' : 'rgba(34,36,38,.15)'};\r\n\t}`}\r\n\t${props => props.bottomBorder && `{\r\n\t\tborder-bottom: 1px solid ${props.bottomBorder === 'dark' ? 'rgba(126, 127, 129, 1)' : 'rgba(34,36,38,.1)'};\r\n\t}`}\r\n`\r\n\r\nconst PopupPropFilter = ({ showIf, ...rest }) => (\r\n\t<SPopup {...rest} />\r\n)\r\nexport const Popup = styled(PopupPropFilter)`\r\n\t&&& {\r\n\t\t${props => !props.showIf && `{\r\n\t\t\topacity: 0;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nexport const Label = styled.label`\r\n\t${props => baseSet(props)}\r\n\twidth: ${props => props.theme.widths.formLabel} !important;\r\n\tmargin-right: 0 !important;\r\n`\r\n\r\nconst InputPropFilter = React.forwardRef(({ w, ...rest }, ref) => (\r\n\t<Ref innerRef={ref}>\r\n\t\t<SInput {...rest} />\r\n\t</Ref>\r\n))\r\nexport const Input = styled(InputPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nexport const Dropdown = styled(SDropdown)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nconst FormFieldPropFilter = ({ w, ...rest }) => (\r\n\t<SForm.Field {...rest} />\r\n)\r\nexport const FormField = styled(FormFieldPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`","import React, { Component, useContext, useMemom, useCallback } from 'react'\r\nimport produce from 'immer'\r\nimport cuid from 'cuid'\r\n\r\nconst NotificationsContext = React.createContext()\r\nexport default NotificationsContext\r\n\r\nexport class NotificationsProvider extends Component {\r\n  state = {\r\n    messages: []\r\n  }\r\n  create = message => {\r\n    message.id = cuid()\r\n    // notification will auto dismiss\r\n    message.timerId = setTimeout(() => {\r\n      this.dismiss(message.id)\r\n    }, 5000)\r\n    this.setState(produce(draft => {\r\n      draft.messages.push(message)\r\n    }))\r\n  }\r\n  dismiss = messageId => this.setState(produce(draft => {\r\n    draft.messages = draft.messages.filter(m => m.id !== messageId)\r\n  }))\r\n  cancelAutoDismiss = messageId => this.setState(produce(draft => {\r\n    const message = draft.messages.find(m => m.id === messageId)\r\n    clearTimeout(message.timerId)\r\n    delete message.timerId\r\n  }))\r\n  render() {\r\n    return (\r\n      <NotificationsContext.Provider\r\n        value={{\r\n          state: this.state,\r\n          notify: this.create,\r\n          dismiss: this.dismiss,\r\n          cancelAutoDismiss: this.cancelAutoDismiss\r\n        }}\r\n      >\r\n        {this.props.children}\r\n      </NotificationsContext.Provider>\r\n    )\r\n  }\r\n}\r\n\r\nexport const NotificationsConsumer = ({ children }) => (\r\n  <NotificationsContext.Consumer>\r\n    {({ notify }) =>\r\n      <PureChild notify={notify} >\r\n        {children}\r\n      </PureChild>\r\n    }\r\n  </NotificationsContext.Consumer>\r\n)\r\n\r\nconst PureChild = React.memo(({ notify, children }) => children({ notify }))\r\n\r\nexport const useNotifications = () => {\r\n  const { notify } = useContext(NotificationsContext)\r\n  return {\r\n    // notify: useMemo(notify, [])\r\n    notify: useCallback((msg) => notify(msg), [])\r\n  }\r\n}\r\n\r\n","import React from 'react'\r\nimport { Message } from '../styled/styled-semantic'\r\n\r\nexport default ({\r\n\tmessage: { id, type, title, content, timerId },\r\n\tdismissNotification,\r\n\tcancelAutoDismiss\r\n}) => {\r\n  return (\r\n\t\t<Message\r\n\t\t\tm='0 0 2rem 2rem'\r\n\t\t\tw='unset'\r\n\t\t\tmw='550px'\r\n\t\t\tpr='4em'\r\n\t\t\tpe='all'\r\n\t\t\tcompact\r\n\t\t\tsize='large'\r\n\t\t\ticon={\r\n\t\t\t\ttype === 'error' ? 'exclamation' :\r\n\t\t\t\ttype === 'warning' ? 'info' :\r\n\t\t\t\ttype === 'success' ? 'check' :\r\n\t\t\t\tundefined\r\n\t\t\t}\r\n\t\t\theader={title}\r\n\t\t\tcontent={content}\r\n\t\t\terror={type === 'error'}\r\n\t\t\tinfo={type === 'info'}\r\n\t\t\tsuccess={type === 'success'}\r\n\t\t\twarning={type === 'warning'}\r\n\t\t\tonDismiss={timerId ? undefined : (() => dismissNotification(id))}\r\n\t\t\tonMouseEnter={timerId ? (() => cancelAutoDismiss(id)) : undefined}\r\n\t\t/>\r\n\t)\r\n}","import React from \"react\"\r\nimport reactDom from 'react-dom'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport Notification from \"./Notification\"\r\n\r\nconst NotificationsHolder = styled.div`\r\n\tposition: fixed;\r\n  bottom: 0;\r\n\ttop: 0;\r\n\tleft: 0;\r\n  width: 100%;\r\n\theight: 100%;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: flex-end;\r\n\tpointer-events: none;\r\n  z-index: 1;\r\n`\r\n\r\nconst PosedItem = posed.div({\r\n  boobl: {\r\n\t\ty: 200,\r\n\t\topacity: 0,\r\n\t},\r\n  enter: {\r\n\t\ty: 0,\r\n\t\topacity: 1,\r\n\t},\r\n\texit: {\r\n\t\tx: -400,\r\n\t\topacity: 0,\r\n\t},\r\n})\r\n\r\nexport default ({\r\n\tmessages,\r\n\tdismissNotification,\r\n\tcancelAutoDismiss\r\n}) => {\r\n\t// this Portal is never unmounted\r\n  return reactDom.createPortal(\r\n\t\t<NotificationsHolder>\r\n\t\t\t<PoseGroup\r\n\t\t\t\tanimateOnMount\r\n\t\t\t\tpreEnterPose='boobl'\r\n\t\t\t>\r\n\t\t\t\t{messages.map(m =>\r\n\t\t\t\t\t<PosedItem\r\n\t\t\t\t\t\tkey={m.id}\r\n\t\t\t\t\t\tinitialPose=\"boobl\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Notification\r\n\t\t\t\t\t\t\tmessage={m}\r\n\t\t\t\t\t\t\tdismissNotification={dismissNotification}\r\n\t\t\t\t\t\t\tcancelAutoDismiss={cancelAutoDismiss}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</PosedItem>\r\n\t\t\t\t)}\r\n\t\t\t</PoseGroup>\r\n\t\t</NotificationsHolder>,\r\n\t\tdocument.getElementById('kolmech-notifications')\r\n\t)\r\n}","import React from 'react'\r\n\r\nimport NotificationsContext from './NotificationsContext'\r\nimport Notifications from './Notifications'\r\n\r\nexport default () => {\r\n  return (\r\n\t\t<NotificationsContext.Consumer>\r\n\t\t\t{({\r\n\t\t\t\tstate: { messages },\r\n\t\t\t\tdismiss,\r\n\t\t\t\tcancelAutoDismiss,\r\n\t\t\t}) =>\r\n\t\t\t\t<Notifications\r\n\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\tdismissNotification={dismiss}\r\n\t\t\t\t\tcancelAutoDismiss={cancelAutoDismiss}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</NotificationsContext.Consumer>\r\n\t)\r\n}","import gql from 'graphql-tag'\r\n\r\nexport const highlightFolder = gql`\r\n\tmutation highlightFolder ($orgId: ID, $dealId: ID) {\r\n\t\thighlightFolder (orgId: $orgId, dealId: $dealId) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n","import React from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { highlightFolder } from '../../graphql/disk'\r\n\r\nconst DiskContext = React.createContext()\r\nexport default DiskContext\r\n\r\nexport const DiskProvider = ({\r\n  children\r\n}) => {\r\n  return (\r\n    <Mutation\r\n      mutation={highlightFolder}\r\n    >\r\n      {(highlightFolder) =>\r\n        <DiskContext.Provider\r\n          value={{\r\n            highlightFolder: ({ orgId, dealId }) => highlightFolder({\r\n              variables: { orgId, dealId }\r\n            })\r\n          }}\r\n        >\r\n          {children}\r\n        </DiskContext.Provider>\r\n      }\r\n    </Mutation>\r\n  )\r\n}","import decode from 'jwt-decode'\r\n\r\nexport function getTokenExpirationDate(token) {\r\n  const decoded = decode(token)\r\n  if (!decoded.exp) {\r\n    return null\r\n  }\r\n  const date = new Date(0) // The 0 here is the key, which sets the date to the epoch\r\n  date.setUTCSeconds(decoded.exp)\r\n  return date\r\n}\r\n\r\nexport function isTokenExpired(token) {\r\n  const date = getTokenExpirationDate(token)\r\n  const offsetSeconds = 0\r\n  if (date === null) {\r\n    return false\r\n  }\r\n  return !(date.valueOf() > new Date().valueOf() + offsetSeconds * 1000)\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const me = gql`\r\n\tquery Me {\r\n\t\tme {\r\n\t\t\tid\r\n\t\t\temail\r\n\t\t\tperson {\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const meLocal = gql`\r\n\tquery MeLocal {\r\n\t\tme @client {\r\n\t\t\tperson {\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const login = gql`\r\n\tmutation Login($email: String!, $password: String!) {\r\n\t\tlogin(email: $email, password: $password) {\r\n\t\t\ttoken\r\n\t\t}\r\n\t}\r\n`","import React, { Component, Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Header, Form, Message, Button, Segment } from 'semantic-ui-react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { login } from '../graphql/user'\r\n\r\nconst MenuDiv = styled.div`\r\n\tborder-bottom: 1px solid #7e7e81;\r\n\t// height: 35px;\r\n`\r\n\r\nconst MenuHeader = styled(Header)`\r\n\tdisplay: inline;\r\n\tpadding: 0 1rem !important;\r\n`\r\n\r\nconst SSegment = styled(Segment)`\r\n\tmax-width: 350px !important;\r\n\tmargin: auto !important;\r\n`\r\n\r\nclass LoginPage extends Component {\r\n\tstate = {\r\n\t\temail: '',\r\n\t\tpassword: '',\r\n\t\tsendingRequest: false,\r\n\t\terror: ''\r\n\t}\r\n\thandleInputChange = (attr) => {\r\n\t\tthis.setState({ [attr]: this[attr].value })\r\n\t}\r\n\tsubmit = async () => {\r\n\t\ttry {\r\n\t\t\tconst { email, password } = this.state\r\n\t\t\tthis.setState({ sendingRequest: true })\r\n\t\t\tconst result = await this.props.login({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\temail,\r\n\t\t\t\t\tpassword\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconst token = result.data.login.token\r\n\t\t\tthis.setState({ sendingRequest: false })\r\n\t\t\tthis.props.refreshToken(token)\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({ error: err.message, sendingRequest: false })\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { email, password, sendingRequest, error } = this.state\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<MenuHeader size='large'>\r\n\t\t\t\t\t\t<i>Колмех</i>\r\n\t\t\t\t\t</MenuHeader>\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t\t<SSegment basic>\r\n\t\t\t\t\t<Form error={!!error}>\r\n\t\t\t\t\t\t<Form.Field>\r\n\t\t\t\t\t\t\t<label>E-mail</label>\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\ttype=\"email\" \r\n\t\t\t\t\t\t\t\tplaceholder='E-mail'\r\n\t\t\t\t\t\t\t\tref={ref => this.email = ref} \r\n\t\t\t\t\t\t\t\tonChange={() => this.handleInputChange('email')} />\r\n\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t<Form.Field>\r\n\t\t\t\t\t\t\t<label>Пароль</label>\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\ttype=\"password\" \r\n\t\t\t\t\t\t\t\tplaceholder='Пароль'\r\n\t\t\t\t\t\t\t\tref={ref => this.password = ref} \r\n\t\t\t\t\t\t\t\tonChange={() => this.handleInputChange('password')} />\r\n\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\theader='Войти не удалось..'\r\n\t\t\t\t\t\t\tcontent={error} />\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\t\tfloated='right'\r\n\t\t\t\t\t\t\tdisabled={!email || !password || sendingRequest}\r\n\t\t\t\t\t\t\tloading={sendingRequest}\r\n\t\t\t\t\t\t\tonClick={this.submit} >\r\n\t\t\t\t\t\t\tВойти\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</SSegment>\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(login, {\r\n\t\tname: 'login',\r\n\t\toptions: {\r\n\t\t\tfetchPolicy: 'no-cache'\r\n\t\t}\r\n\t})\r\n)(LoginPage)","import React from 'react'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Header } from './styled/styled-semantic'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { meLocal } from '../graphql/user'\r\n\r\nconst Container = styled.div`\r\n  height: 36px;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n`\r\n\r\nexport default ({\r\n  children,\r\n  title,\r\n  titleLinkTo,\r\n\trefreshToken\r\n}) => {\r\n\treturn (\r\n    <Container>\r\n      <Link\r\n        to={titleLinkTo || ''}\r\n        onClick={titleLinkTo\r\n          ? undefined\r\n          : e => e.preventDefault()\r\n        }\r\n      >\r\n        <Header inline\r\n          size='medium'\r\n          content={title}\r\n        />\r\n      </Link>\r\n      {children}\r\n      <Query query={meLocal}>\r\n        { ({ data }) => {\r\n          if (data && data.me) {\r\n            const { fName, lName } = data.me.person\r\n            const menuNameTitle = fName + ' ' + (lName ? `${lName.slice(0,1)}.` : '')\r\n            return (\r\n              <Header inline\r\n                ml='auto'\r\n                size='small'\r\n                content={menuNameTitle} \r\n              />\r\n          )} else return null\r\n        }}\r\n      </Query>\r\n      <Icon link\r\n        name='log out'\r\n        size='large'\r\n        onClick={() => refreshToken(null)} \r\n      />\r\n    </Container>\r\n\t)\r\n}\r\n","import { compose, graphql } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout, setExpanded } from '../../graphql/layout'\r\nimport { getLists, getListsOptions, setList } from '../../graphql/lists'\r\n\r\n// const GlobalContext = React.createContext()\r\n\r\n// class GlobalContextProvider extends Component {\r\n// \t// setDetails = (details) => {\r\n// \t// \tthis.props.setLayout({variables: { details }})\r\n// \t// }\r\n// \trender() {\r\n// \t\tconst { children, getLayout: { details }, setLayout } = this.props\r\n// \t\treturn (\r\n// \t\t\t<GlobalContext.Provider \r\n// \t\t\t\tvalue={{\r\n// \t\t\t\t\tdetails,\r\n// \t\t\t\t\tsetDetails: (details) => setLayout({variables: { details }})\r\n// \t\t\t\t}}\r\n// \t\t\t>\r\n// \t\t\t\t{children}\r\n// \t\t\t</GlobalContext.Provider>\r\n// \t\t)\r\n// \t}\r\n// }\r\n\r\nconst GlobalContext = ({\r\n\t\tchildren,\r\n\t\tlayout: { details, extra, bottomPanel },\r\n\t\tsetLayout,\r\n\t\tsetExpanded,\r\n\t\tlists: { selectedProdIds },\r\n\t\tsetList\r\n}) => {\r\n\t// setLayout({ variables: { \r\n\t// \tdetails: {\"type\":\"Order\",\"id\":\"cjmzkpstb00170983jkb7bcbq\"},\r\n\t// \textra: {\"type\":\"Store\",\"modelId\":\"cjcfy68q55d3x0149fcpq7l63\",\"orderId\":\"cjmzkpstb00170983jkb7bcbq\"}\r\n\t// } })\r\n  return children({\r\n\t\tdetails,\r\n\t\textra,\r\n\t\tbottomPanel,\r\n\t\tsetDetails: (details) => setLayout({ variables: { input: { details, extra: null } }}),\r\n\t\tsetExtra: (extra) => setLayout({ variables: { input: { extra } } }),\r\n\t\tsetBottomPanel: (bottomPanel) => setLayout({ variables: { input: { bottomPanel } } }),\r\n\t\tsetExpanded: (args) => setExpanded({variables: { args }}),\r\n\t\tselectedProdIds,\r\n\t\tsetSelectedProdIds: (value) => \r\n\t\t\tsetList({variables: { name: 'selectedProdIds', value }}),\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(setExpanded, { name: 'setExpanded' }),\r\n\tgraphql(getLists, getListsOptions),\r\n\tgraphql(setList, { name: 'setList' }),\r\n)(GlobalContext)\r\n\t\r\n// export default GlobalContextProvider\r\n// export const GlobalContextConsumer = GlobalContext.Consumer","import React from 'react'\r\n\r\nimport { Icon, Popup as SPopup } from 'semantic-ui-react'\r\nimport { Div, Header, Button, Popup } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../../graphql/layout'\r\nimport { enquiryLocal } from '../../graphql/enquiry'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst SubmenuDiv = styled.div`\r\n\talign-self: stretch;\r\n\tposition: relative;\r\n\tmargin-left: 10px;\r\n\tpadding: 0 1em;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground-color: #f5f6f7;\r\n\tborder-top-right-radius: .35rem;\r\n\tborder-bottom-right-radius: .35rem;\r\n\t::before {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tleft: 0;\r\n\t\tbackground-color: #fff;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\r\n\t}\r\n\t/* ::after {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tright: 0;\r\n\t\tbackground-color: #f3f4f5;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\r\n\t} */\r\n`\r\n\r\n// const EnquiriesSubmenu = ({ item, addNewOrder, setLayout, layout: { details } }) => {\r\nconst EnquiriesSubmenu = () => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId }, setDetails }) => (\r\n\t\t\t\t<Query \r\n\t\t\t\t\tquery={enquiryLocal}\r\n\t\t\t\t\tvariables={{ \r\n\t\t\t\t\t\tid: type === 'Enquiry' \r\n\t\t\t\t\t\t\t? id\r\n\t\t\t\t\t\t\t: enquiryId\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\tif (data && data.enquiryLocal) {\r\n\t\t\t\t\t\t\tconst { num, docs } = data.enquiryLocal\r\n\t\t\t\t\t\t\tconst addNewOrderForbidden = !docs.some(d => d.type === 'CO')\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<SubmenuDiv>\r\n\t\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\t\tc='rgba(0,0,0,.68)'\r\n\t\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\t\tcontent={`Заявка №${num}`}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Popup \r\n\t\t\t\t\t\t\t\t\t\tposition='bottom left'\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tflowing\r\n\t\t\t\t\t\t\t\t\t\tshowIf={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\ttrigger={\r\n\t\t\t\t\t\t\t\t\t\t\t<Div inline>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent='Заказ'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === 'new'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'new',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tenquiryId: id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Header content='Не все условия выполнены' />\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon name='cancel' color='red' />\r\n\t\t\t\t\t\t\t\t\t\t\tВыставлено КП\r\n\t\t\t\t\t\t\t\t\t\t</SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t\t\t\t</SubmenuDiv>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t} else return null\r\n\t\t\t\t\t}}\r\n\t\t\t\t</Query>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(getLayout, getLayoutOptions),\r\n)(EnquiriesSubmenu)\r\n","import React from 'react'\r\n\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport Menu from '../Menu'\r\nimport EnquiriesSubmenu from './EnquiriesSubmenu'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst EnquiriesMenu = ({\r\n\trefetchEnquiries,\r\n\tenquiriesAreLoading,\r\n\trefreshToken\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details, setDetails }) => (\r\n\t\t\t\t<Menu\r\n\t\t\t\t\ttitle='Заявки и заказы'\r\n\t\t\t\t\trefreshToken={refreshToken}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tw='118.5px'\r\n\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\tta='left'\r\n\t\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\t\tonClick={refetchEnquiries}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\t\tcolor={enquiriesAreLoading ? 'blue' : undefined} \r\n\t\t\t\t\t\t\tloading={enquiriesAreLoading}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{enquiriesAreLoading ? 'Загрузка' : 'Обновить'}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\tcontent='Заявка'\r\n\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t&& details.id === 'new'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonClick={() => setDetails({type: 'Enquiry', id: 'new'})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{details && (\r\n\t\t\t\t\t\t(details.type === 'Enquiry' && details.id !== 'new')\r\n\t\t\t\t\t\t|| (details.type === 'Order' && details.id === 'new')\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\t\t<EnquiriesSubmenu />\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesMenu\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst STable = styled.table`\r\n\ttable-layout: fixed;\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n\t/* TODO Make this table with scrollable tbody (Not trivial css trick) */\r\n\t/* thead, tbody, tr {\r\n\t\tdisplay: block;\r\n\t} */\r\n`\r\n\r\nconst TableHeaderRow = styled.tr`\r\n\tcolor: rgba(0,0,0,.8);\r\n\tline-height: 1.5em;\r\n\tbackground: rgb(233, 234, 235);\r\n\tborder-top: 1px solid #d4d4d5;\r\n\t/* ${props => props.noTopBorder ? '' : 'border-top: 1px solid #d4d4d5;'} */\r\n\tborder-bottom: 1px solid #d4d4d5;\r\n\tfont-weight: bold;\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\t// @ts-ignore\r\n\t${props => props.w && `width: ${props.w};`}\r\n`\r\n\r\nconst TBody = styled.tbody`\r\n\t/* overflow-y: auto;\r\n  overflow-x: hidden; */\r\n`\r\n\r\nconst Table = ({\r\n\tchildren,\r\n\tfields,\r\n\tindent,\r\n\tnoTopBorder,\r\n\tselect,\r\n\texpand\r\n}) => {\r\n\tconst modes =  {\r\n\t\tindent: !!indent,\r\n\t\tselect: !!select,\r\n\t\texpand: !!expand,\r\n\t}\r\n\tconst fieldsExtended = [\r\n\t\t...modes['indent'] ? [{\r\n\t\t\tname: 'indent',\r\n\t\t\twidth: indent\r\n\t\t}] : [],\r\n\t\t{\r\n\t\t\tname: 'service',\r\n\t\t\twidth: '28px'\r\n\t\t},\r\n\t\t...modes['select'] ? [{\r\n\t\t\tname: 'select',\r\n\t\t\twidth: '28px'\r\n\t\t}]: [],\r\n\t\t...fields,\r\n\t\t// lastField is needed to take remaining width in fixed table-layout\r\n\t\t{ name: 'lastField' }\r\n\t]\r\n\treturn (\r\n\t\t<STable>\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<TableHeaderRow\r\n\t\t\t\t\t\tclassName='fz-tableHeaderRow'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{fieldsExtended.map(f =>{\r\n\t\t\t\t\t\t\t// console.log(f)\r\n\t\t\t\t\t\t\treturn <Td\r\n\t\t\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\tw={f.width}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{f.title}\r\n\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</TableHeaderRow>\r\n\t\t\t\t</thead>\r\n\t\t\t<TBody>\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t{children({\r\n\t\t\t\t\t\ttableFields: fieldsExtended.map(f => {\r\n\t\t\t\t\t\t\tconst field = { ...f }\r\n\t\t\t\t\t\t\tdelete field.width\r\n\t\t\t\t\t\t\tdelete field.title\r\n\t\t\t\t\t\t\treturn field\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t})}\r\n\t\t\t\t</Fragment>\r\n\t\t\t</TBody>\r\n\t\t</STable>\r\n\t)\r\n}\r\n\r\nexport default Table","import { conformToMask } from 'react-text-mask'\r\n\r\nexport const formatTel = ({ number, country }) => {\r\n\treturn country === 'rus'\r\n\t\t? '+7 ' + conformToMask(\r\n\t\t\t\tnumber,\r\n\t\t\t\t['(', /\\d/, /\\d/, /\\d/, ')', ' ', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, '-', /\\d/, /\\d/],\r\n\t\t\t\t{guide: false}\r\n\t\t\t).conformedValue\r\n\t\t: '+ ' + number\r\n}\r\n\r\nexport const currency = (num, trailing) => {\r\n\tlet curNum = (num).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$& ').replace(/\\./, ',')\r\n\tif (!trailing) curNum = curNum.slice(0,-3)\r\n\treturn curNum + ' ₽'\r\n}\r\nexport const isNaN = Number.isNaN || function(value) {\r\n\treturn value !== value;\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Caret } from '../styled/styled-semantic'\r\n\r\nimport { getObjProp } from '../../utils/object'\r\nimport { currency } from '../../utils/format'\r\n\r\nconst Row = styled.tr`\r\n\tvertical-align: unset;\r\n\tfont-size: 1rem;\r\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t${props => !props.noRowHover && `\r\n\t\t:hover {\r\n\t\t\tbackground: ${props.lightRowHower\r\n\t\t\t\t? 'rgb(250, 250, 250)'\r\n\t\t\t\t: 'rgb(242, 242, 242)'};\r\n\t\t\tcolor: rgba(0,0,0,.95);\r\n\t\t}\r\n\t`}\r\n\t${props => !!props.onClick && `cursor: pointer;`}\r\n\t${props => props.lineHeight && `\r\n\t\tline-height: ${props.lineHeight};\r\n\t`}\r\n\t${props => props.secondary && `\r\n\t\tbackground: rgba(0,0,50,.02);\r\n\t\t${!props.lastSecondaryRow ? 'border-bottom: none;' : ''}\r\n\t`}\r\n\t${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\r\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t`}\r\n\t${props => props.bold && `\r\n\t\tfont-weight: bold;\r\n\t`}\r\n`\r\n\r\nconst tdActiveStyle = `\r\n\tbackground: rgba(0,0,0,.12);\r\n\topacity: 1 !important;\r\n\t.icon {\r\n\t\topacity: 1 !important;\r\n\t}\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\twhite-space: nowrap;\r\n\ttext-overflow: ellipsis;\r\n\t${props => !!props.onClick && `cursor: pointer;`}\r\n\t/* ${props => !props.truncated && `overflow: hidden;`} */\r\n\t${props => props.service && `padding-left: 3px;`}\r\n\t${Row}:not(:hover) & {\r\n\t\t${props => props.hoverable\r\n\t\t\t&& props.hideUnhovered\r\n\t\t\t&& !props.active\r\n\t\t\t&& !props.hasEntries && `\r\n\t\t\topacity: 0 !important;\r\n\t\t`}\r\n\t}\r\n\t${props => props.color && `color: ${props.color};`}\r\n\t${props => props.truncated && `position: relative`}\r\n\t${props => props.hoverable && `\r\n\t\ttransition: background .3s ease;\r\n\t\t${props.hideUnhovered && `\r\n\t\t\topacity: 0.8;\r\n\t\t\tpadding-left: ${props.hasEntries ? '5px' : '7.5px'};\r\n\t\t`};\r\n\t\t:hover {\r\n\t\t\t${tdActiveStyle}\r\n\t\t}\r\n\t\t${props.active ? tdActiveStyle : ''}\r\n\t`}\r\n`\r\n\r\nconst Untruncated = styled.div`\r\n\ttext-overflow: ellipsis;\r\n\toverflow: hidden;\r\n\tbox-sizing: content-box;\r\n\t/*\r\n\t// horizontal overlay\r\n\t:hover {\r\n\t\twidth: max-content;\r\n\t\toverflow: unset;\r\n\t\tbackground-color: white;\r\n\t} */\r\n\t/* vertical overlay */\r\n\t:hover {\r\n\t\tposition: absolute;\r\n\t\ttop: 1px;\r\n\t\tleft: -4px;\r\n\t\twidth: 100%;\r\n\t\tz-index: 1;\r\n\t\toverflow: unset;\r\n\t\twhite-space: normal;\r\n\t\tbackground-color: white;\r\n\t\tborder: 5px solid rgb(242,242,242);\r\n    border-top: none;\r\n\t}\r\n`\r\n\r\nconst TableRow = props => {\r\n\tconst {\r\n\t\ttableFields,\r\n\t\trowFields = [],\r\n\t\tentity,\r\n\t\texpandFor,\r\n\t\texpanded,\r\n\t\texpand,\r\n\t\tselect,\r\n\t\t...rest \r\n\t} = props\r\n\t// const [isRowHovered, setIsRowHovered] = useState(false)\r\n\t// rowFields are merged into tableFields\r\n\tconst fields = tableFields.map(f => {\r\n\t\tconst rowField = rowFields.find(rf => rf.name === f.name)\r\n\t\treturn rowField ? { ...f, ...rowField } : f\r\n\t})\r\n\tconst { selected, disabled } = entity\r\n\treturn (\r\n\t\t<Row\r\n\t\t\t{...rest}\r\n\t\t\t// onMouseEnter={() => setIsRowHovered(true)}\r\n\t\t\t// onMouseLeave={() => setIsRowHovered(false)}\r\n\t\t>\r\n\t\t\t{fields.map(f => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'service'\r\n\t\t\t\t\t&& typeof expanded !== 'undefined'\r\n\t\t\t\t\t&& entity[expandFor].length\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\texpand()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Caret\r\n\t\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'select'\r\n\t\t\t\t\t&& typeof select !== 'undefined'\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\tselect()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\tselected === 'partly' ? 'square' :\r\n\t\t\t\t\t\t\t\tselected \r\n\t\t\t\t\t\t\t\t\t? 'check square outline'\r\n\t\t\t\t\t\t\t\t\t: 'square outline'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcomponent,\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tpath,\r\n\t\t\t\t\ticon,\r\n\t\t\t\t\ticonColor,\r\n\t\t\t\t\tonClick,\r\n\t\t\t\t\t...rest\r\n\t\t\t\t} = f\r\n\t\t\t\tif (component || content) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Td\r\n\t\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t!!onClick\r\n\t\t\t\t\t\t\t\t? e => {\r\n\t\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\t\tonClick()\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{/* {component && React.cloneElement(component, { isRowHovered })} */}\r\n\t\t\t\t\t\t\t{component && component}\r\n\t\t\t\t\t\t\t{content ? content : null}\r\n\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t\tlet val = value || (path ? getObjProp(entity, path) : null)\r\n\t\t\t\tif (val && name === 'amount') val = currency(val)\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t!!onClick\r\n\t\t\t\t\t\t\t? e => {\r\n\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\tonClick()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{val && icon &&\r\n\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\tlink={!!onClick}\r\n\t\t\t\t\t\t\t\tname={icon}\r\n\t\t\t\t\t\t\t\tcolor={iconColor || undefined}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{f.truncated\r\n\t\t\t\t\t\t\t? <Untruncated>\r\n\t\t\t\t\t\t\t\t\t{val}\r\n\t\t\t\t\t\t\t\t</Untruncated>\r\n\t\t\t\t\t\t\t: val\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</Row>\r\n\t)\r\n}\r\n\r\nexport default TableRow","export const getObjProp = function(obj, path){\r\n  const pathArr = path.split('.')\r\n  for (let i=0; i<pathArr.length; i++){\r\n      obj = obj[pathArr[i]]\r\n      if (!obj) return undefined\r\n  }\r\n  return obj\r\n}","import React, { Fragment } from 'react'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\n\r\nconst fields = [{\r\n\tname: 'num',\r\n\tpath: 'num',\r\n\ttitle: '№',\r\n\twidth: '45px'\r\n},{\r\n\tname: 'date',\r\n\tpath: 'dateLocal',\r\n\ttitle: 'Дата',\r\n\twidth: '110px'\r\n},{\r\n\tname: 'org',\r\n\tpath: 'org.name',\r\n\ttitle: 'Организация',\r\n\twidth: '225px',\r\n  truncated: true\r\n},{\r\n\tname: 'emps',\r\n\tpath: 'org.name',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'model',\r\n\tpath: 'model.name',\r\n\ttitle: 'Изделие',\r\n\twidth: '250px'\r\n},{\r\n\tname: 'qty',\r\n\tpath: 'qty',\r\n\ttitle: 'Кол.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'reserved',\r\n\ttitle: 'Рез.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'amount',\r\n\ttitle: 'Сумма',\r\n\twidth: '105px'\r\n},{\r\n\tname: 'status',\r\n\tpath: 'status.name',\r\n\ttitle: 'Статус',\r\n\twidth: '130px'\r\n}]\r\n\r\nconst EnquiriesTable = ({ enquiries }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details,extra, setDetails, bottomPanel, setBottomPanel, setExpanded }) =>\r\n\t\t\t\t<Table\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\tenquiries.map(enquiry => {\r\n\t\t\t\t\t\t\tconst { id, org, docs, isExpanded, model, orders } = enquiry\r\n\t\t\t\t\t\t\tconst active = details\r\n\t\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Fragment key={id} >\r\n\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\tlineHeight='21px'\r\n\t\t\t\t\t\t\t\t\t\tentity={enquiry}\r\n\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: docs.length && docs[docs.length - 1].amount\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'emps',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: org.employees.length ? 'user' : 'user plus',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'grey',\r\n\t\t\t\t\t\t\t\t\t\t\thoverable: true,\r\n\t\t\t\t\t\t\t\t\t\t\thideUnhovered: true,\r\n\t\t\t\t\t\t\t\t\t\t\thasEntries: !!org.employees.length,\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: org.employees.length || ' ',\r\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetBottomPanel({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Employees',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId: org.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tactive: bottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.type === 'Employees'\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.orgId === org.id\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'model',\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: <Div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td='flex'\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tminw='215px'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{model.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!!model.drawings.length &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmr='5px'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\to='.6'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='image outline'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor='grey'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Div>,\r\n\t\t\t\t\t\t\t\t\t\t\thoverable: true,\r\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Model',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: model.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tactive: details\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& details.type === 'Model'\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& details.id === model.id\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'reserved',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: orders.reduce((res, o) => res += o.prods.length, 0),\r\n\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\texpandFor='orders'\r\n\t\t\t\t\t\t\t\t\t\texpanded={isExpanded}\r\n\t\t\t\t\t\t\t\t\t\texpand={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)}}\r\n\t\t\t\t\t\t\t\t\t\tactive={active}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !active ? true : !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t{\tisExpanded && orders.map((order, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { id, prods } = order\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === enquiry.orders.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\tentity={order}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'num',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'fullnum'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'org',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.org.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'model',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.model && enquiry.model.name //check only for migration from aws\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserved',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: prods.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'amount'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& details.type === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesTable","import { compose, graphql } from 'react-apollo'\r\n\r\nimport { enquiryDetails, enquiryLocal } from '../../graphql/enquiry'\r\nimport { orderDetails, orderLocal } from '../../graphql/order'\r\nimport { modelDetails, modelLocal } from '../../graphql/model'\r\n\r\nconst DetailsDataProvider = ({\r\n  children,\r\n  type,\r\n  id,\r\n  query1,\r\n  query2,\r\n  query3,\r\n  localQuery1,\r\n  localQuery2,\r\n  localQuery3,\r\n}) => {\r\n  const query = query1 || query2 || query3\r\n  const { loading, error, refetch } = query\r\n  const entity =\r\n    type === 'Enquiry' ? query.enquiry :\r\n    type === 'Order' ? query.order :\r\n    type === 'Model' ? query.model\r\n    : null\r\n  const localQuery = localQuery1 || localQuery2 || localQuery3\r\n  const localEntity =\r\n    id === 'new' ? null :\r\n    type === 'Enquiry' ? localQuery.enquiryLocal :\r\n    type === 'Order' ? localQuery.orderLocal :\r\n    type === 'Model' ? localQuery.modelLocal\r\n    : null\r\n  return children({\r\n    loading,\r\n    error,\r\n    refetch,\r\n    entity,\r\n    localEntity\r\n  })\r\n}\r\n\r\nexport default compose(\r\n  graphql(enquiryDetails, {\r\n    name: 'query1',\r\n    skip: ({ type }) => type !== 'Enquiry'\r\n  }),\r\n  graphql(orderDetails, {\r\n    name: 'query2',\r\n    skip: ({ type }) => type !== 'Order'\r\n  }),\r\n  graphql(modelDetails, {\r\n    name: 'query3',\r\n    skip: ({ type }) => type !== 'Model'\r\n  }),\r\n  graphql(enquiryLocal, {\r\n    name: 'localQuery1',\r\n    skip: ({ type, id }) => type !== 'Enquiry' || id === 'new',\r\n  }),\r\n  graphql(orderLocal, {\r\n    name: 'localQuery2',\r\n    skip: ({ type, id }) => type !== 'Order' || id === 'new',\r\n  }),\r\n  graphql(modelLocal, {\r\n    name: 'localQuery3',\r\n    skip: ({ type, id }) => type !== 'Model' || id === 'new',\r\n  }),\r\n)(DetailsDataProvider)","import React, { forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section, Caret } from '../styled/styled-semantic'\r\n\r\nconst SIcon = styled(Icon)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\nconst SCaret = styled(Caret)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\n\r\nexport default forwardRef(({\r\n\tchildren,\r\n\t// style\r\n\tsize,\r\n\tbottomBorder,\r\n\tclose,\r\n\texpanded,\r\n\tdisabled,\r\n\tonClick,\r\n\tnoIndent,\r\n}, ref) => {\r\n\tconst modes = {\r\n\t\t...close && { close: true },\r\n\t\t...(typeof expanded !== 'undefined') && { expand: true },\r\n\t}\r\n\treturn (\r\n\t\t<Section\r\n\t\t\tref={ref}\r\n\t\t\tbc='white'\r\n\t\t\thead\r\n\t\t\tnoLP\r\n\t\t\tnoIndent={noIndent}\r\n\t\t\tbottomBorder={bottomBorder || true}\r\n\t\t\tsize={size || undefined}\r\n\t\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\t{ modes['close']\r\n\t\t\t\t?\t<SIcon link\r\n\t\t\t\t\t\tsize='big'\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tonClick={close}\r\n\t\t\t\t\t/> :\r\n\t\t\t\t// TODO make disabled work (grey out color)\r\n\t\t\t\tmodes['expand']\r\n\t\t\t\t? <SCaret\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t/> : null\r\n\t\t\t}\r\n\t\t\t{children}\r\n\t\t</Section>\r\n\t)\r\n})\r\n","import React from 'react'\r\n\r\nimport { Span } from '../styled/styled-semantic'\r\n\r\nconst DetailsHeaderSubitle = ({ content }) => {\r\n\treturn (\r\n\t\t<Span\r\n\t\t\tml='10px'\r\n\t\t\tfs='1rem'\r\n\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\tws='0.5em'\r\n\t\t>\r\n\t\t\t{content}\r\n\t\t</Span>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderSubitle\r\n","import React from 'react'\r\n\r\nimport { Header } from '../styled/styled-semantic'\r\nimport DetailsHeaderSubitle from './DetailsHeaderSubitle'\r\n\r\nconst DetailsHeaderTitle = ({\r\n\ttitle,\r\n\tsubtitle,\r\n\tsize\r\n}) => {\r\n\treturn (\r\n\t\t<Header\r\n\t\t\tm='0'\r\n\t\t\tsize={size || 'medium'}\r\n\t\t>\r\n\t\t\t{title}\r\n\t\t\t{(subtitle || subtitle === 0) &&\r\n\t\t\t\t<DetailsHeaderSubitle\r\n\t\t\t\t\tcontent={subtitle}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</Header>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderTitle\r\n","import React from 'react'\r\n\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nconst DetailsHeaderButtons = ({ children }) => {\r\n\treturn (\r\n\t\t<Div\r\n\t\t\tml='auto'\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Div>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderButtons\r\n","import React from 'react'\r\n\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nconst SButton = styled(Button)`\r\n\tpadding: .78571429em !important;\r\n\t&>i {\r\n\t\topacity: .9 !important;\r\n\t\tmargin: 0 !important;\r\n\t}\r\n`\r\n\r\nconst RefreshButton = ({ loading, onClick }) => {\r\n\treturn (\r\n\t\t<SButton\r\n\t\t\tactiveColor='blue'\r\n\t\t\tactive={loading}\r\n\t\t\tonClick={onClick} >\r\n\t\t\t<Icon \r\n\t\t\t\tname='refresh'\r\n\t\t\t\tloading={loading} \r\n\t\t\t/>\r\n\t\t</SButton>\r\n\t)\r\n}\r\n\r\nexport default RefreshButton\r\n","import React from 'react'\r\n\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\nimport RefreshButton from '../common/RefreshButton'\r\n\r\nconst settings = {\r\n\tEnquiry: {\r\n\t\ttitleNew: 'Новая заявка',\r\n\t\ttitleExisting: 'Заявка №',\r\n\t},\r\n\tOrder: {\r\n\t\ttitleNew: 'Новый заказ',\r\n\t\ttitleExisting: 'Заказ №',\r\n\t},\r\n\tModel: {\r\n\t\ttitleNew: 'Новое изделие',\r\n\t\ttitleExisting: '',\r\n\t}\r\n}\r\n\r\nconst DetailsMainHeader = ({\r\n\ttype,\r\n\tcloseDetails,\r\n\tloading,\r\n\trefresh,\r\n\tsetDetails,\r\n\teditMode,\r\n\tlocalEntity\r\n}) => {\r\n\tconst { id, num, fullnum, name, article, dateLocal } = localEntity || {}\r\n\treturn (\r\n\t\t<DetailsHeaderContainer\r\n\t\t\tclose={closeDetails}\r\n\t\t>\r\n\t\t\t{ !id && // new entity\r\n\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\ttitle={settings[type].titleNew}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{ id && // existing entity\r\n\t\t\t\t<>\r\n\t\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\t\ttitle={type === 'Model'\r\n\t\t\t\t\t\t\t? name\r\n\t\t\t\t\t\t\t: settings[type].titleExisting + ' ' + (num || fullnum)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubtitle={type === 'Model'\r\n\t\t\t\t\t\t\t? (article ? `Артикул: ${article}` : '')\r\n\t\t\t\t\t\t\t: 'от ' + dateLocal\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t\t<RefreshButton\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={refresh}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ticon='edit'\r\n\t\t\t\t\t\t\tactiveColor='blue'\r\n\t\t\t\t\t\t\tactive={editMode || false}\r\n\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\t\tid: localEntity.id,\r\n\t\t\t\t\t\t\t\teditMode: true\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t/> \r\n\t\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t\t</>\r\n\t\t\t}\r\n\t\t</DetailsHeaderContainer>\r\n\t)\r\n}\r\n\r\nexport default DetailsMainHeader\r\n","import styled from 'styled-components'\r\n\r\nexport const Table = styled.table`\r\n\t/* table-layout: fixed; */\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n`\r\n\r\nexport const Tr = styled.tr`\r\n  margin: 0 0 1em;\r\n  line-height: 1.4285em;\r\n  color: rgba(0,0,0,.87);\r\n`\r\n\r\nexport const Td = styled.td`\r\n  :nth-child(1) {\r\n\t\twidth: ${props => props.theme.widths.formLabel};\r\n\t// color: rgba(0,0,0,.87);\r\n\t/* font-size: .92857143em; */\r\n\t/* line-height: 32px; */\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n\t\tvertical-align: top;\r\n  }\r\n  :nth-child(2) {\r\n\t\t// width: 100px;\r\n\t\tfont-size: 1em;\r\n\t\tfont-weight: bold;\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n  }\r\n`\r\nexport const InputTd = styled(Td)`\r\n\tpadding-top: 0 !important;\r\n`\r\n\r\nexport const EditorTd = styled(InputTd)`\r\n\tfont-weight: unset !important;\r\n\t/* padding-bottom: 0 !important; */\r\n`","import React from 'react'\r\nimport {\r\n\tEditor,\r\n\tEditorState,\r\n\tContentState,\r\n\tRichUtils,\r\n\tconvertFromHTML,\r\n\tgetDefaultKeyBinding,\r\n\tKeyBindingUtil\r\n} from 'draft-js'\r\nimport 'draft-js/dist/Draft.css'\r\nimport {stateToHTML} from 'draft-js-export-html'\r\n\r\nclass DraftEditor extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tlet editorState\r\n\t\tif (props.initFromHtml) {\r\n\t\t\tconst blocksFromHTML = convertFromHTML(props.initFromHtml)\r\n\t\t\teditorState = EditorState.createWithContent(\r\n\t\t\t\tContentState.createFromBlockArray(\r\n\t\t\t\t\tblocksFromHTML.contentBlocks,\r\n\t\t\t\t\tblocksFromHTML.entityMap\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\teditorState = EditorState.createEmpty()\r\n\t\t}\r\n\t\tthis.state = { \r\n\t\t\teditorState,\r\n\t\t\toriContent: editorState.getCurrentContent()\r\n\t\t}\r\n\t}\r\n\tonChange = (editorState) => {\r\n\t\tthis.setState({ editorState })\r\n\t\tconst newContent = editorState.getCurrentContent()\r\n\t\tconst { setEditorHasText, setEditorDiff, setHasFocus } = this.props\r\n\t\tif (editorState && setEditorHasText) setEditorHasText(newContent.hasText())\r\n\t\tif (setEditorDiff) setEditorDiff(newContent !== this.state.oriContent)\r\n\t\tif (setHasFocus) setHasFocus(editorState.getSelection().getHasFocus())\r\n\t}\r\n\tkolmechKeyBindingFn = (e) => {\r\n\t\t// catch Ctrl + Enter event\r\n\t\tif (e.keyCode === 13 && KeyBindingUtil.hasCommandModifier(e)) {\r\n\t\t  return 'ctrlEnter'\r\n\t\t}\r\n\t\treturn getDefaultKeyBinding(e)\r\n\t}\r\n\thandleKeyCommand = (command, editorState) => {\r\n\t\t// handle Ctrl + Enter command\r\n\t\tif (command === 'ctrlEnter') {\r\n\t\t\tthis.props.onCtrlEnter()\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\tconst newState = RichUtils.handleKeyCommand(editorState, command);\r\n\t\tif (newState) {\r\n\t\t\tthis.onChange(newState);\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\treturn 'not-handled'\r\n\t}\r\n\tclear = () => this.setState({ \r\n\t\teditorState: EditorState.push(this.state.editorState, ContentState.createFromText(''), 'remove-range')\r\n\t})\r\n\texportHtml = () => {\r\n\t\tconst html = stateToHTML(this.state.editorState.getCurrentContent())\r\n\t\tif (!convertFromHTML(html).contentBlocks) return null\r\n\t\treturn html\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Editor\r\n\t\t\t\teditorState={this.state.editorState}\r\n\t\t\t\tonChange={this.onChange}\r\n\t\t\t\thandleKeyCommand={this.handleKeyCommand}\r\n\t\t\t\tkeyBindingFn={this.kolmechKeyBindingFn}\r\n\t\t\t\treadOnly={this.props.readOnly}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default DraftEditor","import React, { Component } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport DraftEditor from './DraftEditor'\r\n\r\nconst EditorWrapper = styled.div`\r\n\tpadding: calc(0.678571em - 1px) 1em;\r\n\tline-height: 1.4285em;\r\n\tborder: 1px solid rgba(34,36,38,.15);\r\n\tborder-radius: .28571429rem;\r\n\ttransition: all .1s ease;\r\n\t${({ borderless, hasFocus, diff }) =>\r\n\t\tborderless\r\n\t\t&& !hasFocus\r\n\t\t&& !diff && `\r\n\t\t\tmargin-left: -1em;\r\n\t\t\tborder: 1px solid white;\r\n\t\t\t:hover {\r\n\t\t\t\tbackground: rgba(0,0,0,.05);\r\n\t\t\t\tcolor: rgba(0,0,0,.65);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\t\t`\r\n\t}\r\n`\r\n\r\nclass WrappedDraftEditor extends Component {\r\n\tstate = {\r\n\t\thasFocus: false\r\n\t}\r\n\tsetHasFocus = (hasFocus) => this.setState({ hasFocus })\r\n\trender() {\r\n\t\tconst { hasFocus } = this.state\r\n\t\tconst {\r\n\t\t\tborderless,\r\n\t\t\tdiff,\r\n\t\t\tforwardedRef,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\t\treturn (\r\n\t\t\t<EditorWrapper\r\n\t\t\t\tborderless={borderless}\r\n\t\t\t\thasFocus={hasFocus}\r\n\t\t\t\tdiff={diff}\r\n\t\t\t>\r\n\t\t\t\t<DraftEditor\r\n\t\t\t\t\tref={forwardedRef}\r\n\t\t\t\t\tsetHasFocus={this.setHasFocus}\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t/>\r\n\t\t\t</EditorWrapper>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default React.forwardRef((props, ref) =>\r\n\t<WrappedDraftEditor\r\n\t\tforwardedRef={ref}\r\n\t\t{...props}\r\n\t/>\r\n)","const validateInn = (inn, error) => {\r\n    var result = false;\r\n\tif (typeof inn === 'number') {\r\n        inn = inn.toString();\r\n\t} else if (typeof inn !== 'string') {\r\n        inn = '';\r\n\t}\r\n\tif (!inn.length) {\r\n        error.code = 1;\r\n\t\terror.message = 'ИНН пуст';\r\n\t} else if (/[^0-9]/.test(inn)) {\r\n        error.code = 2;\r\n\t\terror.message = 'ИНН может состоять только из цифр';\r\n\t} else if ([10, 12].indexOf(inn.length) === -1) {\r\n        error.code = 3;\r\n\t\terror.message = 'ИНН может состоять только из 10 или 12 цифр';\r\n\t} else {\r\n        var checkDigit = function (inn, coefficients) {\r\n            var n = 0;\r\n\t\t\tfor (var i in coefficients) {\r\n                n += coefficients[i] * inn[i];\r\n\t\t\t}\r\n            // eslint-disable-next-line\r\n\t\t\treturn parseInt(n % 11 % 10);\r\n\t\t};\r\n        // eslint-disable-next-line\r\n\t\tswitch (inn.length) {\r\n            case 10:\r\n            var n10 = checkDigit(inn, [2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if (n10 === parseInt(inn[9])) {\r\n                result = true;\r\n            }\r\n            break;\r\n\t\t\tcase 12:\r\n            var n11 = checkDigit(inn, [7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            var n12 = checkDigit(inn, [3, 7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if ((n11 === parseInt(inn[10])) && (n12 === parseInt(inn[11]))) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (!result) {\r\n\t\t\terror.code = 4;\r\n\t\t\terror.message = 'Неправильное контрольное число ИНН';\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport default validateInn","export const isValidDate = date => date instanceof Date && !isNaN(date.valueOf())\r\nexport const isValidDateString = dateString => isValidDate(new Date(Date.parse(dateString))) && dateString.length === 10\r\nexport const tz = new Date().getTimezoneOffset() * 60000\r\nexport const toLocalISOString = date => new Date(date.getTime() - tz).toISOString()\r\nexport const toLocalDateString = date => toLocalISOString(date).slice(0,10)\r\nexport const toLocalDatetimeString = date => toLocalISOString(date).slice(0,16)\r\nexport const fromLocalISOString = (string) => new Date(Date.parse(string) + tz)\r\n// util to split array into chunks\r\nexport const toChunks = (arr, size) => {\r\n    let chunks = []\r\n    for (let i = 0; i < arr.length; i += size) {\r\n        chunks.push(arr.slice(i, i + size))\r\n    }\r\n    return chunks\r\n}\r\n\r\n// groupBy = (xs, key) => xs.reduce((rv, x) => {\r\n//     (rv[x[key]] = rv[x[key]] || []).push(x)\r\n//     return rv\r\n//   }, {})\r\n// groupByArray(xs, key) => xs.reduce( (rv, x) => {\r\n//   let v = key instanceof Function ? key(x) : x[key];\r\n//   let el = rv.find((r) => r && r.key === v);\r\n//   if (el) { el.values.push(x); } else { rv.push({ key: v, values: [x] }); }\r\n//   return rv;\r\n// }, [])\r\n// const splitBy = (xs, key) => xs.reduce( (rv, x) => {\r\n//   let el = rv.find(r => r[0][key] === x[key])\r\n//   if (el) { el.push(x); } else { rv.push([x]); }\r\n// }, [])\r\n","import gql from 'graphql-tag'\r\n\r\nexport const opTypeFragmentBasic = gql`\r\n\tfragment opTypeFragmentBasic on OpType {\r\n\t\tid\r\n\t\tname\r\n\t\topClass\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\nexport const orgFragmentBasic = gql`\r\n\tfragment OrgFragmentBasic on Org {\r\n\t\tid\r\n\t\tinn\r\n\t\tname\r\n\t}\r\n`\r\n\r\nexport const orgFragmentFull = gql`\r\n\tfragment OrgFragmentFull on Org {\r\n\t\t...OrgFragmentBasic\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\n\r\nexport const orgExecFragment = gql`\r\n\tfragment orgExecFragment on Org {\r\n\t\tid\r\n\t\tname\r\n\t\texec {\r\n\t\t\tid\r\n\t\t\topTypes { ...opTypeFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const org = gql`\r\n\tquery org ($id: ID!) {\r\n\t\torg (id: $id) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const allOrgs = gql`\r\n\tquery allOrgs {\r\n\t\torgs {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const createContract = gql`\r\n\tmutation createContract($id: ID!, $date: String) {\r\n\t\tcreateContract(id: $id, date: $date) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const createOrg = gql`\r\n\tmutation createOrg($inn: String!) {\r\n\t\tcreateOrg(inn: $inn) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const mergeOrg = gql`\r\n\tmutation mergeOrg($id: ID!, $inn: String!) {\r\n\t\tmergeOrg(id: $id, inn: $inn) {\r\n\t\t\t...OrgFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orgFragmentFull}\r\n`\r\n\r\nexport const orgLocal = gql`\r\n\tquery OrgLocal ($id: ID!) {\r\n\t\torgLocal (id: $id) {\r\n\t\t\t...OrgFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${orgFragmentBasic}\r\n`\r\n\r\nexport const orgDetails = gql`\r\n\tquery orgDetails ($id: ID!) {\r\n\t\torgDetails (id: $id) {\r\n\t\t\t...OrgFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orgFragmentFull}\r\n`\r\n\r\nexport const upsertOrgExec = gql`\r\n\tmutation upsertOrg($input: OrgInput!) {\r\n\t\tupsertOrg(input: $input) {\r\n\t\t\t...orgExecFragment\r\n\t\t}\r\n\t}\r\n\t${orgExecFragment}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const allOrgsAndModels = gql`\r\n    query AllOrgsAndModels {\r\n        orgs {\r\n            id\r\n            inn\r\n            name\r\n        }\r\n        models {\r\n            id\r\n            article\r\n            name\r\n        }\r\n    }\r\n`","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { toLocalISOString, isValidDate, isValidDateString } from '../../utils/dates'\r\nimport { Button } from 'semantic-ui-react';\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.error && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nexport default ({\r\n\tselectedDate,\r\n\tselectDay,\r\n\terror\r\n}) => {\r\n\tconst inputRef = useRef(null)\r\n\tconst [ date, setDate ] = useState(selectedDate || new Date())\r\n\tconst [ input, setInput ] = useState(toLocalISOString(date).slice(0, 10))\r\n\tconst [ err, setErr ] = useState('')\r\n\t// useEffect(() => {\r\n\t// \tisValidDate(selectedDate)\r\n\t// \t\t? setDate(selectedDate) || setErr('') || setInput(toLocalISOString(date).slice(0, 10))\r\n\t// \t\t: setErr('Provided date is not valid')\r\n\t// }, [selectedDate])\r\n\t// useEffect(() => {\r\n\t// \tconsole.log('useEffect > ') || setDate(selectedDate)\r\n\t// \t|| setInput(toLocalISOString(selectedDate).slice(0, 10))\r\n\t// }, [date, selectedDate, input])\r\n\tuseEffect(() => {\r\n\t\tconsole.log('useEffect > ') || setDate(selectedDate)\r\n\t\t|| setInput(toLocalISOString(selectedDate).slice(0, 10))\r\n\t}, [selectedDate])\r\n\tconsole.log(' render > date, input, err > ', date, input, err)\r\n\treturn (\r\n\t\t<PickerDiv\r\n\t\t\terror={err}\r\n\t\t>\r\n\t\t\t<Button\r\n\t\t\t\tonClick={() => setInput(input.slice(0,-1))}\r\n\t\t\t>\r\n\t\t\t\tClick ME!\r\n\t\t\t</Button>\r\n\t\t\t<DayPickerInput\r\n\t\t\t\tref={inputRef}\r\n\t\t\t\tvalue={input}\r\n\t\t\t\tonDayChange={date => {\r\n\t\t\t\t\t// console.log('inputRef > ', inputRef.current.input.value)\r\n\t\t\t\t\tconsole.log('onDateChange > ') ||\r\n\t\t\t\t\tisValidDateString(inputRef.current.input.value)\r\n\t\t\t\t\t\t? setErr('') || setDate(date)\r\n\t\t\t\t\t\t: setErr('Provided date is not valid')\r\n\t\t\t\t}}\r\n\t\t\t\tonDayPickerHide={() => {\r\n\t\t\t\t\tconsole.log('onDayPickerHide > ')\r\n\t\t\t\t\tconsole.log('selectedDate > ', selectedDate)\r\n\t\t\t\t\tconsole.log('toLocalISOString(selectedDate).slice(0, 10) > ', toLocalISOString(selectedDate).slice(0, 10))\r\n\t\t\t\t\tconsole.log('inputRef.current.input.value > ', inputRef.current.input.value)\r\n\t\t\t\t\tconsole.log('isValidDateString(inputRef.current.input.value) > ', isValidDateString(inputRef.current.input.value))\r\n\t\t\t\t\tconsole.log('((date.getTime() !== selectedDate.getTime()) > ', date.getTime() !== selectedDate.getTime())\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn ((date.getTime() !== selectedDate.getTime())\r\n\t\t\t\t\t\t&& isValidDateString(inputRef.current.input.value))\r\n\t\t\t\t\t\t\t?\t(console.log('selectDay > ') || selectDay(date))\r\n\t\t\t\t\t\t\t// : (console.log('setDate & input > ') || setDate(selectedDate)|| setInput(toLocalISOString(selectedDate).slice(0, 10))) || setErr('')\r\n\t\t\t\t\t\t\t: (console.log('setDate & input > ')\r\n\t\t\t\t\t\t\t\t|| setDate(selectedDate)\r\n\t\t\t\t\t\t\t\t|| setInput(toLocalISOString(selectedDate).slice(0, 10)))\r\n\t\t\t\t\t\t\t\t|| setErr('')\r\n\t\t\t\t\t\t\t\t|| (inputRef.current.input.value = toLocalISOString(selectedDate).slice(0, 10))\r\n\t\t\t\t}\r\n\t\t\t\t\t\t// ? setErr('') || setDate(date)\r\n\t\t\t\t\t\t// : setErr('Provided date is not valid')\r\n\t\t\t\t\t// console.log('date, selectedDate > ', date, selectedDate)\r\n\t\t\t\t\t// (date.getTime() !== selectedDate.getTime()) && selectDay(date)\r\n\t\t\t\t\t// () => (date.getTime() !== selectedDate.getTime()) && selectDay(date)\r\n\t\t\t\t\t// console.log('onDayPickerHide > ', date)\r\n\t\t\t\t\t// selectDay(date)\r\n\t\t\t\t}\r\n\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\tmonth: selectedDate\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</PickerDiv>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { Section, Header, Div, Icon } from '../styled/styled-semantic';\r\n\r\nexport default ({\r\n  title,\r\n  content,\r\n  onClose\r\n}) => {\r\n  return (\r\n    <Div\r\n      m='0 -1em 1em -55px'\r\n    >\r\n      <Section\r\n        head\r\n        minor\r\n        secondary\r\n        topBorder\r\n        bottomBorder\r\n        noLP={!!onClose}\r\n      >\r\n        {!!onClose &&\r\n          <Icon\r\n            bs='content-box'\r\n            w='calc(55px - 1em)'\r\n            m='0 0.5em'\r\n            link\r\n            size='large'\r\n            name='close'\r\n            // onClick={() => onClose()}\r\n            onClick={onClose}\r\n          />\r\n        }\r\n        <Header\r\n          m='0'\r\n        >\r\n          {title}\r\n        </Header>\r\n      </Section>\r\n      <Section\r\n        secondary\r\n        bottomBorder\r\n      >\r\n        {content}\r\n      </Section>\r\n    </Div>\r\n  )\r\n}\r\n","import produce from 'immer'\r\n\r\nexport const projectEntity = (entity, schema) => {\r\n\tlet result = {}\r\n\thandleObj(schema, entity, result)\r\n\treturn result\r\n}\r\n\r\nexport const preparePayload = (values, initialValues, schema) => {\r\n\tlet result = {}\r\n\thandlePayloadObj(schema, initialValues, values, result)\r\n\treturn result\r\n}\r\n\r\nconst handleObj = (objSchema, obj = {}, result) => {\r\n\t// preserve ids of entity objects\r\n\tif (obj.id) result.id = obj.id\r\n\tObject.keys(objSchema).forEach(k => {\r\n\t\tconst type = typeof objSchema[k]\r\n\t\t// NOTE form schema should contain only non-empty nested objects\r\n\t\tif (type === 'object' && Array.isArray(objSchema[k]))\r\n\t\t\treturn handleArr(objSchema[k], obj[k], result[k] = [])\r\n\t\tif (type === 'object')\r\n\t\t\treturn handleObj(objSchema[k], obj[k], result[k] = {})\r\n\t\tif (k.endsWith('Id') && !!obj[k.slice(0, -2)])\r\n\t\t\treturn result[k] = obj[k.slice(0, -2)].id\r\n\t\tresult[k] = obj[k] || objSchema[k]\r\n\t})\r\n}\r\n\r\nconst handleArr = (arrSchema, arr = [], resultArr) => {\r\n\t// NOTE schema array should contain one element only just to define schema\r\n\tconst type = typeof arrSchema[0]\r\n\t// TODO handle array of primitives (now only collections)\r\n\tif (type === 'object') {\r\n\t\treturn arr.length\r\n\t\t\t? arr.forEach((obj, i) => handleObj(arrSchema[0], obj, resultArr[i] = {}))\r\n\t\t\t: handleObj(arrSchema[0], {}, resultArr[0] = {})\r\n\t}\r\n}\r\n\r\nconst handlePayloadObj = (objSchema, initialObj, obj, result) => {\r\n\t// preserve ids of entity objects\r\n\tif (obj.id) result.id = obj.id\r\n\tObject.keys(objSchema).forEach(k => {\r\n\t\t// console.log('k > ', k)\r\n\t\t// console.log('objSchema[k] > ', objSchema[k])\r\n\t\tconst type = typeof objSchema[k]\r\n\t\t// NOTE form schema should contain only non-empty nested objects\r\n\t\tif (type === 'object' && Array.isArray(objSchema[k]))\r\n\t\t\treturn handlePayloadArr(objSchema[k], initialObj[k], obj[k], result[k] = [])\r\n\t\tif (type === 'object')\r\n\t\t\treturn handlePayloadObj(objSchema[k], initialObj[k], obj[k], result[k] = {})\r\n\t\t// result includes changed values\r\n\t\tif (obj[k] !== initialObj[k]) return result[k] = obj[k]\r\n\t\t// and non-empty schema values\r\n\t\tif (!obj[k] && !!objSchema[k]) return result[k] = objSchema[k]\r\n\t})\r\n}\r\n\r\nconst handlePayloadArr = (arrSchema, initialArr, arr, resultArr) => {\r\n\t// NOTE schema array should contain one element only just to define schema\r\n\tconst type = typeof arrSchema[0]\r\n\t// TODO handle array of primitives (now only collections)\r\n\tif (type === 'object') {\r\n\t\t// arr should contain at least one element\r\n\t\treturn arr.forEach((obj, i) =>\r\n\t\t\thandlePayloadObj(arrSchema[0], initialArr[i], obj, resultArr[i] = {})\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport const getStructure = obj => {\r\n\tconst result = {}\r\n\tgetSkeleton(obj, result)\r\n\treturn result\r\n}\r\n\r\nconst getSkeleton = (obj, result) => {\r\n\t// preserve ids of entity objects\r\n\tObject.keys(obj).forEach(k => {\r\n\t\tif (k === 'id')\r\n\t\t\treturn result.id = obj.id\r\n\t\tif (obj[k] === null)\r\n\t\t\t// return result[k] = {}\r\n\t\t\treturn\r\n\t\tconst type = typeof obj[k]\r\n\t\tif (type === 'object' && Array.isArray(obj[k]))\r\n\t\t\treturn result[k] = getArrSkeleton(obj[k])\r\n\t\tif (type === 'object')\r\n\t\t\treturn getSkeleton(obj[k], result[k] = {})\r\n\t})\r\n}\r\n\r\nconst getArrSkeleton = arr => arr\r\n\t.filter(item => typeof item === 'object')\r\n\t.map(obj => {\r\n\t\tconst result = {}\r\n\t\tgetSkeleton(obj, result)\r\n\t\treturn result\r\n\t})\r\n\r\nconst analysePath = (path, acc = []) => {\r\n\tconst dotPos = path.indexOf('.')\r\n\tconst braketPos = path.indexOf('[')\r\n\tif (path === '') {\r\n\t\tacc[acc.length - 1].last = true\r\n\t\treturn acc\r\n\t}\r\n\tif (dotPos*braketPos === 1) return [\r\n\t\t...acc, {\r\n\t\tkey: path,\r\n\t\tlast: true\r\n\t}]\r\n\tif (braketPos === -1 || dotPos + 1 && dotPos < braketPos) return analysePath(\r\n\t\tpath.slice(dotPos + 1), [\r\n\t\t\t...acc, {\r\n\t\t\t\tkey: path.slice(0, dotPos)\r\n\t\t\t}\r\n\t])\r\n\tif (dotPos === -1 || braketPos + 1 && braketPos < dotPos) {\r\n\t\tconst closingBraketPos = path.indexOf(']')\r\n\t\treturn analysePath(\r\n\t\t\tpath.slice(closingBraketPos + 2), [\r\n\t\t\t\t...acc, {\r\n\t\t\t\t\tkey: path.slice(0, braketPos),\r\n\t\t\t\t\tarray: true\r\n\t\t\t\t}, {\r\n\t\t\t\t\tkey: path.slice(braketPos + 1, closingBraketPos),\r\n\t\t\t\t\tarrayItem: true\r\n\t\t\t\t}\r\n\t\t])\r\n\t}\r\n}\r\n\r\nexport const assignNested = (obj, path, val, preserveKeys=false) => {\r\n\tconst keys = analysePath(path)\r\n\tkeys.reduce((obj, { key, last, array, arrayItem }) => {\r\n\t\tObject.keys(obj).forEach(k => {\r\n\t\t\tif (k === 'id' || k === key) return\r\n\t\t\tif (!preserveKeys) {\r\n\t\t\t\tif (arrayItem) obj[k] = { id: obj[k].id }\r\n\t\t\t\telse delete obj[k]\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (last) {\r\n\t\t\tif (arrayItem && key === 'length') return obj[obj.length] = val\r\n\t\t\treturn obj[key] = val\r\n\t\t}\r\n\t\tif (!obj[key]) {\r\n\t\t\tif (array) obj[key] = []\r\n\t\t\telse obj[key] = {}\r\n\t\t}\r\n\t\treturn obj[key]\r\n\t}, obj)\r\n}\r\n\r\nexport const produceNested = (obj, path, val, preserveKeys=false) => {\r\n\tconst keys = analysePath(path)\r\n\treturn produce(obj, obj => {\r\n\t\tkeys.reduce((obj, { key, last, array, arrayItem }) => {\r\n\t\t\tObject.keys(obj).forEach(k => {\r\n\t\t\t\tif (k === 'id' || k === key) return\r\n\t\t\t\tif (!preserveKeys) {\r\n\t\t\t\t\tif (arrayItem) obj[k] = { id: obj[k].id }\r\n\t\t\t\t\telse delete obj[k]\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tif (last) {\r\n\t\t\t\tif (arrayItem && key === 'length') return obj[obj.length] = val\r\n\t\t\t\treturn obj[key] = val\r\n\t\t\t}\r\n\t\t\tif (!obj[key]) {\r\n\t\t\t\tif (array) obj[key] = []\r\n\t\t\t\telse obj[key] = {}\r\n\t\t\t}\r\n\t\t\treturn obj[key]\r\n\t\t}, obj)\r\n\t})\r\n}\r\n","import { string } from 'yup'\r\n\r\nexport const idValidationType = string().matches(/^[a-z0-9]{25}$/)","import { object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  // orgId: idValidationType\r\n\t// \t.when('id', (id, schema) => id\r\n\t// \t\t? schema.notRequired()\r\n\t// \t\t: schema.required('Организация не указана')\r\n\t// \t),\r\n  name: string().trim().min(4).max(255)\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required()\r\n    ),\r\n  article: string().trim().min(4).max(10).notRequired(),\r\n})\r\n\r\nexport const formikSchema = {\r\n  name: '',\r\n  article: ''\r\n}\r\n\r\nexport const listSchema = {\r\n  name: {\r\n    label: 'Наименование'\r\n  },\r\n  article: {\r\n    label: 'Артикул'\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport NumberFormat from 'react-number-format'\r\n\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Span } from '../styled/styled-semantic'\r\n// import CurrencyInput from './CurrencyInput'\r\n\r\nexport default ({\r\n\tplaceholder,\r\n\tname,\r\n\tvalue,\r\n\tsetField\r\n}) => {\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<NumberFormat\r\n\t\t\t\tcustomInput={Input}\r\n\t\t\t\t// customInput={CurrencyInput}\r\n\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tdecimalSeparator=','\r\n\t\t\t\tthousandSeparator=' '\r\n\t\t\t\tdecimalScale={2}\r\n\t\t\t\tallowNegative={false}\r\n\t\t\t\tonValueChange={values => setField(name, values.floatValue)} />\r\n\t\t\t<Span\r\n\t\t\t\tpl='6px'\r\n\t\t\t\tfs='1.3rem'\r\n\t\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\t>\r\n\t\t\t\t₽\r\n\t\t\t</Span>\r\n\t\t\t{/* <Span pl='9px' fs='1.1rem' ws='0.1em'>с НДС</Span> */}\r\n\t\t</>\r\n\t)\r\n}\r\n","import React, { Component } from 'react'\r\nimport { connect, getIn } from 'formik'\r\n\r\nimport FormikCurrency from './FormikCurrency'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { Dropdown } from 'semantic-ui-react'\r\n\r\nclass FormikInput extends Component {\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tformik,\r\n\t\t\tname,\r\n\t\t\ttype,\r\n\t\t\toptions,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\t\tconst value = getIn(formik.values, name)\r\n\t\tif (options) return (\r\n\t\t\t<Dropdown\r\n\t\t\t\t{...rest}\r\n\t\t\t\tselection\r\n\t\t\t\tfluid\r\n\t\t\t\tsearch\r\n\t\t\t\tnoResultsMessage='Ничего не найдено'\r\n\t\t\t\tvalue={value}\r\n\t\t\t\toptions={options}\r\n\t\t\t\tonChange={(e, {value}) => formik.setFieldValue(name, value)}\r\n\t\t\t/>\r\n\t\t)\r\n\t\tif (name.endsWith('amount')) return (\r\n\t\t\t<FormikCurrency\r\n\t\t\t\tname={name}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tsetField={formik.setFieldValue}\r\n\t\t\t/>\r\n\t\t)\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\t{...rest}\r\n\t\t\t\tw='100%'\r\n\t\t\t\tname={name}\r\n\t\t\t\tvalue={type === 'date' ? value.slice(0,16) : value}\r\n\t\t\t\terror={getIn(formik.touched, name) && !!getIn(formik.errors, name)}\r\n\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\tonBlur={formik.handleBlur}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default connect(FormikInput)","import React, { Component } from 'react'\r\nimport { connect, getIn } from 'formik'\r\nimport InputMask from 'react-input-mask'\r\nimport styled from 'styled-components'\r\nimport { Dropdown as SDropdown } from 'semantic-ui-react';\r\nimport { Input } from '../styled/styled-semantic';\r\nimport FormikInput from './FormikInput.js';\r\n\r\nconst countryOtions = [\r\n  { key: 'rus', text: '+7', value: 'rus' },\r\n  { key: 'notRus', text: '+', value: 'notRus' },\r\n]\r\n\r\nconst DropdownPropFilter = ({ inputError, ...rest }) => (\r\n\t<SDropdown {...rest} />\r\n)\r\nexport const Dropdown = styled(DropdownPropFilter)`\r\n\t&&&&&& {\r\n    ${props => props.inputError && `\r\n      border: 1px solid ${props.theme.colors.errorBorder};\r\n      border-right-color: transparent;\r\n    `}\r\n\t}\r\n`\r\n\r\nconst Error = styled.div`\r\n  color: ${props => props.theme.colors.error};\r\n`\r\n\r\nclass Tel extends Component {\r\n  render() {\r\n    const {\r\n      baseName,\r\n      formik,\r\n      ...rest\r\n    } = this.props\r\n    const number = getIn(formik.values, baseName + '.number')\r\n    const country = getIn(formik.values, baseName + '.country')\r\n    const touched = getIn(formik.touched, baseName + '.number')\r\n    const error = getIn(formik.errors, baseName)\r\n    const renderDropdown =() => (\r\n      <Dropdown\r\n        tabIndex={-1}\r\n        name={baseName + '.country'}\r\n        value={country}\r\n        options={countryOtions}\r\n        inputError={touched && !!error}\r\n        onChange={(e, { name, value }) => formik.setFieldValue( name, value )}\r\n      />\r\n    )\r\n    return <>\r\n      {country === 'rus'\r\n        ? <InputMask\r\n            name={baseName + '.number'}\r\n            mask='( 999 ) 999-99-99'\r\n            maskChar=''\r\n            value={number}\r\n            onBlur={formik.handleBlur}\r\n            onChange={formik.handleChange}\r\n          >\r\n            {(inputProps) =>\r\n              <Input\r\n                w='240px !important'\r\n                // placeholder='Номер телефона'\r\n                error={touched && !!error}\r\n                label={renderDropdown()}\r\n                {...rest}\r\n                {...inputProps}\r\n              />\r\n            }\r\n          </InputMask>\r\n        : <FormikInput\r\n            w='240px !important'\r\n            name={baseName + '.number'}\r\n            error={touched && !!error}\r\n            // placeholder='Телефон с кодом страны'\r\n            label={renderDropdown()}\r\n            {...rest}\r\n          />\r\n      }\r\n      <Error>\r\n        {touched && error && error.number}\r\n      </Error>\r\n    </>\r\n  }\r\n}\r\n\r\nexport default connect(Tel)\r\n","import React, { Fragment } from 'react'\r\nimport { getIn, connect, FieldArray } from 'formik'\r\nimport styled from 'styled-components'\r\n\r\nimport FormikInput from './FormikInput'\r\nimport FormikTel from './FormikTel'\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tmargin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n\tflex: 0 0 122px;\r\n\tpadding-top: calc(10.5rem/14);\r\n\tfont-size: calc(13rem/14);\r\n\tfont-weight: bold;\r\n\tline-height: 1.21428571rem;\r\n\t${props => props.required && `\r\n\t\t::after {\r\n\t\t\tcontent: '*';\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tmargin: -.2em 0 0 .2em;\r\n\t\t\tvertical-align: top;\r\n\t\t\tcolor: #db2828;\r\n\t\t}\r\n\t`}\r\n`\r\n\r\nconst Content = styled.div`\r\n\tflex: 1 1 auto;\r\n\tmax-width: calc(100% - 122px);\r\n`\r\n\r\nconst InputContainer = styled.div`\r\n\tmax-width: 240px;\r\n`\r\n\r\nconst Error = styled.div`\r\n\tcolor: ${props => props.theme.colors.error};\r\n`\r\n\r\nconst Field = ({\r\n\tlabel,\r\n\trequired,\r\n\tname,\r\n\ttype,\r\n\tformik,\r\n\tinputLabel,\r\n\tcontentBeforeField,\r\n\t...rest\r\n}) => {\r\n\tconst isArray = name === 'person.tels'\r\n\t// const component = data =>\r\n\t//   type === 'string' ? data :\r\n\t//   type === 'tel' ? <FormikTel tel={data} />\r\n\t//   : null\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Label\r\n\t\t\t\tclassName='fz-formFieldLabel'\r\n\t\t\t\trequired={required}\r\n\t\t\t>\r\n\t\t\t\t{label}\r\n\t\t\t</Label>\r\n\t\t\t<Content>\r\n\t\t\t\t{isArray\r\n\t\t\t\t\t? <FieldArray\r\n\t\t\t\t\t\t\tname={name}\r\n\t\t\t\t\t\t\trender={arrayHelpers => (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{getIn(formik.values, name).map((_, i) => \r\n\t\t\t\t\t\t\t\t\t\t<Fragment\r\n\t\t\t\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormikTel\r\n\t\t\t\t\t\t\t\t\t\t\t\tbaseName={`${name}.${i}`}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t: <>\r\n\t\t\t\t\t\t\t<InputContainer>\r\n\t\t\t\t\t\t\t\t{contentBeforeField}\r\n\t\t\t\t\t\t\t\t<FormikInput\r\n\t\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t\t\tname={name}\r\n\t\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</InputContainer>\r\n\t\t\t\t\t\t\t<Error>\r\n\t\t\t\t\t\t\t\t{getIn(formik.touched, name) ? getIn(formik.errors, name) : ''}\r\n\t\t\t\t\t\t\t</Error>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t</Content>\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\nexport default connect(Field)","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertModel } from '../../graphql/model'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/model'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\nexport default class ModelForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      model,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries,\r\n      onSubmit,\r\n    } = this.props\r\n    let schema = model ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = model ? projectEntity(model, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertModel}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertModel, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('upsertModel input > ', input)\r\n              const upserted = await upsertModel({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return model\r\n                ? toggleEditMode()\r\n                : this.didMount && onSubmit(upserted.data.upsertModel.id)\r\n            }}\r\n          >\r\n            {({\r\n              handleSubmit,\r\n              handleReset,\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label='Наименование'\r\n                  name='name'\r\n                  required\r\n                />\r\n                <Field\r\n                  label='Артикул'\r\n                  name='article'\r\n                />\r\n                {!!error &&\r\n                  <Message\r\n                    d='block !important'\r\n                    error\r\n                    header='Не удалось добавить..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  type='button'\r\n                  primary\r\n                  content={model ? 'Сохранить' : 'Добавить'}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ model ? toggleEditMode : handleReset}\r\n                >\r\n                  {model ? 'Отмена' : 'Очистить'}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport validateInn from '../../utils/validateInn'\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { allEnquiries, createEnquiry, updateEnquiry } from '../../graphql/enquiry'\r\nimport { createOrg } from '../../graphql/org'\r\nimport { allOrgsAndModels } from '../../graphql/combinedQueries'\r\n\r\nimport styled from 'styled-components'\r\nimport { Form, Input, Message, Dropdown as SDropdown } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Button, Section } from '../styled/styled-semantic.js'\r\nimport DatePicker from '../common/DatePicker'\r\nimport SecondarySection from '../presentational/SecondarySection'\r\nimport ModelForm from '../Model/Form'\r\n\r\nconst Dropdown = styled(SDropdown)`\r\n\t&&&&&& {\r\n\t\twidth: 350px;\r\n\t\t&:hover {\r\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n\t\t}\r\n\t}\r\n`\r\n\r\nclass EnquiryEdit extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEnquiry = props.id === 'new'\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tthis.state = {\r\n\t\t\tloading: false,\r\n\t\t\t// if any of the form fields has error, the following err prop should always contain non empty string error message with explanaition \r\n\t\t\terr: {\r\n\t\t\t\tmessage: ''\r\n\t\t\t},\r\n\t\t\torgDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tmodelDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tnewModelMode: false\r\n\t\t}\r\n\t\t// gather form fields on oriEnquiry object\r\n\t\tconst oriEnquiry = cloneDeep(props.enquiry)\r\n\t\t// console.log('props.enquiry > ', props.enquiry)\r\n\t\tif (isNewEnquiry) oriEnquiry.dateLocal = toLocalISOString(new Date()).slice(0, 10)\r\n\t\tdelete oriEnquiry.events\r\n\t\toriEnquiry.orgId = oriEnquiry.org ? oriEnquiry.org.id : null\r\n\t\toriEnquiry.modelId = oriEnquiry.model ? oriEnquiry.model.id : null\r\n\t\toriEnquiry.qty = oriEnquiry.qty ? oriEnquiry.qty : ''\r\n\t\t// console.log('oriEnquiry > ', oriEnquiry)\r\n\t\tthis.fields = Object.keys(oriEnquiry)\r\n\t\t\t.filter(key => !['__typename', 'id', 'num', 'org', 'model'].includes(key))\r\n\t\t// console.log('this.fields > ', this.fields)\r\n\t\tthis.requiredFields = ['dateLocal', 'orgId', 'modelId', 'qty']\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\t// console.log(key, oriEnquiry[key])\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tcurVal: oriEnquiry[key],\r\n\t\t\t\t// err bool controls weather the field is heighlighted with error (red) style\r\n\t\t\t\terr: false,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!isNewEnquiry && {\r\n\t\t\t\t\toriVal: oriEnquiry[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (!isNewEnquiry) this.state.diff = false\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tcloseNewModelSection = () => this.setState({ newModelMode: false })\r\n\tchangeFieldValue = (field, newVal) => {\r\n\t\tconsole.log('change ', field, ' to value > ', newVal)\r\n\t\tconst fieldObj = cloneDeep(this.state[field])\r\n\t\tfieldObj.curVal = newVal\r\n\t\tfieldObj.err = false\r\n\t\tif (!this.isNewEnquiry) fieldObj.diff = fieldObj.curVal !== fieldObj.oriVal\r\n\t\tconst diff = this.fields.filter(f => f !== field).map(f => this.state[f].diff).includes(true) || fieldObj.diff\r\n\t\tthis.setState({ [field]: fieldObj, diff, err: { message: '' } })\r\n\t}\r\n\tselectDay = (pickedDate) => {\r\n\t\tif (!isValidDate(pickedDate)) return this.setState({ \r\n\t\t\tdateLocal: { ...this.state.dateLocal, err: true },\r\n\t\t\terr: { title: 'Ошибка ввода даты', message: 'Дата заявки не соответствует формату дат' } \r\n\t\t})\r\n\t\tthis.changeFieldValue('dateLocal', toLocalISOString(pickedDate).slice(0, 10))\r\n\t}\r\n\thandleOrgDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\torgDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleModelDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\tmodelDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleQtyInputChange = ( e, { value } ) => {\r\n\t\tconst newVal = parseInt(value, 10) || ''\r\n\t\tthis.changeFieldValue('qty', newVal)\r\n\t}\r\n\tselectOrg = (e, { value }) => {\r\n\t\tthis.setState({ orgDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('orgId', value)\r\n\t}\r\n\tselectModel = (e, { value }) => {\r\n\t\tthis.setState({ modelDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('modelId', value)\r\n\t}\r\n\tsubmitNewModel = (modelId) => {\r\n\t\tthis.changeFieldValue('modelId', modelId)\r\n\t\tthis.closeNewModelSection()\r\n\t}\r\n\tcreateOrg = async (e, { value: inn }) => {\r\n\t\ttry {\r\n\t\t\tlet err = {}\r\n\t\t\tconst isValidInn = validateInn(inn, err)\r\n\t\t\tif (!isValidInn) throw new Error(err.message)\r\n\t\t\tthis.setState({ orgDdn: { search: inn, loading: true} })\r\n\t\t\tconst data = await this.props.createOrg({ variables: { inn } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.selectOrg(null, { value: data.data.createOrg.id } )\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Добавить организацию по ИНН не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t},\r\n\t\t\t\torgDdn: {\r\n\t\t\t\t\tsearch: inn,\r\n\t\t\t\t\tloading: false\r\n\t\t\t\t},\r\n\t\t\t\torgId: {\r\n\t\t\t\t\t...this.state.orgId,\r\n\t\t\t\t\terr: true\r\n\t\t\t\t}\r\n\t\t\t })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst enquiry = {}\r\n\t\t// take out only changed fields for update\r\n\t\tthis.fields.forEach(f => {\r\n\t\t\tif (this.isNewEnquiry || this.state[f].diff) enquiry[f] = this.state[f].curVal\r\n\t\t})\r\n\t\tconst variables = { ...enquiry }\r\n\t\tif (this.isNewEnquiry) return this.createEnquiry(variables)\r\n\t\tvariables.id = this.props.id\r\n\t\tthis.updateEnquiry(variables)\r\n\t}\r\n\tcreateEnquiry = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.createEnquiry({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid: res.data.createEnquiry.id\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Создать не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tupdateEnquiry = async (variables) => {\r\n\t\tconst { id, updateEnquiry, setDetails } = this.props\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tawait updateEnquiry({ variables: { input: variables } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tsetDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ \r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Сохранить не удалось..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { dateLocal, orgId, orgDdn, modelId, modelDdn, qty, diff, loading, err, newModelMode } = this.state\r\n\t\tconst { id, setDetails, allOrgsAndModels } = this.props\r\n\t\tconst selectedDate = fromLocalISOString(dateLocal.curVal)\r\n\t\tconst orgs = allOrgsAndModels.orgs\r\n\t\tconst models = allOrgsAndModels.models\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst someFieldHasError = this.fields.some(f => !!this.state[f].err)\r\n\t\treturn (\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<Section\r\n\t\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t\t<DatePicker\r\n\t\t\t\t\t\t\t\t\t\terror={dateLocal.err}\r\n\t\t\t\t\t\t\t\t\t\tselectedDate={selectedDate}\r\n\t\t\t\t\t\t\t\t\t\tselectDay={this.selectDay} />\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t<Form.Field inline error={orgId.err} required>\r\n\t\t\t\t\t\t\t\t\t<Label>Организация</Label>\r\n\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\tloading={!orgs || orgDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={id !== 'new' || !orgs || orgDdn.loading} //org cannot be changed when editing existing enquiry\r\n\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Поиск по наименованию или ИНН'\r\n\t\t\t\t\t\t\t\t\t\toptions={ orgs ? orgs.map(o => ({key:o.id, value: o.id, text: o.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\tvalue={orgId.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.selectOrg}\r\n\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\tsearchQuery={orgDdn.search}\r\n\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleOrgDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\tnoResultsMessage='Если не найдено, введите ИНН, чтобы добавить.'\r\n\t\t\t\t\t\t\t\t\t\tallowAdditions\r\n\t\t\t\t\t\t\t\t\t\tadditionLabel='Добавить по ИНН: '\r\n\t\t\t\t\t\t\t\t\t\tonAddItem={this.createOrg}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t{!newModelMode\r\n\t\t\t\t\t\t\t\t\t? <Form.Field\r\n\t\t\t\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\terror={modelId.err}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label>Изделие</Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder='Поиск по наименованию или артикулу'\r\n\t\t\t\t\t\t\t\t\t\t\t\toptions={ models ? models.map(m => ({key:m.id, value: m.id, text: m.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={modelId.curVal}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.selectModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery={modelDdn.search}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleModelDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tnoResultsMessage='Если не найдено, выберите \"Нет в списке\"'\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tml='5px'\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={newModelMode}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.setState({ newModelMode: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t\t: <SecondarySection\r\n\t\t\t\t\t\t\t\t\t\t\ttitle='Новое изделие'\r\n\t\t\t\t\t\t\t\t\t\t\tonClose={this.closeNewModelSection}\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ModelForm\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmodel={undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId={orgId.curVal || undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trefetchQueries={allOrgsAndModels.refetch}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonSubmit={this.submitNewModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t\t<Label>Кол-во</Label>\r\n\t\t\t\t\t\t\t\t\t<Input type='number'\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Введите кол-во шт.' \r\n\t\t\t\t\t\t\t\t\t\tvalue={qty.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleQtyInputChange} />\r\n\t\t\t\t\t\t\t\t\t<Span pl='6px'>шт.</Span>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\thidden={!err.message}\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} />\r\n\t\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\t\tcontent={this.isNewEnquiry ? 'Создать' : 'Сохранить'}\r\n\t\t\t\t\t\t\t\tdisabled={(!this.isNewEnquiry && !diff) || !!err.message || someFieldHasError || !!orgId.loading || requiredIsEmpty}\r\n\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\tonClick={this.submit} />\r\n\t\t\t\t\t\t\t<A cancel \r\n\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? () => setDetails(null)\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tОтмена\r\n\t\t\t\t\t\t\t</A>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(createOrg, { \r\n\t\tname: 'createOrg',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createOrg }}) => {\r\n\t\t\t\tconst query = allOrgsAndModels\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tdata.orgs.push(createOrg)\r\n\t\t\t\tdata.orgs.sort((a, b) => a.name > b.name)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n\tgraphql(allOrgsAndModels, { name: 'allOrgsAndModels' }),\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiry, { \r\n\t\tname: 'createEnquiry',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createEnquiry }}) => {\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tcreateEnquiry.isExpanded = false\r\n\t\t\t\tdata.enquiries.unshift(createEnquiry)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n)(EnquiryEdit)","import React, { Component } from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.err && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nclass LocalDatePicker extends Component {\r\n\thandleDayChange = (pickedDate) => {\r\n\t\t// console.log('pickedDate > ', pickedDate)\r\n\t\tconst { setField, field: { name }} = this.props\r\n\t\tif (!isValidDate(pickedDate)) {\r\n\t\t\tsetField(name, {\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: 'Ошибка ввода даты', \r\n\t\t\t\t\tmessage: 'Дата не соответствует формату ГГГГ-ММ-ДД'\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tsetField(name, {\r\n\t\t\tvalue: toLocalISOString(pickedDate).slice(0, 10)\r\n\t\t})\r\n\t}\r\n\trender() {\r\n\t\tconst { field: {curVal: value, err} } = this.props\r\n\t\treturn (\r\n\t\t\t<PickerDiv err={!!err}>\r\n\t\t\t\t<DayPickerInput\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonDayChange={this.handleDayChange}\r\n\t\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\t\tmonth: fromLocalISOString(value)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</PickerDiv>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default LocalDatePicker\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport NumberFormat from 'react-number-format'\r\n\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Span } from '../styled/styled-semantic'\r\n\r\nclass CurrencyInput extends Component {\r\n\trender() {\r\n\t\tconst { placeholder, field: {name, curVal: value}, setField } = this.props\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<NumberFormat\r\n\t\t\t\t\tcustomInput={Input}\r\n\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tdecimalSeparator=','\r\n\t\t\t\t\tthousandSeparator=' '\r\n\t\t\t\t\tdecimalScale={2}\r\n\t\t\t\t\tallowNegative={false}\r\n\t\t\t\t\tonValueChange={values => setField(name, {value: values.floatValue})}\r\n\t\t\t\t/>\r\n\t\t\t\t<Span pl='6px' fs='1.1rem' c='rgba(0,0,0,.87)'>₽</Span>\r\n\t\t\t\t<Span pl='9px' fs='1.1rem' ws='0.1em'>с НДС</Span>\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default CurrencyInput\r\n","import { Component } from 'react'\r\n\r\nclass SmartForm extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEntity = props.isNewEntity\r\n\t\t// gather original form fields' values from provided object\r\n\t\tconst oriEntity = props.entity\r\n\t\tthis.fields = Object.keys(oriEntity)\r\n\t\tthis.requiredFields = props.requiredFields\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.state = {}\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tname: key,\r\n\t\t\t\tcurVal: oriEntity[key],\r\n\t\t\t\terr: null,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!this.isNewEntity && {\r\n\t\t\t\t\toriVal: oriEntity[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tsetField = (field, {value, err}) => {\r\n\t\t// console.log('field, value, err > ', field, value, err)\r\n\t\tthis.setState({\r\n\t\t\t[field]: {\r\n\t\t\t\t...this.state[field],\r\n\t\t\t\t...value && {\r\n\t\t\t\t\tcurVal: value,\r\n\t\t\t\t\t...!this.isNewEntity && { diff: value !== this.state[field].oriVal },\r\n\t\t\t\t},\r\n\t\t\t\terr: err || null,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst entity = this.fields.reduce((entity, f) => {\r\n\t\t\tentity[f] = this.state[f].curVal\r\n\t\t\treturn entity\r\n\t\t}, {})\r\n\t\tthis.props.submit(entity)\r\n\t}\r\n\trender() {\r\n\t\tconst { children } = this.props\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst diff = this.isNewEntity ? null : this.fields.map(f => this.state[f].diff).includes(true)\r\n\t\tconst err = this.fields.map(f => this.state[f].err).find(err => !!err)\r\n\t\tconst state = {\r\n\t\t\tdisabled: (!this.isNewEntity && !diff) || requiredIsEmpty || !!err,\r\n\t\t\terr: err || this.props.err,\r\n\t\t\tsetField: this.setField,\r\n\t\t\tsubmit: this.submit,\r\n\t\t\tformState: this.state\r\n\t\t}\r\n\t\t// @ts-ignore\r\n\t\treturn children(state)\r\n\t}\r\n}\r\n\r\nexport default SmartForm","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Header, Form, Message, Button, Divider } from 'semantic-ui-react'\r\nimport { Div, A, Label, Section } from '../styled/styled-semantic'\r\n\r\nimport LocalDatePicker from '../common/LocalDatePicker'\r\nimport CurrencyInput from '../common/CurrencyInput'\r\nimport SmartForm from '../common/SmartForm'\r\n\r\nimport { toLocalISOString } from '../../utils/dates'\r\n\r\nclass EnquiryCommercialOffer extends Component {\r\n\trender() {\r\n\t\tconst { cancel, submit, loading } = this.props\r\n\t\tconst isNewCO = this.props.id === 'new'\r\n\t\tconst co = isNewCO\r\n\t\t?   {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tamount: ''\r\n\t\t\t} \r\n\t\t:   {\r\n\t\t\t\tdateLocal: this.props.co.dateLocal,\r\n\t\t\t\tamount: this.props.co.amount\r\n\t\t\t}\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewCO}\r\n\t\t\t\tentity={co}\r\n\t\t\t\trequiredFields={['dateLocal', 'amount']}\r\n\t\t\t\tsubmit={submit}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\thead\r\n\t\t\t\t\t\tminor\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\ttopBorder\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\tКоммерческое предложение\r\n\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Сумма</Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите сумму КП'\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tsmall\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\tcontent={'Создать'}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit} />\r\n\t\t\t\t\t\t<A cancel onClick={cancel}>Отмена</A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Divider fitted/>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default EnquiryCommercialOffer","import React, { Component, Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n// TODO use List instead of entity-table\r\nimport { Table, Tr, Td, InputTd, EditorTd } from '../styled/entity-table'\r\nimport { Header as SHeader, Icon, Label, Form, Comment, \r\n\tMessage, Dropdown } from 'semantic-ui-react'\r\nimport { P, Div, Button, Section } from '../styled/styled-semantic'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { enquiryDetails, newEnquiry, createEnquiryEvent, \r\n\tenquiryFragment, allEnquiries, updateEnquiry } from '../../graphql/enquiry'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport WrappedDraftEditor from '../common/WrappedDraftEditor'\r\nimport { sanitize } from 'dompurify'\r\nimport { currency } from '../../utils/format'\r\n\r\nimport EnquiryEdit from './Edit'\r\nimport EnquiryCommercialOffer from './EnquiryCommercialOffer'\r\n\r\nconst SDropdown = styled(Dropdown)`\r\n\t& .active.item {\r\n\t\tdisplay: none !important;\r\n\t}\r\n\t& .selected.item {\r\n\t\tbackground: none !important;\r\n\t}\r\n`\r\n\r\nconst Comments = styled(Comment.Group)`\r\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\r\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\r\n`\r\n\r\nconst CIcon = styled(Icon)`\r\n\t// apply horizontal offset correction for different icons to be vertically alined\r\n  width: ${props => (props.type === 'CREATE') ? '1.73em' : '1.4em' } !important;\r\n\t${props => (props.type === 'CREATE') && 'margin-left: -0.33em !important;'}\r\n  margin-top: .15em !important;\r\n\tfloat: left;\r\n\topacity: 0.6 !important;\r\n`\r\n\r\nconst UserLabel = styled(Label)`\r\n  width: 2em;\r\n  height: 2em;\r\n  margin-left: 0 !important;\r\n  padding: .4em 0em !important;\r\n  float: left;\r\n\ttext-align: center;\r\n\t${props => props.indent && 'margin-left: 42.69px !important;'}\r\n\t// ${props => props.indent && 'margin-left: calc(1.4em + 0.25rem) !important;'}\r\n`\r\n\r\nconst CContent = styled(Comment.Content)`\r\n  margin-left: 6.5em !important;\r\n`\r\n\r\nconst CMetadata = styled(Comment.Metadata)`\r\n\tmargin-left: 0 !important;\r\n  color: rgba(0,0,0,.6) !important;\r\n`\r\n\r\nconst CText = styled(Comment.Text)`\r\n\t& p { margin: 0 !important; }\r\n\t&>table { \r\n\t\twidth: 100%;\r\n\t\tborder-collapse: collapse; \r\n\t}\r\n\t&>table>tbody>tr>td {\r\n\t\tpadding-left: 4px;\r\n\t\tvertical-align: top;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(1) {\r\n\t\twidth: 5px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(2) {\r\n\t\twidth: 25px;\r\n\t\tmin-width: 90px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(3) {\r\n\t\tpadding-left: 10px;\r\n\t\twidth: 1000px;\r\n\t\tmin-width: 240px;\r\n\t}\r\n\t&>table>tbody>tr>td>span {\r\n\t\tmargin-right: 5px;\r\n\t}\r\n`\r\n\r\nconst CMessage = styled(Message)`\r\n\tmargin-left: 6.35em !important;\r\n`\r\n\t\r\nclass EnquiryDetails extends Component {\r\n\tisNewEnquiry = this.props.id === 'new'\r\n\teditorRef = React.createRef()\r\n\tnoteEditorRef = React.createRef()\r\n\tcomponentIsMounted = true\r\n  state = {\r\n\teditMode: this.isNewEnquiry ? true : false,\r\n\t\teditorHasText: false,\r\n\t\tnoteEditorDiff: false,\r\n\t\tnoteKey: 1,\r\n\t\tactiveCO: '',\r\n\t\tloading: false,\r\n\t\tcreatingComment: false,\r\n\t\tchangingStatus: false,\r\n\t\tstatusPending: false,\r\n\t\tsavingNote: false,\r\n\t\terror: ''\r\n\t}\r\n\t// refetchEnquiry = async () => {\r\n\t// \tthis.setState({ loading: true })\r\n\t// \tconst res = await this.props.enquiryQuery.refetch()\r\n\t// \tthis.setState({ loading: false })\r\n\t// }\r\n\tenableEditMode = () => this.setState({ editMode: true })\r\n\texitEditMode = () => this.setState({ editMode: false })\r\n\tsetEditorHasText = (bool) => this.setState({ editorHasText: bool })\r\n\tsetNoteEditorDiff = (bool) => this.setState({ noteEditorDiff: bool })\r\n\tcancelEdit = () => {\r\n\t\tif (this.isNewEnquiry) return this.props.closeDetails()\r\n\t\tthis.exitEditMode()\r\n  }\r\n  createComment = async () => {\r\n\t\ttry {\r\n\t\t\tconst htmlText = this.editorRef.current.exportHtml()\r\n\t\t\t// if (htmlText === '<p><br></p>') return\r\n\t\t\tif (htmlText === null) return\r\n\t\t\tthis.setState({creatingComment: true})\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\thtmlText\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ creatingComment: false, editorHasText: false, error: '' })\r\n\t\t\tthis.editorRef.current.clear()\r\n\t\t} catch(err) {\r\n\t\t\tthis.setState({ creatingComment: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tchangeStatus = async (e, { value, co }) => {\r\n\t\tconst coStatusId = this.props.enquiryQuery.statuses.find(s => s.name === 'Выставлено КП').id\r\n\t\tif (value === coStatusId) {\r\n\t\t\tif (!this.state.statusPending) return this.setState({ statusPending: true, activeCO: 'new' })\r\n\t\t\telse this.setState({ statusPending: false })\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tthis.setState({ changingStatus: true })\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\tstatusId: value,\r\n\t\t\t\t\t...(co && { doc: { ...co } })\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ changingStatus: false, activeCO: '' })\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({ changingStatus: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcancelPendingStatusChange = () => {\r\n\t\tthis.setState({ statusPending: false, activeCO: '' })\r\n\t}\r\n\tsaveNote = async () => {\r\n\t\ttry {\r\n\t\t\tlet htmlNote = this.noteEditorRef.current.exportHtml()\r\n\t\t\tif (htmlNote === this.props.enquiryQuery.enquiry.htmlNote) {\r\n\t\t\t\treturn this.setState({ noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t\t}\r\n\t\t\tthis.setState({ savingNote: true })\r\n\t\t\tawait this.props.updateEnquiry({ \r\n\t\t\t\tvariables: { input: { id: this.props.id, htmlNote } } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: '', noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n  render() { \r\n\t\tconst { editorHasText, creatingComment, changingStatus, statusPending, \r\n\t\t\t\terror, noteEditorDiff, noteKey, savingNote, activeCO } = this.state\r\n\t\tconst { enquiryQuery } = this.props\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tif (enquiryQuery.loading) return <Section>Загрузка...</Section>\r\n\t\tif (enquiryQuery.error) return <Section>Ошибка {enquiryQuery.error.message}</Section>\r\n\t\tconst enquiry = isNewEnquiry ? enquiryQuery.newEnquiry : enquiryQuery.enquiry\r\n\t\tconst { org, model, qty, htmlNote, events } = enquiry\r\n\t\tconst coEvents = events && events.filter(e => e.doc)\r\n\t\tconst curStatus = events && events.filter(e => e.status).pop().status\r\n\t\t// rawStatuses - received from server\r\n\t\tconst rawStatuses = enquiryQuery.statuses.slice()\r\n\t\tconst coStatusId = rawStatuses.find(s => s.name === 'Выставлено КП').id\r\n\t\tconst orderStatusId = rawStatuses.find(s => s.name === 'Заказ').id\r\n\t\tconst refusalStatusIds = rawStatuses.filter(s => ['Нет возможности', 'Отказ'].includes(s.name)).map(s => s.id)\r\n\t\t// sort statuses so that refusal statuses are at the end of their stage block\r\n\t\tconst statuses = rawStatuses.sort((a, b) => a.stage === b.stage && refusalStatusIds.includes(a.id))\r\n\t\tlet stage = 0\r\n\t\tconst eventStatusPresentationHelpers = events && events.reduce((res, e, i) => {\r\n\t\t\tif (!e.status || i === 0) return res = [...res, null]\r\n\t\t\tif (refusalStatusIds.includes(e.status.id)) return [...res, 'refuse']\r\n\t\t\tif (e.status.id === orderStatusId) return [...res, 'order']\r\n\t\t\tres.push(e.status.stage - stage > 0 ? 'up' : 'down')\r\n\t\t\tstage = e.status.stage\r\n\t\t\treturn res\r\n\t\t}, [])\r\n\t\treturn (\r\n\t\t\t<GlobalContext>\r\n\t\t\t\t{({ details, setDetails }) => {\r\n\t\t\t\t\tconst { id, editMode } = details\r\n\t\t\t\t\tconst isNewEnquiry = id === 'new'\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t{ (editMode || isNewEnquiry) &&\r\n\t\t\t\t\t\t\t\t<EnquiryEdit\r\n\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\tenquiry={enquiry}\r\n\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{ !(editMode || isNewEnquiry) && <Fragment>\r\n\t\t\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t\t\t<Table><tbody>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Организация</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{org && org.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Изделие</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{model && model.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Кол-во, шт.</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{qty}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t{ !!coEvents.length &&\r\n\t\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td>КП</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{coEvents.map(({ doc: { id, dateLocal, amount } }) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<P key={id} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfw='normal'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlh='1.21428571em' >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b>{currency(amount)} </b> ( от {dateLocal} )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</P>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tr> }\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Примечания</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={noteKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderless\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tref={this.noteEditorRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitFromHtml={htmlNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetEditorDiff={this.setNoteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdiff={noteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonCtrlEnter={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{noteEditorDiff &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmt='.67857143em'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent='Сохранить примечание'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon='save'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfloated='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>Статус</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<SDropdown labeled button className='icon'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={changingStatus}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={changingStatus || statusPending}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={curStatus.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={curStatus.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toptions={statuses\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(s => (s.id === curStatus.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|| Math.abs(s.stage - curStatus.stage) === 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& !(s.stage === 0 && curStatus.stage !== 0))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// && !(s.name === 'Выставлено КП'))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map(s => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: s.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: { \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbasic: true, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: 'ст', \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetail: s.stage, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon:   refusalStatusIds.includes(s.id) ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ts.id === orderStatusId ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`long arrow alternate ${(s.stage - curStatus.stage) > 0 ? 'up' : 'down' }`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.changeStatus} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t</SDropdown>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label basic size='large' content='стадия' detail={ curStatus.stage} />\r\n\t\t\t\t\t\t\t\t\t\t\t</InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t</tbody></Table>\r\n\t\t\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t\t\t{ activeCO && \r\n\t\t\t\t\t\t\t\t\t<EnquiryCommercialOffer \r\n\t\t\t\t\t\t\t\t\t\tid={activeCO} \r\n\t\t\t\t\t\t\t\t\t\tsubmit={(co) => this.changeStatus(null, { value: coStatusId, co })}\r\n\t\t\t\t\t\t\t\t\t\tcancel={this.cancelPendingStatusChange} />}\r\n\t\t\t\t\t\t\t\t<Comments minimal>\r\n\t\t\t\t\t\t\t\t\t<SHeader as='h3' dividing content='Комментарии и события' />\r\n\t\t\t\t\t\t\t\t\t{ events.map((e, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { fName, lName } = e.user.person\r\n\t\t\t\t\t\t\t\t\t\tconst userInitials = (lName ? fName.slice(0,1) : fName.slice(0,2)) + (lName ? lName.slice(0,1) : '')\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<Comment key={e.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ e.type && (e.type !== 'COMMENT') &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CIcon \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' type={e.type}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor={ e.type === 'CREATE' ? 'green' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'blue' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'up' ? 'yellow' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'down' ? 'brown' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'red' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'green' : 'grey'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname ={ e.type === 'CREATE' ? 'plus' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'write square' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' ? `long arrow alternate ${eventStatusPresentationHelpers[i]}` : 'question'} /> }\r\n\t\t\t\t\t\t\t\t\t\t\t\t<UserLabel \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={userInitials}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindent={!e.type || e.type === 'COMMENT' ? 1 : 0} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CMetadata\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={e.datetimeLocal.slice(0,16)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CText dangerouslySetInnerHTML={{__html: sanitize(e.htmlText)}} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t</Comment>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t<Form reply error={!!error}>\r\n\t\t\t\t\t\t\t\t\t\t<Div m='0 0 1em 6.35em'>\r\n\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\tref={this.editorRef} \r\n\t\t\t\t\t\t\t\t\t\t\t\tsetEditorHasText={this.setEditorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSave={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t<CMessage\r\n\t\t\t\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\t\t\t\theader='Коммент добавить не удалось..'\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={error}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Button content='Добавить коммент' labelPosition='left' icon='edit' primary floated='right' \r\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={!editorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={creatingComment}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t\t</Comments>\r\n\t\t\t\t\t\t\t</Fragment> }\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t)\r\n\t\t\t\t}}\r\n\t\t\t</GlobalContext>\r\n\t\t)\r\n  }\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiryEvent, { \r\n\t\tname: 'createEnquiryEvent',\r\n\t\toptions: (props) => ({\r\n\t\t\tupdate: (cache, {data: reponseData}) => {\r\n\t\t\t\tconst newEvent = reponseData.createEnquiryEvent\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst id = `Enquiry:${props.id}`\r\n\t\t\t\tconst fragment = enquiryFragment\r\n\t\t\t\tlet data = cache.readFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment\r\n\t\t\t\t})\r\n\t\t\t\tdata.events.push(newEvent)\r\n\t\t\t\tcache.writeFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment,\r\n\t\t\t\t\tdata\r\n\t\t\t\t})\r\n\t\t\t\t// also update allEnquiries if status changed (for EnquiryTable view update)\r\n\t\t\t\tif (! newEvent.status) return\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tdata = cache.readQuery({ query })\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === props.id)\r\n\t\t\t\tenquiry.status = newEvent.status\r\n\t\t\t\tif (newEvent.doc) enquiry.docs.push(newEvent.doc)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t})\r\n  }),\r\n\tgraphql(newEnquiry, { name: 'enquiryQuery', skip: (props) => props.id !== 'new' }),\r\n\tgraphql(enquiryDetails, { name: 'enquiryQuery', skip: (props) => props.id === 'new' })\r\n)(EnquiryDetails)","import React, { Component, createRef } from 'react'\r\nimport debounce from 'lodash/debounce'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { isNaN } from '../../utils/format'\r\n\r\n// INFO built-in handling of 'int' number type\r\n// TODO think about integrating other input types (currency, etc..)\r\nclass SmartInput extends Component {\r\n\tstate = {\r\n\t\tvalue: (this.props.field && this.props.field.curVal) || ''\r\n\t}\r\n\tinput = createRef()\r\n\tdebouncedSetField = debounce(value => {\r\n    const { field: { name }, setField } = this.props\r\n    setField(name, { value })\r\n\t}, 250)\r\n\twriteVal = (value) => {\r\n\t\tthis.setState({ value })\r\n\t\tthis.debouncedSetField(value)\r\n\t}\r\n\thandleInputChange = ( e, { value } ) => {\r\n\t\tif (value === '') return this.writeVal('')\r\n\t\tconst { type } = this.props\r\n\t\t// block/parse invalid integer input for 'int' input type\r\n\t\tif (type === 'int') {\r\n\t\t\tconst intVal = parseInt(value, 10)\r\n\t\t\treturn intVal && this.writeVal(intVal)\r\n\t\t}\r\n\t\treturn this.writeVal(value)\r\n\t}\r\n\t// onChanged isn't fired on input with type[\"number\"]\r\n\t// when user mixes numbers with symbols -,. for ex -> '234234,,,,,,,234'\r\n\t// so I check valueAsNumber html input attr onBlur and set error\r\n\tonBlur = () => {\r\n\t\tconst { field: { name }, setField } = this.props\r\n\t\tconst { type, valueAsNumber } = this.input.current.children[0] || {}\r\n\t\tif (type === 'number' && isNaN(valueAsNumber)) {\r\n\t\t\tsetField(name, { err: {\r\n\t\t\t\ttitle: 'Ошибка в поле \"Количество\"',\r\n\t\t\t\tmessage: 'Недопустимое значение'\r\n\t\t\t} })\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { field, setField, type, ...rest } = this.props\r\n\t\tconst { value } = this.state\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\t{...rest}\r\n\t\t\t\ttype={type === 'int' ? 'number' : (type || 'text')}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\tonBlur={this.onBlur}\r\n\t\t\t\tref={this.input}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default SmartInput\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Form, Button, Message } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Section } from '../styled/styled-semantic.js'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { orderLocal, upsertOrder } from '../../graphql/order'\r\nimport { allEnquiries } from '../../graphql/enquiry'\r\n\r\nimport { toLocalISOString } from '../../utils/dates'\r\n\r\nimport LocalDatePicker from '../common/LocalDatePicker'\r\nimport CurrencyInput from '../common/CurrencyInput'\r\nimport SmartForm from '../common/SmartForm'\r\nimport SmartInput from '../common/SmartInput'\r\n\r\nclass OrderEdit extends Component {\r\n\tcomponentIsMounted = true\r\n\tisNewEntity = this.props.id === 'new'\r\n\tstate = {\r\n\t\tloading: false,\r\n\t\terr: null\r\n\t}\r\n\tsubmit = (entity) => {\r\n\t\tthis.upsertOrder({\r\n\t\t\t...entity,\r\n\t\t\t...this.isNewEntity && {\r\n\t\t\t\tenquiryId: this.props.enquiryId,\r\n\t\t\t},\r\n\t\t\t...!this.isNewEntity && {\r\n\t\t\t\tid: this.props.id,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tupsertOrder = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.upsertOrder({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: null })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Order',\r\n\t\t\t\tid: res.data.upsertOrder.id\r\n\t\t\t})\r\n\t\t\tthis.props.setExpanded({\r\n\t\t\t\tid: res.data.upsertOrder.enquiry.id,\r\n\t\t\t\tvalue: true\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: `${this.isNewEntity ? 'Создать' : 'Сохранить'} не удалось..`,\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { loading } = this.state\r\n\t\tconst { id, closeDetails, setDetails } = this.props\r\n\t\tconst isNewEntity = id === 'new'\r\n\t\tconst order = isNewEntity\r\n\t\t\t? {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tqty: '',\r\n\t\t\t\tamount: ''\r\n\t\t\t}\r\n\t\t\t: this.props.orderLocal.orderLocal\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewEntity}\r\n\t\t\t\tentity={order}\r\n\t\t\t\trequiredFields={['dateLocal', 'qty', 'amount']}\r\n\t\t\t\tsubmit={this.submit}\r\n\t\t\t\terr={this.state.err}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, qty, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label>Дата</Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Кол-во</Label>\r\n\t\t\t\t\t\t\t\t<SmartInput\r\n\t\t\t\t\t\t\t\t\ttype='number'\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите кол-во шт.'\r\n\t\t\t\t\t\t\t\t\tfield={qty}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Span pl='6px'>шт.</Span>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>Сумма</Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='Введите сумму заказа'\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\tcontent={this.isNewEntity ? 'Создать' : 'Сохранить'}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<A cancel\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? closeDetails\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tОтмена\r\n\t\t\t\t\t\t</A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(upsertOrder, {\r\n\t\t\tname: 'upsertOrder',\r\n\t\t\toptions: {\r\n\t\t\t\tupdate: (cache, { data: responseData }) => {\r\n\t\t\t\t\tconst upsertedOrder = responseData.upsertOrder\r\n\t\t\t\t\tconst query = allEnquiries\r\n\t\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === upsertedOrder.enquiry.id)\r\n\t\t\t\t\tenquiry.orders = [\r\n\t\t\t\t\t\t...enquiry.orders.filter(o => o.id !== upsertedOrder.id),\r\n\t\t\t\t\t\tupsertedOrder\r\n\t\t\t\t\t].sort((a, b) => a.fullnum > b.fullnum ? 1 : -1)\r\n\t\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}),\r\n\tgraphql(orderLocal, {\r\n\t\tname: 'orderLocal',\r\n\t\tskip: (props) => props.id === 'new'\r\n\t}),\r\n)(OrderEdit)","import React, { forwardRef } from 'react'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\n\r\nexport default forwardRef(({\r\n\tbuttons,\r\n\tsize,\r\n\tnoIndent,\r\n\tbottomBorder,\r\n\ttitle,\r\n\tsubtitle,\r\n\ttitleSize,\r\n\tonClick,\r\n\t// expandable\r\n\texpanded,\r\n}, ref) => {\r\n\treturn (\r\n\t\t<DetailsHeaderContainer\r\n\t\t\tref={ref}\r\n\t\t\texpanded={expanded}\r\n\t\t\tonClick={onClick}\r\n\t\t\tsize={size}\r\n\t\t\tnoIndent={noIndent}\r\n\t\t\tbottomBorder={bottomBorder}\r\n\t\t>\r\n\t\t\t<DetailsHeaderTitle\r\n\t\t\t\ttitle={title}\r\n\t\t\t\tsubtitle={subtitle}\r\n\t\t\t\tsize={titleSize || size}\r\n\t\t\t/>\r\n\t\t\t{ buttons &&\r\n\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t{buttons}\r\n\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t}\r\n\t\t</DetailsHeaderContainer>\r\n\t)\r\n})\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Section, Div } from '../styled/styled-semantic';\r\n\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport posed, { PoseGroup } from 'react-pose'\r\n\r\nconst OuterSection = styled(Section)`\r\n  & {\r\n    width: 100%;\r\n    position: relative;\r\n    padding: 0;\r\n    ${props => props.expanded && `{\r\n      margin-top: -1px;\r\n      border-bottom-color: rgba(34, 36, 38, 0.15);\r\n    }`}\r\n  }\r\n`\r\n\r\nconst PosedDetailsHeader = posed(DetailsHeader)({\r\n  visible: { opacity: 1 },\r\n  invisible: { opacity: 0 }\r\n})\r\n\r\nconst InnerSection = styled(posed(Section)({\r\n  enter: { y: 0 },\r\n  exit: { y: '-100%' },\r\n}))`\r\n  & {\r\n    z-index: -1;\r\n    width: 100%;\r\n    padding: 0;\r\n    margin-bottom: -1px;\r\n  }\r\n`\r\n\r\nexport default ({\r\n  children,\r\n  initiallyExpanded,\r\n  disabled,\r\n  headerInvisible,\r\n  forceExpanded,\r\n  overflowVisible,\r\n  mode,\r\n  ...headerProps,\r\n}) => {\r\n  const [ expanded, expand ] = useState(false)\r\n  useEffect(() => expand(\r\n    !!initiallyExpanded\r\n    || (!disabled && (forceExpanded || this.state.expanded))\r\n  ), [initiallyExpanded, disabled, forceExpanded])\r\n  return (\r\n    <OuterSection\r\n      expanded={expanded ? 1 : 0}\r\n      topBorder={expanded}\r\n      bottomBorder={expanded}\r\n    >\r\n      <PosedDetailsHeader\r\n        {...headerProps}\r\n        expanded={expanded}\r\n        bottomBorder={expanded && 'dark'}\r\n        disabled={forceExpanded}\r\n        titleSize='small'\r\n        onClick={\r\n          !forceExpanded\r\n          && (() => expand(!expanded))\r\n        }\r\n        pose={headerInvisible ? 'invisible' : 'visible'}\r\n      />\r\n      <Div\r\n        oy={overflowVisible ? undefined : 'hidden'}\r\n      >\r\n        <PoseGroup>\r\n          {expanded &&\r\n            <InnerSection\r\n              key={1}\r\n            >\r\n              {children}\r\n            </InnerSection>\r\n          }\r\n        </PoseGroup>\r\n      </Div>\r\n    </OuterSection>\r\n  )\r\n}\r\n\r\n","import _ from 'lodash'\r\n\r\nconst ProdsByDept = ({\r\n    children,\r\n    prods: oriProds,\r\n    // extra\r\n    selectedIds,\r\n    orderId,\r\n    selectLimit,\r\n    // order\r\n    selectedProds = [],\r\n    orderProdsQty,\r\n    diff, //diff mode\r\n    // epxpand\r\n    expandedIds,\r\n    expanded\r\n}) => {\r\n  const modes = {\r\n    ...orderId && { extra: true },\r\n    ...orderId && selectLimit === selectedIds.length && { limitReached: true },\r\n    ...!orderId && { order: true },\r\n    ...diff && { diff: true },\r\n    ...expandedIds && { expand: true },\r\n    ...expanded && { expanded: true },\r\n  }\r\n  const allProds =\r\n    modes['extra'] ? oriProds :\r\n    modes['order'] ? _.unionBy(oriProds, selectedProds, 'id') : []\r\n  const depts = _(allProds)\r\n    .sortBy('dept.type')\r\n    .groupBy('dept.name')\r\n    .reduce(function(depts, prods) {\r\n      let dept = { ...prods[0].dept }\r\n      dept = {\r\n        ...dept,\r\n        count: prods.length,\r\n        readyCount: prods.filter(p => p.progress === 100).length,\r\n        hasDefect: prods.filter(p => p.hasDefect).length,\r\n        isSpoiled: prods.filter(p => p.isSpoiled).length,\r\n        ...modes['expand'] && {\r\n          expanded: expandedIds.some(id => id === dept.id)\r\n        },\r\n        ...modes['expanded'] && {\r\n          expanded: true\r\n        },\r\n        prods: prods.map(p => {\r\n          let prod = {\r\n            ...p,\r\n            ...modes['extra'] && {\r\n              selected: selectedIds.includes(p.id),\r\n              ordered: !!p.order && p.order.id !== orderId\r\n            },\r\n            ...modes['order'] && modes['diff'] && {\r\n              added: !oriProds.some(op => op.id === p.id),\r\n              removed: !selectedProds.some(sp => sp.id === p.id),\r\n            },\r\n          }\r\n          if (modes['extra']) {\r\n            prod = {\r\n              ...prod,\r\n              disabled:\r\n                prod.ordered\r\n                || (modes['limitReached'] && !prod.selected)\r\n            }\r\n          }\r\n          return prod\r\n        }),\r\n      }\r\n      if (modes['extra']) {\r\n        const orderedCount = dept.prods.filter(p => p.ordered).length || 0\r\n        dept = {\r\n          ...dept,\r\n          selectedCount: dept.prods.filter(p => p.selected).length || 0,\r\n          orderedCount,\r\n          availCount: dept.count - orderedCount\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          selected:\r\n            dept.selectedCount === dept.availCount ? true :\r\n            dept.selectedCount === 0 ? false :\r\n            'partly'\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          disabled:\r\n            dept.prods.every(p => p.disabled)\r\n            || (modes['limitReached'] && [false].includes(dept.selected))\r\n        }\r\n      }\r\n      depts.push(dept)\r\n      return depts\r\n    }, [])\r\n  if (modes['order']) {\r\n    const unreservedProdsCount = diff\r\n      ? orderProdsQty - selectedProds.length\r\n      : orderProdsQty - oriProds.length\r\n    if (unreservedProdsCount) {\r\n      depts.unshift({\r\n        id: 'unreserved',\r\n        name: 'Без резерва',\r\n        count: unreservedProdsCount,\r\n        prods: []\r\n      })\r\n    }\r\n  }\r\n  const xor = !!_.xorBy(oriProds, selectedProds, 'id').length\r\n  // console.log('depts > ', depts)\r\n  return children({ depts, xor })\r\n}\r\n\r\nexport default ProdsByDept\r\n","import React, { Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nconst defaultFields = [{\r\n\tname: 'name',\r\n\tpath: 'name',\r\n\ttitle: 'Участок / № Изделия',\r\n\twidth: '170px'\r\n},{\r\n\tname: 'progress',\r\n\tpath: 'progress',\r\n\ttitle: 'Заверш.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'hasDefect',\r\n\tpath: 'hasDefect',\r\n\ttitle: 'Отклон.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'isSpoiled',\r\n\tpath: 'isSpoiled',\r\n\ttitle: 'Брак',\r\n\twidth: '55px'\r\n},{\r\n\tname: 'reserve',\r\n\ttitle: 'Резерв',\r\n\twidth: '75px'\r\n}]\r\n\r\nconst DeptProdTable = ({\r\n\t// data\r\n\tdepts,\r\n\tskipFields = [],\r\n\t// methods\r\n\tselect,\r\n\texpand,\r\n\t// visual\r\n\tindent,\r\n\tnameFieldWidth\r\n}) => {\r\n\tconst fields = cloneDeep(defaultFields)\r\n\tif (nameFieldWidth) fields.find(f => f.name === 'name').width = nameFieldWidth\r\n\treturn (\r\n\t\t<Table\r\n\t\t\tfields={fields.filter(f => !skipFields.includes(f.name))}\r\n\t\t\tindent={indent}\r\n\t\t\tselect={select}\r\n\t\t\texpand={expand}\r\n\t\t>\r\n\t\t\t{({ tableFields }) => <Fragment>\r\n\t\t\t\t{depts.map(dept => {\r\n\t\t\t\t\t\tconst { id, expanded } = dept\r\n\t\t\t\t\t\tif (id === 'unreserved') return (\r\n\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t// bold\r\n\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Fragment\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\texpandFor='prods'\r\n\t\t\t\t\t\t\t\t\texpanded={expanded}\r\n\t\t\t\t\t\t\t\t\texpand={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tonClick={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'readyCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'checkmark',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'green'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'orderedCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'gavel',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'brown'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{\texpanded && dept.prods.map((prod, i) => {\r\n\t\t\t\t\t\t\t\t\tconst { id, progress, order, added, removed } = prod\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === dept.prods.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\tentity={prod}\r\n\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t\t\t...(added || removed) ? [{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'service',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: added ? 'plus' : 'minus',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: added ? 'green' : 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}] : [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'fullnumber'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: progress && progress + '%'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: order && order.fullnum,\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t\t\t// active={}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={select && (() => select(id))}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t</Fragment>}\r\n\t\t</Table>\r\n\t\t// {/* {name} <ProdQtyLabel color='grey' basic content={`${prods.length}шт`} /> */}\r\n\t)\r\n}\r\n\r\nexport default DeptProdTable","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst IconRight = styled(Icon)`\r\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\r\n`\r\n\r\nconst ReserveProdsButton = ({ modelId, orderId, prodIds }) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, setSelectedProdIds }) => (\r\n        <Button compact circular menu\r\n          activeColor='green'\r\n          active={!!extra}\r\n          onClick={e => {\r\n            e.stopPropagation()\r\n            setSelectedProdIds(prodIds)\r\n            setExtra({\r\n              type: 'Store',\r\n              modelId,\r\n              orderId\r\n            })\r\n          }}\r\n        >\r\n          <Icon name='gavel' />\r\n          Резервирование\r\n          <IconRight name='angle right' />\r\n        </Button>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ReserveProdsButton","import gql from 'graphql-tag'\r\n\r\nexport const modelProds = gql`\r\n\tquery ModelProds ($modelId: ID!) {\r\n\t\tmodelProds (modelId: $modelId) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t\torder {\r\n\t\t\t\tid\r\n\t\t\t\tfullnum\r\n\t\t\t\tenquiry {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tnum\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const prodsLocal = gql`\r\n\tquery ProdsLocal ($ids: [ID!]!) {\r\n\t\tprodsLocal (ids: $ids) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n","import { compose, graphql } from 'react-apollo'\r\nimport { prodsLocal } from '../../graphql/prod'\r\n\r\nconst ProdContext = ({\r\n\tchildren,\r\n\tprodsLocal: { prodsLocal }\r\n}) => {\r\n  return children({\r\n\t\tprodsLocal: prodsLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(prodsLocal, { name: 'prodsLocal' }),\r\n)(ProdContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { reserveProds } from '../../graphql/order'\r\n\r\nimport { Section, Button, Message } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport CollapsableSection from '../presentational/CollapsableSection'\r\nimport ProdsByDept from './ProdsByDept';\r\nimport DeptProdTable from './DeptProdTable';\r\nimport ReserveProdsButton from './ReserveProdsButton'\r\n// import ListProvider from './special/ListProvider'\r\nimport ProdContext from '../context/ProdContext'\r\n\r\nconst ModelProdsSection = ({\r\n  order: { id, model, qty, prods }\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, selectedProdIds }) => (\r\n        <CollapsableSection\r\n          forceExpanded={!!extra}\r\n          title={model.name}\r\n          subtitle={qty + 'шт'}\r\n          buttons={\r\n            <ReserveProdsButton\r\n              modelId={model.id}\r\n              orderId={id}\r\n              prodIds={prods.map(p => p.id)}\r\n            />\r\n          }\r\n        >\r\n            <ProdContext\r\n              ids={selectedProdIds}\r\n            >\r\n              {({ prodsLocal: selectedProds }) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedProds={selectedProds}\r\n                  orderProdsQty={qty}\r\n                  expanded\r\n                  diff={!!extra}\r\n                >\r\n                  {({ depts, xor }) =>\r\n                    <Fragment>\r\n                      <DeptProdTable\r\n                        depts={depts}\r\n                        skipFields={['reserve']}\r\n                        expand={() => null}\r\n                        indent='32px'\r\n                        nameFieldWidth='200px'\r\n                      />\r\n                      {extra && \r\n                      <Mutation\r\n                        mutation={reserveProds}\r\n                        variables={{\r\n                          orderId: id,\r\n                          prodIds: selectedProdIds\r\n                        }}\r\n                      >\r\n                        {( reserveProds, { loading, error }) => \r\n                          <Fragment>\r\n                            <Section\r\n                              minor\r\n                              head\r\n                              topBorder='dark'\r\n                            >\r\n                              <Button\r\n                                primary\r\n                                compact\r\n                                circular\r\n                                menu\r\n                                ml='0'\r\n                                content='Резервировать'\r\n                                icon='gavel'\r\n                                loading={loading}\r\n                                disabled={!xor}\r\n                                onClick={() => {\r\n                                  reserveProds()\r\n                                  setExtra(null)\r\n                                }}\r\n                              />\r\n                            </Section>\r\n                            {error &&\r\n                              <Message\r\n                                section\r\n                                error\r\n                                header='Зарезервировать не удалось..'\r\n                                content={error.message}\r\n                              />\r\n                            }\r\n                          </Fragment>\r\n                        }\r\n                      </Mutation>\r\n                      }\r\n                    </Fragment>\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ProdContext>\r\n          {/* {!extra && \r\n            <ListProvider>\r\n              {({ list: selectedIds, setList: setSelectedProdIds}) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedIds={selectedIds}\r\n                  orderProdsQty={qty}\r\n                >\r\n                  {({ depts }) =>\r\n                    <DeptProdTable\r\n                      depts={depts}\r\n                      setSelectedProdIds={setSelectedProdIds}\r\n                      skipFields={['reserve']}\r\n                    />\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ListProvider>\r\n          } */}\r\n        </CollapsableSection>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ModelProdsSection\r\n","import React from 'react'\r\n\r\nimport ModelProdsSection from './ModelProdsSection'\r\n\r\nconst OrderDetails = ({ order }) => {\r\n  return (\r\n    <ModelProdsSection\r\n      order={order}\r\n    />\r\n  )\r\n}\r\n\r\nexport default OrderDetails","import React from 'react'\r\n\r\nimport { SortableElement } from 'react-sortable-hoc'\r\n\r\nimport styled from 'styled-components'\r\nimport posed from 'react-pose'\r\nimport { Icon } from '../../../styled/styled-semantic';\r\n\r\nconst AspectRatioDiv = styled.div`\r\n  position: relative;\r\n  width: 100%;\r\n  padding-top: ${props => 100/props.proportion}%;\r\n  margin-bottom: 3px;\r\n`\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: rgba(0,0,50,.03);\r\n`\r\n\r\nconst ImgSpacer = posed.div({\r\n  shrinked: {\r\n    width:  'calc(100% - 60px)',\r\n    height: ({ proportion }) => `calc(100% - 60px/${proportion})`,\r\n  },\r\n  fullsize: {\r\n    width: '100%',\r\n    height: '100%',\r\n  }\r\n})\r\n\r\nconst Image = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst Mask = styled.div`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  cursor: pointer;\r\n  transition: background-image .135s cubic-bezier(0.0,0.0,0.2,1);\r\n  :hover {\r\n    background-image: linear-gradient(to bottom,rgba(0,0,0,0.26),transparent 56px,transparent);\r\n  }\r\n  ${props => props.hide && `\r\n    background-image: unset !important;\r\n  `}\r\n  ${props => props.off && `\r\n    display: none;\r\n  `}\r\n`\r\n\r\nconst CheckBox = styled(Icon)`\r\n  position: absolute;\r\n  top: 7px;\r\n  left: 10px;\r\n  color: white;\r\n  &&& {\r\n    opacity: ${props => \r\n      props.active ? '1 !important' :\r\n      props.selectMode ? '.5 !important' : '0'};\r\n  }\r\n  ${Mask}:hover && {\r\n    opacity: ${props => props.selectMode ? '1 !important' : '.5'};\r\n  }\r\n`\r\n\r\nconst Check = styled(Icon)`\r\n  position: absolute;\r\n  left: 5px;\r\n  top: 4px;\r\n  &&& {\r\n    opacity: ${props => props.active ? '.9 !important' : '0'};\r\n    :hover {\r\n      opacity: .5 !important;\r\n    }\r\n  }\r\n  ${Mask}:hover && {\r\n    opacity: ${props => \r\n      props.active ? '.9 !important' :\r\n      props.selectMode ? '.5 !important' : '.2'};\r\n  }\r\n`\r\n\r\nexport default SortableElement(({\r\n  drawing: { id, files },\r\n  toggleSelection,\r\n  selected,\r\n  selectMode,\r\n  sortMode\r\n}) => {\r\n  const oriImage = files.find(f => f.imgFor === 'ORIGINAL')\r\n  const image = files.find(f => f.imgFor === 'FEED_792') || oriImage\r\n  const { path, width, height} = image\r\n  const proportion = width/height\r\n  return (<div>\r\n    <AspectRatioDiv\r\n      proportion={proportion}\r\n    >\r\n      <Container>\r\n        <Mask\r\n          hide={selected}\r\n          off={sortMode}\r\n          onClick={() => {\r\n            // deselect drawing if selected, select if in the selectMode\r\n            if (selected || selectMode) return toggleSelection(id)\r\n            // otherwise open fullsize image in new tab\r\n            const win = window.open(oriImage.path, '_blank')\r\n            win.focus()\r\n          }}\r\n        >\r\n          <CheckBox\r\n            link\r\n            name='square'\r\n            size='big'\r\n            fs='2.2em'\r\n            active={selected}\r\n            d={sortMode ? 'none !important' : undefined}\r\n            selectMode={selectMode}\r\n            color={selected ? 'grey' : undefined}\r\n          >\r\n            <Check\r\n              link\r\n              name='check'\r\n              size='small'\r\n              color='black'\r\n              c={selected ? '#fff !important' : undefined}\r\n              active={selected}\r\n              selectMode={selectMode}\r\n              onClick={e => {\r\n                e.stopPropagation()\r\n                toggleSelection(id)\r\n              }}\r\n            />\r\n          </CheckBox>\r\n        </Mask>\r\n        <ImgSpacer\r\n          pose={(selected || sortMode) ? 'shrinked' : 'fullsize'}\r\n          proportion={proportion}\r\n          onClick={() => selected && toggleSelection(id)}\r\n        >\r\n          <Image\r\n            src={path}\r\n            width={width}\r\n            height={height}\r\n          />\r\n        </ImgSpacer>\r\n      </Container>\r\n    </AspectRatioDiv></div>\r\n  )\r\n})\r\n","import React from 'react'\r\nimport { SortableContainer } from 'react-sortable-hoc'\r\nimport Drawing from './Drawing'\r\n\r\nexport default SortableContainer(({\r\n  drawings,\r\n  toggleDrawingSelection,\r\n  selectedDrawings,\r\n  sortMode\r\n}) => {\r\n  return (\r\n    <div>\r\n      {drawings.map((drw, i) =>\r\n        <Drawing\r\n          key={drw.id}\r\n          index={i}\r\n          drawing={drw}\r\n          toggleSelection={toggleDrawingSelection}\r\n          selected={!!selectedDrawings.includes(drw.id)}\r\n          selectMode={!!selectedDrawings.length}\r\n          sortMode={sortMode}\r\n          disabled={!sortMode}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n})\r\n\r\n","import { Component } from 'react'\r\nimport produce from 'immer'\r\n// import memoize from 'memoize-one'\r\n\r\nexport default class SortedCollectionProvider extends Component {\r\n  // sort = () => {\r\n  //   const { collection, sortBy } = this.props\r\n  //   return collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n  // }\r\n  // sort = memoize(watchedVar => {\r\n  //   const { collection, sortBy } = this.props\r\n  //   return this.setState({\r\n  //     sortedCollection: collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n  //   })\r\n  // })\r\n  state = {\r\n    sortedCollection: []\r\n  }\r\n  static getDerivedStateFromProps(props, state) {\r\n    if( props.collection !== state.prevPropsCollection) {\r\n      console.log(' > getDerivedStateFromProps')\r\n      const { collection, sortBy } = props\r\n      return {\r\n        prevPropsCollection: collection,\r\n        sortedCollection: collection.sort((a, b) => a[sortBy] < b[sortBy] ? -1 : 1)\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  move = ( oldIndex, newIndex ) => {\r\n    this.setState(produce(draft => {\r\n      const [ removed ] = draft.sortedCollection.splice(oldIndex, 1)\r\n      draft.sortedCollection.splice(newIndex, 0, removed)\r\n    }))\r\n  }\r\n  render() {\r\n    const { children } = this.props\r\n    const { sortedCollection } = this.state\r\n    return children({\r\n      sortedCollection,\r\n      move: this.move\r\n    })\r\n  }\r\n}\r\n","import { Component } from 'react'\r\nimport { produce } from 'immer'\r\n\r\nexport default class StatefulList extends Component {\r\n  state = {\r\n    list: []\r\n  }\r\n  toggle = item => {\r\n    this.setState(produce(draft => {\r\n      console.log('draft > ', draft)\r\n      const index = draft.list.indexOf(item)\r\n      if (index !== -1) draft.list.splice(index, 1)\r\n        else draft.list.push(item)\r\n    }))\r\n  }\r\n  clear = () => this.setState({ list: [] })\r\n  removeMany = items => {\r\n    this.setState(({ list }) => ({\r\n      list: [ ...list.filter(i => !items.includes(i)) ]\r\n    }))\r\n  }\r\n  render() {\r\n    return this.props.children({\r\n      list: this.state.list,\r\n      toggle: this.toggle,\r\n      clear: this.clear,\r\n      removeMany: this.removeMany,\r\n    })\r\n  }\r\n}","import { Component } from 'react'\r\n\r\nexport default class StatefulBool extends Component {\r\n  state = {\r\n    bool: false\r\n  }\r\n  toggle = () => {\r\n    this.setState(({ bool }) => ({ bool: !bool }))\r\n  }\r\n  enable = () => this.setState({ bool: true })\r\n  disable = () => this.setState({ bool: false })\r\n  render() {\r\n    return this.props.children({\r\n      bool: this.state.bool,\r\n      toggle: this.toggle,\r\n      enable: this.enable,\r\n      disable: this.disable,\r\n    })\r\n  }\r\n}","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { createDrawings, deleteDrawings, setDrawingsSortOrder } from '../../../graphql/drawing'\r\n\r\nimport { NotificationsConsumer } from '../../notifications/NotificationsContext'\r\n\r\nimport Dropzone from 'react-dropzone'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport { Loader } from 'semantic-ui-react'\r\nimport { Icon, Button, Span } from '../../styled/styled-semantic'\r\nimport CollapsableSection from '../../presentational/CollapsableSection'\r\nimport SortableDrawingsList from './Drawings/Sortable'\r\nimport SortedCollectionProvider from './Drawings/SortedCollectionProvider'\r\nimport StatefulList from '../../context/StatefulList'\r\nimport StatefulBool from '../../context/StatefulBool'\r\n\r\nconst DropzoneArea = styled.div`\r\n  position: relative;\r\n  :focus {\r\n    outline: none;\r\n  }\r\n`\r\n\r\nconst DropzoneOverlay = styled(posed.div({\r\n  enter: { opacity: 1 },\r\n  exit: { opacity: 0 },\r\n}))`\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  z-index: 2;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: rgba(0,0,0,.65);\r\n`\r\n\r\nconst MenuOverlay = styled(posed.div({\r\n  enter: { opacity: 1 },\r\n  exit: { opacity: 0 },\r\n}))`\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 1px;\r\n  right: 0;\r\n  left: 0;\r\n  height: 48px;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: rgba(255,255,255,1);\r\n`\r\n\r\nconst MenuLeftIcon = styled(Icon)`\r\n  &&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\n\r\nexport default class Drawings extends Component {\r\n  render() {\r\n    console.log('> Drawings render')\r\n    const { model, sidebarRef } = this.props\r\n    const { id: modelId, drawings } = model\r\n    return (\r\n      <NotificationsConsumer>\r\n        {({ notify }) =>\r\n          <Mutation\r\n            mutation={createDrawings}\r\n            onCompleted={() => notify({\r\n              type: 'success',\r\n              title: 'Файлы успешно загружены'\r\n            })}\r\n            onError={err => notify({\r\n              type: 'error',\r\n              title: 'Ошибка загрузки файлов',\r\n              content: err.message,\r\n            })}\r\n          >\r\n            {(createDrawings, { loading: creating, client }) =>\r\n              <Mutation\r\n                mutation={deleteDrawings}\r\n                onCompleted={() => notify({\r\n                  type: 'success',\r\n                  title: 'Файлы удалены'\r\n                })}\r\n                onError={err => notify({\r\n                  type: 'error',\r\n                  title: 'Ошибка удаления файлов',\r\n                  content: err.message,\r\n                })}\r\n              >\r\n                {(deleteDrawings, { loading: deleting }) =>\r\n                  <Mutation\r\n                    mutation={setDrawingsSortOrder}\r\n                    onCompleted={() => notify({\r\n                      type: 'success',\r\n                      content: 'Новый порядок чертежей установлен'\r\n                    })}\r\n                    onError={err => notify({\r\n                      type: 'error',\r\n                      title: 'Ошибка сортировки',\r\n                      content: err.message,\r\n                    })}\r\n                  >\r\n                    {(setDrawingsSortOrder, { loading: sorting }) =>\r\n                      <SortedCollectionProvider\r\n                        collection={drawings}\r\n                        sortBy='sortOrder'\r\n                      >\r\n                        {({ sortedCollection: drawings, move: moveDrawing }) =>\r\n                          <StatefulList>\r\n                            {({\r\n                              list: selectedDrawings,\r\n                              toggle: toggleDrawingSelection,\r\n                              clear: deselectAllDrawings,\r\n                              removeMany: deselectManyDrawings\r\n                            }) =>\r\n                              <StatefulBool>\r\n                                {({\r\n                                  bool: sortMode,\r\n                                  enable: enableSortMode,\r\n                                  disable: disableSortMode\r\n                                }) =>\r\n                                  <Dropzone\r\n                                    disabled={sortMode}\r\n                                    onDrop={async (acceptedFiles) => {\r\n                                      console.log('acceptedFiles > ', acceptedFiles)\r\n                                      if (!acceptedFiles.length) return\r\n                                      const res = await createDrawings({\r\n                                        variables: {\r\n                                          modelId,\r\n                                          files: acceptedFiles\r\n                                        }\r\n                                      })\r\n                                      if (!res) return\r\n                                      const { data } = res\r\n                                      client.writeData({\r\n                                        id: `Model:${modelId}`,\r\n                                        data: {\r\n                                          ...model,\r\n                                          drawings: [\r\n                                            ...drawings,\r\n                                            ...data.createDrawings\r\n                                          ]\r\n                                        }\r\n                                      })\r\n                                      this.collapsableSection.expand()\r\n                                    }}\r\n                                    disableClick\r\n                                    accept='image/jpeg, image/png'\r\n                                    onDropRejected={() => notify({\r\n                                      type: 'error',\r\n                                      title: 'Недопустимый формат файла',\r\n                                      content: 'Поддерживаются только изображения .jpeg или .png',\r\n                                    })}\r\n                                  >\r\n                                    {({\r\n                                      getRootProps,\r\n                                      getInputProps,\r\n                                      open: openFileDialog,\r\n                                      isDragActive,\r\n                                    }) =>\r\n                                      <DropzoneArea\r\n                                        isDragActive={isDragActive}\r\n                                        {...getRootProps()}\r\n                                      >\r\n                                        <input {...getInputProps()} />\r\n                                        <PoseGroup>\r\n                                          {isDragActive &&\r\n                                            <DropzoneOverlay key='1'>\r\n                                              <Icon\r\n                                                name='download'\r\n                                                size='large'\r\n                                                c='white'\r\n                                              />\r\n                                            </DropzoneOverlay>\r\n                                          }\r\n                                          {selectedDrawings.length &&\r\n                                            <MenuOverlay key='2' >\r\n                                              <MenuLeftIcon\r\n                                                link\r\n                                                size='large'\r\n                                                name='cancel'\r\n                                                onClick={() => deselectAllDrawings()}\r\n                                              />\r\n                                              <Span\r\n                                                fs='1.1em'\r\n                                                c='rgba(0,0,0,.75)'\r\n                                                fw='700'\r\n                                              >\r\n                                                Выбрано чертежей: {selectedDrawings.length}\r\n                                              </Span>\r\n                                              <Span\r\n                                                m='0 23px 0 auto'\r\n                                              >\r\n                                                <Icon\r\n                                                  link\r\n                                                  d={deleting ? 'none' : undefined}\r\n                                                  activeColor='#db2828'\r\n                                                  name='trash alternate outline'\r\n                                                  size='large'\r\n                                                  onClick={async () => {\r\n                                                    const ids = selectedDrawings\r\n                                                    const res = await deleteDrawings({ variables: { ids }})\r\n                                                    if (!res) return\r\n                                                    client.writeData({\r\n                                                      id: `Model:${modelId}`,\r\n                                                      data: {\r\n                                                        ...model,\r\n                                                        drawings: [ ...drawings.filter(drw => !ids.includes(drw.id)) ]\r\n                                                      }\r\n                                                    })\r\n                                                    deselectManyDrawings(ids)\r\n                                                    console.log('deleted!')\r\n                                                  }}\r\n                                                />\r\n                                                <Loader\r\n                                                  inline\r\n                                                  size='small'\r\n                                                  active={deleting}\r\n                                                />\r\n                                              </Span>\r\n                                              \r\n                                            </MenuOverlay>\r\n                                          }\r\n                                          {sortMode &&\r\n                                            <MenuOverlay key='3' >\r\n                                              <MenuLeftIcon\r\n                                                link\r\n                                                name='check'\r\n                                                size='large'\r\n                                                c='#016936'\r\n                                                onClick={async () => {\r\n                                                  let reordered = false\r\n                                                  drawings.forEach((drw, i) => {\r\n                                                    if (drw.sortOrder !== i) {\r\n                                                      reordered = true\r\n                                                      client.writeData({\r\n                                                        id: `Drawing:${drw.id}`,\r\n                                                        data: {\r\n                                                          ...drw,\r\n                                                          sortOrder: i\r\n                                                        }\r\n                                                      })\r\n                                                    }\r\n                                                  })\r\n                                                  if (reordered) await setDrawingsSortOrder({ variables: {\r\n                                                    ids: drawings.map(drw => drw.id)\r\n                                                  }})\r\n                                                  disableSortMode()\r\n                                                }}\r\n                                              />\r\n                                              <Span\r\n                                                fs='1.1em'\r\n                                                c='rgba(0,0,0,.75)'\r\n                                                fw='700'\r\n                                              >\r\n                                                Сортировка\r\n                                              </Span>\r\n                                              <Span\r\n                                                m='0 23px 0 auto'\r\n                                              >\r\n                                                <Loader\r\n                                                  inline\r\n                                                  size='small'\r\n                                                  active={sorting}\r\n                                                />\r\n                                              </Span>\r\n                                            </MenuOverlay>\r\n                                          }\r\n                                        </PoseGroup>\r\n                                        <CollapsableSection\r\n                                          ref={component => this.collapsableSection = component}\r\n                                          initiallyExpanded={!!drawings.length}\r\n                                          disabled={!drawings.length}\r\n                                          title='Чертеж '\r\n                                          subtitle={\r\n                                            <Span\r\n                                              fs='1.2em'\r\n                                            >\r\n                                              <Icon\r\n                                                name='file image outline'\r\n                                                mr='4px'\r\n                                              />\r\n                                              {drawings.length}\r\n                                            </Span>\r\n                                          }\r\n                                          buttons={<>\r\n                                            <Button compact circular menu\r\n                                              activeColor='green'\r\n                                              icon='plus'\r\n                                              onClick={e => {\r\n                                                e.stopPropagation()\r\n                                                notify({\r\n                                                  type: 'warning',\r\n                                                  content: 'Чтобы загрузить файлы, перетащите их в раздел',\r\n                                                })\r\n                                                openFileDialog()\r\n                                              }}\r\n                                              loading={creating}\r\n                                            />\r\n                                            <Button compact circular menu\r\n                                              icon='sort'\r\n                                              onClick={e => {\r\n                                                e.stopPropagation()\r\n                                                notify({\r\n                                                  type: 'warning',\r\n                                                  content: 'Чтобы изменить порядок, выберите и перетащите нужные чертежи',\r\n                                                })\r\n                                                enableSortMode()\r\n                                              }}\r\n                                            />\r\n                                          </>}\r\n                                        >\r\n                                          <SortableDrawingsList\r\n                                            drawings={drawings}\r\n                                            toggleDrawingSelection={toggleDrawingSelection}\r\n                                            selectedDrawings={selectedDrawings}\r\n                                            sortMode={sortMode}\r\n                                            onSortEnd={({ oldIndex, newIndex }) => moveDrawing( oldIndex, newIndex )}\r\n                                            getContainer={() => sidebarRef}\r\n                                          />\r\n                                        </CollapsableSection>\r\n                                      </DropzoneArea>\r\n                                    }\r\n                                  </Dropzone>\r\n                                }\r\n                              </StatefulBool>\r\n                            }\r\n                          </StatefulList>\r\n                        }\r\n                      </SortedCollectionProvider>\r\n                    }\r\n                  </Mutation>\r\n                }\r\n              </Mutation>\r\n            }\r\n          </Mutation>\r\n        }\r\n      </NotificationsConsumer>\r\n    )\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport Drawings from './Details/Drawings'\r\n\r\nexport default ({\r\n  model,\r\n  sidebarRef\r\n}) => {\r\n  return <>\r\n    <Drawings\r\n      model={model}\r\n      sidebarRef={sidebarRef}\r\n    />\r\n  </>\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport DetailsDataProvider from './DetailsDataProvider'\r\nimport DetailsMainHeader from './DetailsMainHeader'\r\nimport EnquiryDetails from '../Enquiry/EnquiryDetails'\r\nimport OrderEdit from '../Order/OrderEdit'\r\nimport OrderDetails from '../Order/OrderDetails'\r\nimport ModelDetails from '../Model/Details'\r\n\r\nconst Container = styled.div`\r\n\t/* flex-grow: 1; */\r\n\twidth: 60%;  // evaluates to 792px\r\n`\r\n\r\nconst Details = ({ closeDetails, sidebarRef }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId, editMode }, setDetails, setExpanded }) => (\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{/* Should I get rid of Details' components unification? */}\r\n\t\t\t\t\t\t<DetailsDataProvider\r\n\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{({ loading, error, refetch, entity, localEntity }) =>\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<DetailsMainHeader\r\n\t\t\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t\t\tlocalEntity={localEntity}\r\n\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t\t\teditMode={editMode}\r\n\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\trefresh={() => refetch()}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t\t\t? <EnquiryDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t:\tnull\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{type === 'Order' &&\r\n\t\t\t\t\t\t\t\t\t\t(id === 'new' || editMode\r\n\t\t\t\t\t\t\t\t\t\t\t? <OrderEdit\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenquiryId={enquiryId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetExpanded={setExpanded}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t: (entity &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<OrderDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\torder={entity}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t{type === 'Model' &&\r\n\t\t\t\t\t\t\t\t\t\t(id === 'new' || editMode\r\n\t\t\t\t\t\t\t\t\t\t\t? <div></div>\r\n\t\t\t\t\t\t\t\t\t\t\t: (entity &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ModelDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodel={entity}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsidebarRef={sidebarRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</DetailsDataProvider>\r\n\t\t\t\t</Container>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default Details\r\n","import { Component } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport without from 'lodash/without'\r\nimport take from 'lodash/take'\r\nimport union from 'lodash/union'\r\nimport difference from 'lodash/difference'\r\nimport find from 'lodash/fp/find'\r\n\r\nclass ProdTableUtils extends Component {\r\n\tselect = (id) => {\r\n\t\tconst {\r\n\t\t\tdepts: propDepts,\r\n\t\t\tsetList,\r\n\t\t\tselectLimit\r\n\t\t} = this.props\r\n\t\tconst depts = cloneDeep(propDepts)\r\n\t\tconst selectedProdIds =\r\n\t\t\tdepts.reduce((list, d) =>\r\n\t\t\t\t[\r\n\t\t\t\t\t...list,\r\n\t\t\t\t\t...d.prods.filter(p => p.selected).map(p => p.id)\r\n\t\t\t\t]\r\n\t\t\t, [])\r\n\t\tconst dept =\r\n\t\t\tfind({ id }, depts)\r\n\t\t\t|| find({ prods: [ { id } ]}, depts)\r\n\t\tconst { prods } = dept\r\n\t\tconst entity =\r\n\t\t\tdept.id === id\r\n\t\t\t\t? dept\r\n\t\t\t\t: find({ id }, prods)\r\n\t\tif (entity.disabled) return null\r\n\t\tlet newList = []\r\n\t\tif (entity.__typename === 'Prod') {\r\n\t\t\tnewList =\r\n\t\t\t\tselectedProdIds.includes(id)\r\n\t\t\t\t\t? without(selectedProdIds, id)\r\n\t\t\t\t\t: [...selectedProdIds, id]\r\n\t\t}\r\n\t\tif (entity.__typename === 'Dept') {\r\n\t\t\tif ([ 'partly', true ].includes(entity.selected))\r\n\t\t\t\tnewList = difference(selectedProdIds, prods.map(p => p.id))\r\n\t\t\tif (entity.selected === false) {\r\n\t\t\t\tconst idsWithinLimit = take(\r\n\t\t\t\t\tprods.filter(p => !p.disabled).map(p => p.id),\r\n\t\t\t\t\tselectLimit - selectedProdIds.length\r\n\t\t\t\t)\r\n\t\t\t\tnewList = union(selectedProdIds, idsWithinLimit)\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetList(newList)\r\n\t}\r\n\trender () {\r\n\t\tconst { children } = this.props\r\n\t\treturn children({\r\n\t\t\tselect: this.select\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport default ProdTableUtils","import { Component } from 'react'\r\n\r\n// deprecated, use SelectableListProvider\r\nexport default class ListProvider extends Component {\r\n\tstate = {\r\n\t\tlist: []\r\n\t}\r\n\tsetList = (list) => this.setState({ list })\r\n\ttoggle = (item) => {\r\n\t\tconst { list } = this.state\r\n\t\tconst newList = \r\n\t\t\tlist.includes(item)\r\n\t\t\t? [ ...list.filter(i => i !== item) ]\r\n\t\t\t: [ ...list, item ]\r\n\t\tthis.setState({ list: newList })\r\n\t}\r\n\trender() {\r\n\t\treturn this.props.children({\r\n\t\t\tlist: this.state.list,\r\n\t\t\tsetList: this.setList,\r\n\t\t\ttoggle: this.toggle,\r\n\t\t})\r\n\t}\r\n}\r\n","import { compose, graphql } from 'react-apollo'\r\nimport { orderLocal } from '../../graphql/order'\r\n\r\nconst OrderContext = ({\r\n\tchildren,\r\n\torderLocal: { orderLocal }\r\n}) => {\r\n  return children({\r\n\t\torderLocal: orderLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(orderLocal, { name: 'orderLocal' }),\r\n)(OrderContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section } from '../styled/styled-semantic'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { modelLocal } from '../../graphql/model'\r\nimport { modelProds } from '../../graphql/prod'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport DetailsHeader from './DetailsHeader'\r\nimport ProdsByDept from '../Order/ProdsByDept'\r\nimport ProdTableUtils from '../Order/ProdTableUtils'\r\nimport DeptProdTable from '../Order/DeptProdTable'\r\nimport ListProvider from '../context/ListProvider';\r\nimport OrderContext from '../context/OrderContext';\r\n\r\nconst Container = styled.div`\r\n\twidth: 40%;\r\n\tmin-height: calc(100vh - 36px);\r\n\theight: fit-content;\r\n\t/* border-left: 1px solid rgb(126, 126, 129); */\r\n\tborder-left: 1px solid rgb(156, 156, 159);\r\n`\r\n\r\nconst DetailsExtra = ({ closeExtra }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ extra, selectedProdIds, setSelectedProdIds }) => (\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{!!extra && \r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelLocal}\r\n\t\t\t\t\t\t\t\tvariables={{ id: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ data: { modelLocal } }) =>\r\n\t\t\t\t\t\t\t\t\t<DetailsHeader\r\n\t\t\t\t\t\t\t\t\t\ttitle={modelLocal.name + ' в наличии'}\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tnoIndent\r\n\t\t\t\t\t\t\t\t\t\tbottomBorder='dark'\r\n\t\t\t\t\t\t\t\t\t\tbuttons={\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon link\r\n\t\t\t\t\t\t\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={closeExtra}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelProds}\r\n\t\t\t\t\t\t\t\tvariables={{ modelId: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ loading, error, data }) => {\r\n\t\t\t\t\t\t\t\t\tif (loading) return <Section noIndent >Загрузка...</Section>\r\n\t\t\t\t\t\t\t\t\tif (error) return <Section noIndent >Ошибка {error.message}</Section>\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<OrderContext\r\n\t\t\t\t\t\t\t\t\t\t\tid={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{({ orderLocal }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{({ list: expandedIds, toggle: toggleExpanded }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdsByDept\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprods={data.modelProds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedIds={selectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torderId={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpandedIds={expandedIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ depts }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdTableUtils\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetList={setSelectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ select }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DeptProdTable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect={select}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpand={toggleExpanded}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdTableUtils>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdsByDept>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</OrderContext>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Container>\r\n\t\t\t\t\t\t\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default DetailsExtra\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar, Ref } from 'semantic-ui-react';\r\nimport Details from './Details'\r\nimport DetailsExtra from './DetailsExtra'\r\n\r\nconst SSidebar = styled(Sidebar)`\r\n\t&&&& {\r\n\t\tdisplay: flex;\r\n\t\twidth: 120%;\r\n\t\tbackground-color: white;\r\n\t\ttransition: all .5s ease;\r\n\t\tmax-width: ${props => \r\n\t\t\tprops.type === 'Enquiry'\r\n\t\t\t? '1000px'\r\n\t\t\t: '1320px'\r\n\t\t};\r\n\t\t${props => !props.extra && `\r\n\t\t\t&.ui.visible.right.overlay.sidebar {\r\n\t\t\t\ttransform: translate3d(40%,0,0);\r\n\t\t\t}\r\n\t\t`}\r\n\t\t${props => props.extra && `\r\n\t\t\twidth: 86%;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nclass DetailsSidebar extends Component {\r\n\tstate = { detailsClosing: false }\r\n\tcloseDetails = () => {\r\n\t\tthis.setState({ detailsClosing: true })\r\n\t\t// set timeout for sidebar to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { input: { details: null, extra: null } }})\r\n\t\t\tthis.setState({ detailsClosing: false })\r\n\t\t}, 300)\r\n\t}\r\n\tcloseExtra = () => {\r\n\t\tthis.props.setLayout({variables: { input: { extra: null } }})\r\n\t}\r\n\trender() {\r\n\t\tconst { detailsClosing } = this.state\r\n\t\tconst { layout: { details, extra } } = this.props\r\n\t\treturn (\r\n\t\t\t<Ref innerRef={node => this.sidebarRef = node}>\r\n\t\t\t\t<SSidebar\r\n\t\t\t\t\tvisible={!!details && !detailsClosing}\r\n\t\t\t\t\textra={!!extra ? 1: 0}\r\n\t\t\t\t\ttype={details && details.type}\r\n\t\t\t\t\tanimation='overlay'\r\n\t\t\t\t\tdirection='right'\r\n\t\t\t\t>\r\n\t\t\t\t\t{details &&\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<Details\r\n\t\t\t\t\t\t\t\tkey={details.type + details.id}\r\n\t\t\t\t\t\t\t\tcloseDetails={this.closeDetails}\r\n\t\t\t\t\t\t\t\tsidebarRef={this.sidebarRef}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<DetailsExtra\r\n\t\t\t\t\t\t\t\textra={extra}\r\n\t\t\t\t\t\t\t\tcloseExtra={this.closeExtra}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t}\r\n\t\t\t\t</SSidebar>\r\n\t\t\t</Ref>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(DetailsSidebar)","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100vh - 36px) !important;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n`\r\n\r\nconst Main = styled.div`\r\n  flex: 1 0 50px;\r\n  min-height: 50px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n`\r\n\r\nconst Panel = styled.div`\r\n  flex: 0 0 0;\r\n  min-height: 387px;\r\n  background: #fff;\r\n  z-index: 10;\r\n  /* box-shadow: 0 0 20px rgba(34,36,38,.15); shadow of semantic-ui Sidebar*/\r\n  box-shadow: 0 0 20px 5px #fff;\r\n  transition: min-height .4s ease-out;\r\n  ${props => !props.panelVisible && `\r\n    min-height: 0;\r\n  `}\r\n`\r\n\r\nexport default class PanelPusher extends Component {\r\n  render() {\r\n    const {\r\n      children,\r\n      panel,\r\n      panelVisible,\r\n      panelRendered\r\n    } = this.props\r\n    return (\r\n      <Container>\r\n        <Main\r\n          panelVisible={panelVisible}\r\n        >\r\n          {children}\r\n        </Main>\r\n        <Panel\r\n          panelVisible={panelVisible}\r\n        >\r\n          { panelRendered &&\r\n            panel\r\n          }\r\n        </Panel>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const telFragment = gql`\r\n\tfragment TelFragment on Tel {\r\n\t\tid\r\n\t\tnumber\r\n\t\ttype\r\n\t\tcountry\r\n\t\tnote\r\n\t\tdefault\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { telFragment } from './tel'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\n// TODO switch to using only amoName in the app\r\nexport const personFragmentBasic = gql`\r\n\tfragment PersonFragmentBasic on Person {\r\n\t\tid\r\n\t\tamoId\r\n\t\tfName\r\n\t\tlName\r\n\t\tmName\r\n\t\tamoName\r\n\t}\r\n`\r\n\r\nexport const personContactsFragment = gql`\r\nfragment PersonContactsFragment on Person {\r\n\t...PersonFragmentBasic\r\n\thtmlNote\r\n\ttels { ...TelFragment }\r\n\tuser {\r\n\t\temail\r\n\t\tconfirmed\r\n\t}\r\n}\r\n${telFragment}\r\n${personFragmentBasic}\r\n`\r\n\r\nexport const personExecFragment = gql`\r\n\tfragment personExecFragment on Person {\r\n\t\tid\r\n\t\tamoName\r\n\t\texec {\r\n\t\t\tid\r\n\t\t\topTypes { ...opTypeFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const persons = gql`\r\n\tquery Persons {\r\n\t\tpersons { ...PersonFragmentBasic }\r\n\t}\r\n\t${personFragmentBasic}\r\n`\r\n\r\nexport const personExecs = gql`\r\n\tquery personExecs {\r\n\t\tpersons { ...personExecFragment }\r\n\t}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const personExec = gql`\r\n\tquery personExec ($id: ID!) {\r\n\t\tperson (id: $id) { ...personExecFragment }\r\n\t}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const upsertPerson2 = gql`\r\n\tmutation upsertPerson2($input: PersonInput!) {\r\n\t\tupsertPerson2(input: $input) {\r\n\t\t\t...personExecFragment\r\n\t\t}\r\n\t}\r\n\t${personExecFragment}\r\n`","import gql from 'graphql-tag'\r\nimport { personContactsFragment } from './person'\r\n\r\nexport const orgEmployees = gql`\r\n\tquery OrgEmployees ($orgId: ID!) {\r\n\t\torgEmployees (orgId: $orgId) {\r\n\t\t\tid\r\n\t\t\tposition\r\n\t\t\tperson { ...PersonContactsFragment }\r\n\t\t}\r\n\t}\r\n\t${personContactsFragment}\r\n`\r\n\r\nexport const upsertEmployee = gql`\r\n\tmutation UpsertEmployee(\r\n\t\t$input: EmployeeInput!\r\n\t) {\r\n\t\tupsertEmployee(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import React from 'react'\r\nimport produce from 'immer'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { orgLocal } from '../../graphql/org'\r\n\r\nimport styled from 'styled-components'\r\nimport { Header, Button, Icon } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nconst MenuDiv = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n\t/* border-top: 1px solid rgb(180, 181, 182); color of Chrome address section bottom border */\r\n\tborder-top: 1px solid rgb(160, 161, 162);\r\n`\r\n\r\nexport default ({\r\n\tclosePanel\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\tw='30px'\r\n\t\t\t\t\t\tm='0 10px'\r\n\t\t\t\t\t\tlink\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tonClick={closePanel}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Query\r\n\t\t\t\t\t\tquery={orgLocal}\r\n\t\t\t\t\t\tvariables={{id: bottomPanel.orgId}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\t\tif (data && data.orgLocal) return (\r\n\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\tpl='0 !important'\r\n\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\tcontent={`Представители \\u00A0 ${data.orgLocal.name}`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn null\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t// content=''\r\n\t\t\t\t\t\tactive={ !bottomPanel.id }\r\n\t\t\t\t\t\tonClick={() => setBottomPanel(\r\n\t\t\t\t\t\t\tproduce(bottomPanel, draft => { delete draft.id })\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nexport default ({\r\n  tel\r\n}) => {\r\n  return (\r\n    <div>\r\n      {formatTel(tel)}\r\n    </div>\r\n  )\r\n}\r\n","import React, { Fragment } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport Tel from './Tel'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n  flex: 0 0 122px;\r\n  color: rgba(0,0,0,.87);\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n  vertical-align: top;\r\n`\r\n\r\nconst Content = styled.div`\r\n  flex: 1 1 auto;\r\n  min-width: 210px;\r\n  font-size: calc(15rem/14);\r\n  font-weight: bold;\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n`\r\n\r\nexport default ({\r\n  type,\r\n  label,\r\n  content\r\n}) => {\r\n  const component = data =>\r\n    type === 'string' ? data :\r\n    type === 'tel' ? <Tel tel={data} />\r\n    : null\r\n  return (\r\n    <Container>\r\n      <Label>\r\n        {label}\r\n      </Label>\r\n      <Content>\r\n        {Array.isArray(content)\r\n          ? content.map((item, i) => \r\n              <Fragment key={i}>\r\n                {component(item)}\r\n              </Fragment>\r\n            )\r\n          : component(content)\r\n        }\r\n      </Content>\r\n    </Container>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Field from './Field'\r\n\r\nconst renderObj = (obj, objSchema, key) => {\r\n  // obj may be any value\r\n  // objSchema should be either Object or Array with only one schema object element\r\n  const isArray = Array.isArray(objSchema)\r\n  const schema = isArray ? objSchema[0] : objSchema\r\n  const schemaKeys = Object.keys(schema)\r\n  // if objSchema contains 'label' than that's a field\r\n  const isField = schemaKeys.includes('label')\r\n  if (isField) {\r\n    // default type is 'string\r\n    const type = schema.type || 'string'\r\n    return (\r\n      <Field\r\n        key={key}\r\n        type={type}\r\n        label={schema.label}\r\n        content={obj}\r\n      />\r\n    )\r\n  }\r\n  else {\r\n    // when traversing, take only obj keys that are non-empty arrays/values\r\n    return schemaKeys\r\n      .filter(k => Array.isArray(obj[k]) ? obj[k].length : !!obj[k])\r\n      .map((k, i)=> renderObj(obj[k], objSchema[k], i))\r\n  }\r\n}\r\n\r\nexport default ({\r\n  entity,\r\n  schema\r\n}) => renderObj(entity, schema, '0')\r\n","import { lazy, object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tcountry: string()\r\n\t\t.oneOf(['rus', 'notRus'])\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.default('rus')\r\n\t\t),\r\n\tnumber: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string()\r\n\t\t\t.transform(val => val.match(/.*\\d.*/) //if value contains digits\r\n\t\t\t\t? val.match(/\\d+/g).join('') // extract and join digits\r\n\t\t\t\t: val // else pass value through\r\n\t\t\t)\r\n\t\t\t.when('country', {\r\n\t\t\t\tis: 'rus',\r\n\t\t\t\tthen: string().matches(/\\d{10}/, 'российский телефонный номер должен содержать 10 цифр'), \t\t\t\t\t\t\t\t\t// check number of digits for russia (10)\r\n\t\t\t\totherwise: string().matches(/\\d{7,25}/, 'международный телефонный номер должен содержать от 7 до 25 цифр')\t// from 7 to 25 for notRus numbers\r\n\t\t\t})\r\n\t)\r\n})","import { lazy, array, object, string } from 'yup'\r\n\r\nimport { validationSchema as telValidationSchema } from './tel'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tlName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\tfName: string().trim().min(2).max(255)\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required('Пропущено обязательное поле Имя')\r\n\t\t)\r\n  ,\r\n\tmName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\ttels: array().of(telValidationSchema)\r\n})","import { object } from 'yup'\r\n\r\nimport { validationSchema as personValidationSchema } from './person'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  orgId: idValidationType\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required()\r\n\t\t),\r\n  person: personValidationSchema\r\n})\r\n\r\nexport const formikSchema = {\r\n  person: {\r\n    lName: '',\r\n    fName: '',\r\n    mName: '',\r\n    tels: [{\r\n      number: '',\r\n      country: 'rus',\r\n    }]\r\n  }\r\n}\r\n\r\nexport const listSchema = {\r\n  person: {\r\n    lName: {\r\n      label: 'Фамилия'\r\n    },\r\n    fName: {\r\n      label: 'Имя'\r\n    },\r\n    mName: {\r\n      label: 'Отчество'\r\n    },\r\n    tels: [{\r\n      label: 'Телефон',\r\n      type: 'tel'\r\n    }]\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport List from '../list/List'\r\nimport { listSchema } from '../../schema/employee'\r\n\r\nexport default ({\r\n  emp,\r\n  toggleEditMode\r\n}) => {\r\n  return <>\r\n    <DetailsHeader\r\n      title={emp.person.fullname}\r\n      size='small'\r\n      noIndent\r\n      bottomBorder='dark'\r\n      buttons={<>\r\n        <Icon\r\n          link\r\n          name='edit'\r\n          activeColor='blue'\r\n          onClick={toggleEditMode}\r\n        />\r\n      </>}\r\n    />\r\n    <Div\r\n      p='1em'\r\n    >\r\n      <List\r\n        entity={emp}\r\n        schema={listSchema}\r\n      />\r\n    </Div>\r\n  </>\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertEmployee } from '../../graphql/employee'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/employee'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\n// position\r\n// fName\r\n// lName\r\n// mName\r\n// htmlNote\r\n// tels { ...TelFragment }\r\n// user {\r\n//   email\r\n//   confirmed\r\n// }\r\n\r\nexport default class EmployeeForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    let schema = emp ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = emp ? projectEntity(emp, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertEmployee}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertEmployee, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('input > ', input)\r\n              await upsertEmployee({ variables: { input } })\r\n              // const upserted = await upsertEmployee({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return emp\r\n                ? toggleEditMode()\r\n                : this.didMount && resetForm()\r\n            }}\r\n          >\r\n            {({\r\n              values,\r\n              handleChange,\r\n              handleSubmit,\r\n              handleReset,\r\n              setFieldValue\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label='Фамилия'\r\n                  name='person.lName'\r\n                />\r\n                <Field\r\n                  label='Имя'\r\n                  required\r\n                  name='person.fName'\r\n                />\r\n                <Field\r\n                  label='Отчество'\r\n                  name='person.mName'\r\n                />\r\n                <Field\r\n                  label='Телефон'\r\n                  name='person.tels'\r\n                />\r\n                {/* TODO add email input */}\r\n                {/* <Field\r\n                  label='E-mail'\r\n                  name='person.email'\r\n                /> */}\r\n                {!!error &&\r\n                  <Message\r\n                    error\r\n                    header='Не удалось добавить..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  // type=\"submit\"\r\n                  type='button'\r\n                  primary\r\n                  content={emp ? 'Сохранить' : 'Добавить'}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ emp ? toggleEditMode : handleReset}\r\n                >\r\n                  {emp ? 'Отмена' : 'Очистить'}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport DetailsHeader from '../DetailsOld/DetailsHeader'\r\nimport EmployeeForm from './Form'\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nexport default class EmployeeEdit extends Component {\r\n  render() {\r\n    const { \r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    return <>\r\n      <DetailsHeader\r\n        title={\r\n          emp\r\n          ? 'Редактировать'\r\n          : 'Добавить представителя'\r\n        }\r\n        size='small'\r\n        noIndent\r\n        bottomBorder='dark'\r\n        buttons={<>\r\n          {/* <Icon\r\n            link\r\n            name='save'\r\n            color='blue'\r\n            onClick={(emp) => console.log('upsert emp -> ', emp)}\r\n          /> */}\r\n        </>}\r\n      />\r\n      <Div\r\n        p='1em'\r\n        oy='auto'\r\n        h='315px'\r\n      >\r\n        <EmployeeForm\r\n          emp={emp}\r\n          orgId={orgId}\r\n          toggleEditMode={toggleEditMode}\r\n          refetchQueries={refetchQueries}\r\n        />\r\n      </Div>\r\n    </>\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nimport GlobalContext from '../context/GlobalContext'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nconst fields = [{\r\n\tname: 'fullname',\r\n\ttitle: 'ФИО',\r\n\twidth: '250px'\r\n},{\r\n  name: 'tel',\r\n  title: 'Телефон',\r\n  width: '140px'\r\n}]\r\n\r\nexport default ({\r\n  emps\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<Table\r\n          fields={fields}\r\n          indent='27px'\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\temps.map(emp => {\r\n              const { id, person } = emp\r\n              const { lName, fName, mName, tels } = person || {}\r\n\t\t\t\t\t\t\tconst active = bottomPanel.id === id\r\n\t\t\t\t\t\t\treturn (\r\n                <TableRow\r\n                  key={id}\r\n                  entity={emp}\r\n                  tableFields={tableFields}\r\n                  rowFields={[{\r\n                    name: 'fullname',\r\n                    value: person\r\n                      ? [lName, fName, mName].join(' ')\r\n                      : 'Персональные данные удалены'\r\n                  },{\r\n                    name: 'tel',\r\n                    value: (tels && tels.length && formatTel(tels[0])) || ''\r\n                  }\r\n                  // ,{\r\n                  //   name: 'emps',\r\n                  //   icon: org.employees.length ? 'user' : 'user plus',\r\n                  //   iconColor: 'grey',\r\n                  //   type: 'onHover',\r\n                  //   styles: ['center'],\r\n                  //   value: org.employees.length || ' ',\r\n                  //   onClick: () => {\r\n                  //     setBottomPanel({\r\n                  //       type: 'Employees',\r\n                  //       orgId: org.id\r\n                  //     })\r\n                  //   },\r\n                  //   active: bottomPanel\r\n                  //     && bottomPanel.type === 'Employees'\r\n                  //     && bottomPanel.orgId === org.id\r\n                  // }\r\n                  ]}\r\n                  active={active}\r\n                  onClick={() => {\r\n                    setBottomPanel({\r\n                      ...bottomPanel,\r\n                      editMode: false,\r\n                      id\r\n                    })\r\n                  }}\r\n                />\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport produce from 'immer'\r\nimport { Query } from 'react-apollo'\r\nimport { orgEmployees } from '../../graphql/employee'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { Message } from '../styled/styled-semantic';\r\nimport GlobalContext from '../context/GlobalContext'\r\nimport EmployeesPanelHeader from '../Employee/PanelHeader'\r\nimport EmployeeDetails from '../Employee/Details'\r\nimport EmployeeEdit from '../Employee/Edit'\r\nimport EmployeesTable from '../Employee/Table';\r\n\r\nconst EmployeesPanelBody = styled.div`\r\n  display: flex;\r\n  height: calc(100% - 37px);\r\n`\r\n\r\nconst EmployeesPanelTableSection = styled.div`\r\n  flex: 0 0 600px;\r\n`\r\n\r\nconst EmployeeDetailsSection = styled.div`\r\n  flex: 0 0 480px;\r\n  border: solid rgb(156,156,159);\r\n  border-width: 0 1px;\r\n  min-height: 100%;\r\n`\r\n\r\nconst processEmp = emp =>\r\n  produce(emp, draft => {\r\n    const { lName, fName, mName } = draft.person\r\n    draft.person.fullname = [lName, fName, mName].join(' ')\r\n  })\r\n\r\nexport default ({\r\n  closePanel\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ bottomPanel, setBottomPanel }) => <>\r\n        <EmployeesPanelHeader \r\n          closePanel={closePanel}\r\n        />\r\n        <Query\r\n          query={orgEmployees}\r\n          variables={{ orgId: bottomPanel.orgId }}\r\n        >\r\n          {({ loading, error, data, refetch }) => {\r\n            if (loading) return 'Загрузка..'\r\n            if (error) return `Ошибка ${error.message}`\r\n            const emps = data.orgEmployees\r\n            const activeEmp = bottomPanel.id && data.orgEmployees.find(e => e.id === bottomPanel.id)\r\n            return (\r\n              <EmployeesPanelBody>\r\n                <EmployeesPanelTableSection>\r\n                  {emps.length\r\n                    ? <EmployeesTable\r\n                        emps={emps}\r\n                      />\r\n                    : <Message\r\n                        m='1em'\r\n                        content={<>\r\n                          Добавьте первого представителя<br/>\r\n                          👉\r\n                        </>}\r\n                      />\r\n                  }\r\n                </EmployeesPanelTableSection>\r\n                <EmployeeDetailsSection>\r\n                  {!bottomPanel.id\r\n                    ? <EmployeeEdit \r\n                        orgId={bottomPanel.orgId}\r\n                        refetchQueries={refetch}\r\n                      /> :\r\n                    !activeEmp.person ?\r\n                      null :\r\n                    bottomPanel.editMode\r\n                    ? <EmployeeEdit\r\n                        emp={activeEmp}\r\n                        orgId={bottomPanel.orgId}\r\n                        toggleEditMode={() => setBottomPanel(\r\n                          produce(bottomPanel, draft => { delete draft.editMode })\r\n                        )}\r\n                        refetchQueries={refetch}\r\n                      />\r\n                    : <EmployeeDetails\r\n                        emp={processEmp(activeEmp)}\r\n                        toggleEditMode={() => setBottomPanel({ ...bottomPanel, editMode: true })}\r\n                      />\r\n                  }\r\n                </EmployeeDetailsSection>\r\n              </EmployeesPanelBody>\r\n            )\r\n          }}\r\n        </Query>\r\n      </>}\r\n    </GlobalContext>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { allEnquiries } from '../../graphql/enquiry'\r\nimport { setLayout } from '../../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar } from 'semantic-ui-react'\r\n\r\nimport EnquiriesMenu from './EnquiriesMenu'\r\nimport EnquiriesTable from './EnquiriesTable'\r\nimport DetailsSidebar from '../DetailsOld/DetailsSidebar'\r\nimport PanelPusher from '../common/PanelPusher';\r\nimport EnquiriesBottomPanel from './EnquiriesBottomPanel';\r\nimport GlobalContext from '../context/GlobalContext';\r\n\r\nconst Pushable = styled(Sidebar.Pushable)`\r\n\tmin-height: calc(100vh - 36px) !important;\r\n`\r\n\r\nexport class EnquiriesPage extends Component {\r\n\t// TODO refactor -> move bottomPanel logic to PanelProvider, switch to Apollo Query components\r\n\tstate = { panelClosing: false }\r\n\tclosePanel = () => {\r\n\t\tthis.setState({ panelClosing: true })\r\n\t\t// set timeout for panel to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { input: { bottomPanel: null } } })\r\n\t\t\tthis.setState({ panelClosing: false })\r\n\t\t}, 430)\r\n\t}\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tallEnquiries: { loading, error, refetch, enquiries },\r\n\t\t\trefreshToken\r\n\t\t} = this.props\r\n\t\tconst { panelClosing } = this.state\r\n\t\treturn <>\r\n\t\t\t<EnquiriesMenu\r\n\t\t\t\trefetchEnquiries={() => refetch()}\r\n\t\t\t\tenquiriesAreLoading={loading}\r\n\t\t\t\trefreshToken={refreshToken}\r\n\t\t\t/>\r\n\t\t\t{loading && \"Загрузка...\"}\r\n\t\t\t{error && `Ошибка ${error.message}`}\r\n\t\t\t{enquiries &&\r\n\t\t\t\t<GlobalContext>\r\n\t\t\t\t\t{({ bottomPanel }) =>\r\n\t\t\t\t\t\t<Pushable>\r\n\t\t\t\t\t\t\t<DetailsSidebar />\r\n\t\t\t\t\t\t\t<Sidebar.Pusher>\r\n\t\t\t\t\t\t\t\t<PanelPusher\r\n\t\t\t\t\t\t\t\t\tpanel={\r\n\t\t\t\t\t\t\t\t\t\t<EnquiriesBottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\tclosePanel={this.closePanel}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpanelRendered={!!bottomPanel}\r\n\t\t\t\t\t\t\t\t\tpanelVisible={!!bottomPanel && !panelClosing}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<EnquiriesTable\r\n\t\t\t\t\t\t\t\t\t\tenquiries={enquiries}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</PanelPusher>\r\n\t\t\t\t\t\t\t</Sidebar.Pusher>\r\n\t\t\t\t\t\t</Pushable>\r\n\t\t\t\t\t}\r\n\t\t\t\t</GlobalContext>\r\n\t\t\t}\r\n\t\t</>\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(allEnquiries, {\r\n\t\tname: 'allEnquiries',\r\n\t\talias: 'allEnquiriesQuery'\r\n\t}),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(EnquiriesPage)","import gql from 'graphql-tag'\r\n\r\nexport const articleFragmentBasic = gql`\r\n\tfragment ArticleFragmentBasic on Article {\r\n\t\tid\r\n\t\trusName\r\n\t\tisIncome\r\n\t\tisLoan\r\n\t}\r\n`\r\n\r\nexport const articleFragmentFull = gql`\r\n\tfragment ArticleFragmentFull on Article {\r\n\t\t...ArticleFragmentBasic\r\n\t\trelations\r\n\t}\r\n\t${articleFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\n\r\nexport const accountFragmentBasic = gql`\r\n\tfragment AccountFragmentBasic on Account {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const accountFragmentFull = gql`\r\n\tfragment AccountFragmentFull on Account {\r\n\t\t...AccountFragmentBasic\r\n\t\tname\r\n\t\tnumber\r\n\t}\r\n\t${accountFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const equipmentFragmentBasic = gql`\r\n\tfragment EquipmentFragmentBasic on Equipment {\r\n\t\tid\r\n\t\tname\r\n\t}\r\n`\r\n\r\nexport const equipmentFragmentFull = gql`\r\n\tfragment EquipmentFragmentFull on Equipment {\r\n\t\t...EquipmentFragmentBasic\r\n\t}\r\n\t${equipmentFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\nimport { articleFragmentBasic, articleFragmentFull } from './article'\r\nimport { personFragmentBasic } from './person'\r\nimport { accountFragmentBasic, accountFragmentFull } from './account'\r\nimport { equipmentFragmentBasic } from './equipment'\r\nimport { orgFragmentBasic } from './org';\r\n\r\nexport const paymentFragmentBasic = gql`\r\n\tfragment PaymentFragmentBasic on Payment {\r\n\t\tid\r\n\t\tisIncome\r\n\t\tdateLocal\r\n\t\tamount\r\n\t\tpurpose\r\n\t\taccount { ...AccountFragmentBasic }\r\n\t\tarticle { ...ArticleFragmentBasic }\r\n\t\tequipment { ...EquipmentFragmentBasic }\r\n\t\torg { ...OrgFragmentBasic }\r\n\t\tperson { ...PersonFragmentBasic }\r\n\t}\r\n\t${accountFragmentBasic}\r\n\t${articleFragmentBasic}\r\n\t${equipmentFragmentBasic}\r\n\t${orgFragmentBasic}\r\n\t${personFragmentBasic}\r\n`\r\n\r\nexport const payments = gql`\r\n\tquery Payments {\r\n\t\tpayments { ...PaymentFragmentBasic }\r\n\t}\r\n\t${paymentFragmentBasic}\r\n`\r\n\r\nexport const paymentsPage = gql`\r\n\tquery PaymentsPage {\r\n\t\taccounts { ...AccountFragmentFull }\r\n\t\tarticles { ...ArticleFragmentFull }\r\n\t\torgs { ...OrgFragmentBasic }\r\n\t\tequipments { ...EquipmentFragmentBasic }\r\n\t\tpayments { ...PaymentFragmentBasic }\r\n\t}\r\n\t${accountFragmentFull}\r\n\t${articleFragmentFull}\r\n\t${orgFragmentBasic}\r\n\t${equipmentFragmentBasic}\r\n\t${paymentFragmentBasic}\r\n`\r\n\r\nexport const upsertPayment = gql`\r\n\tmutation UpsertPayment(\r\n\t\t$input: PaymentInput!\r\n\t) {\r\n\t\tupsertPayment(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\t...PaymentFragmentBasic\r\n\t\t}\r\n\t}\r\n\t${paymentFragmentBasic}\r\n`\r\n","import React from 'react'\r\n\r\nimport {\r\n  XAxis,\r\n  YAxis,\r\n  HorizontalGridLines,\r\n  LineSeries,\r\n  VerticalBarSeries,\r\n  FlexibleWidthXYPlot\r\n} from 'react-vis'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n`\r\n\r\nexport default ({\r\n  payments: allPayments\r\n}) => {\r\n  const payments = allPayments\r\n    .filter(p => !p.article || !p.article.isLoan)\r\n  const data = payments.map(p => {\r\n    const isIncome = p.article\r\n      ? p.article.isIncome\r\n      : p.isIncome\r\n    return {\r\n      x: new Date(p.dateLocal.slice(0, 10)).getTime(),\r\n      y: (!!isIncome ? 1 : -1) * p.amount\r\n    }\r\n  })\r\n  const [positive, negative, total] = data\r\n    .reduce((arrs, p) => {\r\n      let length = arrs[0].length\r\n      if (!length || arrs[0][length - 1].x !== p.x) {\r\n        arrs.forEach(arr => arr.push({ x: p.x, y: 0, y0: 0 }))\r\n        length = arrs[0].length\r\n      }\r\n      if (p.y > 0) arrs[0][length - 1].y += p.y\r\n      if (p.y < 0) {\r\n        arrs[1][length - 1].y0 += p.y\r\n      }\r\n      arrs[2][length - 1].y += p.y\r\n      return arrs\r\n    }, [[], [], []])\r\n  let sum = 0\r\n  const lineData = total.reverse().reduce((lineData, p) => {\r\n    const pointIndex = (\r\n      lineData.findIndex(({ x }) => x === p.x) + 1\r\n      || (\r\n          lineData.push({ x: p.x, y: sum })\r\n          && lineData.push({ x: p.x, y: 0 })\r\n        )\r\n    ) - 1\r\n    lineData[pointIndex].y = sum += p.y\r\n    return lineData\r\n  }, [])\r\n  return (\r\n    <Container>\r\n      <FlexibleWidthXYPlot\r\n        height={400}\r\n        margin={{\r\n          left: 60\r\n        }}\r\n        stackBy=\"y\"\r\n      >\r\n        <HorizontalGridLines />\r\n        <XAxis \r\n          tickFormat={(d) => new Date(d).toLocaleDateString()}\r\n        />\r\n        <YAxis />\r\n        <LineSeries\r\n          data={lineData}\r\n        />\r\n        <VerticalBarSeries\r\n          stack={true}\r\n          data={negative}\r\n          color='rgb(255, 152, 51)'\r\n        />\r\n        <VerticalBarSeries\r\n          stack={true}\r\n          data={positive}\r\n          color='#4fb79b'\r\n        />\r\n      </FlexibleWidthXYPlot>\r\n    </Container>\r\n  )\r\n}\r\n","import gql from 'graphql-tag'\r\nimport { personFragmentBasic, personExecFragment } from './person';\r\n\r\nexport const syncWithAmoContacts = gql`\r\n\tmutation SyncWithAmoContacts {\r\n\t\tsyncWithAmoContacts {\r\n\t\t\t...PersonFragmentBasic\r\n\t\t\t...personExecFragment\r\n\t\t}\r\n\t}\r\n\t${personFragmentBasic}\r\n\t${personExecFragment}\r\n`\r\n","import { object, number, string, date } from 'yup'\r\nimport { idValidationType } from './commonTypes'\r\nimport { toLocalISOString } from '../utils/dates';\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  amount: number()\r\n    .positive('зачение должно быть положительным')\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('введите сумму платежа'),\r\n    ),\r\n  articleId: idValidationType\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('выберите основание платежа')\r\n    ),\r\n  dateLocal: date('неверный формат даты')\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required('введите дату и время в формате ГГГГ-ММ-ДДTЧЧ:ММ'),\r\n    ),\r\n    // TODO create proper isValidISODate function to check date\r\n    // .transform(function(value, originalValue) {\r\n    //   return isValidISODate(value) ? value : new Date('');\r\n    // }),\r\n  equipmentId: idValidationType\r\n    .notRequired(),\r\n    // TODO proper conditional validation of equipmentId\r\n    // equipmentId: idValidationType\r\n    //   .when('articleId', (articleId, schema) => \r\n    //     articles.find(a => a.id === articleId).relations.includes('EQUIPMENT')\r\n    //     ? schema.required('выберите оборудование')\r\n    //     : schema.strip()\r\n    //   ),\r\n  personId: idValidationType\r\n    .notRequired(),\r\n    // TODO I'm disappointed with yup. Schema definition rules are not semantic, need to change to something else!\r\n    // .when('id', (id, schema) => id\r\n    //   ? schema.notRequired()\r\n    //   : schema.required('выберите контрагента')\r\n    // ),\r\n  orgId: idValidationType\r\n    .notRequired(),\r\n  purpose: string()\r\n    .max(250, 'превышено максимальное число символов (250)')\r\n    .notRequired(),\r\n})\r\n\r\nexport const formikSchema = date => ({\r\n  dateLocal: toLocalISOString(date),\r\n  articleId: '',\r\n  equipmentId: '',\r\n  personId: '',\r\n  orgId: '',\r\n  purpose: '',\r\n  amount: ''\r\n})\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport { Mutation, Query } from 'react-apollo'\r\nimport { upsertPayment, paymentsPage } from '../../graphql/payment'\r\nimport { syncWithAmoContacts } from '../../graphql/amo'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/payment'\r\nimport Field from '../form/FormikField'\r\n\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\n\r\nimport styled from 'styled-components'\r\nimport { Button, A, Div } from '../styled/styled-semantic'\r\nimport { persons } from '../../graphql/person'\r\nimport produce from 'immer'\r\nimport { createOrg } from '../../graphql/org'\r\n\r\nconst Container = styled.div`\r\n\tmin-height: content;\r\n\tmax-width: 50%;\r\n\tmin-width: 430px;\r\n\tflex: 0 0 430px;\r\n\tbox-shadow: 0 2px 4px 0 rgba(34,36,38,.12), 0 2px 10px 0 rgba(34,36,38,.15);\r\n\tborder: 1px solid rgba(34,36,38,.15);\r\n\tborder-radius: .28571429rem;\r\n`\r\n\r\nconst Header = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\theight: 52px;\r\n\tpadding: 0 2rem;\r\n\tfont-size: 1.28571429rem;\r\n\tline-height: 1.28571429em;\r\n\tfont-weight: bold;\r\n\tborder-bottom: 1px solid rgba(34,36,38,.15);\r\n`\r\n\r\nconst Fields = styled.div`\r\n\t.fz-formFieldLabel {\r\n\t\t${({ labelWidth }) => labelWidth ? `flex-basis: ${labelWidth} !important;` : ''}\r\n\t}\r\n`\r\n\r\nconst CounterpartyFieldSwitch = ({\r\n\tchildren,\r\n\tpayment\r\n}) => {\r\n\tconst [orgCounterparty, setOrgCounterparty] = useState(!!(payment && payment.org))\r\n\tuseEffect(() => {\r\n\t\tsetOrgCounterparty(!!(payment && payment.org))\r\n\t}, [payment])\r\n\treturn (\r\n\t\tchildren({\r\n\t\t\torgCounterparty,\r\n\t\t\tsetOrgCounterparty\r\n\t\t})\r\n\t)\r\n}\r\n\r\nexport default ({\r\n\tpayment,\r\n\treset,\r\n\tarticles,\r\n\torgs,\r\n\tequipment\r\n}) => {\r\n\tlet schema = formikSchema(new Date())\r\n\tlet initialValues = payment ? projectEntity(payment, schema) : schema\r\n\tconst formLabelWidth = '110px'\r\n\tconst articleOptions = articles.map(a => \r\n\t\t({ key: a.id, text: a.rusName, value: a.id })\r\n\t)\r\n\tconst bankPayment = payment && payment.isIncome !== null\r\n\treturn (\r\n\t\t<NotificationsConsumer>\r\n\t\t\t{({ notify }) =>\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t<Query\r\n\t\t\t\t\t\tquery={persons}\r\n\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\ttitle: 'Ошибка загрузки контактов',\r\n\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{({ loading: personsLoading,\r\n\t\t\t\t\t\t\t\tdata,\r\n\t\t\t\t\t\t\t\trefetch: refetchPersons\r\n\t\t\t\t\t\t\t}) => <>\r\n\t\t\t\t\t\t\t<Mutation\r\n\t\t\t\t\t\t\t\tmutation={syncWithAmoContacts}\r\n\t\t\t\t\t\t\t\tonCompleted={() => {\r\n\t\t\t\t\t\t\t\t\trefetchPersons()\r\n\t\t\t\t\t\t\t\t\tnotify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Контакты синхронизированы'\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\ttitle: 'Ошибка синхронизации с Амо',\r\n\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{(syncWithAmoContacts, { loading }) => \r\n\t\t\t\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t\t\t\t{(payment ? 'Изменить' : 'Добавить') + ' платеж'}\r\n\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\tml='auto'\r\n\t\t\t\t\t\t\t\t\t\t\ticon='sync alternate'\r\n\t\t\t\t\t\t\t\t\t\t\tcontent='Контакты AmoCRM'\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => syncWithAmoContacts()}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t<Div\r\n\t\t\t\t\t\t\t\tp='1rem 2rem'\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Mutation\r\n\t\t\t\t\t\t\t\t\tmutation={upsertPayment}\r\n\t\t\t\t\t\t\t\t\tonCompleted={() => notify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Платеж сохранен'\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Ошибка сохранения',\r\n\t\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\tupdate={(cache, { data: { upsertPayment } }) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { payments } = cache.readQuery({ query: paymentsPage })\r\n\t\t\t\t\t\t\t\t\t\tcache.writeQuery({\r\n\t\t\t\t\t\t\t\t\t\t\tquery: paymentsPage,\r\n\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\tpayments: produce(payments, draft => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst foundIndex = payments.findIndex(p => p.id === upsertPayment.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfoundIndex !== -1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? draft.splice(foundIndex, 1, upsertPayment)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: draft.unshift(upsertPayment)\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{(upsertPayment, { loading }) =>\r\n\t\t\t\t\t\t\t\t\t\t<Formik\r\n\t\t\t\t\t\t\t\t\t\t\tinitialValues={initialValues}\r\n\t\t\t\t\t\t\t\t\t\t\tenableReinitialize={true}\r\n\t\t\t\t\t\t\t\t\t\t\tvalidationSchema={validationSchema}\r\n\t\t\t\t\t\t\t\t\t\t\tonSubmit={async (values, { resetForm }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst input = preparePayload(values, initialValues, schema)\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!payment && !input.dateLocal) \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinput.dateLocal = initialValues.dateLocal\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait upsertPayment({ variables: { input } })\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn payment ? reset() : resetForm()\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{({\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalues,\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleSubmit,\r\n\t\t\t\t\t\t\t\t\t\t\t\thandleReset,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue,\r\n\t\t\t\t\t\t\t\t\t\t\t}) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Fields\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabelWidth={formLabelWidth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Дата'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='dateLocal'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='date'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Статья'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='articleId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={articleOptions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CounterpartyFieldSwitch\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={payment}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpayment={payment}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({orgCounterparty, setOrgCounterparty}) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torgCounterparty\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? <Mutation\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmutation={createOrg}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCompleted={(res) => console.log('res > ', res) || notify({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Организация добавлена'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={err => notify({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Ошибка. Организация не добавлена',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdate={(cache, { data: { createOrg } }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst { orgs } = cache.readQuery({ query: paymentsPage })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcache.writeQuery({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tquery: paymentsPage,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torgs: produce(orgs, draft => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst foundIndex = orgs.findIndex(o => o.id === createOrg.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfoundIndex !== -1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? draft.splice(foundIndex, 1, createOrg)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: draft.unshift(createOrg)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(createOrg, { loading: orgsLoading }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Контрагент'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='orgId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={orgs\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? orgs.map(o => \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({ key: o.id, text: o.name + ' (ИНН: ' + o.inn + ')', value: o.id })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={orgsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={orgsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowAdditions\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tadditionLabel='Добавить по ИНН: '\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonAddItem={async (e, { value: inn }) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst created = await createOrg({ variables: { inn: inn.toString() } })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('orgId', created && created.data && created.data.createOrg.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontentBeforeField={<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tОрганизация или <A\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOrgCounterparty(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('orgId', '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>Персона</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: <Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Контрагент'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='personId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={data.persons\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? data.persons.map(p => \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({ key: p.id, text: p.amoName || p.fName, value: p.id })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: []\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={personsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={personsLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontentBeforeField={<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tПерсона или <A\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetOrgCounterparty(true)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetFieldValue('personId', '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>Организация</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</CounterpartyFieldSwitch>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{values.articleId\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& articles.find(a => a.id === values.articleId).relations\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& articles.find(a => a.id === values.articleId).relations.includes('EQUIPMENT') &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Оборудование'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='equipmentId'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={equipment.map(e => \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t({ key: e.id, text: e.name, value: e.id })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{!bankPayment && <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Назначение'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='purpose'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel='Сумма'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname='amount'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tml={formLabelWidth}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype='button'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={payment ? 'Сохранить' : 'Добавить'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={handleSubmit}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<A cancel\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={payment ? () => reset() : handleReset}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{payment ? 'Отмена' : 'Очистить'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</A>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Fields>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</Formik>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</Mutation>\r\n\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t</>}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t</Container>\r\n\t\t\t}\r\n\t\t</NotificationsConsumer>\r\n\t)\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Statistic } from 'semantic-ui-react'\r\nimport { currency } from '../../utils/format'\r\n\r\nconst Container = styled.div`\r\n\tflex-grow: 1;\r\n\theight: 100%;\r\n\tmargin-left: 30px;\r\n  overflow-y: auto;\r\n\t>div {\r\n\t\twidth: 100%;\r\n\t}\r\n`\r\n\r\nconst SStatistic = styled(Statistic)`\r\n\t&&&&>.value {\r\n\t\t${({ color }) => color && `\r\n\t\t\tcolor: ${\r\n\t\t\t\tcolor === 'green' ? '#016936' :\r\n\t\t\t\tcolor === 'red' ? '#9f3a38' :\r\n\t\t\t\tcolor === 'purple' ? '#9924bf' :\r\n\t\t\t\t// color === 'violet' ? '#5d31bb' :\r\n\t\t\t\tcolor === 'blue' ? '#2185d0' :\r\n\t\t\t\tcolor\r\n\t\t\t};\r\n\t\t`}\r\n\t\ttext-align: unset;\r\n\t}\r\n\t&&&&>.label {\r\n\t\tpadding-left: 2em;\r\n\t\ttext-align: unset;\r\n\t}\r\n`\r\n\r\nexport default ({\r\n\tpayments,\r\n\taccounts,\r\n\torgs,\r\n}) => {\r\n\t// TODO make postgres aggregation query on server side instead of reduce here\r\n\tconst accountsStats = payments\r\n\t\t.reduce((accounts, p) => {\r\n\t\t\tconst account = accounts.find(a => a.id === p.account.id)\r\n\t\t\tconst isIncome = p.article ? p.article.isIncome : p.isIncome\r\n\t\t\taccount.total += (isIncome ? 1 : -1) * p.amount\r\n\t\t\treturn accounts\r\n\t\t}, accounts.map(a => ({ ...a, total: 0 })))\r\n\tconst persons = payments\r\n\t\t.filter(p => !!p.person)\r\n\t\t.map(p => p.person)\r\n\t\t.reduce((uniquePersons, p) => {\r\n\t\t\tif (!uniquePersons.find(up => up.id === p.id))\r\n\t\t\t\tuniquePersons.push(p)\r\n\t\t\treturn uniquePersons\r\n\t\t}, [])\r\n\tconst debtsAndLoans = payments\r\n\t\t.filter(p => !!p.article)\r\n\t\t.filter(p => p.article.isLoan)\r\n\t\t.reduce((debts, p) => {\r\n\t\t\tconst counterparty = debts.find(d => d.id === (p.person && p.person.id) || d.id === (p.org && p.org.id))\r\n\t\t\tcounterparty.total += (p.article.isIncome ? 1 : -1) * p.amount\r\n\t\t\treturn debts\r\n\t\t}, [\r\n\t\t\t...persons.map(a => ({ ...a, total: 0 })),\r\n\t\t\t...orgs.map(a => ({ ...a, total: 0 }))\r\n\t\t])\r\n\t\t.reduce((split, d) => {\r\n\t\t\tif (d.total > 0) split[1].push(d)\r\n\t\t\telse if (d.total < 0) split[0].push({ ...d, total: -1*d.total})\r\n\t\t\treturn split\r\n\t\t}, [[],[]])\r\n\treturn (\r\n\t\t<Container>\r\n\t\t\t<Statistic.Group>\r\n\t\t\t\t<SStatistic\r\n\t\t\t\t\tcolor='green'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\tcontent={currency(accountsStats\r\n\t\t\t\t\t\t\t.filter(a => !a.number) // only cache accounts\r\n\t\t\t\t\t\t\t.reduce((sum, a) => sum + a.total, 0))}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\tcontent='Касса, в т.ч.'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{accountsStats\r\n\t\t\t\t\t\t\t.filter(a => !a.number)\r\n\t\t\t\t\t\t\t.map(({ id, name, total }) =>\r\n\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\tlabel={name}\r\n\t\t\t\t\t\t\t\t\tvalue={currency(total)} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t</SStatistic>\r\n\t\t\t\t<SStatistic\r\n\t\t\t\t\tcolor='blue'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\tcontent={currency(accountsStats\r\n\t\t\t\t\t\t\t.filter(a => !!a.number) // only bank accounts\r\n\t\t\t\t\t\t\t.reduce((sum, a) => sum + a.total, 0))}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\tcontent='Счета, в т.ч.'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{accountsStats\r\n\t\t\t\t\t\t\t.filter(a => !!a.number)\r\n\t\t\t\t\t\t\t.map(({ id, name, total }) =>\r\n\t\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\tlabel={name}\r\n\t\t\t\t\t\t\t\t\tvalue={currency(total)} \r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t</SStatistic>\r\n\t\t\t\t<SStatistic\r\n\t\t\t\t\tcolor='purple'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\tcontent={currency(debtsAndLoans[0].reduce((sum, l) => sum + l.total, 0))}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\tcontent='Нам должны, в т.ч.'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{debtsAndLoans[0].map(({ id, amoName, name, total }) =>\r\n\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\tlabel={!!amoName\r\n\t\t\t\t\t\t\t\t\t? amoName.slice(0, amoName.lastIndexOf(' ') + 2) + '.'\r\n\t\t\t\t\t\t\t\t\t: name.slice(0, 12) + '...'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvalue={currency(total)} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t</SStatistic>\r\n\t\t\t\t<SStatistic\r\n\t\t\t\t\tcolor='red'\r\n\t\t\t\t>\r\n\t\t\t\t\t<Statistic.Value\r\n\t\t\t\t\t\tcontent={currency(-debtsAndLoans[1].reduce((sum, d) => sum + d.total, 0))}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Label\r\n\t\t\t\t\t\tcontent='Мы должны, в т.ч.'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Statistic.Group\r\n\t\t\t\t\t\thorizontal\r\n\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{debtsAndLoans[1].map(({ id, amoName, name, total }) =>\r\n\t\t\t\t\t\t\t<Statistic\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\tlabel={!!amoName\r\n\t\t\t\t\t\t\t\t\t? amoName.slice(0, amoName.lastIndexOf(' ') + 2) + '.'\r\n\t\t\t\t\t\t\t\t\t: name.slice(0, 12) + '...'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvalue={currency(total)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Statistic.Group>\r\n\t\t\t\t</SStatistic>\r\n\t\t\t</Statistic.Group>\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\n","import React from 'react'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  margin-top: 1rem;\r\n  max-height: 100%;\r\n  border: 1px solid rgba(34,36,38,.15);\r\n  border-radius: 0.285714rem;\r\n  .fz-tableHeaderRow {\r\n    border-top: none !important;\r\n  }\r\n`\r\n\r\nconst fields = [{\r\n  name: 'edit',\r\n\twidth: '35px'\r\n},{\r\n  name: 'dateLocal',\r\n  path: 'dateLocal',\r\n\ttitle: 'Дата и время',\r\n\twidth: '145px'\r\n},{\r\n  name: 'article',\r\n  path: 'article.rusName',\r\n\ttitle: 'Статья',\r\n\twidth: '180px',\r\n  truncated: true\r\n},{\r\n  name: 'counterparty',\r\n  title: 'Контрагент',\r\n  width: '200px',\r\n  truncated: true\r\n},{\r\n  name: 'equipment',\r\n  path: 'equipment.name',\r\n  title: 'Оборудование',\r\n  width: '170px'\r\n},{\r\n  name: 'purpose',\r\n  path: 'purpose',\r\n  title: 'Назначение',\r\n  width: '270px',\r\n  truncated: true\r\n},{\r\n  name: 'amount',\r\n  path: 'amount',\r\n  title: 'Сумма',\r\n  width: '140px'\r\n}]\r\n\r\nexport default ({\r\n  payments,\r\n  activePayment,\r\n  onClickRow\r\n}) => {\r\n  //  TODO add CollectionUtils to support sorting\r\n  return (\r\n    <Container>\r\n      <Table\r\n        fields={fields}\r\n      >\r\n        {({ tableFields }) => \r\n          payments.map(payment => {\r\n            const { id, dateLocal, amount, person } = payment\r\n            const isIncome = payment.article ? payment.article.isIncome : payment.isIncome\r\n            return (\r\n              <TableRow\r\n                key={id}\r\n                entity={payment}\r\n                tableFields={tableFields}\r\n                rowFields={[\r\n                  {\r\n                    name: 'edit',\r\n                    icon: 'edit',\r\n                    iconColor: 'grey',\r\n                    hoverable: true,\r\n                    hideUnhovered: true,\r\n                    hasEntries: false,\r\n                    value: ' ',\r\n                    onClick: () => onClickRow(id),\r\n                    active: activePayment\r\n                      && activePayment.id === id\r\n                  },\r\n                  {\r\n                    name: 'dateLocal',\r\n                    value: dateLocal.slice(0,16).replace('T', ' '),\r\n                  },\r\n                  {\r\n                    name: 'counterparty',\r\n                    path: person ? 'person.amoName' : 'org.name',\r\n                  },\r\n                  {\r\n                    name: 'amount',\r\n                    value: isIncome ? amount : -amount,\r\n                    color: isIncome ? '#016936' : '#9f3a38'\r\n                  }\r\n                ]}\r\n                // onClick={() => onClickRow(id)}\r\n              />\r\n            )\r\n          }\r\n        )}\r\n      </Table>\r\n    </Container>\r\n  )\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const syncWithTochkaPayments = gql`\r\n\tmutation SyncWithTochkaPayments {\r\n\t\tsyncWithTochkaPayments {\r\n\t\t\tcount\r\n\t\t}\r\n\t}\r\n`\r\n","import React, { useState } from 'react'\r\n\r\nimport { Query, Mutation } from 'react-apollo'\r\nimport { paymentsPage } from '../../graphql/payment'\r\n\r\nimport styled from 'styled-components'\r\nimport PaymentChart from './Chart'\r\nimport PaymentForm from './Form'\r\nimport PaymentStats from './Stats'\r\nimport PaymentTable from './Table'\r\nimport { syncWithTochkaPayments } from '../../graphql/tochka'\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\nimport { Button, Icon } from '../styled/styled-semantic'\r\nimport { Route, Link, matchPath } from 'react-router-dom'\r\nimport Menu from '../Menu'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100% - 36px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n`\r\n\r\nconst TopSection = styled.div`\r\n  flex: 1 0 content;\r\n  min-height: ${308 + 47.5*2}px;\r\n  display: flex;\r\n  \r\n`\r\n\r\nconst BottomSection = styled.div`\r\n  flex: 1 1 2000px;\r\n  margin-top: 1rem;\r\n`\r\n\r\nexport default ({\r\n  refreshToken\r\n}) => {\r\n  const [activePayment, setActivePayment] = useState(null)\r\n  return (\r\n    <NotificationsConsumer>\r\n\t\t\t{({ notify }) =>\r\n        <Query\r\n          query={paymentsPage}\r\n          onError={err => notify({\r\n            type: 'error',\r\n            title: 'Ошибка загрузки платежей',\r\n            content: err.message,\r\n          })}\r\n        >\r\n          {({ loading: paymentsLoading,\r\n              error,\r\n              data: {\r\n                payments,\r\n                articles,\r\n                orgs,\r\n                accounts,\r\n                equipments: equipment\r\n              } = {},\r\n              refetch: refetchPayments\r\n            }) => <>\r\n              <Mutation\r\n                mutation={syncWithTochkaPayments}\r\n                onCompleted={({ syncWithTochkaPayments: { count } }) => {\r\n                  refetchPayments()\r\n                  notify({\r\n                    type: 'success',\r\n                    title: 'Платежи синхронизированы с банком. Добавлено: ' + count\r\n                  })\r\n                }}\r\n                onError={err => notify({\r\n                  type: 'error',\r\n                  title: 'Ошибка синхронизации с Точкой',\r\n                  content: err.message,\r\n                })}\r\n              >\r\n                {(syncWithTochkaPayments, { loading }) =>\r\n                  <Menu\r\n                    title='Платежи'\r\n                    titleLinkTo='/pay'\r\n                    refreshToken={refreshToken}\r\n                  >\r\n                    <Button compact circular menu\r\n                      w='120px'\r\n                      ml='0'\r\n                      ta='left'\r\n                      activeColor='blue' \r\n                      onClick={syncWithTochkaPayments}\r\n                    >\r\n                      <Icon\r\n                        name='refresh'\r\n                        color={loading ? 'blue' : undefined} \r\n                        loading={loading}\r\n                      />\r\n                      {loading ? 'Загрузка..' : 'Точка Банк'}\r\n                    </Button>\r\n                    <Link to={\r\n                      !!matchPath(\r\n                        window.location.href.replace(/.*#/, ''),\r\n                        '/pay/chart'\r\n                      )\r\n                        ? '/pay'\r\n                        : '/pay/chart'\r\n                    }>\r\n                      <Button compact circular menu\r\n                        activeColor='green'\r\n                        icon='chart bar outline'\r\n                        content='График'\r\n                        active={!!matchPath(\r\n                          window.location.href.replace(/.*#/, ''),\r\n                          '/pay/chart'\r\n                        )}\r\n                      />\r\n                    </Link>\r\n                  </Menu>\r\n                }\r\n              </Mutation>\r\n              <Container>\r\n                { paymentsLoading ? 'Загрузка...' :\r\n                  error ? `Ошибка ${error.message}` : <>\r\n                    <TopSection>\r\n                      <Route\r\n                        exact\r\n                        path=\"/pay\"\r\n                        render={() => (<>\r\n                          <PaymentForm\r\n                            payment={activePayment}\r\n                            reset={() => setActivePayment(null)}\r\n                            articles={articles}\r\n                            orgs={orgs}\r\n                            equipment={equipment}\r\n                          />\r\n                          <PaymentStats\r\n                            payments={payments}\r\n                            accounts={accounts}\r\n                            orgs={orgs}\r\n                          />\r\n                        </>)}\r\n                      />\r\n                      <Route\r\n                        exact\r\n                        path=\"/pay/chart\"\r\n                        render={() => (\r\n                          <PaymentChart\r\n                            payments={payments}\r\n                          />\r\n                        )}\r\n                      />\r\n                    </TopSection>\r\n                    <BottomSection>\r\n                      <PaymentTable\r\n                        payments={payments}\r\n                        activePayment={activePayment}\r\n                        onClickRow={id => setActivePayment(payments.find(p => p.id === id))}\r\n                      />\r\n                    </BottomSection>\r\n                  </>\r\n                }\r\n              </Container>\r\n            </>\r\n          }\r\n        </Query>\r\n      }\r\n    </NotificationsConsumer>\r\n  )\r\n}\r\n\r\n","import gql from 'graphql-tag'\r\n\r\nexport const dealStatusFragmentBasic = gql`\r\n\tfragment DealStatusFragmentBasic on DealStatus {\r\n    id\r\n    name\r\n    color\r\n    sort\r\n\t}\r\n`\r\n\r\nexport const dealStatusFragmentFull = gql`\r\n\tfragment DealStatusFragmentFull on DealStatus {\r\n\t\t...DealStatusFragmentBasic\r\n    amoId\r\n\t}\r\n\t${dealStatusFragmentBasic}\r\n`\r\n","import gql from 'graphql-tag'\r\nimport { orgExecFragment } from './org'\r\nimport { personFragmentBasic, personExecFragment } from './person'\r\n\r\nexport const execFragmentBasic = gql`\r\n\tfragment execFragmentBasic on Exec {\r\n\t\tid\r\n\t\tperson { ...PersonFragmentBasic }\r\n\t}\r\n\t${personFragmentBasic}\r\n`\r\n\r\nexport const orgsAndPersonsExecs = gql`\r\n\tquery orgsAndPersonsExecs {\r\n\t\torgs { ...orgExecFragment }\r\n\t\tpersons { ...personExecFragment }\r\n\t}\r\n\t${orgExecFragment}\r\n\t${personExecFragment}\r\n`\r\n\r\nexport const upsertExec = gql`\r\n\tmutation upsertExec($input: ExecInput!) {\r\n\t\tupsertExec(input: $input) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const taskFragmentBasic = gql`\r\n\tfragment taskFragmentBasic on Task {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const taskFragmentMiddle = gql`\r\n\tfragment taskFragmentMiddle on Task {\r\n\t\t...taskFragmentBasic\r\n    end\r\n    from\r\n    status\r\n    to\r\n    exec { id }\r\n  }\r\n  ${taskFragmentBasic}\r\n`\r\n\r\nexport const taskFragmentFull = gql`\r\n\tfragment taskFragmentFull on Task {\r\n\t\t...taskFragmentMiddle\r\n    text\r\n  }\r\n  ${taskFragmentMiddle}\r\n`\r\n\r\nexport const taskDetails = gql`\r\n\tquery task ($id: ID!) {\r\n\t\ttask (id: $id) {\r\n\t\t\t...taskFragmentFull\r\n\t\t}\r\n\t}\r\n\t${taskFragmentFull}\r\n`\r\n\r\nexport const upsertTask = gql`\r\n\tmutation upsertTask($input: TaskInput!) {\r\n\t\tupsertTask(input: $input) {\r\n\t\t\t...taskFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${taskFragmentMiddle}\r\n`","import gql from 'graphql-tag'\r\nimport { execFragmentBasic } from './exec'\r\nimport { taskFragmentMiddle } from './task'\r\n\r\nexport const appointFragmentBasic = gql`\r\n\tfragment appointFragmentBasic on Appoint {\r\n\t\tid\r\n\t}\r\n`\r\n\r\nexport const appointFragmentMiddle = gql`\r\n\tfragment appointFragmentMiddle on Appoint {\r\n\t\t...appointFragmentBasic\r\n\t\tfactCost\r\n\t\tfactLabor\r\n\t\tplanCost\r\n\t\tplanLabor\r\n\t\texec { ...execFragmentBasic }\r\n\t\ttasks { ...taskFragmentMiddle }\r\n\t}\r\n\t${appointFragmentBasic}\r\n\t${execFragmentBasic}\r\n\t${taskFragmentMiddle}\r\n`\r\n\r\nexport const upsertAppoint = gql`\r\n\tmutation upsertAppoint($input: AppointInput!) {\r\n\t\tupsertAppoint(input: $input) {\r\n\t\t\t...appointFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${appointFragmentMiddle}\r\n`","import gql from 'graphql-tag'\r\nimport { opTypeFragmentBasic } from './opType'\r\nimport { appointFragmentMiddle } from './appoint'\r\n\r\nexport const opFragmentBasic = gql`\r\n\tfragment opFragmentBasic on Op {\r\n\t\tid\r\n\t\tdealLabor\r\n\t\topType { ...opTypeFragmentBasic }\r\n\t}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const opFragmentMiddle = gql`\r\n\tfragment opFragmentMiddle on Op {\r\n\t\t...opFragmentBasic\r\n\t\tappoints { ...appointFragmentMiddle }\r\n\t}\r\n\t${opFragmentBasic}\r\n\t${appointFragmentMiddle}\r\n`\r\n\r\nexport const opFragmentDetails = gql`\r\n\tfragment opFragmentDetails on Op {\r\n\t\t...opFragmentBasic\r\n\t\tdescription\r\n\t}\r\n\t${opFragmentBasic}\r\n`\r\n\r\nexport const upsertOp = gql`\r\n\tmutation upsertOp($input: OpInput!) {\r\n\t\tupsertOp(input: $input) {\r\n\t\t\t...opFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${opFragmentMiddle}\r\n`","import gql from 'graphql-tag'\r\nimport { opFragmentBasic, opFragmentMiddle, opFragmentDetails } from './op'\r\n\r\nexport const procFragmentBasic = gql`\r\n\tfragment procFragmentBasic on Proc {\r\n\t\tid\r\n\t\tname\r\n\t\tops { ...opFragmentBasic }\r\n\t}\r\n\t${opFragmentBasic}\r\n`\r\n\r\nexport const procFragmentMiddle = gql`\r\n\tfragment procFragmentMiddle on Proc {\r\n\t\t...procFragmentBasic\r\n\t\tops { ...opFragmentMiddle }\r\n\t}\r\n\t${procFragmentBasic}\r\n\t${opFragmentMiddle}\r\n`\r\n\r\nexport const procFragmentDetails = gql`\r\n\tfragment procFragmentDetails on Proc {\r\n\t\t...procFragmentBasic\r\n\t\tops { ...opFragmentDetails }\r\n\t}\r\n\t${procFragmentBasic}\r\n\t${opFragmentDetails}\r\n`","import gql from 'graphql-tag'\r\nimport { drawingFragmentBasic } from './drawing';\r\n\r\nexport const workpieceFragmentBasic = gql`\r\n\tfragment WorkpieceFragmentBasic on Workpiece {\r\n    id\r\n    hardness\r\n    material\r\n    name\r\n\t}\r\n`\r\n\r\nexport const workpieceFragmentWithDrawings = gql`\r\n\tfragment WorkpieceFragmentWithDrawings on Workpiece {\r\n\t\t...WorkpieceFragmentBasic\r\n\t\tdrawing { ...DrawingFragmentBasic }\r\n\t}\r\n\t${workpieceFragmentBasic}\r\n\t${drawingFragmentBasic}\r\n`","import gql from 'graphql-tag'\r\nimport { modelFragmentBasic, modelFragmentWithDrawings } from './model'\r\nimport { procFragmentBasic, procFragmentMiddle, procFragmentDetails } from './proc'\r\nimport { workpieceFragmentWithDrawings } from './workpiece'\r\nimport { opFragmentMiddle } from './op'\r\n\r\nexport const batchFragmentBasic = gql`\r\n\tfragment batchFragmentBasic on Batch {\r\n\t\tid\r\n\t\tqty\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\tprocs { ...procFragmentBasic }\r\n\t}\r\n\t${modelFragmentBasic}\r\n\t${procFragmentBasic}\r\n`\r\n\r\nexport const batchFragmentMiddle = gql`\r\n\tfragment batchFragmentMiddle on Batch {\r\n\t\t...batchFragmentBasic\r\n\t\tmodel { ...ModelFragmentBasic }\r\n\t\tops { ...opFragmentMiddle }\r\n\t\tprocs { ...procFragmentMiddle }\r\n\t}\r\n\t${batchFragmentBasic}\r\n\t${modelFragmentBasic}\r\n\t${opFragmentMiddle}\r\n\t${procFragmentMiddle}\r\n`\r\n\r\nexport const batchFragmentDetails = gql`\r\n\tfragment batchFragmentDetails on Batch {\r\n\t\t...batchFragmentBasic\r\n\t\tinfo\r\n\t\twarning\r\n\t\tmodel { ...ModelFragmentWithDrawings }\r\n\t\tprocs { ...procFragmentDetails }\r\n\t\tworkpiece { ...WorkpieceFragmentWithDrawings }\r\n\t}\r\n\t${modelFragmentWithDrawings}\r\n\t${batchFragmentBasic}\r\n\t${procFragmentDetails}\r\n\t${workpieceFragmentWithDrawings}\r\n`\r\n\r\nexport const batchDetails = gql`\r\n\tquery batch ($id: ID!) {\r\n\t\tbatch (id: $id) {\r\n\t\t\t...batchFragmentDetails\r\n\t\t}\r\n\t}\r\n\t${batchFragmentDetails}\r\n`\r\n\r\nexport const upsertBatch = gql`\r\n\tmutation upsertBatch($input: BatchInput!) {\r\n\t\tupsertBatch(input: $input) {\r\n\t\t\t...batchFragmentMiddle\r\n\t\t\t...batchFragmentDetails\r\n\t\t}\r\n\t}\r\n\t${batchFragmentMiddle}\r\n\t${batchFragmentDetails}\r\n`","import gql from 'graphql-tag'\r\nimport { dealStatusFragmentBasic, dealStatusFragmentFull } from './dealStatus'\r\nimport { orgFragmentBasic } from './org'\r\nimport { batchFragmentMiddle, batchFragmentDetails } from './batch'\r\nimport { opTypeFragmentBasic } from './opType'\r\n\r\nexport const dealFragmentBasic = gql`\r\n\tfragment DealFragmentBasic on Deal {\r\n    id\r\n    amoId\r\n    name\r\n\t\tstatus { ...DealStatusFragmentBasic }\r\n  }\r\n  ${dealStatusFragmentBasic}\r\n`\r\n\r\nexport const dealFragmentMiddle = gql`\r\n\tfragment DealFragmentMiddle on Deal {\r\n\t\t...DealFragmentBasic\r\n\t\tdate\r\n\t\tbatches { ...batchFragmentMiddle}\r\n\t\torg { ...OrgFragmentBasic}\r\n  }\r\n  ${dealFragmentBasic}\r\n  ${orgFragmentBasic}\r\n  ${batchFragmentMiddle}\r\n`\r\n\r\nexport const dealFragmentFull = gql`\r\n\tfragment DealFragmentFull on Deal {\r\n\t\t...DealFragmentMiddle\r\n    status { ...DealStatusFragmentFull }\r\n\t}\r\n\t${dealFragmentMiddle}\r\n\t${dealStatusFragmentFull}\r\n`\r\n\r\nexport const dealsPage = gql`\r\n\tquery Deals {\r\n\t\tdeals { ...DealFragmentMiddle }\r\n\t\torgs { ...OrgFragmentBasic }\r\n\t\topTypes { ...opTypeFragmentBasic }\r\n\t}\r\n\t${dealFragmentMiddle}\r\n\t${orgFragmentBasic}\r\n\t${opTypeFragmentBasic}\r\n`\r\n\r\nexport const dealDetails = gql`\r\n\tquery deal ($id: ID!) {\r\n\t\tdeal (id: $id) {\r\n\t\t\tid\r\n\t\t\tbatches { ...batchFragmentDetails}\r\n\t\t}\r\n\t}\r\n\t${batchFragmentDetails}\r\n`\r\n\r\nexport const createComOffer = gql`\r\n\tmutation createComOffer($dealId: ID!, $date: String) {\r\n\t\tcreateComOffer(dealId: $dealId, date: $date) {\r\n\t\t\tstatusText\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const connectDealToOrg = gql`\r\n\tmutation ConnectDealToOrg($orgId: ID! $dealId: ID!) {\r\n\t\tconnectDealToOrg(orgId: $orgId dealId: $dealId) {\r\n\t\t\t...DealFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${dealFragmentMiddle}\r\n`\r\n\r\nexport const syncDeals = gql`\r\n\tmutation syncDeals {\r\n\t\tsyncDeals {\r\n\t\t\tcount\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const upsertDeal = gql`\r\n\tmutation upsertDeal($input: DealInput!) {\r\n\t\tupsertDeal(input: $input) {\r\n\t\t\t...DealFragmentMiddle\r\n\t\t}\r\n\t}\r\n\t${dealFragmentMiddle}\r\n`","import React from 'react'\r\n\r\nexport const DealsContext = React.createContext()\r\n\r\nexport const DealsContextProvider = ({\r\n  children,\r\n  opTypes\r\n}) => {\r\n  return (\r\n    <DealsContext.Provider\r\n      value={{\r\n        opTypes\r\n      }}\r\n    >\r\n      {children}\r\n    </DealsContext.Provider>\r\n  )\r\n}\r\n\r\n// export const BatchContext = React.createContext()\r\n\r\n// export const BatchContextProvider = ({\r\n//   children,\r\n//   dealId,\r\n//   batchId\r\n// }) => {\r\n//   return (\r\n//     <BatchContext.Provider\r\n//       value={{\r\n//         dealId,\r\n//         batchId\r\n//       }}\r\n//     >\r\n//       {children}\r\n//     </BatchContext.Provider>\r\n//   )\r\n// }","import React from 'react'\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\n// import { Icon } from 'semantic-ui-react'\r\n\r\nexport default props =>\r\n  <Div\r\n    w='55px'\r\n    ta='center'\r\n  >\r\n    <Icon\r\n      link\r\n      {...props}\r\n    />\r\n  </Div>","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\nimport LeftIcon from './LeftIcon'\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\twidth: 100%;\r\n  height: 46px;\r\n\tpadding-right: 1em;\r\n\t/* border-bottom: 1px solid #7e7e81; */\r\n\t/* border-bottom: 1px solid rgba(34,36,38,.15); */\r\n\tborder-bottom: 1px solid rgba(152, 153, 154, 1);\r\n`\r\n\r\nexport const Menu = ({\r\n\ttitle,\r\n\tsubtitle,\r\n\tsetDetails,\r\n\tonSubmit\r\n}) => {\r\n  return (\r\n\t\t<Container>\r\n\t\t\t<LeftIcon\r\n\t\t\t\tsize='big'\r\n\t\t\t\tname='cancel'\r\n\t\t\t\tonClick={() => setDetails(null)}\r\n\t\t\t/>\r\n\t\t\t{title &&\r\n\t\t\t\t<Div\r\n\t\t\t\t\tfs='1.28571429rem'\r\n\t\t\t\t\tfw='bold'\r\n\t\t\t\t>\r\n\t\t\t\t\t{title}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t{subtitle &&\r\n\t\t\t\t<Div\r\n\t\t\t\t\tmt='4px'\r\n\t\t\t\t\tml='10px'\r\n\t\t\t\t\tfs='1rem'\r\n\t\t\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\t\t\tws='0.1em'\r\n\t\t\t\t>\r\n\t\t\t\t\t{subtitle}\r\n\t\t\t\t</Div>\r\n\t\t\t}\r\n\t\t\t{onSubmit &&\r\n\t\t\t\t<Icon link\r\n\t\t\t\t\tname='check'\r\n\t\t\t\t\tml='auto'\r\n\t\t\t\t\tcolor='green'\r\n\t\t\t\t\tsize='big'\r\n\t\t\t\t\tonClick={onSubmit}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</Container>\r\n\t)\r\n}\r\n\r\n\r\n\r\n","import React, { useState } from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { mergeOrg } from '../../../graphql/org'\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nexport default ({\r\n  notify,\r\n  id,\r\n}) => {\r\n  const [ val, setVal ] = useState('')\r\n  return <>\r\n    <Mutation\r\n      mutation={mergeOrg}\r\n      variables={{ id }}\r\n      onCompleted={() => {\r\n        // refetchPersons()\r\n        notify({\r\n          type: 'success',\r\n          title: 'ИНН присвоен'\r\n        })\r\n      }}\r\n      onError={err => notify({\r\n        type: 'error',\r\n        title: 'Ошибка присвоения ИНН',\r\n        content: err.message,\r\n      })}\r\n    >\r\n      {( mergeOrg, { loading } ) =>\r\n        <Div\r\n          p='1em 1em 1em 55px'\r\n        >\r\n          <Input\r\n            value={val}\r\n            onChange={(e, { value }) => setVal(value)}\r\n            placeholder='ИНН'\r\n            onBlur={() => mergeOrg({ variables: { id, inn: val } })}\r\n            loading={loading}\r\n          />\r\n        </Div>\r\n      }\r\n    </Mutation>\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { mergeOrg } from '../../../graphql/org'\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nexport default ({\r\n  org\r\n}) => {\r\n  const [ val, setVal ] = useState('')\r\n  return <>\r\n    {/* <Mutation\r\n      mutation={mergeOrg}\r\n      variables={{ id }}\r\n      onCompleted={() => {\r\n        // refetchPersons()\r\n        notify({\r\n          type: 'success',\r\n          title: 'ИНН присвоен'\r\n        })\r\n      }}\r\n      onError={err => notify({\r\n        type: 'error',\r\n        title: 'Ошибка присвоения ИНН',\r\n        content: err.message,\r\n      })}\r\n    >\r\n      {( mergeOrg, { loading } ) =>\r\n        <Div\r\n          p='1em 1em 1em 55px'\r\n        >\r\n          <Input\r\n            value={val}\r\n            onChange={(e, { value }) => setVal(value)}\r\n            placeholder='ИНН'\r\n            onBlur={() => mergeOrg({ variables: { id, inn: val } })}\r\n            loading={loading}\r\n          />\r\n        </Div>\r\n      }\r\n    </Mutation> */}\r\n  </>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Input = styled.input`\r\n\tcursor: pointer;\r\n\tpadding-left: 67.85px;\r\n\t/* border-color: rgba(34,36,38,0.15); */\r\n`\r\n\r\nexport default ({\r\n\tonChange,\r\n\t...rest\r\n}) => {\r\n\treturn (\r\n\t\t<Input\r\n\t\t\t{...rest}\r\n\t\t\t// type=\"date\"\r\n\t\t\tonChange={({ target: { value }}) => onChange(value)}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Input = styled.input`\r\n\twidth: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport default forwardRef(({\r\n  value: propValue,\r\n  onChange,\r\n  onBlur,\r\n\t...rest\r\n}, ref) => {\r\n  const [ value, setValue ] = useState('')\r\n  useEffect(() => setValue(propValue || ''), [propValue])\r\n  const submit = () => propValue !== value && onChange(value)\r\n\treturn (\r\n\t\t<Input\r\n      {...rest}\r\n      ref={ref}\r\n\t\t\tvalue={value}\r\n      onChange={({ target: { value }}) => setValue(value)}\r\n      onBlur={() => {\r\n        submit()\r\n        if (onBlur) onBlur()\r\n      }}\r\n      onKeyDown={e => e.key === 'Enter' && submit()}\r\n\t\t/>\r\n\t)\r\n})\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst TextArea = styled.textarea`\r\n\twidth: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport const HtmlTextArea = ({\r\n  value: propValue,\r\n\tonChange,\r\n\t...rest\r\n}) => {\r\n  const input = useRef(null)\r\n  const [ value, setValue ] = useState('')\r\n  useEffect(() => setValue(propValue || ''), [propValue])\r\n\treturn (\r\n\t\t<TextArea\r\n      {...rest}\r\n      ref={input}\r\n\t\t\tvalue={value}\r\n      onChange={({ target: { value }}) => setValue(value)}\r\n      onBlur={() => propValue !== value && onChange(value)}\r\n\t\t/>\r\n\t)\r\n}\r\n","import React, { useState, useEffect, forwardRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst Select = styled.select`\r\n  width: 100%;\r\n  padding-right: 4px;\r\n  padding-left: 4px;\r\n`\r\n\r\nexport default forwardRef(({\r\n  // value: propValue,\r\n  value,\r\n  onChange,\r\n  options,\r\n\t...rest\r\n}, ref) => {\r\n  // const [ value, setValue ] = useState(0)\r\n  // useEffect(() => setValue(propValue || 0), [propValue])\r\n  // const submit = () => propValue !== value && onChange(value)\r\n\treturn (\r\n    <Select\r\n      {...rest}\r\n      ref={ref}\r\n      value={value}\r\n      onChange={({ target: { value }}) => onChange(value)}\r\n      // onChange={({ target: { value }}) => console.log('value > ', value) || setValue(value)}\r\n      // onBlur={submit}\r\n      // onKeyDown={e => e.key === 'Enter' && submit()}\r\n      // onBlur={() => console.log('ref.current > ', ref.current.blur())}\r\n    >\r\n      {[{ id: 0, name: '' }, ...options].map(({ key, id, name }) =>\r\n        <option key={key || id} value={id}>{name}</option>\r\n      )}}\r\n    </Select>\r\n\t)\r\n})\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport HtmlDatePicker from '../common/HtmlDatePicker'\r\nimport HtmlInput from '../common/HtmlInput'\r\nimport { HtmlTextArea } from '../common/HtmlTextArea'\r\nimport HtmlSelect from '../common/HtmlSelect';\r\n\r\nconst Container = styled.div`\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\talign-items: center;\r\n\tmargin-bottom: .67857143rem;\r\n\t${props => props.indent && `\r\n\t\tborder-left: 1px solid rgba(34, 36, 38, 0.15);\r\n\t`}\r\n`\r\n\r\nconst Label = styled.div`\r\n\tflex: 0 0 122px;\r\n\t/* padding-top: calc(10.5rem/14); */\r\n\tfont-size: calc(13rem/14);\r\n\t/* font-weight: bold; */\r\n\tline-height: 1.21428571rem;\r\n\t${props => props.required && `\r\n\t\t::after {\r\n\t\t\tcontent: '*';\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tmargin: -.2em 0 0 .2em;\r\n\t\t\tvertical-align: top;\r\n\t\t\tcolor: #db2828;\r\n\t\t}\r\n\t`}\r\n\t${props => props.indent && `\r\n\t\tpadding-left: 10px;\r\n\t`}\r\n`\r\n\r\nconst Content = styled.div`\r\n\tflex: 1 1 auto;\r\n\tmax-width: calc(100% - 122px);\r\n`\r\n\r\nconst InputContainer = styled.div`\r\n\twidth: 215px;\r\n`\r\n\r\nconst Error = styled.div`\r\n\tcolor: ${props => props.theme.colors.error};\r\n`\r\n\r\nexport default ({\r\n\tlabel,\r\n\trequired,\r\n\tindent,\r\n\ttype,\r\n\tcontentBeforeField,\r\n\terror,\r\n\t...rest\r\n}) => {\r\n\treturn (\r\n\t\t<Container\r\n\t\t\tindent={indent}\r\n\t\t>\r\n\t\t\t<Label\r\n\t\t\t\tclassName='fz-formFieldLabel'\r\n\t\t\t\trequired={required}\r\n\t\t\t\tindent={indent}\r\n\t\t\t>\r\n\t\t\t\t{label}\r\n\t\t\t</Label>\r\n\t\t\t<Content>\r\n\t\t\t\t<InputContainer>\r\n\t\t\t\t\t{contentBeforeField}\r\n\t\t\t\t\t{\ttype === 'date' || type === 'datetime-local'\r\n\t\t\t\t\t\t? <HtmlDatePicker\r\n\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/> :\r\n\t\t\t\t\t\ttype === 'textarea'\r\n\t\t\t\t\t\t? <HtmlTextArea\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/> :\r\n\t\t\t\t\t\ttype === 'select'\r\n\t\t\t\t\t\t? <HtmlSelect\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t: <HtmlInput\r\n\t\t\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</InputContainer>\r\n\t\t\t\t{error &&\r\n\t\t\t\t\t<Error>\r\n\t\t\t\t\t\t{error}\r\n\t\t\t\t\t</Error>\r\n\t\t\t\t}\r\n\t\t\t</Content>\r\n\t\t</Container>\r\n\t)\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { createContract } from '../../../graphql/org'\r\nimport styled from 'styled-components'\r\nimport { animated, useTransition } from 'react-spring'\r\nimport CollapsableSection from '../../presentational/CollapsableSection'\r\nimport { Icon, Div } from '../../styled/styled-semantic'\r\nimport LeftIcon from '../../Details/Menu/LeftIcon'\r\nimport Field from '../../form/Field'\r\nimport { toLocalDateString } from '../../../utils/dates'\r\n\r\nconst MenuOverlay = styled(animated.div)`\r\n  position: absolute;\r\n  z-index: 10;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n  height: 48px;\r\n  padding-right: 0.7em;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: rgba(255,255,255,1);\r\n`\r\n\r\nexport default ({\r\n  notify,\r\n  org,\r\n  initiallyExpanded\r\n}) => {\r\n  const [ createMode, setCreateMode ] = useState(false)\r\n  useEffect(() => undefined, [createMode])\r\n  const transitions = useTransition(createMode, null, {\r\n    from: { opacity: 0 }, enter: { opacity: 1 }, leave: { opacity: 0 },\r\n  })\r\n  const [ date, setDate ] = useState(toLocalDateString(new Date()))\r\n  return <>\r\n    <Mutation\r\n      mutation={createContract}\r\n      onCompleted={res => {\r\n        // console.log('res > ', res)\r\n        notify({\r\n          type: 'success',\r\n          title: 'Договор добавлен'\r\n        })\r\n      }}\r\n    >\r\n      {( createContract, { loading } ) =>\r\n        <CollapsableSection\r\n          initiallyExpanded={initiallyExpanded}\r\n          // title='Договор'\r\n          title='Договор'\r\n          overflowVisible\r\n          buttons={<>\r\n            <Icon link\r\n              // circular\r\n              activeColor='green'\r\n              name='plus'\r\n              onClick={e => {\r\n                e.stopPropagation()\r\n                setCreateMode(true)\r\n                // notify({\r\n                //   type: 'warning',\r\n                //   content: 'Чтобы загрузить файлы, перетащите их в раздел',\r\n                // })\r\n              }}\r\n              // loading={creating}\r\n            />\r\n          </>}\r\n        >\r\n          {transitions.map(({ item, key, props }) => \r\n            item && \r\n              <MenuOverlay\r\n                key={key}\r\n                style={props}\r\n              >\r\n                <LeftIcon\r\n                  size='large'\r\n                  name='check'\r\n                  color='green'\r\n                  onClick={async () =>\r\n                    await createContract({ variables: { id: org.id, date } })\r\n                    && setCreateMode(false)\r\n                  }\r\n                />\r\n                <Div\r\n                  fs='1.1em'\r\n                  c='rgba(0,0,0,.75)'\r\n                  fw='700'\r\n                >\r\n                  Создание договора\r\n                </Div>\r\n                <Icon link\r\n                  name='cancel'\r\n                  ml='auto'\r\n                  size='large'\r\n                  onClick={() => setCreateMode(false)}\r\n                />\r\n            </MenuOverlay>\r\n          )}\r\n            \r\n          <Div\r\n            p='1em 1em 1em 55px'\r\n          >\r\n            <Field\r\n              label='Дата договора'\r\n              type='date'\r\n              value={date}\r\n              onChange={date => setDate(date)}\r\n            />\r\n          </Div>\r\n        </CollapsableSection>\r\n\r\n      }\r\n    </Mutation>\r\n  </>\r\n}","import React from 'react'\r\nimport { Menu } from '../../Details/Menu/Menu'\r\nimport { Query } from 'react-apollo'\r\nimport { orgLocal, orgDetails } from '../../../graphql/org'\r\nimport { useNotifications } from '../../notifications/NotificationsContext'\r\nimport InnForm from './InnForm'\r\nimport Requisites from './Requisites'\r\nimport Contract from './Contract'\r\n\r\nexport const OrgDetails = ({\r\n  details: {\r\n\t\tid,\r\n\t\tsection\r\n  },\r\n  setDetails\r\n}) => {\r\n  const { notify } = useNotifications()\r\n  return <>\r\n    <Query\r\n      query={orgLocal}\r\n      variables={{ id }}\r\n    >\r\n      {({ data: { orgLocal } }) => orgLocal\r\n        ? <>\r\n            <Menu\r\n              setDetails={setDetails}\r\n              title={orgLocal.name}\r\n              subtitle={orgLocal.inn && `ИНН: ${orgLocal.inn}`}\r\n            />\r\n            {orgLocal.inn\r\n              ? <Query\r\n                  query={orgDetails}\r\n                  variables={{ id }}\r\n                  onError={err => notify({\r\n                    type: 'error',\r\n                    title: 'Ошибка загрузки реквизитов организации',\r\n                    content: err.message,\r\n                  })}\r\n                >\r\n                  {({ data: { orgDetails }, loading }) =>\r\n                    loading ? 'Загрузка..' :\r\n                    orgDetails\r\n                      ?\t<>\r\n                          <Requisites\r\n                            org={orgDetails}\r\n                          />\r\n                          <Contract\r\n                            notify={notify}\r\n                            org={orgDetails}\r\n                            initiallyExpanded={section === 'contract'}\r\n                          />\r\n                        </>\r\n                      : null\r\n                  }\r\n                </Query>\r\n              : <InnForm\r\n                  notify={notify}\r\n                  id={id}\r\n                />\r\n            }\r\n          </>\r\n        : null\r\n      }\r\n\r\n    </Query>\r\n  </>\r\n}","import React, { useState, useContext, useEffect } from 'react'\r\nimport { useQuery as useQueryProto, useMutation as useHookMutation } from 'react-apollo-hooks'\r\nimport { useNotifications } from '../notifications/NotificationsContext'\r\n// import useRefMounted from './useRefMounted'\r\n\r\nexport function useQuery(\r\n  query,\r\n  {\r\n    onCompleted,\r\n    onError,\r\n    successMsg,\r\n    errMsg,\r\n    ...options\r\n  } = {},\r\n) {\r\n  const { notify } = useNotifications()\r\n  const { data, loading, error } = useQueryProto(query, options)\r\n  useEffect(() => {\r\n    if (onCompleted && !loading && !error) {\r\n      onCompleted(data)\r\n    } else if (!loading && error) {\r\n      if (onError) onError(error)\r\n      else notify({\r\n        type: 'error',\r\n        title: errMsg || 'Ошибка загрузки данных',\r\n        content: error.message,\r\n      })\r\n    }\r\n  }, [loading, data, error])\r\n  return { data, loading, error }\r\n}\r\n\r\nexport const useMutation = (\r\n  mutation,\r\n  {\r\n    onCompleted,\r\n    onError,\r\n    successMsg,\r\n    errMsg,\r\n    ...options\r\n  } = {}\r\n) => {\r\n  // const refMounted = useRefMounted()\r\n  // console.log('refMounted.current1 > ', refMounted.current)\r\n  const { notify } = useNotifications()\r\n  const [loading, setLoading] = useState(false)\r\n  const [called, setCalled] = useState(false)\r\n  const [error, setError] = useState(null)\r\n  const [data, setData] = useState(null)\r\n  const mutate = useHookMutation(mutation, options)\r\n  // const handler = async (variables, rest) => {\r\n  const handler = async (...args) => {\r\n    setLoading(true)\r\n    setCalled(true)\r\n    setError(null)\r\n    setData(null)\r\n    try {\r\n      // const { data } = await mutate({ variables, ...rest })\r\n      const { data } = await mutate(...args)\r\n      // console.log('refMounted.current2 > ', refMounted.current)\r\n      // if (refMounted.current) {\r\n        setData(data)\r\n        setLoading(false)\r\n      // }\r\n      if (onCompleted) {\r\n        onCompleted(data)\r\n      } \r\n      else notify({\r\n        type: 'success',\r\n        title: successMsg || 'Данные сохранены',\r\n      })\r\n      return { data }\r\n    } catch (err) {\r\n      setLoading(false)\r\n      setError(err)\r\n      if (onError) {\r\n        onError(err)\r\n      } \r\n      else notify({\r\n        type: 'error',\r\n        title: errMsg || 'Ошибка сохранения',\r\n        content: err.message,\r\n      })\r\n    }\r\n  }\r\n  return [\r\n    handler,\r\n    {\r\n      loading,\r\n      called,\r\n      error,\r\n      data\r\n    }\r\n  ]\r\n}","import React from 'react'\r\nimport { useMutation, useQuery } from '../hooks/apolloHooks'\r\nimport { getStructure, produceNested } from '../form/utils'\r\nimport { batchDetails, upsertBatch as uB } from '../../graphql/batch'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\n\r\nexport default function BatchDetails ({\r\n  batch: batchProp,\r\n  bIndex,\r\n  batchId\r\n}) {\r\n  const [ upsertBatch ] = useMutation(uB)\r\n  let loading, data\r\n  if (!batchProp) ({ loading, data } = useQuery(batchDetails, { variables: { id: batchId } }))\r\n  const batch = batchProp || (data && data.batch) || {}\r\n  if (!batchProp && loading)\r\n    return <Dimmer active ><Loader>Загрузка..</Loader></Dimmer>\r\n  const {\r\n    info,\r\n    warning,\r\n    model: {\r\n      name,\r\n      drawings: [{ name: drwName } = {}]\r\n    },\r\n    workpiece: wp,\r\n    procs: [{ ops = [] } = {}]\r\n  } = batch\r\n  const {\r\n    name: wpName,\r\n    material,\r\n    hardness,\r\n    drawing: wpDrw\r\n  } = wp || {}\r\n  const {\r\n    name: wpDrwName\r\n  } = wpDrw || {}\r\n  const batchStructure = getStructure(batch)\r\n  return <Div\r\n    p='1em 1em 1em 55px'\r\n  >\r\n    <p><b>{`${bIndex + 1}. ${name}`}</b></p>\r\n    <Div\r\n      pl='10px'\r\n      bl='1px solid rgba(34, 36, 38, 0.15)'\r\n    >\r\n      <Field\r\n        label='Чертеж'\r\n        value={drwName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'model.drawings[0].name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Заготовка'\r\n        value={wpName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Чертеж'\r\n        indent\r\n        value={wpDrwName || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.drawing.name', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Материал'\r\n        value={material || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.material', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Твердость'\r\n        value={hardness || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, 'workpiece.hardness', value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Замечание'\r\n        type='textarea'\r\n        value={info || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, `info`, value)\r\n        }})}\r\n      />\r\n      <Field\r\n        label='Предупреждение'\r\n        type='textarea'\r\n        value={warning || ''}\r\n        onChange={value => upsertBatch({ variables: { input:\r\n          produceNested(batchStructure, `warning`, value)\r\n        }})}\r\n      />\r\n      {ops\r\n        .filter(op => op.opType.opClass === 'MACHINING')\r\n        .map(({\r\n          id,\r\n          opType,\r\n          description\r\n        } = {}, opIndex) => {\r\n          const { name } = opType || {}\r\n          return <div key={id}>\r\n            <p><b>{`${bIndex + 1}.${opIndex + 1}. ${name}`}</b></p>\r\n            <Field\r\n              label='Описание'\r\n              type='textarea'\r\n              indent\r\n              value={description || ''}\r\n              onChange={value => upsertBatch({ variables: { input:\r\n                produceNested(batchStructure, `procs[0].ops[${opIndex}].description`, value)\r\n              }})}\r\n            />\r\n          </div>\r\n        })}\r\n    </Div>\r\n  </Div>\r\n}","import React from 'react'\r\nimport { useQuery } from '../../hooks/apolloHooks'\r\nimport { dealDetails } from '../../../graphql/deal'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport BatchDetails from '../../Batch/Details'\r\n\r\nexport default function DealDetails ({\r\n  dealId\r\n}) {\r\n  const { loading, data } = useQuery(dealDetails, { variables: { id: dealId } })\r\n  return <>\r\n    { loading ? <Dimmer active ><Loader>Загрузка..</Loader></Dimmer> :\r\n      data && data.deal && data.deal.batches.map((batch, bIndex) =>\r\n        <BatchDetails\r\n          key={batch.id}\r\n          batch={batch}\r\n          bIndex={bIndex}\r\n        />)\r\n    }\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport { useMutation } from '../hooks/apolloHooks'\r\nimport { createComOffer as cCO } from '../../graphql/deal'\r\nimport { toLocalDateString } from '../../utils/dates'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\nimport DealDetails from '../Deals/Details/Details'\r\n\r\nexport default function CreateComOfferDetails ({\r\n  details: { dealId },\r\n  setDetails\r\n}) {\r\n\tconst [ date, setDate ] = useState(toLocalDateString(new Date()))\r\n  const [ createComOffer ] = useMutation(cCO, { variables: { dealId, date } })\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Создать КП'\r\n      onSubmit={() => createComOffer()}\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n\t\t\t<Div\r\n\t\t\t\tp='1em 1em 1em 55px'\r\n\t\t\t>\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Дата'\r\n\t\t\t\t\ttype='date'\r\n\t\t\t\t\tvalue={date}\r\n\t\t\t\t\tonChange={date => setDate(date)}\r\n\t\t\t\t/>\r\n\t\t\t</Div>\r\n\t\t\t<DealDetails\r\n\t\t\t\tdealId={dealId}\r\n\t\t\t/>\r\n\t\t</Div>\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport { useMutation, useQuery } from '../hooks/apolloHooks'\r\nimport { upsertTask as uT } from '../../graphql/task'\r\nimport { toLocalDatetimeString } from '../../utils/dates'\r\nimport { Div } from '../styled/styled-semantic'\r\nimport Field from '../form/Field'\r\nimport BatchDetails from '../Batch/Details'\r\n\r\nexport default function CreateComOfferDetails ({\r\n  details: { op, execId },\r\n  setDetails\r\n}) {\r\n\tconst [ from, setFrom ] = useState(toLocalDatetimeString(new Date()))\r\n\tconst [ text, setText ] = useState()\r\n\tconst [ upsertTask ] = useMutation(uT, { variables: { input: {\r\n\t\tfrom,\r\n\t\ttext,\r\n\t\tstatus: 'ACTIVE',\r\n\t\topId: op.id,\r\n\t\texecId\r\n\t}}})\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Добавить задачу'\r\n      onSubmit={() => console.log('{ from, text, status: ACTIV, opId: op.id, execId } > ', { from, text, status: 'ACTIVE', opId: op.id, execId }) && upsertTask()}\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n\t\t\t<Div\r\n\t\t\t\tp='1em 1em 1em 55px'\r\n\t\t\t>\r\n        {/* <Field\r\n\t\t\t\t\tlabel='Кому'\r\n\t\t\t\t\ttype='select'\r\n\t\t\t\t\tvalue={date}\r\n\t\t\t\t\tonChange={date => setDate(date)}\r\n\t\t\t\t/> */}\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Дата и время'\r\n\t\t\t\t\ttype='datetime-local'\r\n\t\t\t\t\tvalue={from}\r\n\t\t\t\t\tonChange={date => setFrom(date)}\r\n\t\t\t\t/>\r\n\t\t\t\t<Field\r\n\t\t\t\t\tlabel='Задача'\r\n\t\t\t\t\ttype='textarea'\r\n\t\t\t\t\tvalue={text}\r\n\t\t\t\t\tonChange={text => setText(text)}\r\n\t\t\t\t/>\r\n\t\t\t</Div>\r\n\t\t\t{/* <BatchDetails\r\n\t\t\t\tdealId={dealId}\r\n\t\t\t/> */}\r\n\t\t</Div>\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport { useMutation, useQuery } from '../hooks/apolloHooks'\r\nimport { personExecs } from '../../graphql/person'\r\nimport { orgsAndPersonsExecs } from '../../graphql/exec'\r\nimport { upsertPerson2 as uP } from '../../graphql/person'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div, Button, Icon } from '../styled/styled-semantic'\r\nimport { Menu } from '../Details/Menu/Menu'\r\nimport LeftIcon from '../Details/Menu/LeftIcon'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\nimport produce from 'immer'\r\nimport { assignNested, getStructure } from '../form/utils'\r\nimport { syncWithAmoContacts as sWAC } from '../../graphql/amo'\r\n\r\nconst ListTitle = styled.h4`\r\n\tmargin: 0;\r\n\tpadding: 1em 1em 1em 55px;\r\n\tdisplay: flex;\r\n`\r\n\r\nconst ListItemContainer = styled.div`\r\n  display: flex;\r\n\tcursor: pointer;\r\n\tborder-width: 1px 0;\r\n\tborder-style: solid;\r\n\tborder-color: white;\r\n  :hover {\r\n    background: rgb(250, 250, 250);\r\n    color: rgba(0,0,0,.95);\r\n  }\r\n  ${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n\t`}\r\n`\r\n\r\nconst ListItem = ({\r\n  active,\r\n\ttext,\r\n\tonClick,\r\n}) => <ListItemContainer\r\n\t\tactive={active}\r\n\t\tonClick={onClick}\r\n\t>\r\n  <LeftIcon\r\n    name={active ? 'check square outline' : 'square outline'}\r\n  />\r\n  <Div>\r\n\t\t{text}\r\n  </Div>\r\n</ListItemContainer>\r\n\r\nexport default function SelectExecDetails ({\r\n  details: {\r\n\t\topTypeId,\r\n\t\tonSubmit\r\n\t},\r\n  setDetails,\r\n}) {\r\n  const { data, loading } = useQuery(orgsAndPersonsExecs)\r\n\tconst [ execId, setExecId ] = useState('')\r\n\tconst [ personId, setPersonId ] = useState('')\r\n\tconst [ search, setSearch ] = useState('')\r\n\tconst orgs = data && data.orgs && data.orgs\r\n\t\t.filter(o => !search || o.name.indexOf(search) !== -1) || []\r\n\tconst persons = data && data.persons && data.persons\r\n\t\t.filter(p => !search || p.amoName.indexOf(search) !== -1) || []\r\n\tconst [ syncWithAmoContacts, { loading: syncingContacts } ] = useMutation(sWAC, {\r\n\t\tsuccessMsg: 'Контакты синхронизированы',\r\n\t\terrMsg: 'Ошибка синхронизации с Амо'\r\n\t})\r\n\tconst [ upsertPersonProto ] = useMutation(uP, {\r\n\t\tsuccessMsg: 'Обновлены данные исполнителя',\r\n\t\terrMsg: 'Ошибка. Данные исполнителя не обновлены'\r\n\t})\r\n\tconst upsertPerson = () => upsertPersonProto({ variables: { input:\r\n\t\tproduce(getStructure(persons.find(p => p.id === personId)), draft => {\r\n\t\t\tassignNested(draft, `exec.opTypes[length]`, { opTypeId } )\r\n\t\t})\r\n\t}})\r\n  return <>\r\n    <Menu\r\n      setDetails={setDetails}\r\n      title='Выбор исполнителя'\r\n      onSubmit={async () => {\r\n\t\t\t\tif (personId) {\r\n\t\t\t\t\tconst { data } = await upsertPerson()\r\n\t\t\t\t\tconst execId = data && data.upsertPerson2.exec.id\r\n\t\t\t\t\tif (execId) onSubmit(execId)\r\n\t\t\t\t}\r\n\t\t\t\tif (execId) onSubmit(execId)\r\n\t\t\t\tsetDetails(null)\r\n\t\t\t}}\r\n    />\r\n    <Div\r\n\t\t\th='calc(100% - 47px)'\r\n\t\t\toy='scroll'\r\n\t\t>\r\n\t\t\t{loading ? <Dimmer active ><Loader>Загрузка..</Loader></Dimmer> : <>\r\n\t\t\t\t<ListTitle>Для выбранной операции</ListTitle>\r\n\t\t\t\t{persons\r\n\t\t\t\t\t.filter(p => p.exec && p.exec.opTypes.findIndex(ot => ot.id === opTypeId) !== -1)\r\n\t\t\t\t\t.map(p => <ListItem\r\n\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\tactive={p.exec.id === execId}\r\n\t\t\t\t\t\ttext={p.amoName}\r\n\t\t\t\t\t\tonClick={() => setExecId(p.exec.id) || setPersonId('')}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t<ListTitle>Остальные исполнители</ListTitle>\r\n\t\t\t\t{persons\r\n\t\t\t\t\t.filter(p => p.exec && p.exec.opTypes.findIndex(ot => ot.id === opTypeId) === -1)\r\n\t\t\t\t\t.map(p => <ListItem\r\n\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\tactive={p.exec.id === execId}\r\n\t\t\t\t\t\ttext={p.amoName}\r\n\t\t\t\t\t\tonClick={() => setPersonId(p.id) || setExecId('')}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t<ListTitle>Все контакты\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tw='180px'\r\n\t\t\t\t\t\tml='auto'\r\n\t\t\t\t\t\tta='left'\r\n\t\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\t\tonClick={syncWithAmoContacts}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\t\tcolor={syncingContacts ? 'blue' : undefined} \r\n\t\t\t\t\t\t\tloading={syncingContacts}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{syncingContacts ? 'Загрузка..' : 'Контакты AmoCRM'}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</ListTitle>\r\n\t\t\t\t{persons\r\n\t\t\t\t\t.filter(p => !p.exec)\r\n\t\t\t\t\t.map(p => <ListItem\r\n\t\t\t\t\t\tkey={p.id}\r\n\t\t\t\t\t\tactive={p.id === personId}\r\n\t\t\t\t\t\ttext={p.amoName}\r\n\t\t\t\t\t\tonClick={() => setPersonId(p.id) || setExecId('')}\r\n\t\t\t\t\t/>)\r\n\t\t\t\t}\r\n\t\t\t\t<ListTitle>Все компании</ListTitle>\r\n\r\n\t\t\t</>}\r\n\t\t</Div>\r\n  </>\r\n}","import React, { useState } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport posed, { PoseGroup } from 'react-pose'\r\nimport { OrgDetails } from '../Org/Details/Details'\r\nimport CreateComOfferDetails from '../ComOffer/CreateComOfferDetails'\r\nimport CreateTaskDetails from '../Task/CreateTaskDetails'\r\nimport SelectExecDetails from '../Exec/SelectExecDetails'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100% - 36px);\r\n  overflow-y: scroll;\r\n`\r\n\r\nconst MainContentContainer = styled.div`\r\n  position: relative;\r\n  height: 100%;\r\n`\r\n\r\nconst Sidebar = styled(posed.div({\r\n  enter: { \r\n    x: 0,\r\n    transition: { ease: 'easeInOut' }\r\n  },\r\n  exit: {\r\n    x: '100%',\r\n    transition: { ease: 'easeInOut' }\r\n  }\r\n}))`\r\n  position: absolute;\r\n  z-index: 12;\r\n  top: 36px;\r\n  right: 0;\r\n  width: ${props =>\r\n    props.type === 'CreateComOffer' ? '470px' :\r\n    props.type === 'createAmoTask' ? '470px' :\r\n    '600px'\r\n  };\r\n  height: calc(100% - 36px);\r\n\tbackground-color: rgba(255,255,255,1);\r\n\tbox-shadow: 0 0 20px rgba(34,36,38,.15);\r\n`\r\n\r\nconst DetailsContext = React.createContext()\r\nexport default DetailsContext\r\n\r\nexport const DetailsProvider = ({\r\n  children\r\n}) => {\r\n  const [ details, setDetails ] = useState(null)\r\n  const { type } = details || {}\r\n  return (\r\n    <DetailsContext.Provider\r\n      value={{ details, setDetails }}\r\n    >\r\n      <Container>\r\n        <MainContentContainer>\r\n          {children}\r\n        </MainContentContainer>\r\n        <PoseGroup>\r\n          {details &&\r\n            <Sidebar key='1'\r\n              type={type}\r\n            >\r\n\t\t\t\t\t\t\t{ type === 'Org' ?\t<OrgDetails\r\n                  details={details}\r\n                  setDetails={setDetails}\r\n                /> :\r\n                type === 'CreateComOffer' ?\t<CreateComOfferDetails\r\n                  details={details}\r\n                  setDetails={setDetails}\r\n                /> :\r\n                type === 'createTask' ?\t<CreateTaskDetails\r\n                  details={details}\r\n                  setDetails={setDetails}\r\n                  /> :\r\n                type === 'SelectExec' ?\t<SelectExecDetails\r\n                  details={details}\r\n                  setDetails={setDetails}\r\n                />\r\n\t\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t\t}\r\n            </Sidebar>\r\n          }\r\n        </PoseGroup>\r\n      </Container>\r\n    </DetailsContext.Provider>\r\n  )\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { Div, Icon } from '../../styled/styled-semantic'\r\nimport HtmlInput from '../../common/HtmlInput'\r\n\r\nexport default ({\r\n  batch: { id: batchId, isNew: isNewBatch},\r\n  deal: { id: dealId, batches },\r\n  model: { id, name } = {},\r\n  upsertDeal\r\n}) => {\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlInput\r\n      ref={inputRef}\r\n      placeholder='Новое Изделие'\r\n      value={name || ''}\r\n      onChange={value => upsertDeal({ variables: { input: {\r\n        id: dealId,\r\n        batches: [\r\n          ...batches.map(({ id }) => ({ id })).filter(b => b.id !== batchId),\r\n          {\r\n            ...isNewBatch\r\n              ? { qty: 0 }\r\n              : { id: batchId },\r\n            model: {\r\n              ...!isNewBatch && { id },\r\n              name: value,\r\n            }\r\n          }\r\n        ]\r\n      }}})}\r\n    />\r\n  else if (isNewBatch)\r\n    return <Icon\r\n      link\r\n      name='plus'\r\n      // c='rgba(50,50,50,.87)'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {name}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic';\r\n\r\nconst Input = styled.input`\r\n  width: 40px;\r\n`\r\n\r\nexport default ({\r\n  deal,\r\n  batch,\r\n  upsertDeal\r\n}) => {\r\n  const { id: batchId, isNew: isNewBatch, qty: iniQty } = batch\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  const [ qty, setQty ] = useState(iniQty)\r\n  return editMode\r\n  ? <Input\r\n      ref={inputRef}\r\n      placeholder='0'\r\n      value={qty}\r\n      onChange={({ target: { value }}) => setQty(value)}\r\n      onBlur={async () => {\r\n        if (qty !== iniQty)\r\n          await upsertDeal({ variables: { input: {\r\n            id: deal.id,\r\n            batches: [\r\n              ...deal.batches.map(({ id }) => ({ id })).filter(b => b.id !== batchId),\r\n              { id: batchId, qty }\r\n            ]\r\n          }}})\r\n        // else setEditMode(false)\r\n        setEditMode(false)\r\n      }}\r\n    />\r\n  : <Div\r\n      pl='4px'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {!isNewBatch ? qty : ''}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\nimport { Icon } from 'semantic-ui-react'\r\n\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport HtmlInput from '../../common/HtmlInput'\r\nimport { assignNested } from '../../form/utils'\r\n\r\nexport default function Proc ({\r\n  modelId,\r\n  proc,\r\n  upsertBatch\r\n}) {\r\n  const { isNew: isNewProc, name} = proc\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlInput\r\n      ref={inputRef}\r\n      placeholder='Новый техпроцесс'\r\n      value={name || ''}\r\n      onChange={value => {\r\n        upsertBatch(draft => {\r\n          assignNested(draft, 'procs[0]', { name: value, modelId })\r\n        })\r\n      }}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  else if (isNewProc)\r\n    return <Icon\r\n      link\r\n      name='plus'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {name}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef, useContext } from 'react'\r\n\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport { DealsContext } from '../../context/Context'\r\nimport HtmlSelect from '../../../common/HtmlSelect'\r\nimport { assignNested } from '../../../form/utils'\r\n\r\nexport default function OpType ({\r\n  basePath,\r\n  isNewOp,\r\n  opClass,\r\n  opType = {},\r\n  upsertBatch\r\n}) {\r\n  const { id: opTypeId, name } = opType\r\n  const { opTypes } = useContext(DealsContext)\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  if (editMode)\r\n    return <HtmlSelect\r\n      ref={inputRef}\r\n      value={opTypeId}\r\n      options={opTypes.filter(ot => ot.opClass === opClass)}\r\n      onChange={opTypeId => upsertBatch(draft => {\r\n        assignNested(draft, basePath + 'ops[length]', { opTypeId })\r\n      })}\r\n      onBlur={() => setEditMode(false)}\r\n    />\r\n  else if (isNewOp)\r\n    return <Icon\r\n      ml='6px'\r\n\t\t\t// color='grey'\r\n\t\t\tc='rgba(50,50,50,.87)'\r\n      link\r\n      name='plus'\r\n      onClick={() => setEditMode(true)}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n\t\t\tto='ellipsis'\r\n\t\t\tpl='6px'\r\n    >\r\n      {name}\r\n    </Div>\r\n}","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport { assignNested } from '../../../form/utils'\r\nimport HtmlInput from '../../../common/HtmlInput'\r\n\r\nexport default ({\r\n  dealLabor,\r\n  opIndex,\r\n  upsertBatch,\r\n}) => {\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode &&\r\n    inputRef.current &&\r\n    inputRef.current.focus()) || undefined)\r\n  return editMode\r\n  ? <HtmlInput\r\n    ref={inputRef}\r\n    placeholder='0'\r\n    value={dealLabor}\r\n    onChange={value => {\r\n      upsertBatch(draft => {\r\n        assignNested(draft, `procs[0].ops[${opIndex}].dealLabor`, value)\r\n      })\r\n      setEditMode(false)\r\n    }}\r\n  />\r\n  : <Div\r\n      pl='4px'\r\n      onClick={() => setEditMode(true)}\r\n    >\r\n      {dealLabor}ч\r\n    </Div>\r\n}","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Dropdown } from 'semantic-ui-react'\r\n\r\nconst MenuButton = styled.div`\r\n  .dropdown {\r\n    width: 30px;\r\n    text-align: center;\r\n  }\r\n  .icon {\r\n    margin: 0;\r\n    color: rgba(50,50,50,.87);\r\n  }\r\n  transition: background .3s ease;\r\n  :hover {\r\n    background: rgba(0,0,0,.12);\r\n    .icon {\r\n      opacity: 1 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport const DropdownMenu = ({ children }) => {\r\n  return <MenuButton>\r\n    <Dropdown\r\n      icon={{\r\n        name: 'bars',\r\n        link: true\r\n      }}\r\n      direction='left'\r\n    >\r\n      <Dropdown.Menu>\r\n        {children}\r\n      </Dropdown.Menu>\r\n    </Dropdown>\r\n  </MenuButton>\r\n}\r\n\r\n","import React, { useState, useContext } from 'react'\r\n\r\nimport { Div, Icon } from '../../../styled/styled-semantic'\r\nimport { assignNested } from '../../../form/utils'\r\nimport DetailsContext from '../../../Details/Provider'\r\n\r\nexport default function ExecName ({\r\n  basePath,\r\n  appoint,\r\n  opIndex,\r\n  opTypeId,\r\n  upsertBatch\r\n}) {\r\n  const { setDetails } = useContext(DetailsContext)\r\n  const { isNew: isNewAppoint, exec: { person: { amoName } = {} } = {} } = appoint\r\n  const [ addMode, setAddMode ] = useState(false)\r\n  if (isNewAppoint)\r\n    return <Icon\r\n      ml='6px'\r\n      // TODO fix addMode not recognized as truthy\r\n\t\t\tc={addMode ? 'green' : 'rgba(50,50,50,.87)'}\r\n      link\r\n      name='plus'\r\n      activeColor='green'\r\n      // active={addMode}\r\n      onClick={() => {\r\n        setAddMode(true)\r\n        setDetails({\r\n          type: 'SelectExec',\r\n          opTypeId,\r\n          onSubmit: execId => {\r\n            upsertBatch(draft => {\r\n              assignNested( draft,\r\n                basePath + `ops[${opIndex}].appoints[length]`,\r\n                { execId }\r\n              )\r\n            })\r\n          }\r\n        })\r\n      }}\r\n    />\r\n  else\r\n    return <Div\r\n      ov='hidden'\r\n\t\t\tto='ellipsis'\r\n\t\t\tpl='6px'\r\n    >\r\n      {amoName}\r\n    </Div>\r\n}","import React, { useState, useContext } from 'react'\r\nimport cuid from 'cuid'\r\nimport { assignNested } from '../../../form/utils'\r\nimport DetailsContext from '../../../Details/Provider'\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport { DropdownMenu } from '../DropdownMenu'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport ExecName from '../Exec/Name'\r\n\r\nconst FlexContainer = styled.div`\r\n  display: flex;\r\n`\r\n\r\nconst WarningItem = styled(Dropdown.Item)`\r\n  :hover {\r\n    color: #9f3a38 !important;\r\n    .icon {\r\n      color: #9f3a38 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport default function Appoint ({\r\n  basePath,\r\n  appoint,\r\n  appointIndex,\r\n  op,\r\n  opIndex,\r\n  upsertBatch,\r\n}) {\r\n  const { opType: { id: opTypeId } } = op\r\n  const { id: appointId, isNew, exec } = appoint\r\n  const { setDetails } = useContext(DetailsContext)\r\n  const [isHovered, setIsHovered] = useState(false)\r\n  return <>\r\n    <FlexContainer>\r\n      <Div\r\n        d='flex'\r\n        w='170px'\r\n        onMouseEnter={() => setIsHovered(true)}\r\n        onMouseLeave={() => setIsHovered(false)}\r\n      >\r\n        <Div\r\n          w={isHovered ? '140px' : '100%'}\r\n          whs='nowrap'\r\n          to='ellipsis'\r\n          pos='relative'\r\n        >\r\n          <ExecName\r\n            basePath={basePath}\r\n            appoint={appoint}\r\n            opIndex={opIndex}\r\n            opTypeId={opTypeId}\r\n            upsertBatch={upsertBatch}\r\n          />\r\n        </Div>\r\n        {!isNew && isHovered &&\r\n          <DropdownMenu>\r\n            <WarningItem\r\n              icon='remove'\r\n              text='Открепить'\r\n              onClick={() => upsertBatch(draft => {\r\n                assignNested(draft, basePath + `ops[${opIndex}].appoints[${appointIndex}]`, {})\r\n              })}\r\n              // }, { refetchQueries: [{ query: personExec, variables: { id: person.id } }] })}\r\n            />\r\n            <Dropdown.Item\r\n              icon='plus'\r\n              text='Задача'\r\n              onClick={() => setDetails({ op, execId: exec.id, type: 'createTask' })}\r\n            />\r\n          </DropdownMenu>\r\n        }\r\n      </Div>\r\n      {/* // {!isNew &&\r\n      //   <Div\r\n      //     w='40px'\r\n      //     bl='1px solid rgba(34,36,38,0.15);'\r\n      //   >\r\n      //     <DealLabour\r\n      //       dealLabor={dealLabor}\r\n      //       opIndex={opIndex}\r\n      //       upsertBatch={upsertBatch}\r\n      //     />\r\n      //   </Div>\r\n      // }\r\n      // {!isNew &&\r\n      //   <Div\r\n      //     w='170px'\r\n      //   >\r\n      //     {[\r\n      //       ...execs,\r\n      //       { id: cuid(), isNew: true }\r\n      //     ].map((exec, i) =>\r\n      //       <Exec\r\n      //         key={exec.id}\r\n      //         basePath={basePath}\r\n      //         exec={exec}\r\n      //         execIndex={i}\r\n      //         op={op}\r\n      //         opIndex={opIndex}\r\n      //         upsertBatch={upsertBatch}\r\n      //       />\r\n      //     )}\r\n      //   </Div>\r\n      // } */}\r\n    </FlexContainer>\r\n  </>\r\n}","import React, { useState } from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../../styled/styled-semantic'\r\nimport OpType from './OpType'\r\nimport DealLabour from './DealLabour'\r\nimport { DropdownMenu } from '../DropdownMenu'\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport Appoint from '../Appoint/Appoint'\r\nimport { assignNested } from '../../../form/utils'\r\n\r\nconst FlexContainer = styled.div`\r\n  display: flex;\r\n`\r\n\r\nconst WarningItem = styled(Dropdown.Item)`\r\n  :hover {\r\n    color: #9f3a38 !important;\r\n    .icon {\r\n      color: #9f3a38 !important;\r\n    }\r\n  }\r\n`\r\n\r\nexport const Op = ({\r\n  basePath = '',\r\n  op,\r\n  opClass,\r\n  opIndex,\r\n  upsertBatch\r\n}) => {\r\n  const { isNew, appoints, opType, dealLabor } = op\r\n  const isMachiningClass = basePath.startsWith('procs')\r\n  const [isHovered, setIsHovered] = useState(false)\r\n  return <>\r\n    <FlexContainer>\r\n      <Div\r\n        d='flex'\r\n        w={isMachiningClass ? '130px' : '170px'}\r\n        onMouseEnter={() => setIsHovered(true)}\r\n        onMouseLeave={() => setIsHovered(false)}\r\n      >\r\n        <Div\r\n          w={!isNew && isHovered ? (isMachiningClass ? '100px' : '140px') : '100%'}\r\n          whs='nowrap'\r\n          to='ellipsis'\r\n          pos='relative'\r\n        >\r\n          <OpType\r\n            basePath={basePath}\r\n            opType={opType}\r\n            opClass={opClass}\r\n            isNewOp={isNew}\r\n            upsertBatch={upsertBatch}\r\n          />\r\n        </Div>\r\n        {!isNew && isHovered &&\r\n          <DropdownMenu>\r\n            <WarningItem\r\n              icon='trash'\r\n              text='Удалить'\r\n              onClick={() => upsertBatch(draft => {\r\n                assignNested(draft, basePath + `ops[${opIndex}]`, {})\r\n              })}\r\n            />\r\n          </DropdownMenu>\r\n        }\r\n      </Div>\r\n      {!isNew && isMachiningClass &&\r\n        <Div\r\n          w='40px'\r\n          bl='1px solid rgba(34,36,38,0.15);'\r\n        >\r\n          <DealLabour\r\n            dealLabor={dealLabor}\r\n            opIndex={opIndex}\r\n            upsertBatch={upsertBatch}\r\n          />\r\n        </Div>\r\n      }\r\n      {!isNew && \r\n        <Div\r\n          w='170px'\r\n        >\r\n          {[\r\n            ...appoints,\r\n            { id: cuid(), isNew: true }\r\n          ].map((appoint, i) =>\r\n            <Appoint\r\n              key={appoint.id}\r\n              basePath={basePath}\r\n              appoint={appoint}\r\n              appointIndex={i}\r\n              op={op}\r\n              opIndex={opIndex}\r\n              upsertBatch={upsertBatch}\r\n            />\r\n          )}\r\n        </Div>\r\n      }\r\n    </FlexContainer>\r\n  </>\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { Op } from'./Op'\r\n\r\nconst Container = styled.div`\r\n  :not(:last-child) {\r\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\r\n\t}\r\n  background: rgba(0,0,0,.05);\r\n`\r\n\r\nexport const Ops = ({\r\n  ops,\r\n  upsertBatch\r\n}) => {\r\n  return [\r\n    ...ops,\r\n    { id: cuid(), isNew: true }\r\n  ].map((op, i) =>\r\n    <Container\r\n      key={op.id}\r\n    >\r\n      <Op\r\n        basePath='procs[0].'\r\n        op={op}\r\n        opClass='MACHINING'\r\n        opIndex={i}\r\n        upsertBatch={upsertBatch}\r\n      />\r\n    </Container>\r\n  )\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport Proc from'./Proc'\r\nimport { Ops } from './Op/Ops'\r\nimport { Op } from './Op/Op';\r\n\r\nconst Container = styled.div`\r\n  :not(:last-child) {\r\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\r\n\t}\r\n`\r\n\r\nexport default function ProcOps ({\r\n  modelId,\r\n  ops,\r\n  procs,\r\n  upsertBatch\r\n}) {\r\n  // temporarily limited to only 1 technical process per batch\r\n  return <>\r\n    {[ops[0] || { id: cuid(), isNew: true }]\r\n      .map((op, i) =>\r\n        <Container\r\n          key={op.id}\r\n        >\r\n          <Op\r\n            op={op}\r\n            opClass='SURVEY'\r\n            opIndex={i}\r\n            upsertBatch={upsertBatch}\r\n          />\r\n        </Container>\r\n      )}\r\n    {[procs[0] || { id: cuid(), isNew: true }]\r\n      .map(proc =>\r\n        <Container\r\n          key={proc.id}\r\n        >\r\n          <Proc\r\n            modelId={modelId}\r\n            proc={proc}\r\n            upsertBatch={upsertBatch}\r\n          />\r\n          {!proc.isNew &&\r\n            <Ops\r\n              ops={proc.ops}\r\n              upsertBatch={upsertBatch}\r\n            />\r\n          }\r\n        </Container>\r\n      )}\r\n  </>\r\n}","import React from 'react'\r\nimport { useMutation } from '../../hooks/apolloHooks'\r\nimport { upsertBatch as uBq } from '../../../graphql/batch'\r\nimport { getStructure } from '../../form/utils'\r\n\r\nimport styled from 'styled-components'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport Model from './Model'\r\nimport Qty from './Qty'\r\nimport ProcOps from './ProcOps'\r\nimport produce from 'immer'\r\n\r\nconst BatchContainer = styled.div`\r\n  display: flex;\r\n  width: calc(170px + 170px + 170px);\r\n  :not(:last-child) {\r\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\r\n\t}\r\n`\r\n\r\nexport default function Batch ({\r\n  deal,\r\n  batch,\r\n  upsertDeal,\r\n}) {\r\n  const { isNew, ops, procs, model } = batch\r\n  const [ upsertBatchProto ] = useMutation(uBq)\r\n  const upsertBatch = (draftHandler, options = {}) => upsertBatchProto({ variables: { input:\r\n    produce(getStructure(batch), draftHandler)\r\n  }, ...options})\r\n  return <BatchContainer>\r\n    <Div\r\n      w='130px'\r\n      br={isNew ? undefined : '1px solid rgba(34,36,38,0.15);'}\r\n    >\r\n      <Model\r\n        batch={batch}\r\n        deal={deal}\r\n        model={model}\r\n        upsertDeal={upsertDeal}\r\n      />\r\n    </Div>\r\n    {!isNew && <>\r\n      <Div\r\n        w='40px;'\r\n      >\r\n        <Qty\r\n          deal={deal}\r\n          batch={batch}\r\n          upsertDeal={upsertDeal}\r\n        />\r\n      </Div>\r\n      <Div\r\n        w='calc(170px+140px)'\r\n      >\r\n        <ProcOps\r\n          modelId={model.id}\r\n          ops={ops}\r\n          procs={procs}\r\n          upsertBatch={upsertBatch}\r\n        />\r\n      </Div>\r\n    </>}\r\n  </BatchContainer>\r\n}","import React from 'react'\r\nimport cuid from 'cuid'\r\n\r\nimport Batch from'./Batch'\r\n\r\nexport default function Batches ({\r\n  deal,\r\n  upsertDeal\r\n}) {\r\n  return [\r\n    ...deal.batches,\r\n    { id: cuid(), isNew: true }\r\n  ].map(batch =>\r\n    <Batch\r\n      key={batch.id}\r\n      deal={deal}\r\n      batch={batch}\r\n      upsertDeal={upsertDeal}\r\n    />\r\n  )\r\n}","import React, { useState, useRef, useEffect, useContext } from 'react'\r\nimport DiskContext from '../../context/DiskContext'\r\n\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\nimport { DropdownMenu } from './DropdownMenu'\r\n\r\nexport default function Org ({\r\n  deal,\r\n  orgs,\r\n  upsertDeal,\r\n  upsertingDeal,\r\n  setDetails\r\n}) {\r\n  const { id: dealId, org } = deal\r\n  const orgId = (org && org.id) || 0\r\n  const { highlightFolder } = useContext(DiskContext)\r\n  const inputRef = useRef(null)\r\n  const [ editMode, setEditMode ] = useState(false)\r\n  useEffect(() => (editMode && inputRef.current &&\r\n    inputRef.current.toggle()) || undefined)\r\n  const [isHovered, setIsHovered] = useState(false)\r\n  const options = orgs\r\n    .map(o => ({key:o.id, value: o.id, text: o.name}))\r\n  if (editMode)\r\n    return <Dropdown\r\n      ref={inputRef}\r\n      disabled={upsertingDeal}\r\n      loading={upsertingDeal}\r\n      options={options}\r\n      value={orgId}\r\n      onBlur={() => setEditMode(false)}\r\n      onChange={async (e, { value: orgId }) => {\r\n          await upsertDeal({ variables: { input: {\r\n            id: dealId,\r\n            orgId\r\n          }}})\r\n        setEditMode(false)\r\n      }}\r\n      search\r\n      selection //required when allowAdditions\r\n      selectOnBlur={false}\r\n      selectOnNavigation={false}\r\n      noResultsMessage='Если не найдено, добавьте организацию на странице Платежи'\r\n    />\r\n  else if (orgId === 0)\r\n    return null\r\n    // return <Icon\r\n    //   link\r\n    //   name='plus'\r\n    //   onClick={() => setEditMode(true)}\r\n    // />\r\n  else\r\n    return <Div\r\n      d='flex'\r\n      onMouseEnter={() => setIsHovered(true)}\r\n\t\t\tonMouseLeave={() => setIsHovered(false)}\r\n    >\r\n      <Div\r\n        ov='hidden'\r\n        to='ellipsis'\r\n        w={isHovered ? '140px' : undefined}\r\n        fw={isHovered ? 'bold' : undefined}\r\n        pl='6px'\r\n        // onClick={() => setEditMode(true)} //block editing\r\n      >\r\n        {org && org.name}\r\n      </Div>\r\n      {isHovered &&\r\n        <DropdownMenu>\r\n          <Dropdown.Item\r\n            icon='folder'\r\n            text='Обнаружить папку'\r\n            onClick={() => highlightFolder({ orgId })}\r\n          />\r\n          <Dropdown.Item\r\n            icon='newspaper outline'\r\n            text='Реквизиты'\r\n            onClick={() => setDetails({ id: orgId, type: 'Org' })}\r\n          />\r\n          <Dropdown.Item\r\n            icon='file alternate'\r\n            text='Создать КП'\r\n            onClick={() => setDetails({ dealId, type: 'CreateComOffer' })}\r\n          />\r\n          <Dropdown.Item\r\n            icon='file alternate outline'\r\n            text='Создать договор'\r\n            onClick={() => setDetails({ id: orgId, type: 'Org', section: 'contract' })}\r\n            disabled={!org.inn}\r\n          />\r\n        </DropdownMenu>\r\n      }\r\n    </Div>\r\n}\r\n","import React, { useState, useContext } from 'react'\r\n\r\nimport { Dropdown } from 'semantic-ui-react'\r\nimport { Div } from '../../styled/styled-semantic'\r\n\r\nimport DiskContext from '../../context/DiskContext'\r\nimport { DropdownMenu } from './DropdownMenu'\r\n\r\nexport default ({\r\n  deal\r\n}) => {\r\n  const { id: dealId, amoId } = deal\r\n  const { highlightFolder } = useContext(DiskContext)\r\n  const [isHovered, setIsHovered] = useState(false)\r\n  return <Div\r\n    d='flex'\r\n    onMouseEnter={() => setIsHovered(true)}\r\n    onMouseLeave={() => setIsHovered(false)}\r\n  >\r\n    <Div\r\n      ov='hidden'\r\n      to='ellipsis'\r\n      w={isHovered ? '150px' : undefined}\r\n      fw={isHovered ? 'bold' : undefined}\r\n    >\r\n      {deal && deal.name}\r\n    </Div>\r\n    {isHovered &&\r\n      <DropdownMenu>\r\n        <Dropdown.Header>\r\n          <a\r\n            target=\"_blank\" rel=\"noopener noreferrer\" \r\n            href={`https://kolomnatutamailcom.amocrm.ru/leads/detail/${amoId}`}\r\n          >AmoCRM</a>\r\n        </Dropdown.Header>\r\n        <Dropdown.Divider />\r\n        <Dropdown.Item\r\n          icon='folder'\r\n          text='Обнаружить папку'\r\n          onClick={() => highlightFolder({ dealId })}\r\n        />\r\n      </DropdownMenu>\r\n    }\r\n  </Div>\r\n}\r\n","import React, { useContext } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport Batches from './TableCells/Batches'\r\nimport Org from './TableCells/Org'\r\nimport DetailsContext from '../Details/Provider'\r\nimport Deal from './TableCells/Deal'\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nconst TableHeader = styled.div`\r\n  /* position: absolute;\r\n  top: -1px;\r\n  left: 32px;\r\n  margin-top: 1px; */\r\n  display: flex;\r\n  width: 100%;\r\n  padding: 0 0 0 32px;\r\n  line-height: 1.5em;\r\n  font-weight: bold;\r\n  background: rgb(233, 234, 235);\r\n  border-top: 1px solid #d4d4d5;\r\n  border-bottom: 1px solid #d4d4d5;\r\n`\r\n\r\nconst Row = styled.div`\r\n  display: flex;\r\n  width: 100%;\r\n  line-height: 1.5em;\r\n  border-bottom: 1px solid rgba(34,36,38,0.15);\r\n  :hover {\r\n    background: rgb(250,250,250);\r\n    color: rgba(0,0,0,.95);\r\n  }\r\n`\r\n\r\nexport default function DealsTable ({\r\n  deals,\r\n  orgs,\r\n  upsertDeal,\r\n  upsertingDeal,\r\n}) {\r\n  const { setDetails } = useContext(DetailsContext)\r\n  return <>\r\n    <TableHeader>\r\n      <Div w='80px'>#</Div>\r\n      <Div w='90px'>Дата</Div>\r\n      <Div w='170px'>Наименование</Div>\r\n      <Div w='170px'>Контрагент</Div>\r\n    </TableHeader>\r\n    {deals && deals.map(deal => {\r\n      const { id, amoId, date, batches } = deal\r\n      return <Row\r\n        key={id}\r\n      >\r\n        <Div\r\n          w='max-content'\r\n          pos='relative'\r\n        >\r\n          <Div\r\n            d='flex'\r\n            ml='32px'\r\n            bb={batches.length ? '1px solid rgba(34,36,38,0.15);' : undefined}\r\n          >\r\n            <Div\r\n              w='80px'\r\n            >\r\n              {amoId}\r\n            </Div>\r\n            <Div\r\n              w='90px'\r\n            >\r\n              {date}\r\n            </Div>\r\n            <Div\r\n              w='170px'\r\n              whs='nowrap'\r\n              to='ellipsis'\r\n              pos='relative'\r\n            >\r\n              <Deal\r\n                deal={deal}\r\n                setDetails={setDetails}\r\n              />\r\n            </Div>\r\n            <Div\r\n              w='170px'\r\n              whs='nowrap'\r\n              to='ellipsis'\r\n              pos='relative'\r\n            >\r\n              <Org\r\n                deal={deal}\r\n                orgs={orgs}\r\n                upsertDeal={upsertDeal}\r\n                upsertingDeal={upsertingDeal}\r\n                setDetails={setDetails}\r\n              />\r\n            </Div>\r\n          </Div>\r\n          <Div\r\n            pos={!batches.length ? 'absolute' : undefined}\r\n            t={!batches.length ? '0' : undefined}\r\n            l={!batches.length ? '552px' : undefined}\r\n            pl={!batches.length ? '5px' : '32px'}\r\n          >\r\n            <Batches\r\n              deal={deal}\r\n              upsertDeal={upsertDeal}\r\n            />\r\n          </Div>\r\n        </Div>\r\n      </Row>\r\n    })}\r\n  </>\r\n}\r\n","import React from 'react'\r\nimport { Mutation } from 'react-apollo'\r\nimport { syncDeals } from '../../graphql/deal'\r\nimport { Button } from '../styled/styled-semantic'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport Menu from '../Menu'\r\n\r\nexport default ({\r\n\tnotify,\r\n  title,\r\n  titleLinkTo,\r\n\trefreshToken,\r\n\trefetchDeals\r\n}) => {\r\n  return <Mutation\r\n\t\tmutation={syncDeals}\r\n\t\tonCompleted={async ({ syncDeals: { count } }) => {\r\n\t\t\t// await refetchDeals()\r\n\t\t\tnotify({\r\n\t\t\t\ttype: 'success',\r\n\t\t\t\ttitle: 'Сделки синхронизированы с AmoCRM'\r\n\t\t\t})\r\n\t\t}}\r\n\t\tonError={err => notify({\r\n\t\t\ttype: 'error',\r\n\t\t\ttitle: 'Ошибка синхронизации с AmoCRM',\r\n\t\t\tcontent: err.message,\r\n\t\t})}\r\n  >\r\n    {(syncDeals, { loading }) =>\r\n      <Menu\r\n        title={title}\r\n        titleLinkTo={titleLinkTo}\r\n        refreshToken={refreshToken}\r\n      >\r\n        <Button compact circular menu\r\n\t\t\t\t\tw='170px'\r\n\t\t\t\t\tml='0'\r\n\t\t\t\t\tta='left'\r\n\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\tonClick={syncDeals}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\tcolor={loading ? 'blue' : undefined} \r\n\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{loading ? 'Загрузка..' : 'Сделки AmoCRM'}\r\n\t\t\t\t</Button>\r\n      </Menu>\r\n    }\r\n  </Mutation>\r\n}\r\n\r\n","import React from 'react'\r\nimport { Query, Mutation } from 'react-apollo'\r\nimport { dealsPage, upsertDeal } from '../../graphql/deal'\r\nimport { NotificationsConsumer } from '../notifications/NotificationsContext'\r\nimport { DealsContextProvider } from './context/Context'\r\nimport { DetailsProvider } from '../Details/Provider'\r\n\r\nimport DealsTable from './Table'\r\nimport Menu from './Menu'\r\nimport { Dimmer, Loader } from 'semantic-ui-react'\r\n\r\nexport default ({\r\n  refreshToken\r\n}) => {\r\n  return (\r\n    <NotificationsConsumer>\r\n      {({ notify }) =>\r\n        <Mutation\r\n          mutation={upsertDeal}\r\n          onCompleted={res => {\r\n            // console.log('res > ', res)\r\n            notify({\r\n              type: 'success',\r\n              title: 'Информация сохранена'\r\n            })\r\n          }}\r\n          onError={err => notify({\r\n            type: 'error',\r\n            title: 'Ошибка сохранения сделки',\r\n            content: err.message,\r\n          })}\r\n        >\r\n          {(upsertDeal, { loading: upsertingDeal }) => \r\n            <Query\r\n              query={dealsPage}\r\n              onError={err => notify({\r\n                type: 'error',\r\n                title: 'Ошибка загрузки сделок',\r\n                content: err.message,\r\n              })}\r\n            >\r\n              {({ loading,\r\n                  error,\r\n                  data,\r\n                  refetch\r\n                }) => <>\r\n                  <Menu\r\n                    notify={notify}\r\n                    title='Сделки'\r\n                    titleLinkTo='/deals'\r\n                    refreshToken={refreshToken}\r\n                    refetchDeals={refetch}\r\n                  />\r\n                  <DetailsProvider>\r\n                      {!loading\r\n                        ? !error\r\n                          ? data && \r\n                            <DealsContextProvider\r\n                              opTypes={data.opTypes}\r\n                            >\r\n                              <DealsTable\r\n                                notify={notify}\r\n                                deals={data.deals}\r\n                                orgs={data.orgs}\r\n                                upsertDeal={upsertDeal}\r\n                                upsertingDeal={upsertingDeal}\r\n                              />\r\n                            </DealsContextProvider>\r\n                          : `Ошибка ${error.message}`\r\n                        : <Dimmer\r\n                            active\r\n                          >\r\n                            <Loader>\r\n                              Загрузка..\r\n                            </Loader>\r\n                          </Dimmer>\r\n                      }\r\n                  </DetailsProvider>\r\n                </>\r\n              }\r\n            </Query>\r\n          }\r\n        </Mutation>\r\n      }\r\n    </NotificationsConsumer>\r\n  )\r\n}\r\n\r\n","import React, { Component } from 'react'\r\nimport { HashRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\r\n\r\nimport { AUTH_TOKEN } from '../constants'\r\nimport { isTokenExpired } from '../utils/jwtHelper'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { me } from '../graphql/user'\r\n\r\nimport LoginPage from './LoginPage'\r\nimport EnquiriesPage from './Enquiry/EnquiriesPage'\r\nimport PaymentsPage from './Payments/Page'\r\nimport DealsPage from './Deals/Page'\r\n\r\nclass Root extends Component {\r\n\tstate = {\r\n\t\ttoken: this.props.token\r\n\t}\r\n\t //verify localStorage check\r\n\tcomponentDidMount() {\r\n\t\tthis.bootStrapData()\r\n\t}\r\n\tbootStrapData = () => {\r\n\t\ttry {\r\n\t\t\tconst token = localStorage.getItem(AUTH_TOKEN)\r\n\t\t\tif (token !== null && token !== undefined) {\r\n\t\t\t\tconst expired = isTokenExpired(token)\r\n\t\t\t\tif (!expired) {\r\n\t\t\t\t\tthis.setState({ token: token })\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.refreshToken(null)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// maybe TODO - provide fatal error message\r\n\t\t \t console.log('')\r\n\t\t}\r\n\t}\r\n\trefreshToken = (token) => {\r\n\t\tif (token) {\r\n\t\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\t\tthis.props.client.resetStore()\r\n\t\t}\r\n\t\tthis.setState({ token })\r\n\t}\r\n\trender() {\r\n\t\tconst { token } = this.state\r\n\t\treturn (\r\n\t\t\t<Router>\r\n\t\t\t\t{ !token\r\n\t\t\t\t  ?\t<LoginPage refreshToken={this.refreshToken} />\r\n\t\t\t\t\t: <Query\r\n\t\t\t\t\t\t\tquery={me}\r\n\t\t\t\t\t\t\tdisplayName='meQuery'\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{({ loading, error, data }) => {\r\n\t\t\t\t\t\t\t\tif (loading) return null\r\n\t\t\t\t\t\t\t\tif (error) return `Error!: ${error.message}`\r\n\t\t\t\t\t\t\t\treturn <Switch>\r\n\t\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\t\texact\r\n\t\t\t\t\t\t\t\t\t\tpath=\"/\"\r\n\t\t\t\t\t\t\t\t\t\trender={() => (\r\n\t\t\t\t\t\t\t\t\t\t\t<EnquiriesPage\r\n\t\t\t\t\t\t\t\t\t\t\t\trefreshToken={this.refreshToken}\r\n\t\t\t\t\t\t\t\t\t\t\t\tme={data.me}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\t\tpath=\"/pay\"\r\n\t\t\t\t\t\t\t\t\t\trender={() => (\r\n\t\t\t\t\t\t\t\t\t\t\t<PaymentsPage\r\n\t\t\t\t\t\t\t\t\t\t\t\trefreshToken={this.refreshToken}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\t\tpath=\"/deals\"\r\n\t\t\t\t\t\t\t\t\t\trender={() => (\r\n\t\t\t\t\t\t\t\t\t\t\t<DealsPage\r\n\t\t\t\t\t\t\t\t\t\t\t\trefreshToken={this.refreshToken}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\r\n\t\t\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t}\r\n\t\t\t</Router>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default Root\r\n","import React from 'react'\r\n\r\nimport { ThemeProvider } from 'styled-components'\r\nimport { theme } from './components/styled/styled-semantic'\r\n\r\nimport { NotificationsProvider } from './components/notifications/NotificationsContext'\r\nimport NotificationsViewer from './components/notifications/NotificationsViewer'\r\nimport { DiskProvider } from './components/context/DiskContext'\r\nimport Root from './components/Root'\r\n\r\nconst App = ({ client }) => (\r\n\t<NotificationsProvider>\r\n\t\t<NotificationsViewer />\r\n\t\t<ThemeProvider theme={theme}>\r\n\t\t\t<DiskProvider>\r\n\t\t\t\t<Root client={client} />\r\n\t\t\t</DiskProvider>\r\n\t\t</ThemeProvider>\r\n\t</NotificationsProvider>\r\n)\r\n\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport 'semantic-ui-css/semantic.min.css'\r\nimport 'react-vis/dist/style.css'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nimport { ApolloProvider } from 'react-apollo'\r\nimport { ApolloProvider as ApolloHooksProvider } from 'react-apollo-hooks'\r\nimport { client } from './apollo/apollo'\r\n\r\nimport App from './App'\r\n\r\nReactDOM.render(\r\n\t<ApolloProvider client={client}>\r\n\t\t<ApolloHooksProvider client={client}>\r\n\t\t\t<App client={client}/>\r\n\t\t</ApolloHooksProvider>\r\n\t</ApolloProvider>\r\n, document.getElementById('root'))\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register()  below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}