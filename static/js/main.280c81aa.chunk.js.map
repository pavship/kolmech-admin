{"version":3,"sources":["serviceWorker.js","constants.js","apollo/defaults.js","graphql/layout.js","graphql/order.js","graphql/doc.js","graphql/status.js","graphql/enquiry.js","graphql/lists.js","apollo/resolvers.js","components/styled/styled-semantic.js","utils/jwtHelper.js","graphql/user.js","components/LoginPage.js","components/special/GlobalContext.js","components/EnquiriesSubmenu.js","components/EnquiriesMenu.js","components/common/Table.js","utils/format.js","components/common/TableRow.js","utils/object.js","components/EnquiriesTable.js","components/DetailsHeaderContainer.js","components/DetailsHeaderSubitle.js","components/DetailsHeaderTitle.js","components/DetailsHeaderButtons.js","components/common/RefreshButton.js","components/DetailsMainHeader.js","components/styled/entity-table.js","components/common/DraftEditor.js","components/common/WrappedDraftEditor.js","utils/validateInn.js","utils/dates.js","graphql/org.js","graphql/combinedQueries.js","components/common/DatePicker.js","components/presentational/SecondarySection.js","graphql/model.js","components/form/utils.js","schema/commonTypes.js","schema/model.js","components/form/FormikInput.js","components/form/Tel.js","components/form/Field.js","components/Model/Form.js","components/Enquiry/Edit.js","components/common/LocalDatePicker.js","components/common/CurrencyInput.js","components/common/SmartForm.js","components/EnquiryCommercialOffer.js","components/EnquiryDetails.js","components/common/SmartInput.js","components/OrderEdit.js","components/DetailsHeader.js","components/CollapsableSection.js","components/ProdsByDept.js","components/DeptProdTable.js","components/ReserveProdsButton.js","graphql/prod.js","components/special/ProdContext.js","components/ModelProdsSection.js","components/OrderDetails.js","components/DetailsDataProvider.js","components/Details.js","components/ProdTableUtils.js","components/special/ListProvider.js","components/special/OrderContext.js","components/DetailsExtra.js","components/DetailsSidebar.js","components/common/PanelPusher.js","graphql/tel.js","graphql/person.js","graphql/employee.js","components/Employee/PanelHeader.js","components/list/Tel.js","components/list/Field.js","components/list/List.js","schema/tel.js","schema/person.js","schema/employee.js","components/Employee/Details.js","components/Employee/Form.js","components/Employee/Edit.js","components/Employee/Table.js","components/EnquiriesBottomPanel.js","components/EnquiriesPage.js","components/Root.js","App.js","index.js","apollo/typeDefs.js"],"names":["Boolean","window","location","hostname","match","AUTH_TOKEN","defaults","newEnquiry","__typename","id","layout","details","extra","bottomPanel","lists","selectedProdIds","getLayout","gql","_templateObject","getLayoutOptions","props","_ref","data","setLayout","_templateObject2","setExpanded","_templateObject3","orderFragmentBasic","order_templateObject","orderFragmentFull","order_templateObject2","upsertOrder","order_templateObject3","orderLocal","_templateObject4","orderDetails","_templateObject5","reserveProds","_templateObject6","docFragmentBasic","doc_templateObject","statusFragment","status_templateObject","enquiryFragmentBasic","enquiry_templateObject","allEnquiries","enquiry_templateObject2","enquiryDetails","enquiry_templateObject3","enquiryLocal","enquiry_templateObject4","enquiry_templateObject5","createEnquiry","enquiry_templateObject6","updateEnquiry","_templateObject7","createEnquiryEvent","_templateObject8","enquiryFragment","_templateObject9","getLists","lists_templateObject","setList","lists_templateObject2","resolvers","Enquiry","isExpanded","Mutation","_","input","cache","query","readQuery","Object","objectSpread","writeQuery","_ref2","_ref3","_ref2$args","args","enquiryId","value","enquiries","find","e","_ref4","_ref5","name","theme","widths","formLabel","detailsPL","extraSidebar","colors","green","blue","error","errorBorder","getThemeColor","color","baseSet","bt","bb","bc","bs","c","d","fs","fw","h","lh","mw","m","mb","mt","ml","o","ox","oy","p","pl","pr","pt","ta","va","w","ws","concat","Div","styled","inline","rest","objectWithoutProperties","react_default","a","createElement","styled_semantic_templateObject","P","esm_extends","styled_semantic_templateObject2","Span","styled_semantic_templateObject3","A","styled_semantic_templateObject4","cancel","Header","styled_semantic_templateObject5","Icon","_ref6","activeColor","styled_semantic_templateObject6","Caret","_ref7","active","disabled","assign","styled_semantic_templateObject7","size","Button","_ref8","menu","styled_semantic_templateObject8","Message","_ref9","section","styled_semantic_templateObject9","Section","_ref10","head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","onClick","undefined","_templateObject10","Popup","_ref11","showIf","_templateObject11","Label","label","_templateObject12","Input","_ref12","_templateObject13","SDropdown","_templateObject14","_ref13","Form","Field","_templateObject15","isTokenExpired","token","date","decoded","decode","exp","Date","setUTCSeconds","getTokenExpirationDate","valueOf","offsetSeconds","me","user_templateObject","meLocal","user_templateObject2","login","user_templateObject3","MenuDiv","div","LoginPage_templateObject","MenuHeader","LoginPage_templateObject2","SSegment","Segment","LoginPage_templateObject3","LoginPage","state","email","password","sendingRequest","handleInputChange","attr","_this","setState","defineProperty","submit","_callee","_this$state","result","regenerator_default","wrap","_context","prev","next","variables","sent","refreshToken","t0","message","stop","this","_this2","_this$state2","react","basic","type","placeholder","ref","onChange","header","content","primary","floated","loading","Component","compose","graphql","options","fetchPolicy","_ref$layout","setDetails","setExtra","setBottomPanel","setSelectedProdIds","SubmenuDiv","EnquiriesSubmenu_templateObject","special_GlobalContext","_ref$details","react_apollo_browser_umd","_data$enquiryLocal","num","addNewOrderForbidden","docs","some","styled_semantic_Header","styled_semantic_Popup","position","flowing","trigger","styled_semantic_Button","compact","circular","icon","Content","EnquiriesMenu_templateObject","EnquiriesMenu","refetchEnquiries","enquiriesAreLoading","EnquiriesMenu_MenuDiv","components_EnquiriesSubmenu","_data$me$person","person","fName","lName","menuNameTitle","slice","link","STable","table","Table_templateObject","TableHeaderRow","tr","Table_templateObject2","Td","td","Table_templateObject3","TBody","tbody","Table_templateObject4","Table","fields","indent","modes","select","fieldsExtended","expand","toConsumableArray","width","map","f","key","title","tableFields","path","formatTel","number","country","conformToMask","guide","conformedValue","currency","trailing","curNum","toFixed","replace","isNaN","Number","Row","TableRow_templateObject","lastSecondaryRow","bold","tdActiveStyle","TableRow_templateObject2","service","styles","includes","TableRow","_ref$rowFields","rowFields","entity","expandFor","expanded","rf","selected","length","TableRow_Td","stopPropagation","iconColor","val","obj","pathArr","split","i","getObjProp","EnquiriesTable","common_Table","enquiry","org","common_TableRow","amount","employees","orgId","orders","order","prods","model","SIcon","DetailsHeaderContainer_templateObject","SCaret","DetailsHeaderContainer_templateObject2","DetailsHeaderContainer","close","DetailsHeaderSubitle","text","DetailsHeaderTitle","subtitle","components_DetailsHeaderSubitle","DetailsHeaderButtons","SButton","RefreshButton_templateObject","RefreshButton","settings","titleNew","titleExisting","Order","DetailsMainHeader","closeDetails","refresh","editMode","localEntity","dateLocal","components_DetailsHeaderContainer","components_DetailsHeaderTitle","components_DetailsHeaderButtons","common_RefreshButton","entity_table_templateObject","Tr","entity_table_templateObject2","entity_table_templateObject3","InputTd","extend","entity_table_templateObject4","EditorTd","entity_table_templateObject5","DraftEditor","editorState","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","newContent","getCurrentContent","_this$props","setEditorHasText","setEditorDiff","setHasFocus","hasText","oriContent","getSelection","getHasFocus","kolmechKeyBindingFn","keyCode","KeyBindingUtil","hasCommandModifier","getDefaultKeyBinding","handleKeyCommand","command","onCtrlEnter","newState","RichUtils","clear","EditorState","push","ContentState","createFromText","exportHtml","html","stateToHTML","convertFromHTML","contentBlocks","initFromHtml","blocksFromHTML","createWithContent","createFromBlockArray","entityMap","createEmpty","Draft","keyBindingFn","readOnly","React","EditorWrapper","WrappedDraftEditor_templateObject","borderless","hasFocus","diff","WrappedDraftEditor","forwardedRef","common_DraftEditor","forwardRef","WrappedDraftEditor_WrappedDraftEditor","validateInn","inn","toString","test","code","indexOf","checkDigit","coefficients","n","parseInt","n11","n12","isValidDate","tz","getTimezoneOffset","toLocalISOString","getTime","toISOString","fromLocalISOString","string","parse","org_templateObject","org_templateObject2","createOrg","org_templateObject3","orgLocal","org_templateObject4","allOrgsAndModels","combinedQueries_templateObject","PickerDiv","DatePicker_templateObject","err","DatePicker","selectedDate","selectDay","DayPickerInput_default","onDayChange","dayPickerProps","firstDayOfWeek","month","SecondarySection","onClose","styled_semantic_Icon","modelLocal","model_templateObject","upsertModel","model_templateObject2","projectEntity","schema","handleObj","preparePayload","values","initialValues","handlePayloadObj","objSchema","arguments","keys","forEach","k","Array","isArray","handleArr","arrSchema","arr","resultArr","initialObj","endsWith","handlePayloadArr","initialArr","idValidationType","matches","validationSchema","object","shape","notRequired","trim","min","max","when","required","article","formikSchema","FormikInput","formik","styled_semantic_Input","getIn","touched","errors","handleChange","onBlur","handleBlur","connect","countryOtions","Dropdown","inputError","Tel_templateObject","Error","Tel_templateObject2","Tel","baseName","renderDropdown","Tel_Dropdown","tabIndex","setFieldValue","Fragment","react_input_mask_default","mask","maskChar","inputProps","form_FormikInput","Tel_Error","Container","Field_templateObject","Field_templateObject2","Field_templateObject3","InputContainer","Field_templateObject4","Field_templateObject5","inputLabel","Field_Label","formik_esm","render","arrayHelpers","form_Tel","Field_Error","ModelForm","didMount","toggleEditMode","refetchQueries","onSubmit","mutation","onCompleted","asyncToGenerator","mark","upserted","resetForm","abrupt","_x","_x2","apply","handleSubmit","handleReset","form_Field","styled_semantic_Message","Edit_templateObject","EnquiryEdit","closeNewModelSection","newModelMode","changeFieldValue","field","newVal","_this$setState","console","log","fieldObj","cloneDeep","curVal","isNewEnquiry","oriVal","filter","pickedDate","handleOrgDropdownSearchChange","searchQuery","orgDdn","search","handleModelDropdownSearchChange","modelDdn","handleQtyInputChange","selectOrg","selectModel","submitNewModel","modelId","componentIsMounted","_callee2","res","_context2","_x3","_callee3","_context3","_x4","oriEnquiry","events","qty","requiredFields","_this$props2","orgs","models","requiredIsEmpty","someFieldHasError","common_DatePicker","Edit_Dropdown","selection","selectOnBlur","selectOnNavigation","onSearchChange","noResultsMessage","allowAdditions","additionLabel","onAddItem","Form_ModelForm","refetch","hidden","update","sort","b","unshift","LocalDatePicker_templateObject","LocalDatePicker","handleDayChange","setField","_this$props$field","LocalDatePicker_PickerDiv","CurrencyInput","number_format_default","customInput","decimalSeparator","thousandSeparator","decimalScale","allowNegative","onValueChange","floatValue","SmartForm","isNewEntity","reduce","oriEntity","formState","EnquiryCommercialOffer","isNewCO","co","common_SmartForm","_ref$formState","common_LocalDatePicker","common_CurrencyInput","Divider","fitted","EnquiryDetails_templateObject","Comments","Comment","Group","EnquiryDetails_templateObject2","CIcon","EnquiryDetails_templateObject3","UserLabel","EnquiryDetails_templateObject4","CContent","EnquiryDetails_templateObject5","CMetadata","Metadata","EnquiryDetails_templateObject6","CText","Text","EnquiryDetails_templateObject7","CMessage","EnquiryDetails_templateObject8","EnquiryDetails","editorRef","createRef","noteEditorRef","editorHasText","noteEditorDiff","noteKey","activeCO","creatingComment","changingStatus","statusPending","savingNote","enableEditMode","exitEditMode","bool","setNoteEditorDiff","cancelEdit","createComment","htmlText","current","changeStatus","coStatusId","enquiryQuery","statuses","s","statusId","doc","cancelPendingStatusChange","saveNote","htmlNote","coEvents","curStatus","status","pop","rawStatuses","orderStatusId","refusalStatusIds","stage","eventStatusPresentationHelpers","Edit","entity_table_Table","entity_table_Td","_ref6$doc","common_WrappedDraftEditor","labelPosition","labeled","button","className","Math","abs","detail","Label_Label","components_EnquiryCommercialOffer","minimal","as","dividing","_e$user$person","user","userInitials","datetimeLocal","dangerouslySetInnerHTML","__html","sanitize","reply","onSave","newEvent","fragment","readFragment","writeFragment","skip","SmartInput","debouncedSetField","debounce","writeVal","intVal","_this$input$inputRef","inputRef","valueAsNumber","_this$props3","OrderEdit","_ref2$formState","common_SmartInput","upsertedOrder","DetailsHeader","buttons","titleSize","OuterSection","CollapsableSection_templateObject","InnerSection","CollapsableSection_templateObject2","CollapsableSection","forceExpanded","headerProps","components_DetailsHeader","ProdsByDept","oriProds","selectedIds","orderId","selectLimit","_ref$selectedProds","selectedProds","orderProdsQty","expandedIds","limitReached","allProds","unionBy","depts","sortBy","groupBy","dept","count","readyCount","progress","hasDefect","isSpoiled","prod","ordered","added","op","removed","sp","orderedCount","selectedCount","availCount","every","unreservedProdsCount","xor","xorBy","defaultFields","DeptProdTable","_ref$skipFields","skipFields","nameFieldWidth","IconRight","ReserveProdsButton_templateObject","ReserveProdsButton","prodIds","modelProds","prod_templateObject","prodsLocal","prod_templateObject2","ModelProdsSection","_ref$order","components_CollapsableSection","components_ReserveProdsButton","special_ProdContext","ids","components_ProdsByDept","components_DeptProdTable","OrderDetails","components_ModelProdsSection","query1","query2","localQuery1","localQuery2","localQuery","Details_templateObject","Details","_ref2$details","components_DetailsDataProvider","Details_Container","components_DetailsMainHeader","components_EnquiryDetails","components_OrderEdit","components_OrderDetails","ProdTableUtils","propDepts","list","newList","without","difference","idsWithinLimit","take","union","ListProvider","toggle","item","DetailsExtra_templateObject","DetailsExtra","closeExtra","DetailsExtra_Container","special_OrderContext","ListProvider_ListProvider","toggleExpanded","components_ProdTableUtils","SSidebar","Sidebar","DetailsSidebar_templateObject","DetailsSidebar","detailsClosing","setTimeout","_this$props$layout","visible","animation","direction","components_Details","components_DetailsExtra","PanelPusher_templateObject","Main","PanelPusher_templateObject2","Panel","PanelPusher_templateObject3","panelVisible","PanelPusher","panel","panelRendered","PanelPusher_Container","telFragment","tel_templateObject","personContactsFragment","person_templateObject","orgEmployees","employee_templateObject","upsertEmployee","employee_templateObject2","PanelHeader_templateObject","ClosePanelIcon","PanelHeader_templateObject2","PanelHeader","closePanel","PanelHeader_MenuDiv","produce","draft","list_Tel","tel","list_Field_templateObject","list_Field_templateObject2","list_Field_templateObject3","list_Field","component","Field_Container","list_Field_Label","Field_Content","List","renderObj","schemaKeys","oneOf","default","lazy","transform","join","is","then","otherwise","mName","tels","array","of","telValidationSchema","personValidationSchema","listSchema","Employee_Details","emp","fullname","EmployeeForm","EmployeeEdit","Form_EmployeeForm","Employee_Table","emps","EmployeesPanelBody","EnquiriesBottomPanel_templateObject","EmployeesPanelTableSection","EnquiriesBottomPanel_templateObject2","EmployeeDetailsSection","EnquiriesBottomPanel_templateObject3","EnquiriesBottomPanel","activeEmp","Edit_EmployeeEdit","_draft$person","Pushable","EnquiriesPage_templateObject","EnquiriesPage","_Component","_getPrototypeOf2","_len","_key","panelClosing","inherits","createClass","_this$props$allEnquir","components_EnquiriesMenu","components_DetailsSidebar","Pusher","PanelPusher_PanelPusher","components_EnquiriesTable","Root","bootStrapData","localStorage","getItem","setItem","removeItem","client","resetStore","components_EnquiriesPage","components_LoginPage","App","styled_components_browser_esm","components_Root","ApolloClient","uri","request","operation","setContext","headers","Authorization","onError","graphQLErrors","networkError","clientState","typeDefs","InMemoryCache","dataIdFromObject","defaultDataIdFromObject","cacheRedirects","Query","getCacheKey","ReactDOM","src_App","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.280c81aa.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n\r\n              // Execute callback\r\n              if (config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","export const AUTH_TOKEN = 'kolmech-token'\r\n","const defaults = {\r\n    // apolloClientDemo: {\r\n    //     __typename: ApolloClientDemo,\r\n    //     currentPageName: Apollo Demo,\r\n    // }\r\n    // alteredEnquiry: {\r\n    //     __typename: 'AlteredEnquiry',\r\n    //     // dateLocal: \r\n    //     // active: false,\r\n    // },\r\n    newEnquiry: {\r\n        __typename: 'Enquiry',\r\n        id: 'new'\r\n    },\r\n    layout: {\r\n        __typename: 'Layout',\r\n        details: null,\r\n        extra: null,\r\n        bottomPanel: null\r\n    },\r\n    lists: {\r\n        __typename: 'Lists',\r\n        selectedProdIds: [],\r\n    }\r\n}\r\n\r\nexport default defaults","import gql from 'graphql-tag'\r\n\r\nexport const getLayout = gql`\r\n\tquery getLayout {\r\n\t\tlayout @client {\r\n\t\t\tdetails\r\n\t\t\textra\r\n\t\t\tbottomPanel\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getLayoutOptions = ({\r\n\tprops: ({ data: { layout } }) => {\r\n\t\treturn {\r\n\t\t\tlayout: layout || {}\r\n\t\t}\r\n\t}\r\n})\r\n\r\nexport const setLayout = gql`\r\n\tmutation SetLayout($details: json, $extra: json, $bottomPanel: json) {\r\n\t\tsetLayout(details: $details, extra: $extra, bottomPanel: $bottomPanel) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const setExpanded = gql`\r\n\tmutation SetExpanded($args: json) {\r\n\t\tsetExpanded(args: $args) @client {\r\n\t\t\targs\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const orderFragmentBasic = gql`\r\n\tfragment OrderFragmentBasic on Order {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t\tqty\r\n\t\tamount\r\n\t}\r\n`\r\n\r\nexport const orderFragmentFull = gql`\r\n\tfragment OrderFragmentFull on Order {\r\n\t\t...OrderFragmentBasic\r\n\t\thtmlNote\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tprods {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n\t\t\thasDefect,\r\n\t\t\tisSpoiled,\r\n\t\t\tprogress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\n\r\nexport const upsertOrder = gql`\r\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\r\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\r\n\t\t\t...OrderFragmentBasic\r\n\t\t\tenquiry {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${orderFragmentBasic}\r\n`\r\nexport const orderLocal = gql`\r\n\tquery OrderLocal ($id: ID!) {\r\n\t\torderLocal (id: $id) {\r\n\t\t\tid\r\n\t\t\tnum\r\n\t\t\tdateLocal\r\n\t\t\tqty\r\n\t\t\tamount\r\n\t\t}\r\n\t}\r\n`\r\nexport const orderDetails = gql`\r\n\tquery OrderDetails ($id: ID!) {\r\n\t\torder (id: $id) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`\r\nexport const reserveProds = gql`\r\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\r\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\r\n\t\t\t...OrderFragmentFull\r\n\t\t}\r\n\t}\r\n\t${orderFragmentFull}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const docFragmentBasic = gql`\r\n\tfragment DocFragmentBasic on Doc {\r\n\t\tid\r\n\t\ttype\r\n\t\tdateLocal\r\n\t\tamount\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const statusFragment = gql`\r\n\tfragment StatusFragment on Status {\r\n\t\tid\r\n    name\r\n    stage\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { orderFragmentBasic } from './order'\r\nimport { docFragmentBasic } from './doc'\r\nimport { statusFragment } from './status'\r\n\r\nexport const enquiryFragmentBasic = gql`\r\n\tfragment EnquiryFragmentBasic on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t}\r\n`\r\n\r\nexport const allEnquiries = gql`\r\n\tquery AllEnquiries {\r\n\t\tenquiries {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\temployees {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmodel {\r\n\t\t\t\tid\r\n\t\t\t\tarticle\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tqty\r\n\t\t\torders {\r\n\t\t\t\t...OrderFragmentBasic\r\n\t\t\t\tprods {\r\n\t\t\t\t\tid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tisExpanded @client\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${orderFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryDetails = gql`\r\n\tquery EnquiryDetails ($id: ID!) {\r\n\t\tenquiry (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel {\r\n\t\t\t\tid\r\n\t\t\t\tarticle\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const enquiryLocal = gql`\r\n\tquery EnquiryLocal ($id: ID!) {\r\n\t\tenquiryLocal (id: $id) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n`\r\nexport const newEnquiry = gql`\r\n\tquery {\r\n\t\tnewEnquiry @client {\r\n\t\t\tid\r\n\t\t}\r\n\t\tstatuses {\r\n\t\t\tid\r\n\t\t\tstage\r\n\t\t\tname\r\n\t\t\tprev {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t\tnext {\r\n\t\t\t\tid\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const createEnquiry = gql`\r\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\r\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel {\r\n\t\t\t\tid\r\n\t\t\t\tarticle\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tqty\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdocs { ...DocFragmentBasic }\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t\torders {\r\n\t\t\t\tid\r\n\t\t\t\tnum\r\n\t\t\t\tdateLocal\r\n\t\t\t\tqty\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\nexport const updateEnquiry = gql`\r\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\r\n\t\tupdateEnquiry(input: $input) {\r\n\t\t\t...EnquiryFragmentBasic\r\n\t\t\thtmlNote\r\n\t\t\torg {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tmodel {\r\n\t\t\t\tid\r\n\t\t\t\tarticle\r\n\t\t\t\tname\r\n\t\t\t}\r\n\t\t\tqty\r\n\t\t\tevents {\r\n\t\t\t\tid\r\n\t\t\t\tdatetimeLocal\r\n\t\t\t\thtmlText\r\n\t\t\t\ttype\r\n\t\t\t\tuser {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tperson {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t\tfName\r\n\t\t\t\t\t\tlName\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstatus { ...StatusFragment }\r\n\t\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t${enquiryFragmentBasic}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const createEnquiryEvent = gql`\r\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\r\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus { ...StatusFragment }\r\n\t\t\tdoc { ...DocFragmentBasic }\r\n\t\t}\r\n\t}\r\n\t${docFragmentBasic}\r\n\t${statusFragment}\r\n`\r\n\r\nexport const enquiryFragment = gql`\r\n\tfragment myEnquiry on Enquiry {\r\n\t\tid\r\n\t\tnum\r\n\t\tdateLocal\r\n\t\thtmlNote\r\n\t\tisExpanded\r\n\t\torg {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t\tmodel {\r\n\t\t\tid\r\n\t\t\tarticle\r\n\t\t\tname\r\n\t\t}\r\n\t\tqty\r\n\t\tevents {\r\n\t\t\tid\r\n\t\t\tdatetimeLocal\r\n\t\t\thtmlText\r\n\t\t\ttype\r\n\t\t\tuser {\r\n\t\t\t\tid\r\n\t\t\t\tperson {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tfName\r\n\t\t\t\t\tlName \r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstatus {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\tstage \r\n\t\t\t}\r\n\t\t\tdoc {\r\n\t\t\t\tid\r\n\t\t\t\tdateLocal\r\n\t\t\t\tamount\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const getLists = gql`\r\n\tquery getLists {\r\n\t\tlists @client {\r\n\t\t\tselectedProdIds\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const getListsOptions = ({\r\n\tprops: ({ data: { lists } }) => ({\r\n    lists: lists || {}\r\n\t})\r\n})\r\n\r\nexport const setList = gql`\r\n\tmutation SetList($name: String!, $value: [ID!]) {\r\n\t\tsetList(name: $name, value: $value) @client {\r\n\t\t\tresult\r\n\t\t}\r\n\t}\r\n`","import { getLayout } from '../graphql/layout'\r\nimport { allEnquiries } from '../graphql/enquiry'\r\nimport { getLists } from '../graphql/lists'\r\n\r\nconst resolvers = {\r\n\tEnquiry: {\r\n\t\tisExpanded: () => false\r\n\t},\r\n\tMutation: {\r\n\t\tsetLayout: (_, input, { cache }) => {\r\n\t\t\tconst query = getLayout\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.layout = {\r\n\t\t\t\t...data.layout,\r\n\t\t\t\t...input\r\n\t\t\t}\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetExpanded: (_, { args: { id: enquiryId, value } }, { cache }) => {\r\n\t\t\tconst query = allEnquiries\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tconst enquiry = data.enquiries.find(e => e.id === enquiryId)\r\n\t\t\tenquiry.isExpanded = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t\tsetList: (_, { name, value }, { cache }) => {\r\n\t\t\tconst query = getLists\r\n\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\tdata.lists[name] = value\r\n\t\t\tcache.writeQuery({ query, data })\r\n\t\t\treturn null\r\n\t\t},\r\n\t}\r\n}\r\n\r\nexport default resolvers","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\n// S prefix is used throughout the App just to have flexebility (two names for each component)\r\n// N prefix stands for NativeCssImplementation of a component (When html element is styled instead of semantic ui component) \r\n\r\nimport { \r\n\tHeader as SHeader, \r\n\t// Label as SLabel,\r\n\tIcon as SIcon, \r\n\tButton as SButton,\r\n\tMessage as SMessage,\r\n\tPopup as SPopup,\r\n\tInput as SInput,\r\n\tDropdown as SDropdown,\r\n\tForm as SForm\r\n} from 'semantic-ui-react'\r\n\r\nexport const theme = {\r\n\twidths: {\r\n\t\tformLabel: '122px', //required calc(110px + 0.857143em)\r\n\t\tdetailsPL: '55px',\r\n\t\textraSidebar: '250px'\r\n\t},\r\n\tcolors: {\r\n\t\tgreen: '#016936',\r\n\t\tblue: '#0E6EB8',\r\n\t\terror: '#9f3a38',\r\n\t\terrorBorder: '#e0b4b4'\r\n\t}\r\n}\r\nconst getThemeColor = (color) => theme.colors[color] || color\r\nconst baseSet = ({ theme, bt, bb, bc, bs, c, d, fs, fw, h, lh, mw, m, mb, mt, ml, o, ox, oy, p, pl, pr, pt, ta, va, w, ws }) => {\r\n\treturn `\r\n\t\t${bt \t? `border-top: ${bt};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${bb \t? `border-bottom: ${bb};`\t\t\t\t\t\t\t: ''}\r\n\t\t${bc \t? `background-color: ${bc};`\t\t\t\t\t: ''}\r\n\t\t${bs \t? `box-sizing: ${bs};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${c \t? `color: ${c};`\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${d \t? `display: ${d};`\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fs \t? `font-size: ${fs};`\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${fw \t? `font-weight: ${fw};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${h \t? `height: ${h};`\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${lh \t? `line-height: ${lh};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mw \t? `max-width: ${mw};`\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${m \t? `margin: ${m};`\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${mb \t? `margin-bottom: ${mb};`\t\t\t\t\t\t\t: ''}\r\n\t\t${mt \t? `margin-top: ${mt};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ml \t? `margin-left: ${ml};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${o  \t? `opacity: ${o};`\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ox  ? `overflow-x: ${ox};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${oy  ? `overflow-y: ${oy};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${p \t? `padding: ${p};`\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t${pl \t? `padding-left: ${pl};`\t\t\t\t\t\t\t: ''}\r\n\t\t${pr \t? `padding-right: ${pr};`\t\t\t\t\t\t\t: ''}\r\n\t\t${pt \t? `padding-top: ${pt};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${ta \t? `text-align: ${ta};`\t\t\t\t\t\t\t\t: ''}\r\n\t\t${va \t? `vertical-align: ${va};`\t\t\t\t\t\t: ''}\r\n\t\t${w \t? `width: ${theme.widths[w] || w};`\t\t: ''}\r\n\t\t${ws \t? `word-spacing: ${ws};`\t\t\t\t\t\t\t: ''}\r\n\t`\r\n}\r\n\r\nconst DivPropFilter = ({ ml, inline, ...rest }) => (\r\n\t<div {...rest} />\r\n)\r\nexport const Div = styled(DivPropFilter)`\r\n\t${props => props.inline && `display: inline-block;`}\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst PPropFilter = ({ ...rest }) => (\r\n\t<p {...rest} />\r\n)\r\nexport const P = styled(PPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nconst SpanPropFilter = ({ ml, ...rest }) => (\r\n\t<span {...rest} />\r\n)\r\nexport const Span = styled(SpanPropFilter)`\r\n\t${props => baseSet(props)}\r\n`\r\n\r\nexport const A = styled.a`\r\n\tcursor: pointer;\r\n\t${props => props.cancel && `{\r\n\t\tpadding-left: 15px;\r\n\t\tcolor: rgba(0,0,0,.87);\r\n\t\t&:hover {\r\n\t\t\tcolor: #B03060;\r\n\t\t}\r\n\t}`}\r\n`\r\n\r\nconst HeaderPropFilter = ({ inline, c, ...rest }) => (\r\n\t<SHeader {...rest} />\r\n)\r\nexport const Header = styled(HeaderPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.inline && `{\r\n\t\t\tmargin: 0;\r\n\t\t\tpadding: 0 1rem;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst IconPropFilter = ({ activeColor, ...rest }) => (\r\n\t<SIcon {...rest} />\r\n)\r\nexport const Icon = styled(IconPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst DropdownIcon = ({active, disabled, ...rest}) => (\r\n\t<SIcon {...rest}\r\n\t\tname='dropdown'\r\n\t/>\r\n)\r\nexport const Caret = styled(DropdownIcon)`\r\n\ttransform: ${\r\n\t\tprops => !props.active && (\r\n\t\t\tprops.size === 'large'\r\n\t\t\t? 'translateX(0) translateY(0) rotate(-90deg) !important'\r\n\t\t\t: 'translateX(-3px) translateY(3px) rotate(-90deg) !important'\r\n\t\t)\r\n\t};\r\n\t&&& {\r\n\t\t${props => props.disabled && `{\r\n\t\t\tcolor: rgba(0,0,0,.6);\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst ButtonPropFilter = ({ activeColor, menu, ...rest }) => (\r\n\t<SButton {...rest} />\r\n)\r\nexport const Button = styled(ButtonPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t&.compact {\r\n\t\t\tpadding: .5rem 1rem;\r\n\t\t}\r\n\t\t${props => props.activeColor && `{\r\n\t\t\t&:hover {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n\t\t\t}\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: ${getThemeColor(props.activeColor)} !important;\r\n        \t}\r\n\t\t}`}\r\n\t\t${props => props.menu && `{\r\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\r\n\t\t\tz-index: 3;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nconst MessagePropFilter = ({\r\n\tsection,\r\n\t...rest\r\n}) => (\r\n\t<SMessage {...rest} />\r\n)\r\nexport const Message = styled(MessagePropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n\t&&& {\r\n\t\t${props => props.section && `\r\n\t\t\tmargin-top: 0;\r\n\t\t\tpadding-left: ${props.theme.widths.detailsPL};\r\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\r\n\t\t\tborder-radius: 0;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nconst SectionPropFiltered = ({\r\n\thead,\r\n\tminor,\r\n\tsmall,\r\n\tsecondary,\r\n\tnoP,\r\n\tnoLP,\r\n\tnoIndent,\r\n\ttopBorder,\r\n\tbottomBorder,\r\n\tchildren,\r\n\tonClick,\r\n\t...rest\r\n}) => (\r\n\t\t<div\r\n\t\t\t{...rest}\r\n\t\t\tonClick={onClick || undefined}\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</div>\r\n)\r\nexport const Section = styled(SectionPropFiltered)`\r\n\twidth: 100%;\r\n\tpadding: 1em 1em 1em 55px;\r\n\t${props => props.head && `{\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding-top: 0;\r\n\t\tpadding-bottom: 0;\r\n\t}`}\r\n\t${props => props.onClick && `{\r\n\t\tcursor: pointer;\r\n\t}`}\r\n\t${props => props.minor && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => !props.size && props.head && `{\r\n\t\tmin-height: 3.5em;\r\n\t}`}\r\n\t${props => props.size === 'small' && `{\r\n\t\tmin-height: 2.5em;\r\n\t}`}\r\n\t${props => props.secondary && `{\r\n\t\tbackground: #f3f4f5;\r\n\t\tcolor: rgba(0,0,0,.6);\r\n\t}`}\r\n\t${props => props.noLP && `{\r\n\t\tpadding-left: 0;\r\n\t}`}\r\n\t${props => props.noIndent && `{\r\n\t\tpadding-left: 1em;\r\n\t}`}\r\n\t${props => props.topBorder && `{\r\n\t\tborder-top: 1px solid ${props.topBorder === 'dark' ? 'rgba(152, 153, 154, 1)' : 'rgba(34,36,38,.15)'};\r\n\t}`}\r\n\t${props => props.bottomBorder && `{\r\n\t\tborder-bottom: 1px solid ${props.bottomBorder === 'dark' ? 'rgba(126, 127, 129, 1)' : 'rgba(34,36,38,.1)'};\r\n\t}`}\r\n`\r\n\r\nconst PopupPropFilter = ({ showIf, ...rest }) => (\r\n\t<SPopup {...rest} />\r\n)\r\nexport const Popup = styled(PopupPropFilter)`\r\n\t&&& {\r\n\t\t${props => !props.showIf && `{\r\n\t\t\topacity: 0;\r\n\t\t}`}\r\n\t}\r\n`\r\n\r\nexport const Label = styled.label`\r\n\t${props => baseSet(props)}\r\n\twidth: ${props => props.theme.widths.formLabel} !important;\r\n\tmargin-right: 0 !important;\r\n`\r\n\r\nconst InputPropFilter = ({ w, ...rest }) => (\r\n\t<SInput {...rest} />\r\n)\r\nexport const Input = styled(InputPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nexport const Dropdown = styled(SDropdown)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`\r\n\r\nconst FormFieldPropFilter = ({ w, ...rest }) => (\r\n\t<SForm.Field {...rest} />\r\n)\r\nexport const FormField = styled(FormFieldPropFilter)`\r\n\t&&&& {\r\n\t\t${props => baseSet(props)}\r\n\t}\r\n`","import decode from 'jwt-decode'\r\n\r\nexport function getTokenExpirationDate(token) {\r\n  const decoded = decode(token)\r\n  if (!decoded.exp) {\r\n    return null\r\n  }\r\n  const date = new Date(0) // The 0 here is the key, which sets the date to the epoch\r\n  date.setUTCSeconds(decoded.exp)\r\n  return date\r\n}\r\n\r\nexport function isTokenExpired(token) {\r\n  const date = getTokenExpirationDate(token)\r\n  const offsetSeconds = 0\r\n  if (date === null) {\r\n    return false\r\n  }\r\n  return !(date.valueOf() > new Date().valueOf() + offsetSeconds * 1000)\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const me = gql`\r\n\tquery Me {\r\n\t\tme {\r\n\t\t\tid\r\n\t\t\temail\r\n\t\t\tperson {\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const meLocal = gql`\r\n\tquery MeLocal {\r\n\t\tme @client {\r\n\t\t\tperson {\r\n\t\t\t\tfName\r\n\t\t\t\tlName\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const login = gql`\r\n\tmutation Login($email: String!, $password: String!) {\r\n\t\tlogin(email: $email, password: $password) {\r\n\t\t\ttoken\r\n\t\t}\r\n\t}\r\n`","import React, { Component, Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Header, Form, Message, Button, Segment } from 'semantic-ui-react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { login } from '../graphql/user'\r\n\r\nconst MenuDiv = styled.div`\r\n\tborder-bottom: 1px solid #7e7e81;\r\n\t// height: 35px;\r\n`\r\n\r\nconst MenuHeader = styled(Header)`\r\n\tdisplay: inline;\r\n\tpadding: 0 1rem !important;\r\n`\r\n\r\nconst SSegment = styled(Segment)`\r\n\tmax-width: 350px !important;\r\n\tmargin: auto !important;\r\n`\r\n\r\nclass LoginPage extends Component {\r\n\tstate = {\r\n\t\temail: '',\r\n\t\tpassword: '',\r\n\t\tsendingRequest: false,\r\n\t\terror: ''\r\n\t}\r\n\thandleInputChange = (attr) => {\r\n\t\tthis.setState({ [attr]: this[attr].value })\r\n\t}\r\n\tsubmit = async () => {\r\n\t\ttry {\r\n\t\t\tconst { email, password } = this.state\r\n\t\t\tthis.setState({ sendingRequest: true })\r\n\t\t\tconst result = await this.props.login({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\temail,\r\n\t\t\t\t\tpassword\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconst token = result.data.login.token\r\n\t\t\tthis.setState({ sendingRequest: false })\r\n\t\t\tthis.props.refreshToken(token)\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({ error: err.message, sendingRequest: false })\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { email, password, sendingRequest, error } = this.state\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<MenuHeader size='large'>\r\n\t\t\t\t\t\t<i></i>\r\n\t\t\t\t\t</MenuHeader>\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t\t<SSegment basic>\r\n\t\t\t\t\t<Form error={!!error}>\r\n\t\t\t\t\t\t<Form.Field>\r\n\t\t\t\t\t\t\t<label>E-mail</label>\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\ttype=\"email\" \r\n\t\t\t\t\t\t\t\tplaceholder='E-mail'\r\n\t\t\t\t\t\t\t\tref={ref => this.email = ref} \r\n\t\t\t\t\t\t\t\tonChange={() => this.handleInputChange('email')} />\r\n\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t<Form.Field>\r\n\t\t\t\t\t\t\t<label></label>\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\ttype=\"password\" \r\n\t\t\t\t\t\t\t\tplaceholder=''\r\n\t\t\t\t\t\t\t\tref={ref => this.password = ref} \r\n\t\t\t\t\t\t\t\tonChange={() => this.handleInputChange('password')} />\r\n\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\theader='  ..'\r\n\t\t\t\t\t\t\tcontent={error} />\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\t\tfloated='right'\r\n\t\t\t\t\t\t\tdisabled={!email || !password || sendingRequest}\r\n\t\t\t\t\t\t\tloading={sendingRequest}\r\n\t\t\t\t\t\t\tonClick={this.submit} >\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form>\r\n\t\t\t\t</SSegment>\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(login, {\r\n\t\tname: 'login',\r\n\t\toptions: {\r\n\t\t\tfetchPolicy: 'no-cache'\r\n\t\t}\r\n\t})\r\n)(LoginPage)","import { compose, graphql } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout, setExpanded } from '../../graphql/layout'\r\nimport { getLists, getListsOptions, setList } from '../../graphql/lists'\r\n\r\n// const GlobalContext = React.createContext()\r\n\r\n// class GlobalContextProvider extends Component {\r\n// \t// setDetails = (details) => {\r\n// \t// \tthis.props.setLayout({variables: { details }})\r\n// \t// }\r\n// \trender() {\r\n// \t\tconst { children, getLayout: { details }, setLayout } = this.props\r\n// \t\treturn (\r\n// \t\t\t<GlobalContext.Provider \r\n// \t\t\t\tvalue={{\r\n// \t\t\t\t\tdetails,\r\n// \t\t\t\t\tsetDetails: (details) => setLayout({variables: { details }})\r\n// \t\t\t\t}}\r\n// \t\t\t>\r\n// \t\t\t\t{children}\r\n// \t\t\t</GlobalContext.Provider>\r\n// \t\t)\r\n// \t}\r\n// }\r\n\r\nconst GlobalContext = ({\r\n\t\tchildren,\r\n\t\tlayout: { details, extra, bottomPanel },\r\n\t\tsetLayout,\r\n\t\tsetExpanded,\r\n\t\tlists: { selectedProdIds },\r\n\t\tsetList\r\n}) => {\r\n\t// setLayout({ variables: { \r\n\t// \tdetails: {\"type\":\"Order\",\"id\":\"cjmzkpstb00170983jkb7bcbq\"},\r\n\t// \textra: {\"type\":\"Store\",\"modelId\":\"cjcfy68q55d3x0149fcpq7l63\",\"orderId\":\"cjmzkpstb00170983jkb7bcbq\"}\r\n\t// } })\r\n  return children({\r\n\t\tdetails,\r\n\t\textra,\r\n\t\tbottomPanel,\r\n\t\tsetDetails: (details) => {\r\n\t\t\tsetLayout({ variables: { \r\n\t\t\t\tdetails,\r\n\t\t\t\textra: null\r\n\t\t\t\t// ...details.type === 'Enquiry' && { extra: null }\r\n\t\t\t}})\r\n\t\t},\r\n\t\tsetExtra: (extra) => setLayout({ variables: { extra } }),\r\n\t\tsetBottomPanel: (bottomPanel) => setLayout({ variables: { bottomPanel } }),\r\n\t\tsetExpanded: (args) => setExpanded({variables: { args }}),\r\n\t\tselectedProdIds,\r\n\t\tsetSelectedProdIds: (value) => \r\n\t\t\tsetList({variables: { name: 'selectedProdIds', value }}),\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(setExpanded, { name: 'setExpanded' }),\r\n\tgraphql(getLists, getListsOptions),\r\n\tgraphql(setList, { name: 'setList' }),\r\n)(GlobalContext)\r\n\t\r\n// export default GlobalContextProvider\r\n// export const GlobalContextConsumer = GlobalContext.Consumer","import React from 'react'\r\n\r\nimport { Icon, Popup as SPopup } from 'semantic-ui-react'\r\nimport { Div, Header, Button, Popup } from './styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../graphql/layout'\r\nimport { enquiryLocal } from '../graphql/enquiry'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\n\r\nconst SubmenuDiv = styled.div`\r\n\talign-self: stretch;\r\n\tposition: relative;\r\n\tmargin-left: 10px;\r\n\tpadding: 0 1em;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground-color: #f5f6f7;\r\n\tborder-top-right-radius: .35rem;\r\n\tborder-bottom-right-radius: .35rem;\r\n\t::before {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tleft: 0;\r\n\t\tbackground-color: #fff;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\r\n\t}\r\n\t/* ::after {\r\n\t\tposition: absolute;\r\n\t\tz-index: 2;\r\n\t\tcontent: '';\r\n\t\ttop: 50%;\r\n\t\tright: 0;\r\n\t\tbackground-color: #f3f4f5;\r\n\t\twidth: 1.74em;\r\n\t\theight: 1.74em;\r\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\r\n\t} */\r\n`\r\n\r\n// const EnquiriesSubmenu = ({ item, addNewOrder, setLayout, layout: { details } }) => {\r\nconst EnquiriesSubmenu = () => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId }, setDetails }) => (\r\n\t\t\t\t<Query \r\n\t\t\t\t\tquery={enquiryLocal}\r\n\t\t\t\t\tvariables={{ \r\n\t\t\t\t\t\tid: type === 'Enquiry' \r\n\t\t\t\t\t\t\t? id\r\n\t\t\t\t\t\t\t: enquiryId\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\tif (data && data.enquiryLocal) {\r\n\t\t\t\t\t\t\tconst { num, docs } = data.enquiryLocal\r\n\t\t\t\t\t\t\tconst addNewOrderForbidden = !docs.some(d => d.type === 'CO')\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<SubmenuDiv>\r\n\t\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\t\tc='rgba(0,0,0,.68)'\r\n\t\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\t\tcontent={` ${num}`}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<Popup \r\n\t\t\t\t\t\t\t\t\t\tposition='bottom left'\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tflowing\r\n\t\t\t\t\t\t\t\t\t\tshowIf={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\ttrigger={\r\n\t\t\t\t\t\t\t\t\t\t\t<Div inline>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent=''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === 'new'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={addNewOrderForbidden}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'new',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tenquiryId: id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Header content='   ' />\r\n\t\t\t\t\t\t\t\t\t\t<SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon name='cancel' color='red' />\r\n\t\t\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t\t\t</SPopup.Content>\r\n\t\t\t\t\t\t\t\t\t</Popup>\r\n\t\t\t\t\t\t\t\t</SubmenuDiv>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t} else return null\r\n\t\t\t\t\t}}\r\n\t\t\t\t</Query>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(setLayout, { name: 'setLayout' }),\r\n\tgraphql(getLayout, getLayoutOptions),\r\n)(EnquiriesSubmenu)\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Header, Button } from './styled/styled-semantic'\r\n\r\nimport EnquiriesSubmenu from './EnquiriesSubmenu'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { meLocal } from '../graphql/user'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\n\r\nconst MenuDiv = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n`\r\n\r\nconst EnquiriesMenu = ({\r\n\trefetchEnquiries,\r\n\tenquiriesAreLoading,\r\n\trefreshToken\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details, setDetails }) => (\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\tcontent='  '\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tw='118.5px'\r\n\t\t\t\t\t\tml='0'\r\n\t\t\t\t\t\tta='left'\r\n\t\t\t\t\t\tactiveColor='blue' \r\n\t\t\t\t\t\tonClick={refetchEnquiries}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon \r\n\t\t\t\t\t\t\tname='refresh'\r\n\t\t\t\t\t\t\tcolor={enquiriesAreLoading ? 'blue' : undefined} \r\n\t\t\t\t\t\t\tloading={enquiriesAreLoading}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{enquiriesAreLoading ? '' : ''}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\tcontent=''\r\n\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t&& details.id === 'new'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonClick={() => setDetails({type: 'Enquiry', id: 'new'})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{details && (\r\n\t\t\t\t\t\t(details.type === 'Enquiry' && details.id !== 'new')\r\n\t\t\t\t\t\t|| (details.type === 'Order' && details.id === 'new')\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\t\t<EnquiriesSubmenu />\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<Query query={meLocal}>\r\n\t\t\t\t\t\t{ ({ data }) => {\r\n\t\t\t\t\t\t\tif (data && data.me) {\r\n\t\t\t\t\t\t\t\tconst { fName, lName } = data.me.person\r\n\t\t\t\t\t\t\t\tconst menuNameTitle = fName + ' ' + (lName ? `${lName.slice(0,1)}.` : '')\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\t\tml='auto'\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tcontent={menuNameTitle} \r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)} else return null\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t\t<Icon link\r\n\t\t\t\t\t\tname='log out'\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tonClick={() => refreshToken(null)} \r\n\t\t\t\t\t/>\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesMenu\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nconst STable = styled.table`\r\n\ttable-layout: fixed;\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n\t/* TODO Make this table with scrollable tbody (Not trivial css trick) */\r\n\t/* thead, tbody, tr {\r\n\t\tdisplay: block;\r\n\t} */\r\n`\r\n\r\nconst TableHeaderRow = styled.tr`\r\n\tcolor: rgba(0,0,0,.8);\r\n\tline-height: 1.5em;\r\n\tbackground: rgb(233, 234, 235);\r\n\tborder-top: 1px solid #d4d4d5;\r\n\tborder-bottom: 1px solid #d4d4d5;\r\n\tfont-weight: bold;\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\t// @ts-ignore\r\n\t${props => props.w && `width: ${props.w};`}\r\n`\r\n\r\nconst TBody = styled.tbody`\r\n\t/* overflow-y: auto;\r\n  overflow-x: hidden; */\r\n`\r\n\r\nconst Table = ({\r\n\tchildren,\r\n\tfields,\r\n\tindent,\r\n\tselect,\r\n\texpand\r\n}) => {\r\n\tconst modes =  {\r\n\t\tindent: !!indent,\r\n\t\tselect: !!select,\r\n\t\texpand: !!expand,\r\n\t}\r\n\tconst fieldsExtended = [\r\n\t\t...modes['indent'] ? [{\r\n\t\t\tname: 'indent',\r\n\t\t\twidth: indent\r\n\t\t}] : [],\r\n\t\t{\r\n\t\t\tname: 'service',\r\n\t\t\twidth: '28px'\r\n\t\t},\r\n\t\t...modes['select'] ? [{\r\n\t\t\tname: 'select',\r\n\t\t\twidth: '28px'\r\n\t\t}]: [],\r\n\t\t...fields,\r\n\t\t// lastField is needed to take remaining width in fixed table-layout\r\n\t\t{ name: 'lastField' }\r\n\t]\r\n\treturn (\r\n\t\t<STable>\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<TableHeaderRow>\r\n\t\t\t\t\t\t{fieldsExtended.map(f =>{\r\n\t\t\t\t\t\t\t// console.log(f)\r\n\t\t\t\t\t\t\treturn <Td\r\n\t\t\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\tw={f.width}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{f.title}\r\n\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</TableHeaderRow>\r\n\t\t\t\t</thead>\r\n\t\t\t<TBody>\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t{children({\r\n\t\t\t\t\t\ttableFields: fieldsExtended.map(f => ({ name: f.name, path: f.path })),\r\n\t\t\t\t\t})}\r\n\t\t\t\t</Fragment>\r\n\t\t\t</TBody>\r\n\t\t</STable>\r\n\t)\r\n}\r\n\r\nexport default Table","import { conformToMask } from 'react-text-mask'\r\n\r\nexport const formatTel = ({ number, country }) => {\r\n\treturn country === 'rus'\r\n\t\t? '+7 ' + conformToMask(\r\n\t\t\t\tnumber,\r\n\t\t\t\t['(', /\\d/, /\\d/, /\\d/, ')', ' ', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, '-', /\\d/, /\\d/],\r\n\t\t\t\t{guide: false}\r\n\t\t\t).conformedValue\r\n\t\t: '+ ' + number\r\n}\r\n\r\nexport const currency = (num, trailing) => {\r\n\tlet curNum = (num).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$& ').replace(/\\./, ',')\r\n\tif (!trailing) curNum = curNum.slice(0,-3)\r\n\treturn curNum + ' '\r\n}\r\nexport const isNaN = Number.isNaN || function(value) {     \r\n\treturn value !== value;\r\n}\r\n","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Caret } from '../styled/styled-semantic'\r\n\r\nimport { getObjProp } from '../../utils/object'\r\nimport { currency } from '../../utils/format'\r\n\r\nconst Row = styled.tr`\r\n\tfont-size: 1rem;\r\n\tcursor: pointer;\r\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t:hover {\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tcolor: rgba(0,0,0,.95);\r\n\t}\r\n\t${props => props.secondary && `\r\n\t\tbackground: rgba(0,0,50,.02);\r\n\t\t${!props.lastSecondaryRow ? 'border-bottom: none;' : ''}\r\n\t`}\r\n\t${props => props.active && `\r\n\t\tbackground: rgba(0,0,0,.05);\r\n\t\tfont-weight: bold;\r\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\r\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\r\n\t`}\r\n\t${props => props.bold && `\r\n\t\tfont-weight: bold;\r\n\t`}\r\n`\r\n\r\nconst tdActiveStyle = `\r\n\tbackground: rgba(0,0,0,.12);\r\n\t.icon {\r\n\t\topacity: 1 !important;\r\n\t}\r\n`\r\n\r\nconst Td = styled.td`\r\n\tpadding-right: 4px;\r\n\twhite-space: nowrap;\r\n\toverflow: hidden;\r\n  text-overflow: ellipsis;\r\n\t${props => props.service && `padding-left: 3px;`}\r\n\t${Row}:not(:hover) & {\r\n\t\t${props => props.type === 'onHover' && !props.active && `\r\n\t\t\topacity: 0 !important;\r\n\t\t`}\r\n\t}\r\n\t${props => props.type === 'onHover' && `\r\n\t\tpadding-left: 5px;\r\n\t\ttransition: background .3s ease;\r\n\t\t:hover {\r\n\t\t\t${tdActiveStyle}\r\n\t\t}\r\n\t\t${props.active ? tdActiveStyle : ''}\r\n\t`}\r\n\t${props => props.styles && props.styles.includes('center') && `\r\n\t\ttext-align: center;\r\n\t`}\r\n`\r\n\r\nconst TableRow = ({\r\n\ttableFields,\r\n\trowFields = [],\r\n\tentity,\r\n\texpandFor,\r\n\texpanded,\r\n\texpand,\r\n\tselect,\r\n\t...rest \r\n}) => {\r\n\t// rowFields have precedence over tableFields\r\n\tconst fields = tableFields.map(f => rowFields.find(rf => rf.name === f.name) || f)\r\n\tconst { selected, disabled } = entity\r\n\treturn (\r\n\t\t<Row\r\n\t\t\t{...rest}\r\n\t\t>\r\n\t\t\t{fields.map(f => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'service'\r\n\t\t\t\t\t&& typeof expanded !== 'undefined'\r\n\t\t\t\t\t&& entity[expandFor].length\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\texpand()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Caret\r\n\t\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tif (\r\n\t\t\t\t\tf.name === 'select'\r\n\t\t\t\t\t&& typeof select !== 'undefined'\r\n\t\t\t\t) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={f.name}\r\n\t\t\t\t\t\tservice\r\n\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\tselect()\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\tselected === 'partly' ? 'square' :\r\n\t\t\t\t\t\t\t\tselected \r\n\t\t\t\t\t\t\t\t\t? 'check square outline'\r\n\t\t\t\t\t\t\t\t\t: 'square outline'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tpath,\r\n\t\t\t\t\tonClick,\r\n\t\t\t\t\ticon,\r\n\t\t\t\t\ticonColor,\r\n\t\t\t\t\t...rest\r\n\t\t\t\t} = f\r\n\t\t\t\tif (content) return (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{content}\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t\tlet val = value || (path ? getObjProp(entity, path) : null)\r\n\t\t\t\tif (val && name === 'amount') val = currency(val)\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Td\r\n\t\t\t\t\t\tkey={name}\r\n\t\t\t\t\t\t{...rest}\r\n\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t!!onClick\r\n\t\t\t\t\t\t\t? e => {\r\n\t\t\t\t\t\t\t\t\te.stopPropagation()\r\n\t\t\t\t\t\t\t\t\tonClick()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{val && icon &&\r\n\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\tlink={!!onClick}\r\n\t\t\t\t\t\t\t\tname={icon}\r\n\t\t\t\t\t\t\t\tcolor={iconColor || undefined}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{val}\r\n\t\t\t\t\t</Td>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</Row>\r\n\t)\r\n}\r\n\r\nexport default TableRow","export const getObjProp = function(obj, path){\r\n  const pathArr = path.split('.')\r\n  for (let i=0; i<pathArr.length; i++){\r\n      obj = obj[pathArr[i]]\r\n      if (!obj) return undefined\r\n  }\r\n  return obj\r\n}","import React, { Fragment } from 'react'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\n\r\nimport Table from './common/Table'\r\nimport TableRow from './common/TableRow'\r\n\r\nconst fields = [{\r\n\tname: 'num',\r\n\tpath: 'num',\r\n\ttitle: '',\r\n\twidth: '45px'\r\n},{\r\n\tname: 'date',\r\n\tpath: 'dateLocal',\r\n\ttitle: '',\r\n\twidth: '110px'\r\n},{\r\n\tname: 'org',\r\n\tpath: 'org.name',\r\n\ttitle: '',\r\n\twidth: '225px'\r\n},{\r\n\tname: 'emps',\r\n\tpath: 'org.name',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'model',\r\n\tpath: 'model.name',\r\n\ttitle: '',\r\n\twidth: '250px'\r\n},{\r\n\tname: 'qty',\r\n\tpath: 'qty',\r\n\ttitle: '.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'reserved',\r\n\ttitle: '.',\r\n\twidth: '50px'\r\n},{\r\n\tname: 'amount',\r\n\ttitle: '',\r\n\twidth: '105px'\r\n},{\r\n\tname: 'status',\r\n\tpath: 'status.name',\r\n\ttitle: '',\r\n\twidth: '130px'\r\n}]\r\n\r\nconst EnquiriesTable = ({ enquiries }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details, setDetails, bottomPanel, setBottomPanel, setExpanded }) =>\r\n\t\t\t\t<Table\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\tenquiries.map(enquiry => {\r\n\t\t\t\t\t\t\tconst { id, org, docs, isExpanded } = enquiry\r\n\t\t\t\t\t\t\tconst active = details\r\n\t\t\t\t\t\t\t\t&& details.type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Fragment key={id} >\r\n\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\tentity={enquiry}\r\n\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: docs.length && docs[docs.length - 1].amount\r\n\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'emps',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: org.employees.length ? 'user' : 'user plus',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'grey',\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'onHover',\r\n\t\t\t\t\t\t\t\t\t\t\tstyles: ['center'],\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: org.employees.length || ' ',\r\n\t\t\t\t\t\t\t\t\t\t\tonClick: () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetBottomPanel({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Employees',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId: org.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tactive: bottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.type === 'Employees'\r\n\t\t\t\t\t\t\t\t\t\t\t\t&& bottomPanel.orgId === org.id\r\n\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\texpandFor='orders'\r\n\t\t\t\t\t\t\t\t\t\texpanded={isExpanded}\r\n\t\t\t\t\t\t\t\t\t\texpand={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)}}\r\n\t\t\t\t\t\t\t\t\t\tactive={active}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded({\r\n\t\t\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: !active ? true : !isExpanded\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t{\tisExpanded && enquiry.orders.map((order, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { id, num, prods } = order\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === enquiry.orders.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\t\tentity={order}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\t\trowFields={[{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'num',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.num + '-' + num\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'org',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.org.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'model',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: enquiry.model && enquiry.model.name //check only for migration from aws\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserved',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: prods.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t},{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'amount',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'amount'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdetails\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& details.type === 'Order'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t&& id === details.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetDetails({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t</TableRow>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t\t// {/* {name} <ProdQtyLabel color='grey' basic content={`${prods.length}`} /> */}\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default EnquiriesTable","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section, Caret } from './styled/styled-semantic'\r\n\r\nconst SIcon = styled(Icon)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\nconst SCaret = styled(Caret)`\r\n\t&&& {\r\n\t\tbox-sizing: content-box;\r\n\t\twidth: calc(55px - 1em);\r\n\t\tmargin: 0 0.5em;\r\n\t}\r\n`\r\n\r\nconst DetailsHeaderContainer = ({\r\n\tchildren,\r\n\t// style\r\n\tsize,\r\n\tbottomBorder,\r\n\tclose,\r\n\texpanded,\r\n\tdisabled,\r\n\tonClick,\r\n\tnoIndent,\r\n}) => {\r\n\tconst modes = {\r\n\t\t...close && { close: true },\r\n\t\t...(typeof expanded !== 'undefined') && { expand: true },\r\n\t}\r\n\treturn (\r\n\t\t<Section\r\n\t\t\thead\r\n\t\t\tnoLP\r\n\t\t\tnoIndent={noIndent}\r\n\t\t\tbottomBorder={bottomBorder || true}\r\n\t\t\tsize={size || undefined}\r\n\t\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\t{ modes['close']\r\n\t\t\t\t?\t<SIcon link\r\n\t\t\t\t\t\tsize='big'\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tonClick={close}\r\n\t\t\t\t\t/> :\r\n\t\t\t\t// TODO make disabled work (grey out color)\r\n\t\t\t\tmodes['expand']\r\n\t\t\t\t? <SCaret\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tactive={expanded ? 1 : 0}\r\n\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t/> : null\r\n\t\t\t}\r\n\t\t\t{children}\r\n\t\t</Section>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderContainer\r\n","import React from 'react'\r\n\r\nimport { Span } from './styled/styled-semantic'\r\n\r\nconst DetailsHeaderSubitle = ({ text }) => {\r\n\treturn (\r\n\t\t<Span\r\n\t\t\tml='10px'\r\n\t\t\tfs='1rem'\r\n\t\t\tc='rgba(0,0,0,.6)'\r\n\t\t\tws='0.5em'\r\n\t\t>\r\n\t\t\t{text}\r\n\t\t</Span>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderSubitle\r\n","import React from 'react'\r\n\r\nimport { Header } from './styled/styled-semantic'\r\nimport DetailsHeaderSubitle from './DetailsHeaderSubitle'\r\n\r\nconst DetailsHeaderTitle = ({\r\n\ttitle,\r\n\tsubtitle,\r\n\tsize\r\n}) => {\r\n\treturn (\r\n\t\t<Header\r\n\t\t\tm='0'\r\n\t\t\tsize={size || 'medium'}\r\n\t\t>\r\n\t\t\t{title}\r\n\t\t\t{subtitle &&\r\n\t\t\t\t<DetailsHeaderSubitle\r\n\t\t\t\t\ttext={subtitle}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t</Header>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderTitle\r\n","import React from 'react'\r\n\r\nimport { Div } from './styled/styled-semantic'\r\n\r\nconst DetailsHeaderButtons = ({ children }) => {\r\n\treturn (\r\n\t\t<Div\r\n\t\t\tml='auto'\r\n\t\t>\r\n\t\t\t{children}\r\n\t\t</Div>\r\n\t)\r\n}\r\n\r\nexport default DetailsHeaderButtons\r\n","import React from 'react'\r\n\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from '../styled/styled-semantic'\r\nimport styled from 'styled-components'\r\n\r\nconst SButton = styled(Button)`\r\n\tpadding: .78571429em !important;\r\n\t&>i {\r\n\t\topacity: .9 !important;\r\n\t\tmargin: 0 !important;\r\n\t}\r\n`\r\n\r\nconst RefreshButton = ({ loading, onClick }) => {\r\n\treturn (\r\n\t\t<SButton\r\n\t\t\tactiveColor='blue'\r\n\t\t\tactive={loading}\r\n\t\t\tonClick={onClick} >\r\n\t\t\t<Icon \r\n\t\t\t\tname='refresh'\r\n\t\t\t\tloading={loading} \r\n\t\t\t/>\r\n\t\t</SButton>\r\n\t)\r\n}\r\n\r\nexport default RefreshButton\r\n","import React, { Fragment } from 'react'\r\n\r\nimport { Button } from './styled/styled-semantic'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\nimport RefreshButton from './common/RefreshButton'\r\n\r\nconst settings = {\r\n\tEnquiry: {\r\n\t\ttitleNew: ' ',\r\n\t\ttitleExisting: ' ',\r\n\t},\r\n\tOrder: {\r\n\t\ttitleNew: ' ',\r\n\t\ttitleExisting: ' ',\r\n\t}\r\n}\r\n\r\nconst DetailsMainHeader = ({\r\n\ttype,\r\n\tcloseDetails,\r\n\tloading,\r\n\trefresh,\r\n\tsetDetails,\r\n\teditMode,\r\n\tlocalEntity\r\n}) => {\r\n\tconst { id, num, dateLocal } = localEntity || {}\r\n\treturn (\r\n\t\t<DetailsHeaderContainer\r\n\t\t\tclose={closeDetails}\r\n\t\t>\r\n\t\t\t{ !id && // new entity\r\n\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\ttitle={settings[type].titleNew}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{ id && // existing entity\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\t\ttitle={settings[type].titleExisting + num}\r\n\t\t\t\t\t\tsubtitle={' ' + dateLocal}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t\t<RefreshButton\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={refresh}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ticon='edit'\r\n\t\t\t\t\t\t\tactiveColor='blue'\r\n\t\t\t\t\t\t\tactive={editMode || false}\r\n\t\t\t\t\t\t\tonClick={() => setDetails({\r\n\t\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\t\tid: localEntity.id,\r\n\t\t\t\t\t\t\t\teditMode: true\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t/> \r\n\t\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t\t</Fragment>\r\n\t\t\t}\r\n\t\t</DetailsHeaderContainer>\r\n\t)\r\n}\r\n\r\nexport default DetailsMainHeader\r\n","import styled from 'styled-components'\r\n\r\nexport const Table = styled.table`\r\n\t/* table-layout: fixed; */\r\n\twidth: 100%;\r\n\tborder-collapse: collapse;\r\n`\r\n\r\nexport const Tr = styled.tr`\r\n  margin: 0 0 1em;\r\n  line-height: 1.4285em;\r\n  color: rgba(0,0,0,.87);\r\n`\r\n\r\nexport const Td = styled.td`\r\n  :nth-child(1) {\r\n\t\twidth: ${props => props.theme.widths.formLabel};\r\n\t// color: rgba(0,0,0,.87);\r\n\t/* font-size: .92857143em; */\r\n\t/* line-height: 32px; */\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n\t\tvertical-align: top;\r\n  }\r\n  :nth-child(2) {\r\n\t\t// width: 100px;\r\n\t\tfont-size: 1em;\r\n\t\tfont-weight: bold;\r\n\t\tline-height: 1.21428571em;\r\n\t\tpadding: .67857143em 0;\r\n  }\r\n`\r\nexport const InputTd = Td.extend`\r\n\tpadding-top: 0 !important;\r\n`\r\n\r\nexport const EditorTd = InputTd.extend`\r\n\tfont-weight: unset !important;\r\n\t/* padding-bottom: 0 !important; */\r\n`","import React from 'react'\r\nimport {\r\n\tEditor,\r\n\tEditorState,\r\n\tContentState,\r\n\tRichUtils,\r\n\tconvertFromHTML,\r\n\tgetDefaultKeyBinding,\r\n\tKeyBindingUtil\r\n} from 'draft-js'\r\nimport 'draft-js/dist/Draft.css'\r\nimport {stateToHTML} from 'draft-js-export-html'\r\n\r\nclass DraftEditor extends React.Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tlet editorState\r\n\t\tif (props.initFromHtml) {\r\n\t\t\tconst blocksFromHTML = convertFromHTML(props.initFromHtml)\r\n\t\t\teditorState = EditorState.createWithContent(\r\n\t\t\t\tContentState.createFromBlockArray(\r\n\t\t\t\t\tblocksFromHTML.contentBlocks,\r\n\t\t\t\t\tblocksFromHTML.entityMap\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\teditorState = EditorState.createEmpty()\r\n\t\t}\r\n\t\tthis.state = { \r\n\t\t\teditorState,\r\n\t\t\toriContent: editorState.getCurrentContent()\r\n\t\t}\r\n\t}\r\n\tonChange = (editorState) => {\r\n\t\tthis.setState({ editorState })\r\n\t\tconst newContent = editorState.getCurrentContent()\r\n\t\tconst { setEditorHasText, setEditorDiff, setHasFocus } = this.props\r\n\t\tif (editorState && setEditorHasText) setEditorHasText(newContent.hasText())\r\n\t\tif (setEditorDiff) setEditorDiff(newContent !== this.state.oriContent)\r\n\t\tif (setHasFocus) setHasFocus(editorState.getSelection().getHasFocus())\r\n\t}\r\n\tkolmechKeyBindingFn = (e) => {\r\n\t\t// catch Ctrl + Enter event\r\n\t\tif (e.keyCode === 13 && KeyBindingUtil.hasCommandModifier(e)) {\r\n\t\t  return 'ctrlEnter'\r\n\t\t}\r\n\t\treturn getDefaultKeyBinding(e)\r\n\t}\r\n\thandleKeyCommand = (command, editorState) => {\r\n\t\t// handle Ctrl + Enter command\r\n\t\tif (command === 'ctrlEnter') {\r\n\t\t\tthis.props.onCtrlEnter()\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\tconst newState = RichUtils.handleKeyCommand(editorState, command);\r\n\t\tif (newState) {\r\n\t\t\tthis.onChange(newState);\r\n\t\t\treturn 'handled'\r\n\t\t}\r\n\t\treturn 'not-handled'\r\n\t}\r\n\tclear = () => this.setState({ \r\n\t\teditorState: EditorState.push(this.state.editorState, ContentState.createFromText(''), 'remove-range')\r\n\t})\r\n\texportHtml = () => {\r\n\t\tconst html = stateToHTML(this.state.editorState.getCurrentContent())\r\n\t\tif (!convertFromHTML(html).contentBlocks) return null\r\n\t\treturn html\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Editor\r\n\t\t\t\teditorState={this.state.editorState}\r\n\t\t\t\tonChange={this.onChange}\r\n\t\t\t\thandleKeyCommand={this.handleKeyCommand}\r\n\t\t\t\tkeyBindingFn={this.kolmechKeyBindingFn}\r\n\t\t\t\treadOnly={this.props.readOnly}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default DraftEditor","import React, { Component } from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport DraftEditor from './DraftEditor'\r\n\r\nconst EditorWrapper = styled.div`\r\n\tpadding: calc(0.678571em - 1px) 1em;\r\n\tline-height: 1.4285em;\r\n\tborder: 1px solid rgba(34,36,38,.15);\r\n\tborder-radius: .28571429rem;\r\n\ttransition: all .1s ease;\r\n\t${({ borderless, hasFocus, diff }) =>\r\n\t\tborderless\r\n\t\t&& !hasFocus\r\n\t\t&& !diff && `\r\n\t\t\tmargin-left: -1em;\r\n\t\t\tborder: 1px solid white;\r\n\t\t\t:hover {\r\n\t\t\t\tbackground: rgba(0,0,0,.05);\r\n\t\t\t\tcolor: rgba(0,0,0,.65);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\t\t`\r\n\t}\r\n`\r\n\r\nclass WrappedDraftEditor extends Component {\r\n\tstate = {\r\n\t\thasFocus: false\r\n\t}\r\n\tsetHasFocus = (hasFocus) => this.setState({ hasFocus })\r\n\trender() {\r\n\t\tconst { hasFocus } = this.state\r\n\t\tconst {\r\n\t\t\tborderless,\r\n\t\t\tdiff,\r\n\t\t\tforwardedRef,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\t\treturn (\r\n\t\t\t<EditorWrapper\r\n\t\t\t\tborderless={borderless}\r\n\t\t\t\thasFocus={hasFocus}\r\n\t\t\t\tdiff={diff}\r\n\t\t\t>\r\n\t\t\t\t<DraftEditor\r\n\t\t\t\t\tref={forwardedRef}\r\n\t\t\t\t\tsetHasFocus={this.setHasFocus}\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t/>\r\n\t\t\t</EditorWrapper>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default React.forwardRef((props, ref) =>\r\n\t<WrappedDraftEditor\r\n\t\tforwardedRef={ref}\r\n\t\t{...props}\r\n\t/>\r\n)","const validateInn = (inn, error) => {\r\n    var result = false;\r\n\tif (typeof inn === 'number') {\r\n        inn = inn.toString();\r\n\t} else if (typeof inn !== 'string') {\r\n        inn = '';\r\n\t}\r\n\tif (!inn.length) {\r\n        error.code = 1;\r\n\t\terror.message = ' ';\r\n\t} else if (/[^0-9]/.test(inn)) {\r\n        error.code = 2;\r\n\t\terror.message = '     ';\r\n\t} else if ([10, 12].indexOf(inn.length) === -1) {\r\n        error.code = 3;\r\n\t\terror.message = '     10  12 ';\r\n\t} else {\r\n        var checkDigit = function (inn, coefficients) {\r\n            var n = 0;\r\n\t\t\tfor (var i in coefficients) {\r\n                n += coefficients[i] * inn[i];\r\n\t\t\t}\r\n            // eslint-disable-next-line\r\n\t\t\treturn parseInt(n % 11 % 10);\r\n\t\t};\r\n        // eslint-disable-next-line\r\n\t\tswitch (inn.length) {\r\n            case 10:\r\n            var n10 = checkDigit(inn, [2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if (n10 === parseInt(inn[9])) {\r\n                result = true;\r\n            }\r\n            break;\r\n\t\t\tcase 12:\r\n            var n11 = checkDigit(inn, [7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            var n12 = checkDigit(inn, [3, 7, 2, 4, 10, 3, 5, 9, 4, 6, 8]);\r\n            // eslint-disable-next-line\r\n            if ((n11 === parseInt(inn[10])) && (n12 === parseInt(inn[11]))) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (!result) {\r\n\t\t\terror.code = 4;\r\n\t\t\terror.message = '   ';\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport default validateInn","export const isValidDate = (date) => date instanceof Date && !isNaN(date.valueOf())\r\nexport const tz = new Date().getTimezoneOffset() * 60000\r\nexport const toLocalISOString = (date) => new Date(date.getTime() - tz).toISOString()\r\nexport const fromLocalISOString = (string) => new Date(Date.parse(string) + tz)\r\n// util to split array into chunks\r\nexport const toChunks = (arr, size) => {\r\n    let chunks = []\r\n    for (let i = 0; i < arr.length; i += size) {\r\n        chunks.push(arr.slice(i, i + size))\r\n    }\r\n    return chunks\r\n}\r\n\r\n// groupBy = (xs, key) => xs.reduce((rv, x) => {\r\n//     (rv[x[key]] = rv[x[key]] || []).push(x)\r\n//     return rv\r\n//   }, {})\r\n// groupByArray(xs, key) => xs.reduce( (rv, x) => {\r\n//   let v = key instanceof Function ? key(x) : x[key];\r\n//   let el = rv.find((r) => r && r.key === v);\r\n//   if (el) { el.values.push(x); } else { rv.push({ key: v, values: [x] }); }\r\n//   return rv;\r\n// }, [])\r\n// const splitBy = (xs, key) => xs.reduce( (rv, x) => {\r\n//   let el = rv.find(r => r[0][key] === x[key])\r\n//   if (el) { el.push(x); } else { rv.push([x]); }\r\n// }, [])\r\n","import gql from 'graphql-tag'\r\n\r\nexport const org = gql`\r\n\tquery org ($id: ID!) {\r\n\t\torg (id: $id) {\r\n\t\t\tid\r\n\t\t\tinn\r\n\t\t\tname\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const allOrgs = gql`\r\n\tquery allOrgs {\r\n\t\torgs {\r\n\t\t\tid\r\n\t\t\tinn\r\n\t\t\tname\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const createOrg = gql`\r\n\tmutation createOrg($inn: String!) {\r\n\t\tcreateOrg(inn: $inn) {\r\n\t\t\tid\r\n\t\t\tinn\r\n\t\t\tname\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const orgLocal = gql`\r\n\tquery OrgLocal ($id: ID!) {\r\n\t\torgLocal (id: $id) {\r\n\t\t\tid\r\n\t\t\tname\r\n\t\t}\r\n\t}\r\n`","import gql from 'graphql-tag'\r\n\r\nexport const allOrgsAndModels = gql`\r\n    query AllOrgsAndModels {\r\n        orgs {\r\n            id\r\n            inn\r\n            name\r\n        }\r\n        models {\r\n            id\r\n            article\r\n            name\r\n        }\r\n    }\r\n`","import React from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { toLocalISOString } from '../../utils/dates'\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.err && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nconst DatePicker = ({ selectedDate, selectDay, error }) => {\r\n\treturn (\r\n\t\t<PickerDiv error={error}>\r\n\t\t\t<DayPickerInput\r\n\t\t\t\tvalue={toLocalISOString(selectedDate).slice(0, 10)}\r\n\t\t\t\tonDayChange={selectDay}\r\n\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\tmonth: selectedDate\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</PickerDiv>\r\n\t)\r\n}\r\n\r\nexport default DatePicker\r\n","import React from 'react'\r\nimport { Section, Header, Div, Icon } from '../styled/styled-semantic';\r\n\r\nexport default ({\r\n  title,\r\n  content,\r\n  onClose\r\n}) => {\r\n  return (\r\n    <Div\r\n      m='0 -1em 1em -55px'\r\n    >\r\n      <Section\r\n        head\r\n        minor\r\n        secondary\r\n        topBorder\r\n        bottomBorder\r\n        noLP={!!onClose}\r\n      >\r\n        {!!onClose &&\r\n          <Icon\r\n            bs='content-box'\r\n            w='calc(55px - 1em)'\r\n            m='0 0.5em'\r\n            link\r\n            size='large'\r\n            name='close'\r\n            // onClick={() => onClose()}\r\n            onClick={onClose}\r\n          />\r\n        }\r\n        <Header\r\n          m='0'\r\n        >\r\n          {title}\r\n        </Header>\r\n      </Section>\r\n      <Section\r\n        secondary\r\n        bottomBorder\r\n      >\r\n        {content}\r\n      </Section>\r\n    </Div>\r\n  )\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const modelLocal = gql`\r\n\tquery ModelLocal ($id: ID!) {\r\n\t\tmodelLocal (id: $id) {\r\n\t\t\tname\r\n      article\r\n\t\t}\r\n\t}\r\n`\r\n\r\nexport const upsertModel = gql`\r\n\tmutation upsertModel(\r\n\t\t$input: ModelInput!\r\n\t) {\r\n\t\tupsertModel(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","export const projectEntity = (entity, schema) => {\r\n  let result = {}\r\n  handleObj(schema, entity, result)\r\n  return result\r\n}\r\n\r\nexport const preparePayload = (values, initialValues, schema) => {\r\n  let result = {}\r\n  handlePayloadObj(schema, initialValues, values, result)\r\n  return result\r\n}\r\n\r\nconst handleObj = (objSchema, obj = {}, result) => {\r\n  // preserve ids of entity objects\r\n  if (obj.id) result.id = obj.id\r\n  Object.keys(objSchema).forEach(k => {\r\n    const type = typeof objSchema[k]\r\n    // NOTE form schema should contain only non-empty nested objects\r\n    if (type === 'object' && Array.isArray(objSchema[k]))\r\n      return handleArr(objSchema[k], obj[k], result[k] = [])\r\n    if (type === 'object')\r\n      return handleObj(objSchema[k], obj[k], result[k] = {})\r\n    result[k] = obj[k] || objSchema[k]\r\n  })\r\n}\r\n\r\nconst handleArr = (arrSchema, arr = [], resultArr) => {\r\n  // NOTE schema array should contain one element only just to define schema\r\n  const type = typeof arrSchema[0]\r\n  // TODO handle array of primitives (now only collections)\r\n  if (type === 'object') {\r\n    return arr.length\r\n      ? arr.forEach((obj, i) => handleObj(arrSchema[0], obj, resultArr[i] = {}))\r\n      : handleObj(arrSchema[0], {}, resultArr[0] = {})\r\n  }\r\n}\r\n\r\nconst handlePayloadObj = (objSchema, initialObj, obj, result) => {\r\n  // preserve ids of entity objects\r\n  if (obj.id) result.id = obj.id\r\n  Object.keys(objSchema).forEach(k => {\r\n    // preserve any db entities' Ids\r\n    if (k.endsWith('Id')) return result[k] = objSchema[k]\r\n    const type = typeof objSchema[k]\r\n    // NOTE form schema should contain only non-empty nested objects\r\n    if (type === 'object' && Array.isArray(objSchema[k]))\r\n      return handlePayloadArr(objSchema[k], initialObj[k], obj[k], result[k] = [])\r\n    if (type === 'object')\r\n      return handlePayloadObj(objSchema[k], initialObj[k], obj[k], result[k] = {})\r\n    // result includes changed values\r\n    if (obj[k] !== initialObj[k]) return result[k] = obj[k]\r\n    // and non-empty initial values\r\n    if (!initialObj[k] && !!objSchema[k]) return result[k] = objSchema[k]\r\n  })\r\n}\r\n\r\nconst handlePayloadArr = (arrSchema, initialArr, arr, resultArr) => {\r\n  // NOTE schema array should contain one element only just to define schema\r\n  const type = typeof arrSchema[0]\r\n  // TODO handle array of primitives (now only collections)\r\n  if (type === 'object') {\r\n    // arr should contain at least one element\r\n    return arr.forEach((obj, i) =>\r\n      handlePayloadObj(arrSchema[0], initialArr[i], obj, resultArr[i] = {})\r\n    )\r\n  }\r\n}\r\n","import { string } from 'yup'\r\n\r\nexport const idValidationType = string().matches(/^[a-z0-9]{25}$/)","import { object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  // orgId: idValidationType\r\n\t// \t.when('id', (id, schema) => id\r\n\t// \t\t? schema.notRequired()\r\n\t// \t\t: schema.required('  ')\r\n\t// \t),\r\n  name: string().trim().min(4).max(255)\r\n    .when('id', (id, schema) => id\r\n      ? schema.notRequired()\r\n      : schema.required()\r\n    ),\r\n  article: string().trim().min(4).max(10).notRequired(),\r\n})\r\n\r\nexport const formikSchema = {\r\n  name: '',\r\n  article: ''\r\n}\r\n\r\nexport const listSchema = {\r\n  name: {\r\n    label: ''\r\n  },\r\n  article: {\r\n    label: ''\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { connect, getIn } from 'formik'\r\n\r\nclass FormikInput extends Component {\r\n\trender() {\r\n\t\tconst { formik, name, ...rest } = this.props\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\tw='100%'\r\n\t\t\t\tname={name}\r\n\t\t\t\tvalue={getIn(formik.values, name)}\r\n\t\t\t\terror={getIn(formik.touched, name) && !!getIn(formik.errors, name)}\r\n\t\t\t\tonChange={formik.handleChange}\r\n\t\t\t\tonBlur={formik.handleBlur}\r\n\t\t\t\t{...rest}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default connect(FormikInput)","import React, { Component } from 'react'\r\nimport { connect, getIn } from 'formik'\r\nimport InputMask from 'react-input-mask'\r\nimport styled from 'styled-components'\r\nimport { Dropdown as SDropdown } from 'semantic-ui-react';\r\nimport { Input } from '../styled/styled-semantic';\r\nimport FormikInput from './FormikInput.js';\r\n\r\nconst countryOtions = [\r\n  { key: 'rus', text: '+7', value: 'rus' },\r\n  { key: 'notRus', text: '+', value: 'notRus' },\r\n]\r\n\r\nconst DropdownPropFilter = ({ inputError, ...rest }) => (\r\n\t<SDropdown {...rest} />\r\n)\r\nexport const Dropdown = styled(DropdownPropFilter)`\r\n\t&&&&&& {\r\n    ${props => props.inputError && `\r\n      border: 1px solid ${props.theme.colors.errorBorder};\r\n      border-right-color: transparent;\r\n    `}\r\n\t}\r\n`\r\n\r\nconst Error = styled.div`\r\n  color: ${props => props.theme.colors.error};\r\n`\r\n\r\nclass Tel extends Component {\r\n  render() {\r\n    const {\r\n      baseName,\r\n      formik,\r\n      ...rest\r\n    } = this.props\r\n    const number = getIn(formik.values, baseName + '.number')\r\n    const country = getIn(formik.values, baseName + '.country')\r\n    const touched = getIn(formik.touched, baseName + '.number')\r\n    const error = getIn(formik.errors, baseName)\r\n    const renderDropdown =() => (\r\n      <Dropdown\r\n        tabIndex={-1}\r\n        name={baseName + '.country'}\r\n        value={country}\r\n        options={countryOtions}\r\n        inputError={touched && !!error}\r\n        onChange={(e, { name, value }) => formik.setFieldValue( name, value )}\r\n      />\r\n    )\r\n    return <>\r\n      {country === 'rus'\r\n        ? <InputMask\r\n            name={baseName + '.number'}\r\n            mask='( 999 ) 999-99-99'\r\n            maskChar=''\r\n            value={number}\r\n            onBlur={formik.handleBlur}\r\n            onChange={formik.handleChange}\r\n          >\r\n            {(inputProps) =>\r\n              <Input\r\n                w='240px !important'\r\n                // placeholder=' '\r\n                error={touched && !!error}\r\n                label={renderDropdown()}\r\n                {...rest}\r\n                {...inputProps}\r\n              />\r\n            }\r\n          </InputMask>\r\n        : <FormikInput\r\n            w='240px !important'\r\n            name={baseName + '.number'}\r\n            error={touched && !!error}\r\n            // placeholder='   '\r\n            label={renderDropdown()}\r\n            {...rest}\r\n          />\r\n      }\r\n      <Error>\r\n        {touched && error && error.number}\r\n      </Error>\r\n    </>\r\n  }\r\n}\r\n\r\nexport default connect(Tel)\r\n","import React, { Fragment } from 'react'\r\nimport { getIn, connect, FieldArray } from 'formik'\r\nimport styled from 'styled-components'\r\n\r\nimport FormikInput from './FormikInput'\r\nimport Tel from './Tel'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n  flex: 0 0 122px;\r\n  padding-top: calc(10.5rem/14);\r\n  font-size: calc(13rem/14);\r\n  font-weight: bold;\r\n  line-height: 1.21428571rem;\r\n  ${props => props.required && `\r\n    ::after {\r\n      content: '*';\r\n      display: inline-block;\r\n      margin: -.2em 0 0 .2em;\r\n      vertical-align: top;\r\n      color: #db2828;\r\n    }\r\n  `}\r\n`\r\n\r\nconst Content = styled.div`\r\n  flex: 1 1 auto;\r\n  max-width: calc(100% - 122px);\r\n`\r\n\r\nconst InputContainer = styled.div`\r\n  max-width: 240px;\r\n`\r\n\r\nconst Error = styled.div`\r\n  color: ${props => props.theme.colors.error};\r\n`\r\n\r\nconst Field = ({\r\n  name,\r\n  type,\r\n  formik,\r\n  label,\r\n  required,\r\n  inputLabel,\r\n  ...rest\r\n}) => {\r\n  const isArray = name === 'person.tels'\r\n  // const component = data =>\r\n  //   type === 'string' ? data :\r\n  //   type === 'tel' ? <Tel tel={data} />\r\n  //   : null\r\n  return (\r\n    <Container>\r\n      <Label\r\n        required={required}\r\n      >\r\n        {label}\r\n      </Label>\r\n      <Content>\r\n        {isArray\r\n          ? <FieldArray\r\n              name={name}\r\n              render={arrayHelpers => (\r\n                <>\r\n                  {getIn(formik.values, name).map((_, i) => \r\n                    <Fragment\r\n                      key={i}\r\n                    >\r\n                      <Tel\r\n                        baseName={`${name}.${i}`}\r\n                      />\r\n                    </Fragment>\r\n                  )}\r\n                </>\r\n              )}\r\n            />\r\n          : <>\r\n              <InputContainer>\r\n                <FormikInput\r\n                  {...rest}\r\n                  name={name}\r\n                  type={type}\r\n                />\r\n              </InputContainer>\r\n              <Error>\r\n                {getIn(formik.touched, name) ? getIn(formik.errors, name) : ''}\r\n              </Error>\r\n            </>\r\n        }\r\n        \r\n        {/* {Array.isArray(content)\r\n          ? content.map((item, i) => \r\n              <Fragment key={i}>\r\n                {component(item)}\r\n              </Fragment>\r\n            )\r\n          : component(content)\r\n        } */}\r\n      </Content>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default connect(Field)","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertModel } from '../../graphql/model'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/model'\r\nimport Field from '../form/Field'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\nexport default class ModelForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      model,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries,\r\n      onSubmit,\r\n    } = this.props\r\n    let schema = model ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = model ? projectEntity(model, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertModel}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertModel, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('upsertModel input > ', input)\r\n              const upserted = await upsertModel({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return model\r\n                ? toggleEditMode()\r\n                : this.didMount && onSubmit(upserted.data.upsertModel.id)\r\n            }}\r\n          >\r\n            {({\r\n              handleSubmit,\r\n              handleReset,\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label=''\r\n                  name='name'\r\n                  required\r\n                />\r\n                <Field\r\n                  label=''\r\n                  name='article'\r\n                />\r\n                {!!error &&\r\n                  <Message\r\n                    d='block !important'\r\n                    error\r\n                    header='  ..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  type='button'\r\n                  primary\r\n                  content={model ? '' : ''}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ model ? toggleEditMode : handleReset}\r\n                >\r\n                  {model ? '' : ''}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport validateInn from '../../utils/validateInn'\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { allEnquiries, createEnquiry, updateEnquiry } from '../../graphql/enquiry'\r\nimport { createOrg } from '../../graphql/org'\r\nimport { allOrgsAndModels } from '../../graphql/combinedQueries'\r\n\r\nimport styled from 'styled-components'\r\nimport { Form, Input, Message, Dropdown as SDropdown } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Button, Section } from '../styled/styled-semantic.js'\r\nimport DatePicker from '../common/DatePicker'\r\nimport SecondarySection from '../presentational/SecondarySection'\r\nimport ModelForm from '../Model/Form'\r\n\r\nconst Dropdown = styled(SDropdown)`\r\n\t&&&&&& {\r\n\t\twidth: 350px;\r\n\t\t&:hover {\r\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\r\n\t\t}\r\n\t}\r\n`\r\n\r\nclass EnquiryEdit extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEnquiry = props.id === 'new'\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tthis.state = {\r\n\t\t\tloading: false,\r\n\t\t\t// if any of the form fields has error, the following err prop should always contain non empty string error message with explanaition \r\n\t\t\terr: {\r\n\t\t\t\tmessage: ''\r\n\t\t\t},\r\n\t\t\torgDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tmodelDdn: {\r\n\t\t\t\tsearch: '',\r\n\t\t\t\tloading: false\r\n\t\t\t},\r\n\t\t\tnewModelMode: false\r\n\t\t}\r\n\t\t// gather form fields on oriEnquiry object\r\n\t\tconst oriEnquiry = cloneDeep(props.enquiry)\r\n\t\t// console.log('props.enquiry > ', props.enquiry)\r\n\t\tif (isNewEnquiry) oriEnquiry.dateLocal = toLocalISOString(new Date()).slice(0, 10)\r\n\t\tdelete oriEnquiry.events\r\n\t\toriEnquiry.orgId = oriEnquiry.org ? oriEnquiry.org.id : null\r\n\t\toriEnquiry.modelId = oriEnquiry.model ? oriEnquiry.model.id : null\r\n\t\toriEnquiry.qty = oriEnquiry.qty ? oriEnquiry.qty : ''\r\n\t\t// console.log('oriEnquiry > ', oriEnquiry)\r\n\t\tthis.fields = Object.keys(oriEnquiry)\r\n\t\t\t.filter(key => !['__typename', 'id', 'num', 'org', 'model'].includes(key))\r\n\t\t// console.log('this.fields > ', this.fields)\r\n\t\tthis.requiredFields = ['dateLocal', 'orgId', 'modelId', 'qty']\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\t// console.log(key, oriEnquiry[key])\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tcurVal: oriEnquiry[key],\r\n\t\t\t\t// err bool controls weather the field is heighlighted with error (red) style\r\n\t\t\t\terr: false,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!isNewEnquiry && {\r\n\t\t\t\t\toriVal: oriEnquiry[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (!isNewEnquiry) this.state.diff = false\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tcloseNewModelSection = () => this.setState({ newModelMode: false })\r\n\tchangeFieldValue = (field, newVal) => {\r\n\t\tconsole.log('change ', field, ' to value > ', newVal)\r\n\t\tconst fieldObj = cloneDeep(this.state[field])\r\n\t\tfieldObj.curVal = newVal\r\n\t\tfieldObj.err = false\r\n\t\tif (!this.isNewEnquiry) fieldObj.diff = fieldObj.curVal !== fieldObj.oriVal\r\n\t\tconst diff = this.fields.filter(f => f !== field).map(f => this.state[f].diff).includes(true) || fieldObj.diff\r\n\t\tthis.setState({ [field]: fieldObj, diff, err: { message: '' } })\r\n\t}\r\n\tselectDay = (pickedDate) => {\r\n\t\tif (!isValidDate(pickedDate)) return this.setState({ \r\n\t\t\tdateLocal: { ...this.state.dateLocal, err: true },\r\n\t\t\terr: { title: '  ', message: '     ' } \r\n\t\t})\r\n\t\tthis.changeFieldValue('dateLocal', toLocalISOString(pickedDate).slice(0, 10))\r\n\t}\r\n\thandleOrgDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\torgDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleModelDropdownSearchChange = (e, { searchQuery }) => {\r\n\t\tthis.setState({ \r\n\t\t\tmodelDdn: { search: searchQuery, err: false },\r\n\t\t})\r\n\t}\r\n\thandleQtyInputChange = ( e, { value } ) => {\r\n\t\tconst newVal = parseInt(value, 10) || ''\r\n\t\tthis.changeFieldValue('qty', newVal)\r\n\t}\r\n\tselectOrg = (e, { value }) => {\r\n\t\tthis.setState({ orgDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('orgId', value)\r\n\t}\r\n\tselectModel = (e, { value }) => {\r\n\t\tthis.setState({ modelDdn: { search: '', loading: false } })\r\n\t\tthis.changeFieldValue('modelId', value)\r\n\t}\r\n\tsubmitNewModel = (modelId) => {\r\n\t\tthis.changeFieldValue('modelId', modelId)\r\n\t\tthis.closeNewModelSection()\r\n\t}\r\n\tcreateOrg = async (e, { value: inn }) => {\r\n\t\ttry {\r\n\t\t\tlet err = {}\r\n\t\t\tconst isValidInn = validateInn(inn, err)\r\n\t\t\tif (!isValidInn) throw new Error(err.message)\r\n\t\t\tthis.setState({ orgDdn: { search: inn, loading: true} })\r\n\t\t\tconst data = await this.props.createOrg({ variables: { inn } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.selectOrg(null, { value: data.data.createOrg.id } )\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: '     ..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t},\r\n\t\t\t\torgDdn: {\r\n\t\t\t\t\tsearch: inn,\r\n\t\t\t\t\tloading: false\r\n\t\t\t\t},\r\n\t\t\t\torgId: {\r\n\t\t\t\t\t...this.state.orgId,\r\n\t\t\t\t\terr: true\r\n\t\t\t\t}\r\n\t\t\t })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst enquiry = {}\r\n\t\t// take out only changed fields for update\r\n\t\tthis.fields.forEach(f => {\r\n\t\t\tif (this.isNewEnquiry || this.state[f].diff) enquiry[f] = this.state[f].curVal\r\n\t\t})\r\n\t\tconst variables = { ...enquiry }\r\n\t\tif (this.isNewEnquiry) return this.createEnquiry(variables)\r\n\t\tvariables.id = this.props.id\r\n\t\tthis.updateEnquiry(variables)\r\n\t}\r\n\tcreateEnquiry = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.createEnquiry({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid: res.data.createEnquiry.id\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: '  ..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tupdateEnquiry = async (variables) => {\r\n\t\tconst { id, updateEnquiry, setDetails } = this.props\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tawait updateEnquiry({ variables: { input: variables } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: '' })\r\n\t\t\tsetDetails({\r\n\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\tid\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ \r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: '  ..',\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { dateLocal, orgId, orgDdn, modelId, modelDdn, qty, diff, loading, err, newModelMode } = this.state\r\n\t\tconst { id, setDetails, allOrgsAndModels } = this.props\r\n\t\tconst selectedDate = fromLocalISOString(dateLocal.curVal)\r\n\t\tconst orgs = allOrgsAndModels.orgs\r\n\t\tconst models = allOrgsAndModels.models\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst someFieldHasError = this.fields.some(f => !!this.state[f].err)\r\n\t\treturn (\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<Section\r\n\t\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t\t<DatePicker\r\n\t\t\t\t\t\t\t\t\t\terror={dateLocal.err}\r\n\t\t\t\t\t\t\t\t\t\tselectedDate={selectedDate}\r\n\t\t\t\t\t\t\t\t\t\tselectDay={this.selectDay} />\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t<Form.Field inline error={orgId.err} required>\r\n\t\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\tloading={!orgs || orgDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={!orgs || orgDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='    '\r\n\t\t\t\t\t\t\t\t\t\toptions={ orgs ? orgs.map(o => ({key:o.id, value: o.id, text: o.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\tvalue={orgId.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.selectOrg}\r\n\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\tsearchQuery={orgDdn.search}\r\n\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleOrgDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\tnoResultsMessage='  ,  ,  .'\r\n\t\t\t\t\t\t\t\t\t\tallowAdditions\r\n\t\t\t\t\t\t\t\t\t\tadditionLabel='  : '\r\n\t\t\t\t\t\t\t\t\t\tonAddItem={this.createOrg}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t{!newModelMode\r\n\t\t\t\t\t\t\t\t\t? <Form.Field\r\n\t\t\t\t\t\t\t\t\t\t\tinline\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\terror={modelId.err}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t\t\t\t<Dropdown\r\n\t\t\t\t\t\t\t\t\t\t\t\tloading={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={!models || modelDdn.loading}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselection //render as a formControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder='    '\r\n\t\t\t\t\t\t\t\t\t\t\t\toptions={ models ? models.map(m => ({key:m.id, value: m.id, text: m.name})) : [] }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={modelId.curVal}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.selectModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearch\r\n\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery={modelDdn.search}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSearchChange={this.handleModelDropdownSearchChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\tnoResultsMessage='  ,  \"  \"'\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tml='5px'\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\t\t\t\t\t\t\tactive={newModelMode}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => this.setState({ newModelMode: true })}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t\t\t: <SecondarySection\r\n\t\t\t\t\t\t\t\t\t\t\ttitle=' '\r\n\t\t\t\t\t\t\t\t\t\t\tonClose={this.closeNewModelSection}\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ModelForm\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmodel={undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\torgId={orgId.curVal || undefined}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trefetchQueries={allOrgsAndModels.refetch}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonSubmit={this.submitNewModel}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t\t<Label>-</Label>\r\n\t\t\t\t\t\t\t\t\t<Input type='number'\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=' - .' \r\n\t\t\t\t\t\t\t\t\t\tvalue={qty.curVal}\r\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleQtyInputChange} />\r\n\t\t\t\t\t\t\t\t\t<Span pl='6px'>.</Span>\r\n\t\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\thidden={!err.message}\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} />\r\n\t\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\t\tcontent={this.isNewEnquiry ? '' : ''}\r\n\t\t\t\t\t\t\t\tdisabled={(!this.isNewEnquiry && !diff) || !!err.message || someFieldHasError || !!orgId.loading || requiredIsEmpty}\r\n\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\tonClick={this.submit} />\r\n\t\t\t\t\t\t\t<A cancel \r\n\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? () => setDetails(null)\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: 'Enquiry',\r\n\t\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</A>\r\n\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(createOrg, { \r\n\t\tname: 'createOrg',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createOrg }}) => {\r\n\t\t\t\tconst query = allOrgsAndModels\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tdata.orgs.push(createOrg)\r\n\t\t\t\tdata.orgs.sort((a, b) => a.name > b.name)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n\tgraphql(allOrgsAndModels, { name: 'allOrgsAndModels' }),\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiry, { \r\n\t\tname: 'createEnquiry',\r\n\t\toptions: {\r\n\t\t\tupdate: (cache, {data: { createEnquiry }}) => {\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\tcreateEnquiry.isExpanded = false\r\n\t\t\t\tdata.enquiries.unshift(createEnquiry)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t}\r\n\t\t}\r\n\t}),\r\n)(EnquiryEdit)","import React, { Component } from 'react'\r\n\r\nimport DayPickerInput from 'react-day-picker/DayPickerInput'\r\nimport 'react-day-picker/lib/style.css'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { isValidDate, toLocalISOString, fromLocalISOString }from '../../utils/dates'\r\n\r\nconst PickerDiv = styled.div`\r\n\tdisplay: inline-block;\r\n\twidth: 180px;\r\n\t${props => props.err && `\r\n\t\tinput {\r\n\t\t\tcolor: #9f3a38 !important;\r\n\t\t\tbackground-color: #fff6f6 !important;\r\n\t\t\tborder-color: #e0b4b4 !important;\r\n\t\t}`\r\n\t}\r\n\tinput {\r\n\t\tcursor: pointer;\r\n\t\tvertical-align: unset !important;\r\n\t\tpadding-left: 3.5rem !important;\r\n\t\t&:focus {\r\n\t\t\tcursor: text;\r\n\t\t}\r\n\t}\r\n`\r\n\r\n// TODO logic may be deprecated (check with enremkol-dev)\r\nclass LocalDatePicker extends Component {\r\n\thandleDayChange = (pickedDate) => {\r\n\t\t// console.log('pickedDate > ', pickedDate)\r\n\t\tconst { setField, field: { name }} = this.props\r\n\t\tif (!isValidDate(pickedDate)) {\r\n\t\t\tsetField(name, {\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: '  ', \r\n\t\t\t\t\tmessage: '    --'\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tsetField(name, {\r\n\t\t\tvalue: toLocalISOString(pickedDate).slice(0, 10)\r\n\t\t})\r\n\t}\r\n\trender() {\r\n\t\tconst { field: {curVal: value, err} } = this.props\r\n\t\treturn (\r\n\t\t\t<PickerDiv err={!!err}>\r\n\t\t\t\t<DayPickerInput\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tonDayChange={this.handleDayChange}\r\n\t\t\t\t\tdayPickerProps={{\r\n\t\t\t\t\t\tfirstDayOfWeek: 1,\r\n\t\t\t\t\t\tmonth: fromLocalISOString(value)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</PickerDiv>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default LocalDatePicker\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport NumberFormat from 'react-number-format'\r\n\r\nimport { Input } from 'semantic-ui-react'\r\nimport { Span } from '../styled/styled-semantic'\r\n\r\nclass CurrencyInput extends Component {\r\n\trender() {\r\n\t\tconst { placeholder, field: {name, curVal: value}, setField } = this.props\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<NumberFormat\r\n\t\t\t\t\tcustomInput={Input}\r\n\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t\tdecimalSeparator=','\r\n\t\t\t\t\tthousandSeparator=' '\r\n\t\t\t\t\tdecimalScale={2}\r\n\t\t\t\t\tallowNegative={false}\r\n\t\t\t\t\tonValueChange={values => setField(name, {value: values.floatValue})}\r\n\t\t\t\t/>\r\n\t\t\t\t<Span pl='6px' fs='1.1rem' c='rgba(0,0,0,.87)'></Span>\r\n\t\t\t\t<Span pl='9px' fs='1.1rem' ws='0.1em'> </Span>\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default CurrencyInput\r\n","import { Component } from 'react'\r\n\r\nclass SmartForm extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.componentIsMounted = true\r\n\t\tthis.isNewEntity = props.isNewEntity\r\n\t\t// gather original form fields' values from provided object\r\n\t\tconst oriEntity = props.entity\r\n\t\tthis.fields = Object.keys(oriEntity)\r\n\t\tthis.requiredFields = props.requiredFields\r\n\t\t// map through form fields and write helper props\r\n\t\tthis.state = {}\r\n\t\tthis.fields.forEach(key => {\r\n\t\t\tthis.state[key] = {\r\n\t\t\t\tname: key,\r\n\t\t\t\tcurVal: oriEntity[key],\r\n\t\t\t\terr: null,\r\n\t\t\t\t...this.requiredFields.includes(key) && { required: true },\r\n\t\t\t\t...!this.isNewEntity && {\r\n\t\t\t\t\toriVal: oriEntity[key],\r\n\t\t\t\t\tdiff: false,\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\t// console.log(this.state)\r\n\t}\r\n\tsetField = (field, {value, err}) => {\r\n\t\t// console.log('field, value, err > ', field, value, err)\r\n\t\tthis.setState({\r\n\t\t\t[field]: {\r\n\t\t\t\t...this.state[field],\r\n\t\t\t\t...value && {\r\n\t\t\t\t\tcurVal: value,\r\n\t\t\t\t\t...!this.isNewEntity && { diff: value !== this.state[field].oriVal },\r\n\t\t\t\t},\r\n\t\t\t\terr: err || null,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tsubmit = () => {\r\n\t\tconst entity = this.fields.reduce((entity, f) => {\r\n\t\t\tentity[f] = this.state[f].curVal\r\n\t\t\treturn entity\r\n\t\t}, {})\r\n\t\tthis.props.submit(entity)\r\n\t}\r\n\trender() {\r\n\t\tconst { children } = this.props\r\n\t\tconst requiredIsEmpty = this.requiredFields.some(f => !this.state[f].curVal)\r\n\t\tconst diff = this.isNewEntity ? null : this.fields.map(f => this.state[f].diff).includes(true)\r\n\t\tconst err = this.fields.map(f => this.state[f].err).find(err => !!err)\r\n\t\tconst state = {\r\n\t\t\tdisabled: (!this.isNewEntity && !diff) || requiredIsEmpty || !!err,\r\n\t\t\terr: err || this.props.err,\r\n\t\t\tsetField: this.setField,\r\n\t\t\tsubmit: this.submit,\r\n\t\t\tformState: this.state\r\n\t\t}\r\n\t\t// @ts-ignore\r\n\t\treturn children(state)\r\n\t}\r\n}\r\n\r\nexport default SmartForm","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Header, Form, Message, Button, Divider } from 'semantic-ui-react'\r\nimport { Div, A, Label, Section } from './styled/styled-semantic'\r\n\r\nimport LocalDatePicker from './common/LocalDatePicker'\r\nimport CurrencyInput from './common/CurrencyInput'\r\nimport SmartForm from './common/SmartForm'\r\n\r\nimport { toLocalISOString } from '../utils/dates'\r\n\r\nclass EnquiryCommercialOffer extends Component {\r\n\trender() {\r\n\t\tconst { cancel, submit, loading } = this.props\r\n\t\tconst isNewCO = this.props.id === 'new'\r\n\t\tconst co = isNewCO\r\n\t\t?   {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tamount: ''\r\n\t\t\t} \r\n\t\t:   {\r\n\t\t\t\tdateLocal: this.props.co.dateLocal,\r\n\t\t\t\tamount: this.props.co.amount\r\n\t\t\t}\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewCO}\r\n\t\t\t\tentity={co}\r\n\t\t\t\trequiredFields={['dateLocal', 'amount']}\r\n\t\t\t\tsubmit={submit}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\thead\r\n\t\t\t\t\t\tminor\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\ttopBorder\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Header>\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t</Header>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='  '\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tsecondary\r\n\t\t\t\t\t\tsmall\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button \r\n\t\t\t\t\t\t\tprimary \r\n\t\t\t\t\t\t\tcontent={''}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit} />\r\n\t\t\t\t\t\t<A cancel onClick={cancel}></A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Divider fitted/>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default EnquiryCommercialOffer","import React, { Component, Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Table, Tr, Td, InputTd, EditorTd } from './styled/entity-table'\r\nimport { Header as SHeader, Icon, Label, Form, Comment, \r\n\tMessage, Dropdown } from 'semantic-ui-react'\r\nimport { P, Div, Button, Section } from './styled/styled-semantic'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { enquiryDetails, newEnquiry, createEnquiryEvent, \r\n\tenquiryFragment, allEnquiries, updateEnquiry } from '../graphql/enquiry'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\n\r\nimport WrappedDraftEditor from './common/WrappedDraftEditor'\r\nimport { sanitize } from 'dompurify'\r\nimport { currency } from '../utils/format'\r\n\r\nimport EnquiryEdit from './Enquiry/Edit'\r\nimport EnquiryCommercialOffer from './EnquiryCommercialOffer'\r\n\r\nconst SDropdown = styled(Dropdown)`\r\n\t& .active.item {\r\n\t\tdisplay: none !important;\r\n\t}\r\n\t& .selected.item {\r\n\t\tbackground: none !important;\r\n\t}\r\n`\r\n\r\nconst Comments = styled(Comment.Group)`\r\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\r\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\r\n`\r\n\r\nconst CIcon = styled(Icon)`\r\n\t// apply horizontal offset correction for different icons to be vertically alined\r\n  width: ${props => (props.type === 'CREATE') ? '1.73em' : '1.4em' } !important;\r\n\t${props => (props.type === 'CREATE') && 'margin-left: -0.33em !important;'}\r\n  margin-top: .15em !important;\r\n\tfloat: left;\r\n\topacity: 0.6 !important;\r\n`\r\n\r\nconst UserLabel = styled(Label)`\r\n  width: 2em;\r\n  height: 2em;\r\n  margin-left: 0 !important;\r\n  padding: .4em 0em !important;\r\n  float: left;\r\n\ttext-align: center;\r\n\t${props => props.indent && 'margin-left: 42.69px !important;'}\r\n\t// ${props => props.indent && 'margin-left: calc(1.4em + 0.25rem) !important;'}\r\n`\r\n\r\nconst CContent = styled(Comment.Content)`\r\n  margin-left: 6.5em !important;\r\n`\r\n\r\nconst CMetadata = styled(Comment.Metadata)`\r\n\tmargin-left: 0 !important;\r\n  color: rgba(0,0,0,.6) !important;\r\n`\r\n\r\nconst CText = styled(Comment.Text)`\r\n\t& p { margin: 0 !important; }\r\n\t&>table { \r\n\t\twidth: 100%;\r\n\t\tborder-collapse: collapse; \r\n\t}\r\n\t&>table>tbody>tr>td {\r\n\t\tpadding-left: 4px;\r\n\t\tvertical-align: top;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(1) {\r\n\t\twidth: 5px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(2) {\r\n\t\twidth: 25px;\r\n\t\tmin-width: 90px;\r\n\t}\r\n\t&>table>tbody>tr>td:nth-child(3) {\r\n\t\tpadding-left: 10px;\r\n\t\twidth: 1000px;\r\n\t\tmin-width: 240px;\r\n\t}\r\n\t&>table>tbody>tr>td>span {\r\n\t\tmargin-right: 5px;\r\n\t}\r\n`\r\n\r\nconst CMessage = styled(Message)`\r\n\tmargin-left: 6.35em !important;\r\n`\r\n\t\r\nclass EnquiryDetails extends Component {\r\n\tisNewEnquiry = this.props.id === 'new'\r\n\teditorRef = React.createRef()\r\n\tnoteEditorRef = React.createRef()\r\n\tcomponentIsMounted = true\r\n  state = {\r\n\teditMode: this.isNewEnquiry ? true : false,\r\n\t\teditorHasText: false,\r\n\t\tnoteEditorDiff: false,\r\n\t\tnoteKey: 1,\r\n\t\tactiveCO: '',\r\n\t\tloading: false,\r\n\t\tcreatingComment: false,\r\n\t\tchangingStatus: false,\r\n\t\tstatusPending: false,\r\n\t\tsavingNote: false,\r\n\t\terror: ''\r\n\t}\r\n\t// refetchEnquiry = async () => {\r\n\t// \tthis.setState({ loading: true })\r\n\t// \tconst res = await this.props.enquiryQuery.refetch()\r\n\t// \tthis.setState({ loading: false })\r\n\t// }\r\n\tenableEditMode = () => this.setState({ editMode: true })\r\n\texitEditMode = () => this.setState({ editMode: false })\r\n\tsetEditorHasText = (bool) => this.setState({ editorHasText: bool })\r\n\tsetNoteEditorDiff = (bool) => this.setState({ noteEditorDiff: bool })\r\n\tcancelEdit = () => {\r\n\t\tif (this.isNewEnquiry) return this.props.closeDetails()\r\n\t\tthis.exitEditMode()\r\n  }\r\n  createComment = async () => {\r\n\t\ttry {\r\n\t\t\tconst htmlText = this.editorRef.current.exportHtml()\r\n\t\t\t// if (htmlText === '<p><br></p>') return\r\n\t\t\tif (htmlText === null) return\r\n\t\t\tthis.setState({creatingComment: true})\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\thtmlText\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ creatingComment: false, editorHasText: false, error: '' })\r\n\t\t\tthis.editorRef.current.clear()\r\n\t\t} catch(err) {\r\n\t\t\tthis.setState({ creatingComment: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tchangeStatus = async (e, { value, co }) => {\r\n\t\tconst coStatusId = this.props.enquiryQuery.statuses.find(s => s.name === ' ').id\r\n\t\tif (value === coStatusId) {\r\n\t\t\tif (!this.state.statusPending) return this.setState({ statusPending: true, activeCO: 'new' })\r\n\t\t\telse this.setState({ statusPending: false })\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tthis.setState({ changingStatus: true })\r\n\t\t\tawait this.props.createEnquiryEvent({\r\n\t\t\t\tvariables: {\r\n\t\t\t\t\tenquiryId: this.props.id,\r\n\t\t\t\t\tstatusId: value,\r\n\t\t\t\t\t...(co && { doc: { ...co } })\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.setState({ changingStatus: false, activeCO: '' })\r\n\t\t} catch (err) {\r\n\t\t\tthis.setState({ changingStatus: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcancelPendingStatusChange = () => {\r\n\t\tthis.setState({ statusPending: false, activeCO: '' })\r\n\t}\r\n\tsaveNote = async () => {\r\n\t\ttry {\r\n\t\t\tlet htmlNote = this.noteEditorRef.current.exportHtml()\r\n\t\t\tif (htmlNote === this.props.enquiryQuery.enquiry.htmlNote) {\r\n\t\t\t\treturn this.setState({ noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t\t}\r\n\t\t\tthis.setState({ savingNote: true })\r\n\t\t\tawait this.props.updateEnquiry({ \r\n\t\t\t\tvariables: { input: { id: this.props.id, htmlNote } } })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: '', noteKey: this.state.noteKey + 1, noteEditorDiff: false })\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ savingNote: false, error: err.message })\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n  render() { \r\n\t\tconst { editorHasText, creatingComment, changingStatus, statusPending, \r\n\t\t\t\terror, noteEditorDiff, noteKey, savingNote, activeCO } = this.state\r\n\t\tconst { enquiryQuery } = this.props\r\n\t\tconst isNewEnquiry = this.isNewEnquiry\r\n\t\tif (enquiryQuery.loading) return <Section>...</Section>\r\n\t\tif (enquiryQuery.error) return <Section> {enquiryQuery.error.message}</Section>\r\n\t\tconst enquiry = isNewEnquiry ? enquiryQuery.newEnquiry : enquiryQuery.enquiry\r\n\t\tconst { org, model, qty, htmlNote, events } = enquiry\r\n\t\tconst coEvents = events && events.filter(e => e.doc)\r\n\t\tconst curStatus = events && events.filter(e => e.status).pop().status\r\n\t\t// rawStatuses - received from server\r\n\t\tconst rawStatuses = enquiryQuery.statuses.slice()\r\n\t\tconst coStatusId = rawStatuses.find(s => s.name === ' ').id\r\n\t\tconst orderStatusId = rawStatuses.find(s => s.name === '').id\r\n\t\tconst refusalStatusIds = rawStatuses.filter(s => [' ', ''].includes(s.name)).map(s => s.id)\r\n\t\t// sort statuses so that refusal statuses are at the end of their stage block\r\n\t\tconst statuses = rawStatuses.sort((a, b) => a.stage === b.stage && refusalStatusIds.includes(a.id))\r\n\t\tlet stage = 0\r\n\t\tconst eventStatusPresentationHelpers = events && events.reduce((res, e, i) => {\r\n\t\t\tif (!e.status || i === 0) return res = [...res, null]\r\n\t\t\tif (refusalStatusIds.includes(e.status.id)) return [...res, 'refuse']\r\n\t\t\tif (e.status.id === orderStatusId) return [...res, 'order']\r\n\t\t\tres.push(e.status.stage - stage > 0 ? 'up' : 'down')\r\n\t\t\tstage = e.status.stage\r\n\t\t\treturn res\r\n\t\t}, [])\r\n\t\treturn (\r\n\t\t\t<GlobalContext>\r\n\t\t\t\t{({ details, setDetails }) => {\r\n\t\t\t\t\tconst { id, editMode } = details\r\n\t\t\t\t\tconst isNewEnquiry = id === 'new'\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t{ (editMode || isNewEnquiry) &&\r\n\t\t\t\t\t\t\t\t<EnquiryEdit\r\n\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\tenquiry={enquiry}\r\n\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{ !(editMode || isNewEnquiry) && <Fragment>\r\n\t\t\t\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t\t\t\t<Table><tbody>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{org && org.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{model && model.name}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>-, .</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td>{qty}</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t{ !!coEvents.length &&\r\n\t\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{coEvents.map(({ doc: { id, dateLocal, amount } }) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<P key={id} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfw='normal'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlh='1.21428571em' >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b>{currency(amount)} </b> (  {dateLocal} )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</P>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tr> }\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={noteKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderless\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tref={this.noteEditorRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tinitFromHtml={htmlNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetEditorDiff={this.setNoteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdiff={noteEditorDiff}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonCtrlEnter={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{noteEditorDiff &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmt='.67857143em'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent=' '\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabelPosition='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon='save'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfloated='left'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.saveNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading={savingNote}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t</EditorTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t\t<Tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t\t<InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<SDropdown labeled button className='icon'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={changingStatus}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={changingStatus || statusPending}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={curStatus.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={curStatus.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toptions={statuses\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(s => (s.id === curStatus.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t|| Math.abs(s.stage - curStatus.stage) === 1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&& !(s.stage === 0 && curStatus.stage !== 0))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// && !(s.name === ' '))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map(s => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: s.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: s.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: { \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbasic: true, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: '', \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetail: s.stage, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon:   refusalStatusIds.includes(s.id) ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ts.id === orderStatusId ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`long arrow alternate ${(s.stage - curStatus.stage) > 0 ? 'up' : 'down' }`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={this.changeStatus} \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnBlur={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectOnNavigation={false} >\r\n\t\t\t\t\t\t\t\t\t\t\t\t</SDropdown>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label basic size='large' content='' detail={ curStatus.stage} />\r\n\t\t\t\t\t\t\t\t\t\t\t</InputTd>\r\n\t\t\t\t\t\t\t\t\t\t\t<Td></Td>\r\n\t\t\t\t\t\t\t\t\t\t</Tr>\r\n\t\t\t\t\t\t\t\t\t</tbody></Table>\r\n\t\t\t\t\t\t\t\t</Section>\r\n\t\t\t\t\t\t\t\t{ activeCO && \r\n\t\t\t\t\t\t\t\t\t<EnquiryCommercialOffer \r\n\t\t\t\t\t\t\t\t\t\tid={activeCO} \r\n\t\t\t\t\t\t\t\t\t\tsubmit={(co) => this.changeStatus(null, { value: coStatusId, co })}\r\n\t\t\t\t\t\t\t\t\t\tcancel={this.cancelPendingStatusChange} />}\r\n\t\t\t\t\t\t\t\t<Comments minimal>\r\n\t\t\t\t\t\t\t\t\t<SHeader as='h3' dividing content='  ' />\r\n\t\t\t\t\t\t\t\t\t{ events.map((e, i) => {\r\n\t\t\t\t\t\t\t\t\t\tconst { fName, lName } = e.user.person\r\n\t\t\t\t\t\t\t\t\t\tconst userInitials = (lName ? fName.slice(0,1) : fName.slice(0,2)) + (lName ? lName.slice(0,1) : '')\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<Comment key={e.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{ e.type && (e.type !== 'COMMENT') &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CIcon \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' type={e.type}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor={ e.type === 'CREATE' ? 'green' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'blue' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'up' ? 'yellow' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'down' ? 'brown' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'red' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'green' : 'grey'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname ={ e.type === 'CREATE' ? 'plus' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'UPDATE' ? 'write square' : \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'refuse' ? 'minus circle' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' && eventStatusPresentationHelpers[i] === 'order' ? 'checkmark' :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.type === 'STATUS' ? `long arrow alternate ${eventStatusPresentationHelpers[i]}` : 'question'} /> }\r\n\t\t\t\t\t\t\t\t\t\t\t\t<UserLabel \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize='big' \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={userInitials}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindent={!e.type || e.type === 'COMMENT' ? 1 : 0} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* <Comment.Avatar src='https://react.semantic-ui.com/images/avatar/small/matt.jpg' /> */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/* <Comment.Author \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tas='span' \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={fName + ' ' + lName} /> */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CMetadata\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={e.datetimeLocal.slice(0,16)} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<CText dangerouslySetInnerHTML={{__html: sanitize(e.htmlText)}} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/* <Comment.Actions\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={( <a>Reply</a> )} /> */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</CContent>\r\n\t\t\t\t\t\t\t\t\t\t\t</Comment>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t<Form reply error={!!error}>\r\n\t\t\t\t\t\t\t\t\t\t<Div m='0 0 1em 6.35em'>\r\n\t\t\t\t\t\t\t\t\t\t\t<WrappedDraftEditor\r\n\t\t\t\t\t\t\t\t\t\t\t\tref={this.editorRef} \r\n\t\t\t\t\t\t\t\t\t\t\t\tsetEditorHasText={this.setEditorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSave={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</Div>\r\n\t\t\t\t\t\t\t\t\t\t<CMessage\r\n\t\t\t\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\t\t\t\theader='   ..'\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={error}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<Button content=' ' labelPosition='left' icon='edit' primary floated='right' \r\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.createComment}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={!editorHasText}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={creatingComment}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t\t\t\t</Comments>\r\n\t\t\t\t\t\t\t</Fragment> }\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t)\r\n\t\t\t\t}}\r\n\t\t\t</GlobalContext>\r\n\t\t)\r\n  }\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(updateEnquiry, { name: 'updateEnquiry' }),\r\n\tgraphql(createEnquiryEvent, { \r\n\t\tname: 'createEnquiryEvent',\r\n\t\toptions: (props) => ({\r\n\t\t\tupdate: (cache, {data: reponseData}) => {\r\n\t\t\t\tconst newEvent = reponseData.createEnquiryEvent\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst id = `Enquiry:${props.id}`\r\n\t\t\t\tconst fragment = enquiryFragment\r\n\t\t\t\tlet data = cache.readFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment\r\n\t\t\t\t})\r\n\t\t\t\tdata.events.push(newEvent)\r\n\t\t\t\tcache.writeFragment({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfragment,\r\n\t\t\t\t\tdata\r\n\t\t\t\t})\r\n\t\t\t\t// also update allEnquiries if status changed (for EnquiryTable view update)\r\n\t\t\t\tif (! newEvent.status) return\r\n\t\t\t\tconst query = allEnquiries\r\n\t\t\t\tdata = cache.readQuery({ query })\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === props.id)\r\n\t\t\t\tenquiry.status = newEvent.status\r\n\t\t\t\tif (newEvent.doc) enquiry.docs.push(newEvent.doc)\r\n\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t},\r\n\t\t\t// refetchQueries:[ 'allEnquiries' ]\r\n\t\t})\r\n  }),\r\n\tgraphql(newEnquiry, { name: 'enquiryQuery', skip: (props) => props.id !== 'new' }),\r\n\tgraphql(enquiryDetails, { name: 'enquiryQuery', skip: (props) => props.id === 'new' })\r\n)(EnquiryDetails)","import React, { Component } from 'react'\r\nimport debounce from 'lodash/debounce'\r\nimport { Input } from '../styled/styled-semantic'\r\nimport { isNaN } from '../../utils/format'\r\n\r\n// INFO built-in handling of 'int' number type\r\n// TODO think about integrating other input types (currency, etc..)\r\nclass SmartInput extends Component {\r\n\tstate = {\r\n\t\tvalue: this.props.field.curVal || ''\r\n\t}\r\n\tdebouncedSetField = debounce(value => {\r\n    const { field: { name }, setField } = this.props\r\n    setField(name, { value })\r\n\t}, 250)\r\n\twriteVal = (value) => {\r\n\t\tthis.setState({ value })\r\n\t\tthis.debouncedSetField(value)\r\n\t}\r\n\thandleInputChange = ( e, { value } ) => {\r\n\t\tif (value === '') return this.writeVal('')\r\n\t\tconst { type } = this.props\r\n\t\t// block/parse invalid integer input for 'int' input type\r\n\t\tif (type === 'int') {\r\n\t\t\tconst intVal = parseInt(value, 10)\r\n\t\t\treturn intVal && this.writeVal(intVal)\r\n\t\t}\r\n\t\treturn this.writeVal(value)\r\n\t}\r\n\t// onChanged isn't fired on input with type[\"number\"]\r\n\t// when user mixes numbers with symbols -,. for ex -> '234234,,,,,,,234'\r\n\t// so I check valueAsNumber html input attr onBlur and set error\r\n\tonBlur = () => {\r\n\t\tconst { field: { name }, setField } = this.props\r\n\t\tconst { type, valueAsNumber } = this.input.inputRef\r\n\t\tif (type === 'number' && isNaN(valueAsNumber)) {\r\n\t\t\t// this.input.inputRef.value = ''\r\n\t\t\tsetField(name, { err: {\r\n\t\t\t\ttitle: '   \"\"',\r\n\t\t\t\tmessage: ' '\r\n\t\t\t} })\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { field, setField, type, ...rest } = this.props\r\n\t\tconst { value } = this.state\r\n\t\treturn (\r\n\t\t\t<Input\r\n\t\t\t\t{...rest}\r\n\t\t\t\ttype={type === 'int' ? 'number' : type}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={this.handleInputChange}\r\n\t\t\t\tonBlur={this.onBlur}\r\n\t\t\t\tref={input => this.input = input}\r\n\t\t\t/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default SmartInput\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { Form, Button, Message } from 'semantic-ui-react'\r\nimport { Div, Span, A, Label, Section } from './styled/styled-semantic.js'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { orderLocal, upsertOrder } from '../graphql/order'\r\nimport { allEnquiries } from '../graphql/enquiry'\r\n\r\nimport { toLocalISOString } from '../utils/dates'\r\n\r\nimport LocalDatePicker from './common/LocalDatePicker'\r\nimport CurrencyInput from './common/CurrencyInput'\r\nimport SmartForm from './common/SmartForm'\r\nimport SmartInput from './common/SmartInput'\r\n\r\nclass OrderEdit extends Component {\r\n\tcomponentIsMounted = true\r\n\tisNewEntity = this.props.id === 'new'\r\n\tstate = {\r\n\t\tloading: false,\r\n\t\terr: null\r\n\t}\r\n\tsubmit = (entity) => {\r\n\t\tthis.upsertOrder({\r\n\t\t\t...entity,\r\n\t\t\t...this.isNewEntity && {\r\n\t\t\t\tenquiryId: this.props.enquiryId,\r\n\t\t\t},\r\n\t\t\t...!this.isNewEntity && {\r\n\t\t\t\tid: this.props.id,\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tupsertOrder = async (variables) => {\r\n\t\ttry {\r\n\t\t\tthis.setState({ loading: true })\r\n\t\t\tconst res = await this.props.upsertOrder({ variables })\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({ loading: false, err: null })\r\n\t\t\tthis.props.setDetails({\r\n\t\t\t\ttype: 'Order',\r\n\t\t\t\tid: res.data.upsertOrder.id\r\n\t\t\t})\r\n\t\t\tthis.props.setExpanded({\r\n\t\t\t\tid: res.data.upsertOrder.id,\r\n\t\t\t\tvalue: true\r\n\t\t\t})\r\n\t\t} catch (err) {\r\n\t\t\tif (!this.componentIsMounted) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tloading: false,\r\n\t\t\t\terr: {\r\n\t\t\t\t\ttitle: `${this.isNewEntity ? '' : ''}  ..`,\r\n\t\t\t\t\tmessage: err.message\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tthis.componentIsMounted = false\r\n\t}\r\n\trender() {\r\n\t\tconst { loading } = this.state\r\n\t\tconst { id, closeDetails, setDetails } = this.props\r\n\t\tconst isNewEntity = id === 'new'\r\n\t\tconst order = isNewEntity\r\n\t\t\t? {\r\n\t\t\t\tdateLocal: toLocalISOString(new Date()).slice(0, 10),\r\n\t\t\t\tqty: '',\r\n\t\t\t\tamount: ''\r\n\t\t\t}\r\n\t\t\t: this.props.orderLocal.orderLocal\r\n\t\treturn (\r\n\t\t\t<SmartForm\r\n\t\t\t\tisNewEntity={isNewEntity}\r\n\t\t\t\tentity={order}\r\n\t\t\t\trequiredFields={['dateLocal', 'qty', 'amount']}\r\n\t\t\t\tsubmit={this.submit}\r\n\t\t\t\terr={this.state.err}\r\n\t\t\t>\r\n\t\t\t\t{({\r\n\t\t\t\t\tdisabled,\r\n\t\t\t\t\terr,\r\n\t\t\t\t\tsetField,\r\n\t\t\t\t\tsubmit,\r\n\t\t\t\t\tformState: { dateLocal, qty, amount }\r\n\t\t\t\t}) => <Fragment>\r\n\t\t\t\t\t<Section\r\n\t\t\t\t\t\tbottomBorder\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t\t<Form.Field inline>\r\n\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t<LocalDatePicker\r\n\t\t\t\t\t\t\t\t\tfield={dateLocal}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label>-</Label>\r\n\t\t\t\t\t\t\t\t<SmartInput\r\n\t\t\t\t\t\t\t\t\ttype='number'\r\n\t\t\t\t\t\t\t\t\tplaceholder=' - .'\r\n\t\t\t\t\t\t\t\t\tfield={qty}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Span pl='6px'>.</Span>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t\t<Form.Field inline required>\r\n\t\t\t\t\t\t\t\t<Label></Label>\r\n\t\t\t\t\t\t\t\t<CurrencyInput\r\n\t\t\t\t\t\t\t\t\tfield={amount}\r\n\t\t\t\t\t\t\t\t\tsetField={setField}\r\n\t\t\t\t\t\t\t\t\tplaceholder='  '\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Field>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t\t<Section>\r\n\t\t\t\t\t\t{err &&\r\n\t\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t\terror\r\n\t\t\t\t\t\t\t\theader={err.title}\r\n\t\t\t\t\t\t\t\tcontent={err.message}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<Div inline w='formLabel' />\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tprimary\r\n\t\t\t\t\t\t\tcontent={this.isNewEntity ? '' : ''}\r\n\t\t\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\tonClick={submit}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<A cancel\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\tid === 'new'\r\n\t\t\t\t\t\t\t\t\t? closeDetails\r\n\t\t\t\t\t\t\t\t\t: () => setDetails({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'Order',\r\n\t\t\t\t\t\t\t\t\t\tid\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</A>\r\n\t\t\t\t\t</Section>\r\n\t\t\t\t</Fragment>}\r\n\t\t\t</SmartForm>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(upsertOrder, {\r\n\t\t\tname: 'upsertOrder',\r\n\t\t\toptions: {\r\n\t\t\t\tupdate: (cache, { data: responseData }) => {\r\n\t\t\t\t\tconst upsertedOrder = responseData.upsertOrder\r\n\t\t\t\t\tconst query = allEnquiries\r\n\t\t\t\t\tconst data = cache.readQuery({ query })\r\n\t\t\t\t\tconst enquiry = data.enquiries.find(e => e.id === upsertedOrder.enquiry.id)\r\n\t\t\t\t\tenquiry.orders = [\r\n\t\t\t\t\t\t...enquiry.orders.filter(o => o.id !== upsertedOrder.id),\r\n\t\t\t\t\t\tupsertedOrder\r\n\t\t\t\t\t].sort((a, b) => a.num > b.num)\r\n\t\t\t\t\tcache.writeQuery({ query, data })\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}),\r\n\tgraphql(orderLocal, {\r\n\t\tname: 'orderLocal',\r\n\t\tskip: (props) => props.id === 'new'\r\n\t}),\r\n)(OrderEdit)","import React, { Component } from 'react'\r\n\r\nimport DetailsHeaderContainer from './DetailsHeaderContainer'\r\nimport DetailsHeaderTitle from './DetailsHeaderTitle'\r\nimport DetailsHeaderButtons from './DetailsHeaderButtons'\r\n\r\nclass DetailsHeader extends Component {\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tbuttons,\r\n\t\t\tsize,\r\n\t\t\tnoIndent,\r\n\t\t\tbottomBorder,\r\n\t\t\ttitle,\r\n\t\t\tsubtitle,\r\n\t\t\ttitleSize,\r\n\t\t\tonClick,\r\n\t\t\t// expandable\r\n\t\t\texpanded,\r\n\t\t} = this.props\r\n\t\treturn (\r\n\t\t\t<DetailsHeaderContainer\r\n\t\t\t\texpanded={expanded}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\tsize={size}\r\n\t\t\t\tnoIndent={noIndent}\r\n\t\t\t\tbottomBorder={bottomBorder}\r\n\t\t\t>\r\n\t\t\t\t<DetailsHeaderTitle\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\tsubtitle={subtitle}\r\n\t\t\t\t\tsize={titleSize || size}\r\n\t\t\t\t/>\r\n\t\t\t\t{ buttons &&\r\n\t\t\t\t\t<DetailsHeaderButtons>\r\n\t\t\t\t\t\t{buttons}\r\n\t\t\t\t\t</DetailsHeaderButtons>\r\n\t\t\t\t}\r\n\t\t\t</DetailsHeaderContainer>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default DetailsHeader\r\n","import React, { Component } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Section } from './styled/styled-semantic'\r\n\r\nimport DetailsHeader from './DetailsHeader'\r\n\r\nconst OuterSection = styled(Section)`\r\n  & { \r\n    padding: 0;\r\n    ${props => props.expanded && `{\r\n      margin-top: -1px;\r\n      border-bottom-color: rgba(34, 36, 38, 0.15);\r\n    }`}\r\n  }\r\n`\r\nconst InnerSection = styled(Section)`\r\n  & {\r\n    padding: 0;\r\n    margin-bottom: -1px;\r\n  }\r\n`\r\n\r\nclass CollapsableSection extends Component {\r\n  state = {\r\n    expanded: false\r\n  }\r\n  render() {\r\n    const {\r\n      children,\r\n      forceExpanded,\r\n      ...headerProps\r\n    } = this.props\r\n    const expanded = this.state.expanded || forceExpanded\r\n    return (\r\n      <OuterSection\r\n        expanded={expanded ? 1 : 0}\r\n        topBorder={expanded}\r\n        bottomBorder={expanded}\r\n      >\r\n        <DetailsHeader\r\n          {...headerProps}\r\n          expanded={expanded}\r\n          bottomBorder={expanded && 'dark'}\r\n          disabled={forceExpanded}\r\n          titleSize='small'\r\n          onClick={\r\n            !forceExpanded\r\n            && (() => this.setState({ expanded: !this.state.expanded }))\r\n          }\r\n        />\r\n        {expanded &&\r\n          <InnerSection>\r\n            {children}\r\n          </InnerSection>\r\n        }\r\n      </OuterSection>\r\n    )\r\n  }\r\n}\r\n\r\nexport default CollapsableSection\r\n","import _ from 'lodash'\r\n\r\nconst ProdsByDept = ({\r\n    children,\r\n    prods: oriProds,\r\n    // extra\r\n    selectedIds,\r\n    orderId,\r\n    selectLimit,\r\n    // order\r\n    selectedProds = [],\r\n    orderProdsQty,\r\n    diff, //diff mode\r\n    // epxpand\r\n    expandedIds,\r\n    expanded\r\n}) => {\r\n  const modes = {\r\n    ...orderId && { extra: true },\r\n    ...orderId && selectLimit === selectedIds.length && { limitReached: true },\r\n    ...!orderId && { order: true },\r\n    ...diff && { diff: true },\r\n    ...expandedIds && { expand: true },\r\n    ...expanded && { expanded: true },\r\n  }\r\n  const allProds =\r\n    modes['extra'] ? oriProds :\r\n    modes['order'] ? _.unionBy(oriProds, selectedProds, 'id') : []\r\n  const depts = _(allProds)\r\n    .sortBy('dept.type')\r\n    .groupBy('dept.name')\r\n    .reduce(function(depts, prods) {\r\n      let dept = { ...prods[0].dept }\r\n      dept = {\r\n        ...dept,\r\n        count: prods.length,\r\n        readyCount: prods.filter(p => p.progress === 100).length,\r\n        hasDefect: prods.filter(p => p.hasDefect).length,\r\n        isSpoiled: prods.filter(p => p.isSpoiled).length,\r\n        ...modes['expand'] && {\r\n          expanded: expandedIds.some(id => id === dept.id)\r\n        },\r\n        ...modes['expanded'] && {\r\n          expanded: true\r\n        },\r\n        prods: prods.map(p => {\r\n          let prod = {\r\n            ...p,\r\n            ...modes['extra'] && {\r\n              selected: selectedIds.includes(p.id),\r\n              ordered: !!p.order && p.order.id !== orderId\r\n            },\r\n            ...modes['order'] && modes['diff'] && {\r\n              added: !oriProds.some(op => op.id === p.id),\r\n              removed: !selectedProds.some(sp => sp.id === p.id),\r\n            },\r\n          }\r\n          if (modes['extra']) {\r\n            prod = {\r\n              ...prod,\r\n              disabled:\r\n                prod.ordered\r\n                || (modes['limitReached'] && !prod.selected)\r\n            }\r\n          }\r\n          return prod\r\n        }),\r\n      }\r\n      if (modes['extra']) {\r\n        const orderedCount = dept.prods.filter(p => p.ordered).length || 0\r\n        dept = {\r\n          ...dept,\r\n          selectedCount: dept.prods.filter(p => p.selected).length || 0,\r\n          orderedCount,\r\n          availCount: dept.count - orderedCount\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          selected:\r\n            dept.selectedCount === dept.availCount ? true :\r\n            dept.selectedCount === 0 ? false :\r\n            'partly'\r\n        }\r\n        dept = {\r\n          ...dept,\r\n          disabled:\r\n            dept.prods.every(p => p.disabled)\r\n            || (modes['limitReached'] && [false].includes(dept.selected))\r\n        }\r\n      }\r\n      depts.push(dept)\r\n      return depts\r\n    }, [])\r\n  if (modes['order']) {\r\n    const unreservedProdsCount = diff\r\n      ? orderProdsQty - selectedProds.length\r\n      : orderProdsQty - oriProds.length\r\n    if (unreservedProdsCount) {\r\n      depts.unshift({\r\n        id: 'unreserved',\r\n        name: ' ',\r\n        count: unreservedProdsCount,\r\n        prods: []\r\n      })\r\n    }\r\n  }\r\n  const xor = !!_.xorBy(oriProds, selectedProds, 'id').length\r\n  // console.log('depts > ', depts)\r\n  return children({ depts, xor })\r\n}\r\n\r\nexport default ProdsByDept\r\n","import React, { Fragment } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\n\r\nimport Table from './common/Table'\r\nimport TableRow from './common/TableRow'\r\n\r\nconst defaultFields = [{\r\n\tname: 'name',\r\n\tpath: 'name',\r\n\ttitle: ' /  ',\r\n\twidth: '170px'\r\n},{\r\n\tname: 'progress',\r\n\tpath: 'progress',\r\n\ttitle: '.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'hasDefect',\r\n\tpath: 'hasDefect',\r\n\ttitle: '.',\r\n\twidth: '65px'\r\n},{\r\n\tname: 'isSpoiled',\r\n\tpath: 'isSpoiled',\r\n\ttitle: '',\r\n\twidth: '55px'\r\n},{\r\n\tname: 'reserve',\r\n\ttitle: '',\r\n\twidth: '75px'\r\n}]\r\n\r\nconst DeptProdTable = ({\r\n\t// data\r\n\tdepts,\r\n\tskipFields = [],\r\n\t// methods\r\n\tselect,\r\n\texpand,\r\n\t// visual\r\n\tindent,\r\n\tnameFieldWidth\r\n}) => {\r\n\tconst fields = cloneDeep(defaultFields)\r\n\tif (nameFieldWidth) fields.find(f => f.name === 'name').width = nameFieldWidth\r\n\treturn (\r\n\t\t<Table\r\n\t\t\tfields={fields.filter(f => !skipFields.includes(f.name))}\r\n\t\t\tindent={indent}\r\n\t\t\tselect={select}\r\n\t\t\texpand={expand}\r\n\t\t>\r\n\t\t\t{({ tableFields }) => <Fragment>\r\n\t\t\t\t{depts.map(dept => {\r\n\t\t\t\t\t\tconst { id, expanded } = dept\r\n\t\t\t\t\t\tif (id === 'unreserved') return (\r\n\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t// bold\r\n\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<Fragment\r\n\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\tentity={dept}\r\n\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\texpandFor='prods'\r\n\t\t\t\t\t\t\t\t\texpanded={expanded}\r\n\t\t\t\t\t\t\t\t\texpand={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tonClick={() => expand(id)}\r\n\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: dept.name + ' ('+ dept.count + ')'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'readyCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'checkmark',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'green'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\tpath: 'orderedCount',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'gavel',\r\n\t\t\t\t\t\t\t\t\t\t\ticonColor: 'brown'\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{\texpanded && dept.prods.map((prod, i) => {\r\n\t\t\t\t\t\t\t\t\tconst { id, progress, order, added, removed } = prod\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t// @ts-ignore\r\n\t\t\t\t\t\t\t\t\t\t<TableRow\r\n\t\t\t\t\t\t\t\t\t\t\tsecondary={1}\r\n\t\t\t\t\t\t\t\t\t\t\tlastSecondaryRow={i === dept.prods.length - 1 ? 1 : 0}\r\n\t\t\t\t\t\t\t\t\t\t\tkey={id}\r\n\t\t\t\t\t\t\t\t\t\t\tentity={prod}\r\n\t\t\t\t\t\t\t\t\t\t\ttableFields={tableFields}\r\n\t\t\t\t\t\t\t\t\t\t\tselect={() => select(id)}\r\n\t\t\t\t\t\t\t\t\t\t\trowFields={[\r\n\t\t\t\t\t\t\t\t\t\t\t\t...(added || removed) ? [{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'service',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: added ? 'plus' : 'minus',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: added ? 'green' : 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}] : [],\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'name',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'fullnumber'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'progress',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: progress && progress + '%'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'hasDefect',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'warning sign',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'orange'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: 'isSpoiled',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: 'broken chain',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticonColor: 'red'\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'reserve',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: order && order.enquiry.num + '-' + order.num,\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t\t\t\t// active={}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={select && (() => select(id))}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t</Fragment>}\r\n\t\t</Table>\r\n\t\t// {/* {name} <ProdQtyLabel color='grey' basic content={`${prods.length}`} /> */}\r\n\t)\r\n}\r\n\r\nexport default DeptProdTable","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Button } from './styled/styled-semantic'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\n\r\nconst IconRight = styled(Icon)`\r\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\r\n`\r\n\r\nconst ReserveProdsButton = ({ modelId, orderId, prodIds }) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, setSelectedProdIds }) => (\r\n        <Button compact circular menu\r\n          activeColor='green'\r\n          active={!!extra}\r\n          onClick={(e) => {\r\n            e.stopPropagation()\r\n            setSelectedProdIds(prodIds)\r\n            setExtra({\r\n              type: 'Store',\r\n              modelId,\r\n              orderId\r\n            })\r\n          }}\r\n        >\r\n          <Icon name='gavel' />\r\n          \r\n          <IconRight name='angle right' />\r\n        </Button>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ReserveProdsButton","import gql from 'graphql-tag'\r\n\r\nexport const modelProds = gql`\r\n\tquery ModelProds ($modelId: ID!) {\r\n\t\tmodelProds (modelId: $modelId) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t\torder {\r\n\t\t\t\tid\r\n\t\t\t\tnum\r\n\t\t\t\tenquiry {\r\n\t\t\t\t\tid\r\n\t\t\t\t\tnum\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\nexport const prodsLocal = gql`\r\n\tquery ProdsLocal ($ids: [ID!]!) {\r\n\t\tprodsLocal (ids: $ids) {\r\n\t\t\tid\r\n\t\t\tfullnumber,\r\n      hasDefect,\r\n      isSpoiled,\r\n      progress,\r\n\t\t\tdept {\r\n\t\t\t\tid\r\n\t\t\t\tname\r\n\t\t\t\ttype\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n`\r\n","import { compose, graphql } from 'react-apollo'\r\nimport { prodsLocal } from '../../graphql/prod'\r\n\r\nconst ProdContext = ({\r\n\tchildren,\r\n\tprodsLocal: { prodsLocal }\r\n}) => {\r\n  return children({\r\n\t\tprodsLocal: prodsLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(prodsLocal, { name: 'prodsLocal' }),\r\n)(ProdContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { reserveProds } from '../graphql/order'\r\n\r\nimport { Section, Button, Message } from './styled/styled-semantic'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\nimport CollapsableSection from './CollapsableSection'\r\nimport ProdsByDept from './ProdsByDept';\r\nimport DeptProdTable from './DeptProdTable';\r\nimport ReserveProdsButton from './ReserveProdsButton'\r\n// import ListProvider from './special/ListProvider'\r\nimport ProdContext from './special/ProdContext'\r\n\r\nconst ModelProdsSection = ({\r\n  order: { id, model, qty, prods }\r\n}) => {\r\n  console.log('id, model, qty, prods > ', id, model, qty, prods)\r\n  return (\r\n    <GlobalContext>\r\n      {({ extra, setExtra, selectedProdIds }) => (\r\n        <CollapsableSection\r\n          forceExpanded={!!extra}\r\n          title={model.name}\r\n          subtitle={qty + ''}\r\n          buttons={\r\n            <ReserveProdsButton\r\n              modelId={model.id}\r\n              orderId={id}\r\n              prodIds={prods.map(p => p.id)}\r\n            />\r\n          }\r\n        >\r\n            <ProdContext\r\n              ids={selectedProdIds}\r\n            >\r\n              {({ prodsLocal: selectedProds }) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedProds={selectedProds}\r\n                  orderProdsQty={qty}\r\n                  expanded\r\n                  diff={!!extra}\r\n                >\r\n                  {({ depts, xor }) =>\r\n                    <Fragment>\r\n                      <DeptProdTable\r\n                        depts={depts}\r\n                        skipFields={['reserve']}\r\n                        expand={() => null}\r\n                        indent='32px'\r\n                        nameFieldWidth='200px'\r\n                      />\r\n                      {extra && \r\n                      <Mutation\r\n                        mutation={reserveProds}\r\n                        variables={{\r\n                          orderId: id,\r\n                          prodIds: selectedProdIds\r\n                        }}\r\n                      >\r\n                        {( reserveProds, { loading, error }) => \r\n                          <Fragment>\r\n                            <Section\r\n                              minor\r\n                              head\r\n                              topBorder='dark'\r\n                            >\r\n                              <Button\r\n                                primary\r\n                                compact\r\n                                circular\r\n                                menu\r\n                                ml='0'\r\n                                content=''\r\n                                icon='gavel'\r\n                                loading={loading}\r\n                                disabled={!xor}\r\n                                onClick={() => {\r\n                                  reserveProds()\r\n                                  setExtra(null)\r\n                                }}\r\n                              />\r\n                            </Section>\r\n                            {error &&\r\n                              <Message\r\n                                section\r\n                                error\r\n                                header='  ..'\r\n                                content={error.message}\r\n                              />\r\n                            }\r\n                          </Fragment>\r\n                        }\r\n                      </Mutation>\r\n                      }\r\n                    </Fragment>\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ProdContext>\r\n          {/* {!extra && \r\n            <ListProvider>\r\n              {({ list: selectedIds, setList: setSelectedProdIds}) =>\r\n                <ProdsByDept\r\n                  prods={prods}\r\n                  selectedIds={selectedIds}\r\n                  orderProdsQty={qty}\r\n                >\r\n                  {({ depts }) =>\r\n                    <DeptProdTable\r\n                      depts={depts}\r\n                      setSelectedProdIds={setSelectedProdIds}\r\n                      skipFields={['reserve']}\r\n                    />\r\n                  }\r\n                </ProdsByDept>\r\n              }\r\n            </ListProvider>\r\n          } */}\r\n        </CollapsableSection>\r\n      )}\r\n    </GlobalContext>\r\n  )\r\n}\r\n\r\nexport default ModelProdsSection\r\n","import React from 'react'\r\n\r\nimport ModelProdsSection from './ModelProdsSection'\r\n\r\nconst OrderDetails = ({ order }) => {\r\n  return (\r\n    <ModelProdsSection\r\n      order={order}\r\n    />\r\n  )\r\n}\r\n\r\nexport default OrderDetails","import { compose, graphql } from 'react-apollo'\r\n\r\nimport { enquiryDetails, enquiryLocal } from '../graphql/enquiry'\r\nimport { orderDetails, orderLocal } from '../graphql/order'\r\n\r\nconst DetailsDataProvider = ({\r\n  children,\r\n  type,\r\n  id,\r\n  query1,\r\n  query2,\r\n  localQuery1,\r\n  localQuery2,\r\n}) => {\r\n  const query = query1 || query2\r\n  const { loading, error, refetch } = query\r\n  const entity =\r\n    type === 'Enquiry' ? query.enquiry :\r\n    type === 'Order' ? query.order\r\n    : null\r\n  const localQuery = localQuery1 || localQuery2\r\n  const localEntity =\r\n    id === 'new' ? null :\r\n    type === 'Enquiry' ? localQuery.enquiryLocal :\r\n    type === 'Order' ? localQuery.orderLocal\r\n    : null\r\n  return children({\r\n    loading,\r\n    error,\r\n    refetch,\r\n    entity,\r\n    localEntity\r\n  })\r\n}\r\n\r\nexport default compose(\r\n  graphql(enquiryDetails, {\r\n    name: 'query1',\r\n    skip: ({ type }) => type !== 'Enquiry'\r\n  }),\r\n  graphql(orderDetails, {\r\n    name: 'query2',\r\n    skip: ({ type }) => type !== 'Order'\r\n  }),\r\n  graphql(enquiryLocal, {\r\n    name: 'localQuery1',\r\n    skip: ({ type, id }) => type !== 'Enquiry' || id === 'new',\r\n  }),\r\n  graphql(orderLocal, {\r\n    name: 'localQuery2',\r\n    skip: ({ type, id }) => type !== 'Order' || id === 'new',\r\n  }),\r\n)(DetailsDataProvider)","import React from 'react'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\nimport DetailsMainHeader from './DetailsMainHeader'\r\nimport EnquiryDetails from './EnquiryDetails'\r\nimport OrderEdit from './OrderEdit'\r\nimport OrderDetails from './OrderDetails'\r\nimport DetailsDataProvider from './DetailsDataProvider';\r\n\r\nconst Container = styled.div`\r\n\t/* flex-grow: 1; */\r\n\twidth: 60%;\r\n`\r\n\r\nconst Details = ({ closeDetails }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ details: { type, id, enquiryId, editMode}, setDetails, setExpanded }) => (\r\n\t\t\t\t<DetailsDataProvider\r\n\t\t\t\t\ttype={type}\r\n\t\t\t\t\tid={id}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ loading, error, refetch, entity, localEntity }) =>\r\n\t\t\t\t\t\t<Container>\r\n\t\t\t\t\t\t\t<DetailsMainHeader\r\n\t\t\t\t\t\t\t\ttype={type}\r\n\t\t\t\t\t\t\t\tlocalEntity={localEntity}\r\n\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\teditMode={editMode}\r\n\t\t\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\t\t\trefresh={() => refetch()}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{type === 'Enquiry'\r\n\t\t\t\t\t\t\t\t? <EnquiryDetails\r\n\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t:\tnull\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{type === 'Order' &&\r\n\t\t\t\t\t\t\t\t(id === 'new' || editMode\r\n\t\t\t\t\t\t\t\t\t? <OrderEdit\r\n\t\t\t\t\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\t\t\t\t\tenquiryId={enquiryId}\r\n\t\t\t\t\t\t\t\t\t\t\tcloseDetails={closeDetails}\r\n\t\t\t\t\t\t\t\t\t\t\tsetDetails={setDetails}\r\n\t\t\t\t\t\t\t\t\t\t\tsetExpanded={setExpanded}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t: (entity && \r\n\t\t\t\t\t\t\t\t\t\t\t<OrderDetails\r\n\t\t\t\t\t\t\t\t\t\t\t\torder={entity}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</Container>\r\n\t\t\t\t\t}\r\n\t\t\t\t</DetailsDataProvider>\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default Details\r\n","import { Component } from 'react'\r\n\r\nimport cloneDeep from 'lodash/cloneDeep'\r\nimport without from 'lodash/without'\r\nimport take from 'lodash/take'\r\nimport union from 'lodash/union'\r\nimport difference from 'lodash/difference'\r\nimport find from 'lodash/fp/find'\r\n\r\nclass ProdTableUtils extends Component {\r\n\tselect = (id) => {\r\n\t\tconst {\r\n\t\t\tdepts: propDepts,\r\n\t\t\tsetList,\r\n\t\t\tselectLimit\r\n\t\t} = this.props\r\n\t\tconst depts = cloneDeep(propDepts)\r\n\t\tconst selectedProdIds =\r\n\t\t\tdepts.reduce((list, d) =>\r\n\t\t\t\t[\r\n\t\t\t\t\t...list,\r\n\t\t\t\t\t...d.prods.filter(p => p.selected).map(p => p.id)\r\n\t\t\t\t]\r\n\t\t\t, [])\r\n\t\tconst dept =\r\n\t\t\tfind({ id }, depts)\r\n\t\t\t|| find({ prods: [ { id } ]}, depts)\r\n\t\tconst { prods } = dept\r\n\t\tconst entity =\r\n\t\t\tdept.id === id\r\n\t\t\t\t? dept\r\n\t\t\t\t: find({ id }, prods)\r\n\t\tif (entity.disabled) return null\r\n\t\tlet newList = []\r\n\t\tif (entity.__typename === 'Prod') {\r\n\t\t\tnewList =\r\n\t\t\t\tselectedProdIds.includes(id)\r\n\t\t\t\t\t? without(selectedProdIds, id)\r\n\t\t\t\t\t: [...selectedProdIds, id]\r\n\t\t}\r\n\t\tif (entity.__typename === 'Dept') {\r\n\t\t\tif ([ 'partly', true ].includes(entity.selected))\r\n\t\t\t\tnewList = difference(selectedProdIds, prods.map(p => p.id))\r\n\t\t\tif (entity.selected === false) {\r\n\t\t\t\tconst idsWithinLimit = take(\r\n\t\t\t\t\tprods.filter(p => !p.disabled).map(p => p.id),\r\n\t\t\t\t\tselectLimit - selectedProdIds.length\r\n\t\t\t\t)\r\n\t\t\t\tnewList = union(selectedProdIds, idsWithinLimit)\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetList(newList)\r\n\t}\r\n\trender () {\r\n\t\tconst { children } = this.props\r\n\t\treturn children({\r\n\t\t\tselect: this.select\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport default ProdTableUtils","import { Component } from 'react'\r\n\r\nexport default class ListProvider extends Component {\r\n\tstate = {\r\n\t\tlist: []\r\n\t}\r\n\tsetList = (list) => this.setState({ list })\r\n\ttoggle = (item) => {\r\n\t\tconst { list } = this.state\r\n\t\tconst newList = \r\n\t\t\tlist.includes(item)\r\n\t\t\t? [ ...list.filter(i => i !== item) ]\r\n\t\t\t: [ ...list, item ]\r\n\t\tthis.setState({ list: newList })\r\n\t}\r\n\trender() {\r\n\t\treturn this.props.children({\r\n\t\t\tlist: this.state.list,\r\n\t\t\tsetList: this.setList,\r\n\t\t\ttoggle: this.toggle,\r\n\t\t})\r\n\t}\r\n}\r\n","import { compose, graphql } from 'react-apollo'\r\nimport { orderLocal } from '../../graphql/order'\r\n\r\nconst OrderContext = ({\r\n\tchildren,\r\n\torderLocal: { orderLocal }\r\n}) => {\r\n  return children({\r\n\t\torderLocal: orderLocal || [],\r\n\t})\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(orderLocal, { name: 'orderLocal' }),\r\n)(OrderContext)\r\n","import React, { Fragment } from 'react'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Section } from '../components/styled/styled-semantic'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { modelLocal } from '../graphql/model'\r\nimport { modelProds } from '../graphql/prod'\r\n\r\nimport GlobalContext from './special/GlobalContext'\r\nimport DetailsHeader from './DetailsHeader'\r\nimport ProdsByDept from './ProdsByDept'\r\nimport ProdTableUtils from './ProdTableUtils'\r\nimport DeptProdTable from './DeptProdTable'\r\nimport ListProvider from './special/ListProvider';\r\nimport OrderContext from './special/OrderContext';\r\n\r\nconst Container = styled.div`\r\n\twidth: 40%;\r\n\tmin-height: calc(100vh - 36px);\r\n\theight: fit-content;\r\n\t/* border-left: 1px solid rgb(126, 126, 129); */\r\n\tborder-left: 1px solid rgb(156, 156, 159);\r\n`\r\n\r\nconst DetailsExtra = ({ closeExtra }) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ extra, selectedProdIds, setSelectedProdIds }) => (\r\n\t\t\t\t<Container>\r\n\t\t\t\t\t{!!extra && \r\n\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelLocal}\r\n\t\t\t\t\t\t\t\tvariables={{ id: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ data: { modelLocal } }) =>\r\n\t\t\t\t\t\t\t\t\t<DetailsHeader\r\n\t\t\t\t\t\t\t\t\t\ttitle={modelLocal.name + '  '}\r\n\t\t\t\t\t\t\t\t\t\tsize='small'\r\n\t\t\t\t\t\t\t\t\t\tnoIndent\r\n\t\t\t\t\t\t\t\t\t\tbottomBorder='dark'\r\n\t\t\t\t\t\t\t\t\t\tbuttons={\r\n\t\t\t\t\t\t\t\t\t\t\t<Icon link\r\n\t\t\t\t\t\t\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={closeExtra}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t\t<Query\r\n\t\t\t\t\t\t\t\tquery={modelProds}\r\n\t\t\t\t\t\t\t\tvariables={{ modelId: extra.modelId }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{({ loading, error, data }) => {\r\n\t\t\t\t\t\t\t\t\tif (loading) return <Section noIndent >...</Section>\r\n\t\t\t\t\t\t\t\t\tif (error) return <Section noIndent > {error.message}</Section>\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<OrderContext\r\n\t\t\t\t\t\t\t\t\t\t\tid={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{({ orderLocal }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{({ list: expandedIds, toggle: toggleExpanded }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdsByDept\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprods={data.modelProds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedIds={selectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\torderId={extra.orderId}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpandedIds={expandedIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ depts }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ProdTableUtils\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetList={setSelectedProdIds}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectLimit={orderLocal.qty}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{({ select }) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<DeptProdTable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdepts={depts}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselect={select}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\texpand={toggleExpanded}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdTableUtils>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</ProdsByDept>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</ListProvider>\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t</OrderContext>\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t</Query>\r\n\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Container>\r\n\t\t\t\t\t\t\r\n\t\t\t)}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n\r\nexport default DetailsExtra\r\n","import React, { Component, Fragment } from 'react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { getLayout, getLayoutOptions, setLayout } from '../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar } from 'semantic-ui-react'\r\n\r\nimport Details from './Details';\r\nimport DetailsExtra from './DetailsExtra';\r\n\r\nconst SSidebar = styled(Sidebar)`\r\n\t&&&& {\r\n\t\tdisplay: flex;\r\n\t\twidth: 120%;\r\n\t\tbackground-color: white;\r\n\t\ttransition: all .5s ease;\r\n\t\tmax-width: ${props => \r\n\t\t\tprops.type === 'Enquiry'\r\n\t\t\t? '1000px'\r\n\t\t\t: '1200px'\r\n\t\t};\r\n\t\t${props => !props.extra && `\r\n\t\t\t&.ui.visible.right.overlay.sidebar {\r\n\t\t\t\ttransform: translate3d(40%,0,0);\r\n\t\t\t}\r\n\t\t`}\r\n\t\t${props => props.extra && `\r\n\t\t\twidth: 86%;\r\n\t\t`}\r\n\t}\r\n`\r\n\r\nclass DetailsSidebar extends Component {\r\n\tstate = { detailsClosing: false }\r\n\tcloseDetails = () => {\r\n\t\tthis.setState({ detailsClosing: true })\r\n\t\t// set timeout for sidebar to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { details: null, extra: null }})\r\n\t\t\tthis.setState({ detailsClosing: false })\r\n\t\t}, 300)\r\n\t}\r\n\tcloseExtra = () => {\r\n\t\tthis.props.setLayout({variables: { extra: null }})\r\n\t}\r\n\trender() {\r\n\t\tconst { detailsClosing } = this.state\r\n\t\tconst { layout: { details, extra } } = this.props\r\n\t\treturn (\r\n\t\t\t<SSidebar\r\n\t\t\t\tvisible={!!details && !detailsClosing}\r\n\t\t\t\textra={!!extra ? 1: 0}\r\n\t\t\t\ttype={details && details.type}\r\n\t\t\t\tanimation='overlay'\r\n\t\t\t\tdirection='right'\r\n\t\t\t>\r\n\t\t\t\t{details &&\r\n\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t<Details\r\n\t\t\t\t\t\t\tkey={details.type + details.id}\r\n\t\t\t\t\t\t\tcloseDetails={this.closeDetails}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<DetailsExtra\r\n\t\t\t\t\t\t\textra={extra}\r\n\t\t\t\t\t\t\tcloseExtra={this.closeExtra}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Fragment>\r\n\t\t\t\t}\r\n\t\t\t</SSidebar>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(getLayout, getLayoutOptions),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(DetailsSidebar)","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  height: calc(100vh - 36px) !important;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n`\r\n\r\nconst Main = styled.div`\r\n  flex: 1 0 50px;\r\n  min-height: 50px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n`\r\n\r\nconst Panel = styled.div`\r\n  flex: 0 0 0;\r\n  min-height: 387px;\r\n  background: #fff;\r\n  z-index: 10;\r\n  /* box-shadow: 0 0 20px rgba(34,36,38,.15); shadow of semantic-ui Sidebar*/\r\n  box-shadow: 0 0 20px 5px #fff;\r\n  transition: min-height .4s ease-out;\r\n  ${props => !props.panelVisible && `\r\n    min-height: 0;\r\n  `}\r\n`\r\n\r\nexport default class PanelPusher extends Component {\r\n  render() {\r\n    const {\r\n      children,\r\n      panel,\r\n      panelVisible,\r\n      panelRendered\r\n    } = this.props\r\n    return (\r\n      <Container>\r\n        <Main\r\n          panelVisible={panelVisible}\r\n        >\r\n          {children}\r\n        </Main>\r\n        <Panel\r\n          panelVisible={panelVisible}\r\n        >\r\n          { panelRendered &&\r\n            panel\r\n          }\r\n        </Panel>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n","import gql from 'graphql-tag'\r\n\r\nexport const telFragment = gql`\r\n\tfragment TelFragment on Tel {\r\n\t\tid\r\n\t\tnumber\r\n\t\ttype\r\n\t\tcountry\r\n\t\tnote\r\n\t\tdefault\r\n\t}\r\n`","import gql from 'graphql-tag'\r\nimport { telFragment } from './tel'\r\n\r\nexport const personContactsFragment = gql`\r\n\tfragment PersonContactsFragment on Person {\r\n\t\tid\r\n\t\tfName\r\n\t\tlName\r\n\t\tmName\r\n\t\thtmlNote\r\n\t\ttels { ...TelFragment }\r\n\t\tuser {\r\n\t\t\temail\r\n\t\t\tconfirmed\r\n\t\t}\r\n\t}\r\n\t${telFragment}\r\n`","import gql from 'graphql-tag'\r\nimport { personContactsFragment } from './person'\r\n\r\nexport const orgEmployees = gql`\r\n\tquery OrgEmployees ($orgId: ID!) {\r\n\t\torgEmployees (orgId: $orgId) {\r\n\t\t\tid\r\n\t\t\tposition\r\n\t\t\tperson { ...PersonContactsFragment }\r\n\t\t}\r\n\t}\r\n\t${personContactsFragment}\r\n`\r\n\r\nexport const upsertEmployee = gql`\r\n\tmutation upsertEmployee(\r\n\t\t$input: EmployeeInput!\r\n\t) {\r\n\t\tupsertEmployee(\r\n\t\t\tinput: $input\r\n\t\t) {\r\n\t\t\tid\r\n\t\t}\r\n\t}\r\n`","import React from 'react'\r\nimport produce from 'immer'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { orgLocal } from '../../graphql/org'\r\n\r\nimport styled from 'styled-components'\r\nimport { Icon } from 'semantic-ui-react'\r\nimport { Header, Button } from '../styled/styled-semantic'\r\n\r\nimport GlobalContext from '../special/GlobalContext'\r\n\r\nconst MenuDiv = styled.div`\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tborder-bottom: 1px solid #7e7e81;\r\n\t/* border-top: 1px solid rgb(180, 181, 182); color of Chrome address section bottom border */\r\n\tborder-top: 1px solid rgb(160, 161, 162);\r\n`\r\n\r\nconst ClosePanelIcon =  styled(Icon)`\r\n\t&&& {\r\n\t\tmargin-left: auto;\r\n\t\tmargin-right: 8px;\r\n\t}\r\n`\r\n\r\nexport default ({\r\n\tclosePanel\r\n}) => {\r\n\treturn (\r\n\t\t<GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<MenuDiv>\r\n\t\t\t\t\t<Query\r\n\t\t\t\t\t\tquery={orgLocal}\r\n\t\t\t\t\t\tvariables={{id: bottomPanel.orgId}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{({ data }) => {\r\n\t\t\t\t\t\t\tif (data && data.orgLocal) return (\r\n\t\t\t\t\t\t\t\t<Header inline\r\n\t\t\t\t\t\t\t\t\tsize='medium'\r\n\t\t\t\t\t\t\t\t\tcontent={` \\u00A0 ${data.orgLocal.name}`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn null\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query>\r\n\t\t\t\t\t<Button compact circular menu\r\n\t\t\t\t\t\tactiveColor='green'\r\n\t\t\t\t\t\ticon='plus'\r\n\t\t\t\t\t\t// content=''\r\n\t\t\t\t\t\tactive={ !bottomPanel.id }\r\n\t\t\t\t\t\tonClick={() => setBottomPanel(\r\n\t\t\t\t\t\t\tproduce(bottomPanel, draft => { delete draft.id })\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<ClosePanelIcon \r\n\t\t\t\t\t\tlink\r\n\t\t\t\t\t\tname='cancel'\r\n\t\t\t\t\t\tsize='large'\r\n\t\t\t\t\t\tonClick={closePanel}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</MenuDiv>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n\t)\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nexport default ({\r\n  tel\r\n}) => {\r\n  return (\r\n    <div>\r\n      {formatTel(tel)}\r\n    </div>\r\n  )\r\n}\r\n","import React, { Fragment } from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport Tel from './Tel'\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  margin-bottom: .67857143rem;\r\n`\r\n\r\nconst Label = styled.div`\r\n  flex: 0 0 122px;\r\n  color: rgba(0,0,0,.87);\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n  vertical-align: top;\r\n`\r\n\r\nconst Content = styled.div`\r\n  flex: 1 1 auto;\r\n  min-width: 210px;\r\n  font-size: calc(15rem/14);\r\n  font-weight: bold;\r\n  line-height: 1.21428571rem;\r\n  padding-top: .67857143rem;\r\n`\r\n\r\nexport default ({\r\n  type,\r\n  label,\r\n  content\r\n}) => {\r\n  const component = data =>\r\n    type === 'string' ? data :\r\n    type === 'tel' ? <Tel tel={data} />\r\n    : null\r\n  return (\r\n    <Container>\r\n      <Label>\r\n        {label}\r\n      </Label>\r\n      <Content>\r\n        {Array.isArray(content)\r\n          ? content.map((item, i) => \r\n              <Fragment key={i}>\r\n                {component(item)}\r\n              </Fragment>\r\n            )\r\n          : component(content)\r\n        }\r\n      </Content>\r\n    </Container>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport Field from './Field'\r\n\r\nconst renderObj = (obj, objSchema, key) => {\r\n  // obj may be any value\r\n  // objSchema should be either Object or Array with only one schema object element\r\n  const isArray = Array.isArray(objSchema)\r\n  const schema = isArray ? objSchema[0] : objSchema\r\n  const schemaKeys = Object.keys(schema)\r\n  // if objSchema contains 'label' than that's a field\r\n  const isField = schemaKeys.includes('label')\r\n  if (isField) {\r\n    // default type is 'string\r\n    const type = schema.type || 'string'\r\n    return (\r\n      <Field\r\n        key={key}\r\n        type={type}\r\n        label={schema.label}\r\n        content={obj}\r\n      />\r\n    )\r\n  }\r\n  else {\r\n    // when traversing, take only obj keys that are non-empty arrays/values\r\n    return schemaKeys\r\n      .filter(k => Array.isArray(obj[k]) ? obj[k].length : !!obj[k])\r\n      .map((k, i)=> renderObj(obj[k], objSchema[k], i))\r\n  }\r\n}\r\n\r\nexport default ({\r\n  entity,\r\n  schema\r\n}) => renderObj(entity, schema, '0')\r\n","import { lazy, object, string } from 'yup'\r\n\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tcountry: string()\r\n\t\t.oneOf(['rus', 'notRus'])\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.default('rus')\r\n\t\t),\r\n\tnumber: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string()\r\n\t\t\t.transform(val => val.match(/.*\\d.*/) //if value contains digits\r\n\t\t\t\t? val.match(/\\d+/g).join('') // extract and join digits\r\n\t\t\t\t: val // else pass value through\r\n\t\t\t)\r\n\t\t\t.when('country', {\r\n\t\t\t\tis: 'rus',\r\n\t\t\t\tthen: string().matches(/\\d{10}/, '     10 '), \t\t\t\t\t\t\t\t\t// check number of digits for russia (10)\r\n\t\t\t\totherwise: string().matches(/\\d{7,25}/, '      7  25 ')\t// from 7 to 25 for notRus numbers\r\n\t\t\t})\r\n\t)\r\n})","import { lazy, array, object, string } from 'yup'\r\n\r\nimport { validationSchema as telValidationSchema } from './tel'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n\tid: idValidationType.notRequired(),\r\n\tlName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\tfName: string().trim().min(2).max(255)\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required('   ')\r\n\t\t)\r\n  ,\r\n\tmName: lazy(val => !val\r\n\t\t? string()\r\n\t\t: string().trim().min(2).max(255)\r\n\t),\r\n\ttels: array().of(telValidationSchema)\r\n})","import { object } from 'yup'\r\n\r\nimport { validationSchema as personValidationSchema } from './person'\r\nimport { idValidationType } from './commonTypes'\r\n\r\nexport const validationSchema = object().shape({\r\n  id: idValidationType.notRequired(),\r\n  orgId: idValidationType\r\n\t\t.when('id', (id, schema) => id\r\n\t\t\t? schema.notRequired()\r\n\t\t\t: schema.required()\r\n\t\t),\r\n  person: personValidationSchema\r\n})\r\n\r\nexport const formikSchema = {\r\n  person: {\r\n    lName: '',\r\n    fName: '',\r\n    mName: '',\r\n    tels: [{\r\n      number: '',\r\n      country: 'rus',\r\n    }]\r\n  }\r\n}\r\n\r\nexport const listSchema = {\r\n  person: {\r\n    lName: {\r\n      label: ''\r\n    },\r\n    fName: {\r\n      label: ''\r\n    },\r\n    mName: {\r\n      label: ''\r\n    },\r\n    tels: [{\r\n      label: '',\r\n      type: 'tel'\r\n    }]\r\n  }\r\n}\r\n","import React from 'react'\r\n\r\nimport { Div, Icon } from '../styled/styled-semantic'\r\nimport DetailsHeader from '../DetailsHeader'\r\nimport List from '../list/List'\r\nimport { listSchema } from '../../schema/employee'\r\n\r\nexport default ({\r\n  emp,\r\n  toggleEditMode\r\n}) => {\r\n  return <>\r\n    <DetailsHeader\r\n      title={emp.person.fullname}\r\n      size='small'\r\n      noIndent\r\n      bottomBorder='dark'\r\n      buttons={<>\r\n        <Icon\r\n          link\r\n          name='edit'\r\n          activeColor='blue'\r\n          onClick={toggleEditMode}\r\n        />\r\n      </>}\r\n    />\r\n    <Div\r\n      p='1em'\r\n    >\r\n      <List\r\n        entity={emp}\r\n        schema={listSchema}\r\n      />\r\n    </Div>\r\n  </>\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { Mutation } from 'react-apollo'\r\nimport { upsertEmployee } from '../../graphql/employee'\r\n\r\nimport { Formik } from 'formik'\r\nimport { projectEntity, preparePayload } from '../form/utils'\r\nimport { formikSchema, validationSchema } from '../../schema/employee'\r\nimport Field from '../form/Field'\r\n\r\nimport { Button, A, Message } from '../styled/styled-semantic'\r\n\r\n// position\r\n// fName\r\n// lName\r\n// mName\r\n// htmlNote\r\n// tels { ...TelFragment }\r\n// user {\r\n//   email\r\n//   confirmed\r\n// }\r\n\r\nexport default class EmployeeForm extends Component {\r\n  didMount = false\r\n  componentDidMount() { this.didMount = true }\r\n  componentWillUnmount() { this.didMount = false }\r\n  render() {\r\n    const {\r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    let schema = emp ? formikSchema : {...formikSchema, orgId}\r\n    const initialValues = emp ? projectEntity(emp, schema) : schema\r\n    return (\r\n      <Mutation\r\n        mutation={upsertEmployee}\r\n        onCompleted={() => refetchQueries()}\r\n      >\r\n        {(upsertEmployee, { loading, error }) =>\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={async (values, { resetForm }) => {\r\n              // console.log('values > ', values)\r\n              // console.log('initialValues > ', initialValues)\r\n              const input = preparePayload(values, initialValues, schema)\r\n              // console.log('upsertEmployee input > ', input)\r\n              await upsertEmployee({ variables: { input } })\r\n              // const upserted = await upsertEmployee({ variables: { input } })\r\n              // console.log('upserted > ', upserted)\r\n              return emp\r\n                ? toggleEditMode()\r\n                : this.didMount && resetForm()\r\n            }}\r\n          >\r\n            {({\r\n              values,\r\n              handleChange,\r\n              handleSubmit,\r\n              handleReset,\r\n              setFieldValue\r\n            }) =>\r\n              <>\r\n                <Field\r\n                  label=''\r\n                  name='person.lName'\r\n                />\r\n                <Field\r\n                  label=''\r\n                  required\r\n                  name='person.fName'\r\n                />\r\n                <Field\r\n                  label=''\r\n                  name='person.mName'\r\n                />\r\n                <Field\r\n                  label=''\r\n                  name='person.tels'\r\n                />\r\n                {/* TODO add email input */}\r\n                {/* <Field\r\n                  label='E-mail'\r\n                  name='person.email'\r\n                /> */}\r\n                {!!error &&\r\n                  <Message\r\n                    error\r\n                    header='  ..'\r\n                    content={error && error.message}\r\n                  />\r\n                }\r\n                <Button\r\n                  ml='122px'\r\n                  // type=\"submit\"\r\n                  type='button'\r\n                  primary\r\n                  content={emp ? '' : ''}\r\n                  loading={loading}\r\n                  onClick={handleSubmit}\r\n                />\r\n                <A cancel\r\n                  onClick={ emp ? toggleEditMode : handleReset}\r\n                >\r\n                  {emp ? '' : ''}\r\n                </A>\r\n              </>\r\n            }\r\n          </Formik>\r\n        }\r\n      </Mutation>\r\n    )\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport DetailsHeader from '../DetailsHeader'\r\nimport EmployeeForm from './Form'\r\nimport { Div } from '../styled/styled-semantic'\r\n\r\nexport default class EmployeeEdit extends Component {\r\n  render() {\r\n    const { \r\n      emp,\r\n      orgId,\r\n      toggleEditMode,\r\n      refetchQueries\r\n    } = this.props\r\n    return <>\r\n      <DetailsHeader\r\n        title={\r\n          emp\r\n          ? ''\r\n          : ' '\r\n        }\r\n        size='small'\r\n        noIndent\r\n        bottomBorder='dark'\r\n        buttons={<>\r\n          {/* <Icon\r\n            link\r\n            name='save'\r\n            color='blue'\r\n            onClick={(emp) => console.log('upsert emp -> ', emp)}\r\n          /> */}\r\n        </>}\r\n      />\r\n      <Div\r\n        p='1em'\r\n        oy='auto'\r\n        h='315px'\r\n      >\r\n        <EmployeeForm\r\n          emp={emp}\r\n          orgId={orgId}\r\n          toggleEditMode={toggleEditMode}\r\n          refetchQueries={refetchQueries}\r\n        />\r\n      </Div>\r\n    </>\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { formatTel } from '../../utils/format'\r\n\r\nimport GlobalContext from '../special/GlobalContext'\r\n\r\nimport Table from '../common/Table'\r\nimport TableRow from '../common/TableRow'\r\n\r\nconst fields = [{\r\n\tname: 'fullname',\r\n\ttitle: '',\r\n\twidth: '250px'\r\n},{\r\n  name: 'tel',\r\n  title: '',\r\n  width: '140px'\r\n}]\r\n\r\nexport default ({\r\n  emps\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n\t\t\t{({ bottomPanel, setBottomPanel }) =>\r\n\t\t\t\t<Table\r\n\t\t\t\t\tfields={fields}\r\n\t\t\t\t>\r\n\t\t\t\t\t{({ tableFields }) => \r\n\t\t\t\t\t\temps.map(emp => {\r\n              const { id, person } = emp\r\n              const { lName, fName, mName, tels } = person || {}\r\n\t\t\t\t\t\t\tconst active = bottomPanel.id === id\r\n\t\t\t\t\t\t\treturn (\r\n                <TableRow\r\n                  key={id}\r\n                  entity={emp}\r\n                  tableFields={tableFields}\r\n                  rowFields={[{\r\n                    name: 'fullname',\r\n                    value: person\r\n                      ? [lName, fName, mName].join(' ')\r\n                      : '  '\r\n                  },{\r\n                    name: 'tel',\r\n                    value: (tels && tels.length && formatTel(tels[0])) || ''\r\n                  }\r\n                  // ,{\r\n                  //   name: 'emps',\r\n                  //   icon: org.employees.length ? 'user' : 'user plus',\r\n                  //   iconColor: 'grey',\r\n                  //   type: 'onHover',\r\n                  //   styles: ['center'],\r\n                  //   value: org.employees.length || ' ',\r\n                  //   onClick: () => {\r\n                  //     setBottomPanel({\r\n                  //       type: 'Employees',\r\n                  //       orgId: org.id\r\n                  //     })\r\n                  //   },\r\n                  //   active: bottomPanel\r\n                  //     && bottomPanel.type === 'Employees'\r\n                  //     && bottomPanel.orgId === org.id\r\n                  // }\r\n                  ]}\r\n                  active={active}\r\n                  onClick={() => {\r\n                    setBottomPanel({\r\n                      ...bottomPanel,\r\n                      editMode: false,\r\n                      id\r\n                    })\r\n                  }}\r\n                />\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Table>\r\n\t\t\t}\r\n\t\t</GlobalContext>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport produce from 'immer'\r\nimport { Query } from 'react-apollo'\r\nimport { orgEmployees } from '../graphql/employee'\r\n\r\nimport styled from 'styled-components'\r\n\r\nimport { Message } from './styled/styled-semantic';\r\nimport GlobalContext from './special/GlobalContext'\r\nimport EmployeesPanelHeader from './Employee/PanelHeader'\r\nimport EmployeeDetails from './Employee/Details'\r\nimport EmployeeEdit from './Employee/Edit'\r\nimport EmployeesTable from './Employee/Table';\r\n\r\nconst EmployeesPanelBody = styled.div`\r\n  display: flex;\r\n  height: calc(100% - 37px);\r\n`\r\n\r\nconst EmployeesPanelTableSection = styled.div`\r\n  flex: 0 0 600px;\r\n`\r\n\r\nconst EmployeeDetailsSection = styled.div`\r\n  flex: 0 0 480px;\r\n  border: solid rgb(156,156,159);\r\n  border-width: 0 1px;\r\n  min-height: 100%;\r\n`\r\n\r\nconst processEmp = emp =>\r\n  produce(emp, draft => {\r\n    const { lName, fName, mName } = draft.person\r\n    draft.person.fullname = [lName, fName, mName].join(' ')\r\n  })\r\n\r\nexport default ({\r\n  closePanel\r\n}) => {\r\n  return (\r\n    <GlobalContext>\r\n      {({ bottomPanel, setBottomPanel }) => <>\r\n        <EmployeesPanelHeader \r\n          closePanel={closePanel}\r\n        />\r\n        <Query\r\n          query={orgEmployees}\r\n          variables={{ orgId: bottomPanel.orgId }}\r\n        >\r\n          {({ loading, error, data, refetch }) => {\r\n            if (loading) return '..'\r\n            if (error) return ` ${error.message}`\r\n            const emps = data.orgEmployees\r\n            const activeEmp = bottomPanel.id && data.orgEmployees.find(e => e.id === bottomPanel.id)\r\n            return (\r\n              <EmployeesPanelBody>\r\n                <EmployeesPanelTableSection>\r\n                  {emps.length\r\n                    ? <EmployeesTable\r\n                        emps={emps}\r\n                      />\r\n                    : <Message\r\n                        m='1em'\r\n                        content={<>\r\n                            <br/>\r\n                          \r\n                        </>}\r\n                      />\r\n                  }\r\n                </EmployeesPanelTableSection>\r\n                <EmployeeDetailsSection>\r\n                  {!bottomPanel.id\r\n                    ? <EmployeeEdit \r\n                        orgId={bottomPanel.orgId}\r\n                        refetchQueries={refetch}\r\n                      /> :\r\n                    !activeEmp.person ?\r\n                      null :\r\n                    bottomPanel.editMode\r\n                    ? <EmployeeEdit\r\n                        emp={activeEmp}\r\n                        orgId={bottomPanel.orgId}\r\n                        toggleEditMode={() => setBottomPanel(\r\n                          produce(bottomPanel, draft => { delete draft.editMode })\r\n                        )}\r\n                        refetchQueries={refetch}\r\n                      />\r\n                    : <EmployeeDetails\r\n                        emp={processEmp(activeEmp)}\r\n                        toggleEditMode={() => setBottomPanel({ ...bottomPanel, editMode: true })}\r\n                      />\r\n                  }\r\n                </EmployeeDetailsSection>\r\n              </EmployeesPanelBody>\r\n            )\r\n          }}\r\n        </Query>\r\n      </>}\r\n    </GlobalContext>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { graphql, compose } from 'react-apollo'\r\nimport { allEnquiries } from '../graphql/enquiry'\r\nimport { setLayout } from '../graphql/layout'\r\n\r\nimport styled from 'styled-components'\r\nimport { Sidebar } from 'semantic-ui-react'\r\n\r\nimport EnquiriesMenu from './EnquiriesMenu'\r\nimport EnquiriesTable from './EnquiriesTable'\r\nimport DetailsSidebar from './DetailsSidebar'\r\nimport PanelPusher from './common/PanelPusher';\r\nimport EnquiriesBottomPanel from './EnquiriesBottomPanel';\r\nimport GlobalContext from './special/GlobalContext';\r\n\r\nconst Pushable = styled(Sidebar.Pushable)`\r\n\tmin-height: calc(100vh - 36px) !important;\r\n`\r\n\r\nexport class EnquiriesPage extends Component {\r\n\tstate = { panelClosing: false }\r\n\tclosePanel = () => {\r\n\t\tthis.setState({ panelClosing: true })\r\n\t\t// set timeout for panel to finish animation\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.props.setLayout({variables: { bottomPanel: null }})\r\n\t\t\tthis.setState({ panelClosing: false })\r\n\t\t}, 430)\r\n\t}\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tallEnquiries: { loading, error, refetch, enquiries },\r\n\t\t\trefreshToken\r\n\t\t} = this.props\r\n\t\tconst { panelClosing } = this.state\r\n\t\treturn <>\r\n\t\t\t<EnquiriesMenu\r\n\t\t\t\trefetchEnquiries={() => refetch()}\r\n\t\t\t\tenquiriesAreLoading={loading}\r\n\t\t\t\trefreshToken={refreshToken}\r\n\t\t\t/>\r\n\t\t\t{loading && \"...\"}\r\n\t\t\t{error && ` ${error.message}`}\r\n\t\t\t{enquiries &&\r\n\t\t\t\t<GlobalContext>\r\n\t\t\t\t\t{({ bottomPanel }) =>\r\n\t\t\t\t\t\t<Pushable>\r\n\t\t\t\t\t\t\t<DetailsSidebar />\r\n\t\t\t\t\t\t\t<Sidebar.Pusher>\r\n\t\t\t\t\t\t\t\t<PanelPusher\r\n\t\t\t\t\t\t\t\t\tpanel={ \r\n\t\t\t\t\t\t\t\t\t\t<EnquiriesBottomPanel\r\n\t\t\t\t\t\t\t\t\t\t\tclosePanel={this.closePanel}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpanelRendered={!!bottomPanel}\r\n\t\t\t\t\t\t\t\t\tpanelVisible={!!bottomPanel && !panelClosing}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<EnquiriesTable\r\n\t\t\t\t\t\t\t\t\t\tenquiries={enquiries}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</PanelPusher>\r\n\t\t\t\t\t\t\t</Sidebar.Pusher>\r\n\t\t\t\t\t\t</Pushable>\r\n\t\t\t\t\t}\r\n\t\t\t\t</GlobalContext>\r\n\t\t\t}\r\n\t\t</>\r\n\t}\r\n}\r\n\r\nexport default compose(\r\n\tgraphql(allEnquiries, { name: 'allEnquiries' }),\r\n\tgraphql(setLayout, { name: 'setLayout' })\r\n)(EnquiriesPage)","import React, { Component, Fragment } from 'react'\r\n\r\nimport { AUTH_TOKEN } from '../constants'\r\nimport { isTokenExpired } from '../utils/jwtHelper'\r\n\r\nimport { Query } from 'react-apollo'\r\nimport { me } from '../graphql/user'\r\n\r\nimport LoginPage from './LoginPage'\r\nimport EnquiriesPage from './EnquiriesPage'\r\n\r\nclass Root extends Component {\r\n\tstate = {\r\n\t\ttoken: this.props.token\r\n\t}\r\n\t //verify localStorage check\r\n\tcomponentDidMount() {\r\n\t\tthis.bootStrapData()\r\n\t}\r\n\tbootStrapData = () => {\r\n\t\ttry {\r\n\t\t\tconst token = localStorage.getItem(AUTH_TOKEN)\r\n\t\t\tif (token !== null && token !== undefined) {\r\n\t\t\t\tconst expired = isTokenExpired(token)\r\n\t\t\t\tif (!expired) {\r\n\t\t\t\t\tthis.setState({ token: token })\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.refreshToken(null)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// maybe TODO - provide fatal error message\r\n\t\t \t console.log('')\r\n\t\t}\r\n\t}\r\n\trefreshToken = (token) => {\r\n\t\tif (token) {\r\n\t\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\t\tthis.props.client.resetStore()\r\n\t\t}\r\n\t\tthis.setState({ token })\r\n\t}\r\n\trender() {\r\n\t\tconst { token } = this.state\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t{ !token \r\n\t\t\t\t  ?\t<LoginPage refreshToken={this.refreshToken} />\r\n\t\t\t\t  : <Query query={me} >\r\n\t\t\t\t\t\t\t{({ loading, error, data }) => {\r\n\t\t\t\t\t\t\t\tif (loading) return null\r\n\t\t\t\t\t\t\t\tif (error) return `Error!: ${error.message}`\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<EnquiriesPage refreshToken={this.refreshToken} me={data.me} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t</Query> \r\n\t\t\t\t}\r\n\t\t\t</Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default Root\r\n","import React from 'react'\r\n\r\nimport { ThemeProvider } from 'styled-components'\r\nimport { theme } from './components/styled/styled-semantic'\r\n\r\nimport Root from './components/Root'\r\n\r\n// use stateless component for production!\r\n// class App extends Component {\r\n// \trender() {\r\n// \t\tconst {token, client} = this.props\r\n// \t\treturn (\r\n// \t\t\t<ThemeProvider>\r\n// \t\t\t\t<Root token={token} client={client} />\r\n// \t\t\t</ThemeProvider>\r\n// \t\t)\r\n// \t}\r\n// }\r\n\r\nconst App = ({ client }) => (\r\n\t<ThemeProvider theme={theme}>\r\n\t\t<Root client={client} />\r\n\t</ThemeProvider>\r\n)\r\n\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport 'semantic-ui-css/semantic.min.css'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nimport ApolloClient from 'apollo-boost'\r\n// import { ApolloClient } from 'apollo-client'\r\n// import { HttpLink } from 'apollo-link-http'\r\n// import { withClientState } from 'apollo-link-state';\r\n// import { ApolloLink, split } from 'apollo-link'\r\n// import { getMainDefinition } from 'apollo-utilities'\r\n// import { WebSocketLink } from 'apollo-link-ws'\r\nimport { InMemoryCache, defaultDataIdFromObject } from 'apollo-cache-inmemory'\r\nimport { ApolloProvider } from 'react-apollo'\r\nimport { AUTH_TOKEN } from './constants'\r\n\r\nimport defaults from './apollo/defaults'\r\nimport resolvers from './apollo/resolvers'\r\nimport typeDefs from './apollo/typeDefs'\r\n\r\nimport App from './App'\r\n\r\n// init with Apollo Boost:\r\n// @ts-ignore\r\nconst client = new ApolloClient({\r\n\t// uri: 'http://localhost:4000',\r\n\t// uri: 'https://now-advanced.now.sh',\r\n\turi: 'https://env-1542080.mircloud.ru',\r\n\trequest: (operation) => {\r\n\t\tconst token = localStorage.getItem(AUTH_TOKEN)\r\n\t\toperation.setContext({\r\n\t\t\theaders: {\r\n\t\t\t\tAuthorization: token ? `Bearer ${token}` : '',\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\tonError: ({ graphQLErrors, networkError }) => {\r\n    if (graphQLErrors) {\r\n\t\t\tconsole.log('graphQLErrors!!! > ', graphQLErrors)\r\n      // sendToLoggingService(graphQLErrors);\r\n    }\r\n    if (networkError) {\r\n\t\t\tconsole.log('networkError!!! > ', networkError)\r\n\t\t\tconsole.log('networkError.name > ', networkError.name)\r\n\t\t\tconsole.log('networkError.message > ', networkError.message)\r\n\t\t\tconsole.log(networkError.message === 'Unexpected token I in JSON at position 0')\r\n\t\t\tif (networkError.message === 'Unexpected token I in JSON at position 0') refreshToken(null)\r\n      // logoutUser();\r\n\t\t}\r\n\t\t// networkError!!! >  SyntaxError: Unexpected token I in JSON at position 0\r\n    // at JSON.parse (<anonymous>)\r\n    // at index.js:43\r\n  },\r\n\tclientState: {\r\n\t\tdefaults,\r\n\t\tresolvers,\r\n\t\ttypeDefs\r\n\t},\r\n\tcache: new InMemoryCache({\r\n\t\tdataIdFromObject: object => {\r\n\t\t\tswitch (object.__typename) {\r\n\t\t\t\tcase 'NewEnquiry': return 'NewEnquiry'\r\n\t\t\t\tdefault: return defaultDataIdFromObject(object)\r\n\t\t\t}\r\n\t\t},\r\n\t\tcacheRedirects: {\r\n\t\t\tQuery: {\r\n\t\t\t\torgLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Org', id: args.id }),\r\n\t\t\t\tenquiryLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Enquiry', id: args.id }),\r\n\t\t\t\torderLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Order', id: args.id }),\r\n\t\t\t\tmodelLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\t\tgetCacheKey({ __typename: 'Model', id: args.id }),\r\n\t\t\t\tprodsLocal: (_, args, { getCacheKey }) =>\r\n\t\t\t\t\targs.ids.map(id =>\r\n\t\t\t\t\t\tgetCacheKey({ __typename: 'Prod', id: id }))\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n})\r\n\r\nconst refreshToken = (token) => {\r\n\tif (token) {\r\n\t\tlocalStorage.setItem(AUTH_TOKEN, token)\r\n\t} else {\r\n\t\tlocalStorage.removeItem(AUTH_TOKEN)\r\n\t\tclient.resetStore()\r\n\t}\r\n}\r\n\r\n// const cache = new InMemoryCache({\r\n//     dataIdFromObject: object => {\r\n//         switch (object.__typename) {\r\n//             case 'NewEnquiry': return 'NewEnquiry'\r\n//             default: return defaultDataIdFromObject(object)\r\n//         }\r\n//     }\r\n// })\r\n\r\n// const stateLink = withClientState({\r\n//     cache,\r\n//     defaults,\r\n//     resolvers,\r\n//     // typeDefs\r\n// })\r\n\r\n// const httpLink = new HttpLink({ uri: 'https://now-advanced.now.sh' })\r\n\r\n// const middlewareAuthLink = new ApolloLink((operation, forward) => {\r\n//     // get the authentication token from local storage if it exists\r\n//     const tokenValue = localStorage.getItem(AUTH_TOKEN)\r\n//     // return the headers to the context so httpLink can read them\r\n//     operation.setContext({\r\n//       headers: {\r\n//         Authorization: tokenValue ? `Bearer ${tokenValue}` : '',\r\n//       },\r\n//     })\r\n//     return forward(operation)\r\n// })\r\n// slightly different auth link init implementation -> https://www.apollographql.com/docs/react/recipes/authentication.html\r\n\r\n// // authenticated httplink\r\n// const httpLinkAuth = middlewareAuthLink.concat(httpLink)\r\n\r\n// const wsLink = new WebSocketLink({\r\n//     uri: `ws://now-advanced.now.sh`,\r\n//     options: {\r\n//         reconnect: true,\r\n//         connectionParams: {\r\n//         Authorization: `Bearer ${localStorage.getItem(AUTH_TOKEN)}`,\r\n//         },\r\n//     },\r\n// })\r\n  \r\n// const link = split(\r\n//     // split based on operation type\r\n//     ({ query }) => {\r\n//         const { kind, operation } = getMainDefinition(query)\r\n//         return kind === 'OperationDefinition' && operation === 'subscription'\r\n//     },\r\n//     wsLink,\r\n//     httpLinkAuth,\r\n// )\r\n\r\n// const client = new ApolloClient({\r\n//     cache,\r\n//     link: ApolloLink.from([\r\n//         stateLink,\r\n//         httpLinkAuth\r\n//     ]),\r\n//     connectToDevTools: true,\r\n// })\r\n\r\n// client.cache.reset()\r\n\r\nReactDOM.render(\r\n\t<ApolloProvider client={client}>\r\n\t\t<App client={client}/>\r\n\t</ApolloProvider>\r\n, document.getElementById('root'))\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register()  below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n","export default `\r\n\ttype Details {\r\n\t\ttype: String\r\n\t\tid: ID\r\n\t\tenquiryId: ID\r\n\t\teditMode: Boolean\r\n\t\tclosing: Boolean\r\n\t}\r\n`"],"sourceRoot":""}