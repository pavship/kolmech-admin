(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1065:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(54),i=n.n(o);n(539),n(540),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(33),l=n(14),u=n(100),s=n(485),d=n(87),m=n(519),f=n(484),p=n(326),b="kolmech-token",g={newEnquiry:{__typename:"Enquiry",id:"new"},layout:{__typename:"Layout",details:null,extra:null,bottomPanel:null},lists:{__typename:"Lists",selectedProdIds:[]}},v=n(2),h=n(7),E=n.n(h);function y(){var t=Object(v.a)(["\n\tmutation SetExpanded($args: json) {\n\t\tsetExpanded(args: $args) @client {\n\t\t\targs\n\t\t}\n\t}\n"]);return y=function(){return t},t}function O(){var t=Object(v.a)(["\n\tmutation SetLayout($input: json) {\n\t\tsetLayout(input: $input) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return O=function(){return t},t}function j(){var t=Object(v.a)(["\n\tquery getLayout {\n\t\tlayout @client {\n\t\t\tdetails\n\t\t\textra\n\t\t\tbottomPanel\n\t\t}\n\t}\n"]);return j=function(){return t},t}var x=E()(j()),w={props:function(t){return{layout:t.data.layout||{}}}},k=E()(O()),C=E()(y());function F(){var t=Object(v.a)(["\n\tmutation ReserveProds ($orderId: ID!, $prodIds: [ID!]!) {\n\t\treserveProds (orderId: $orderId, prodIds: $prodIds) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return F=function(){return t},t}function I(){var t=Object(v.a)(["\n\tquery OrderDetails ($id: ID!) {\n\t\torder (id: $id) {\n\t\t\t...OrderFragmentFull\n\t\t}\n\t}\n\t","\n"]);return I=function(){return t},t}function S(){var t=Object(v.a)(["\n\tquery OrderLocal ($id: ID!) {\n\t\torderLocal (id: $id) {\n\t\t\tid\n\t\t\tfullnum\n\t\t\tdateLocal\n\t\t\tqty\n\t\t\tamount\n\t\t}\n\t}\n"]);return S=function(){return t},t}function D(){var t=Object(v.a)(["\n\tmutation UpsertOrder($id: ID, $enquiryId: ID, $dateLocal: String!, $qty: Int, $amount: Float) {\n\t\tupsertOrder(id: $id, enquiryId: $enquiryId, dateLocal: $dateLocal, qty: $qty, amount: $amount) {\n\t\t\t...OrderFragmentBasic\n\t\t\tenquiry {\n\t\t\t\tid\n\t\t\t}\n\t\t\tprods {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return D=function(){return t},t}function q(){var t=Object(v.a)(["\n\tfragment OrderFragmentFull on Order {\n\t\t...OrderFragmentBasic\n\t\thtmlNote\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tprods {\n\t\t\tid\n\t\t\tfullnumber,\n\t\t\thasDefect,\n\t\t\tisSpoiled,\n\t\t\tprogress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return q=function(){return t},t}function M(){var t=Object(v.a)(["\n\tfragment OrderFragmentBasic on Order {\n\t\tid\n\t\tfullnum\n\t\tdateLocal\n\t\tqty\n\t\tamount\n\t}\n"]);return M=function(){return t},t}var B=E()(M()),P=E()(q(),B),L=E()(D(),B),N=E()(S()),T=E()(I(),P),$=E()(F(),P);function R(){var t=Object(v.a)(["\n\tfragment DocFragmentBasic on Doc {\n\t\tid\n\t\ttype\n\t\tdateLocal\n\t\tamount\n\t}\n"]);return R=function(){return t},t}var A=E()(R());function z(){var t=Object(v.a)(["\n\tfragment StatusFragment on Status {\n\t\tid\n    name\n    stage\n\t}\n"]);return z=function(){return t},t}var V=E()(z());function W(){var t=Object(v.a)(["\n\tfragment FileFragmentFull on File {\n\t\tid\n\t\tpath\n\t\tsize\n\t\tfilename\n\t\tmimetype\n\t\twidth\n\t\theight\n\t\timgFor\n\t}\n"]);return W=function(){return t},t}var Q=E()(W());function H(){var t=Object(v.a)(["\n\tmutation SetDrawingsSortOrder( $ids: [ID!]! ) {\n\t\tsetDrawingsSortOrder(ids: $ids) { count }\n\t}\n"]);return H=function(){return t},t}function K(){var t=Object(v.a)(["\n\tmutation DeleteDrawings( $ids: [ID!]! ) {\n\t\tdeleteDrawings(ids: $ids) { count }\n\t}\n"]);return K=function(){return t},t}function U(){var t=Object(v.a)(["\n\tmutation CreateDrawings(\n\t\t$modelId: ID!\n\t\t$files: [Upload!]!\n\t) {\n\t\tcreateDrawings(\n\t\t\tmodelId: $modelId\n\t\t\tfiles: $files\n\t\t) {\n\t\t\t...DrawingFragmentFull\n\t\t}\n\t}\n\t","\n"]);return U=function(){return t},t}function _(){var t=Object(v.a)(["\n\tfragment DrawingFragmentFull on Drawing {\n\t\t...DrawingFragmentBasic\n\t\tfiles { ...FileFragmentFull }\n\t}\n\t","\n\t","\n"]);return _=function(){return t},t}function G(){var t=Object(v.a)(["\n\tfragment DrawingFragmentBasic on Drawing {\n\t\tid\n\t\tname\n\t\tsortOrder\n\t}\n"]);return G=function(){return t},t}var X=E()(G()),Y=E()(_(),X,Q),J=E()(U(),Y),Z=E()(K()),tt=E()(H());function et(){var t=Object(v.a)(["\n\tmutation UpsertModel(\n\t\t$input: ModelInput!\n\t) {\n\t\tupsertModel(\n\t\t\tinput: $input\n\t\t) {\n\t\t\tid\n\t\t}\n\t}\n"]);return et=function(){return t},t}function nt(){var t=Object(v.a)(["\n\tquery ModelDetails ($id: ID!) {\n\t\tmodel (id: $id) {\n\t\t\t...ModelFragmentFull\n\t\t}\n\t}\n\t","\n"]);return nt=function(){return t},t}function rt(){var t=Object(v.a)(["\n\tquery ModelLocal ($id: ID!) {\n\t\tmodelLocal (id: $id) {\n\t\t\t...ModelFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return rt=function(){return t},t}function at(){var t=Object(v.a)(["\n\tfragment ModelFragmentFull on Model {\n\t\t...ModelFragmentBasic\n\t\tdrawings { ...DrawingFragmentFull }\n\t}\n\t","\n\t","\n"]);return at=function(){return t},t}function ot(){var t=Object(v.a)(["\n\tfragment ModelFragmentWithDrawings on Model {\n\t\t...ModelFragmentBasic\n\t\tdrawings { ...DrawingFragmentBasic }\n\t}\n\t","\n\t","\n"]);return ot=function(){return t},t}function it(){var t=Object(v.a)(["\n\tfragment ModelFragmentBasic on Model {\n\t\tid\n\t\tname\n\t\tarticle\n\t}\n"]);return it=function(){return t},t}var ct=E()(it()),lt=E()(ot(),ct,X),ut=E()(at(),ct,Y),st=E()(rt(),ct),dt=E()(nt(),ut),mt=E()(et());function ft(){var t=Object(v.a)(["\n\tfragment myEnquiry on Enquiry {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t\thtmlNote\n\t\tisExpanded\n\t\torg {\n\t\t\tid\n\t\t\tname\n\t\t}\n\t\tmodel { ...ModelFragmentBasic }\n\t\tqty\n\t\tevents {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName \n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tstage \n\t\t\t}\n\t\t\tdoc {\n\t\t\t\tid\n\t\t\t\tdateLocal\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n"]);return ft=function(){return t},t}function pt(){var t=Object(v.a)(["\n\tmutation CreateEnquiryEvent($enquiryId: ID!, $htmlText: String, $statusId: ID, $doc: DocCreateInput) {\n\t\tcreateEnquiryEvent(enquiryId: $enquiryId, htmlText: $htmlText, statusId: $statusId, doc: $doc) {\n\t\t\tid\n\t\t\tdatetimeLocal\n\t\t\thtmlText\n\t\t\ttype\n\t\t\tuser {\n\t\t\t\tid\n\t\t\t\tperson {\n\t\t\t\t\tid\n\t\t\t\t\tfName\n\t\t\t\t\tlName\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdoc { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n"]);return pt=function(){return t},t}function bt(){var t=Object(v.a)(["\n\tmutation UpdateEnquiry($input: EnquiryInput!) {\n\t\tupdateEnquiry(input: $input) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return bt=function(){return t},t}function gt(){var t=Object(v.a)(["\n\tmutation createEnquiry($dateLocal: String!, $orgId: ID!, $modelId: ID!, $qty: Int!) {\n\t\tcreateEnquiry(dateLocal: $dateLocal, orgId: $orgId, modelId: $modelId, qty: $qty) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t\torders {\n\t\t\t\tid\n\t\t\t\tfullnum\n\t\t\t\tdateLocal\n\t\t\t\tqty\n\t\t\t\tamount\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return gt=function(){return t},t}function vt(){var t=Object(v.a)(["\n\tquery {\n\t\tnewEnquiry @client {\n\t\t\tid\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n"]);return vt=function(){return t},t}function ht(){var t=Object(v.a)(["\n\tquery EnquiryLocal ($id: ID!) {\n\t\tenquiryLocal (id: $id) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t}\n\t}\n\t","\n\t","\n"]);return ht=function(){return t},t}function Et(){var t=Object(v.a)(["\n\tquery EnquiryDetails ($id: ID!) {\n\t\tenquiry (id: $id) {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentBasic }\n\t\t\tqty\n\t\t\tevents {\n\t\t\t\tid\n\t\t\t\tdatetimeLocal\n\t\t\t\thtmlText\n\t\t\t\ttype\n\t\t\t\tuser {\n\t\t\t\t\tid\n\t\t\t\t\tperson {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tfName\n\t\t\t\t\t\tlName \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstatus { ...StatusFragment }\n\t\t\t\tdoc { ...DocFragmentBasic }\n\t\t\t}\n\t\t}\n\t\tstatuses {\n\t\t\tid\n\t\t\tstage\n\t\t\tname\n\t\t\tprev {\n\t\t\t\tid\n\t\t\t}\n\t\t\tnext {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return Et=function(){return t},t}function yt(){var t=Object(v.a)(["\n\tquery AllEnquiries {\n\t\tenquiries {\n\t\t\t...EnquiryFragmentBasic\n\t\t\thtmlNote\n\t\t\torg {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\temployees {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\tmodel { ...ModelFragmentWithDrawings }\n\t\t\tqty\n\t\t\torders {\n\t\t\t\t...OrderFragmentBasic\n\t\t\t\tprods {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\tstatus { ...StatusFragment }\n\t\t\tdocs { ...DocFragmentBasic }\n\t\t\tisExpanded @client\n\t\t}\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return yt=function(){return t},t}function Ot(){var t=Object(v.a)(["\n\tfragment EnquiryFragmentBasic on Enquiry {\n\t\tid\n\t\tnum\n\t\tdateLocal\n\t}\n"]);return Ot=function(){return t},t}var jt=E()(Ot()),xt=E()(yt(),jt,lt,B,A,V),wt=E()(Et(),jt,ct,A,V),kt=E()(ht(),jt,A),Ct=E()(vt()),Ft=E()(gt(),jt,lt,A,V),It=E()(bt(),jt,lt,A,V),St=E()(pt(),A,V),Dt=E()(ft(),ct);function qt(){var t=Object(v.a)(["\n\tmutation SetList($name: String!, $value: [ID!]) {\n\t\tsetList(name: $name, value: $value) @client {\n\t\t\tresult\n\t\t}\n\t}\n"]);return qt=function(){return t},t}function Mt(){var t=Object(v.a)(["\n\tquery getLists {\n\t\tlists @client {\n\t\t\tselectedProdIds\n\t\t}\n\t}\n"]);return Mt=function(){return t},t}var Bt=E()(Mt()),Pt=E()(qt()),Lt=n(12),Nt={Enquiry:{isExpanded:function(){return!1}},Mutation:{setLayout:function(t,e,n){var r=e.input,a=n.cache,o=x,i=a.readQuery({query:o});return i.layout=Object(l.a)({},i.layout,Object(Lt.f)(r)),a.writeQuery({query:o,data:i}),null},setExpanded:function(t,e,n){var r=e.args,a=r.id,o=r.value,i=n.cache,c=xt,l=i.readQuery({query:c});return l.enquiries.find(function(t){return t.id===a}).isExpanded=o,i.writeQuery({query:c,data:l}),null},setList:function(t,e,n){var r=e.name,a=e.value,o=n.cache,i=Bt,c=o.readQuery({query:i});return c.lists[r]=a,o.writeQuery({query:i,data:c}),null}}},Tt=new p.a({dataIdFromObject:function(t){switch(t.__typename){case"NewEnquiry":return"NewEnquiry";default:return Object(p.b)(t)}},cacheRedirects:{Query:{dealLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Deal",id:e.id})},orgLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Org",id:e.id})},enquiryLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Enquiry",id:e.id})},orderLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Order",id:e.id})},modelLocal:function(t,e,n){return(0,n.getCacheKey)({__typename:"Model",id:e.id})},prodsLocal:function(t,e,n){var r=n.getCacheKey;return e.ids.map(function(t){return r({__typename:"Prod",id:t})})}}}}),$t=new d.ApolloLink(function(t,e){var n=localStorage.getItem(b)||null;return t.setContext(function(t){var e=t.headers,r=void 0===e?{}:e;return{headers:Object(l.a)({},r,{Authorization:n?"Bearer ".concat(n):""})}}),e(t)}),Rt=new u.a({link:d.ApolloLink.from([Object(f.a)(function(t){var e,n=t.graphQLErrors,r=t.networkError;n&&console.log("graphQLErrors!!! > ",n),r&&(console.log("networkError!!! > ",r),console.log("networkError.name > ",r.name),console.log("networkError.message > ",r.message),console.log("Unexpected token I in JSON at position 0"===r.message),"Unexpected token I in JSON at position 0"===r.message&&((e=null)?localStorage.setItem(b,e):(localStorage.removeItem(b),Rt.resetStore())))}),$t,Object(m.a)({defaults:g,resolvers:Nt,cache:Tt}),Object(s.createUploadLink)({uri:"https://env-1542080.mircloud.ru"})]),cache:Tt}),At=n(4),zt=n(486),Vt=n(26),Wt=n(1092),Qt=n(116),Ht=n(1069),Kt=n(1087),Ut=n(1090),_t=n(1078),Gt=n(1079),Xt=n(1086),Yt=n(1084);function Jt(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return Jt=function(){return t},t}function Zt(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return Zt=function(){return t},t}function te(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n"]);return te=function(){return t},t}function ee(){var t=Object(v.a)(["\n\t","\n\twidth: "," !important;\n\tmargin-right: 0 !important;\n"]);return ee=function(){return t},t}function ne(){var t=Object(v.a)(["\n\t&&& {\n\t\t","\n\t}\n"]);return ne=function(){return t},t}function re(){var t=Object(v.a)(["\n\twidth: 100%;\n\tpadding: 1em 1em 1em 55px;\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return re=function(){return t},t}function ae(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return ae=function(){return t},t}function oe(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t&.compact {\n\t\t\tpadding: .5rem 1rem;\n\t\t}\n\t\t","\n\t\t","\n\t}\n"]);return oe=function(){return t},t}function ie(){var t=Object(v.a)(["\n\ttransform: ",";\n\t&&& {\n\t\t","\n\t}\n"]);return ie=function(){return t},t}function ce(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&&&& {\n\t\t","\n\t\t","\n\t}\n"]);return ce=function(){return t},t}function le(){var t=Object(v.a)(["\n\t&&&& {\n\t\t","\n\t}\n\t&&& {\n\t\t","\n\t}\n"]);return le=function(){return t},t}function ue(){var t=Object(v.a)(["\n\tcursor: pointer;\n\t","\n"]);return ue=function(){return t},t}function se(){var t=Object(v.a)(["\n\t","\n"]);return se=function(){return t},t}function de(){var t=Object(v.a)(["\n\t","\n"]);return de=function(){return t},t}function me(){var t=Object(v.a)(["\n\t","\n\t","\n"]);return me=function(){return t},t}var fe={widths:{formLabel:"122px",detailsPL:"55px",extraSidebar:"250px"},colors:{green:"#016936",blue:"#0E6EB8",error:"#9f3a38",errorBorder:"#e0b4b4"}},pe=function(t){return fe.colors[t]||t},be=function(t){var e=t.theme,n=t.bt,r=t.bb,a=t.bc,o=t.bl,i=t.br,c=t.bs,l=t.bsh,u=t.c,s=t.cur,d=t.d,m=t.f,f=t.fl,p=t.fs,b=t.fw,g=t.h,v=t.l,h=t.lh,E=t.mw,y=t.minw,O=t.m,j=t.mb,x=t.mt,w=t.ml,k=t.mr,C=t.o,F=t.ov,I=t.ox,S=t.oy,D=t.p,q=t.pb,M=t.pe,B=t.pos,P=t.pl,L=t.pr,N=t.pt,T=t.t,$=t.tr,R=t.ta,A=t.to,z=t.v,V=t.va,W=t.w,Q=t.whs,H=t.ws,K=t.z;return"\n\t\t".concat(n?"border-top: ".concat(n,";"):"","\n\t\t").concat(r?"border-bottom: ".concat(r,";"):"","\n\t\t").concat(a?"background-color: ".concat(a,";"):"","\n\t\t").concat(o?"border-left: ".concat(o,";"):"","\n\t\t").concat(i?"border-right: ".concat(i,";"):"","\n\t\t").concat(c?"box-sizing: ".concat(c,";"):"","\n\t\t").concat(l?"box-shadow: ".concat(l,";"):"","\n\t\t").concat(u?"color: ".concat(e.colors&&e.colors[u]||u,";"):"","\n\t\t").concat(s?"cursor: ".concat(s,";"):"","\n\t\t").concat(d?"display: ".concat(d,";"):"","\n\t\t").concat(m?"flex: ".concat(m,";"):"","\n\t\t").concat(f?"float: ".concat(f,";"):"","\n\t\t").concat(p?"font-size: ".concat(p,";"):"","\n\t\t").concat(b?"font-weight: ".concat(b,";"):"","\n\t\t").concat(g?"height: ".concat(g,";"):"","\n\t\t").concat(v?"left: ".concat(v,";"):"","\n\t\t").concat(h?"line-height: ".concat(h,";"):"","\n\t\t").concat(E?"max-width: ".concat(E,";"):"","\n\t\t").concat(y?"min-width: ".concat(y,";"):"","\n\t\t").concat(O?"margin: ".concat(O,";"):"","\n\t\t").concat(j?"margin-bottom: ".concat(j,";"):"","\n\t\t").concat(x?"margin-top: ".concat(x,";"):"","\n\t\t").concat(w?"margin-left: ".concat(w,";"):"","\n\t\t").concat(k?"margin-right: ".concat(k,";"):"","\n\t\t").concat(C?"opacity: ".concat(C,";"):"","\n\t\t").concat(F?"overflow: ".concat(F,";"):"","\n\t\t").concat(I?"overflow-x: ".concat(I,";"):"","\n\t\t").concat(S?"overflow-y: ".concat(S,";"):"","\n\t\t").concat(D?"padding: ".concat(D,";"):"","\n\t\t").concat(q?"padding-bottom: ".concat(q,";"):"","\n\t\t").concat(P?"padding-left: ".concat(P,";"):"","\n\t\t").concat(M?"pointer-events: ".concat(M,";"):"","\n\t\t").concat(B?"position: ".concat(B,";"):"","\n\t\t").concat(L?"padding-right: ".concat(L,";"):"","\n\t\t").concat(N?"padding-top: ".concat(N,";"):"","\n\t\t").concat(T?"top: ".concat(T,";"):"","\n\t\t").concat($?"transition: ".concat($,";"):"","\n\t\t").concat(R?"text-align: ".concat(R,";"):"","\n\t\t").concat(A?"text-overflow: ".concat(A,";"):"","\n\t\t").concat(z?"visibility: ".concat(z,";"):"","\n\t\t").concat(V?"vertical-align: ".concat(V,";"):"","\n\t\t").concat(W?"width: ".concat(e.widths&&e.widths[W]||W,";"):"","\n\t\t").concat(Q?"white-space: ".concat(Q,";"):"","\n\t\t").concat(H?"word-spacing: ".concat(H,";"):"","\n\t\t").concat(K?"z-index: ".concat(K,";"):"","\n\t")},ge=Object(At.b)(function(t){t.ml,t.w,t.inline;var e=Object(Vt.a)(t,["ml","w","inline"]);return a.a.createElement("div",e)})(me(),function(t){return t.inline&&"display: inline-block;"},function(t){return be(t)}),ve=Object(At.b)(function(t){var e=Object(zt.a)({},t);return a.a.createElement("p",e)})(de(),function(t){return be(t)}),he=Object(At.b)(function(t){t.ml;var e=Object(Vt.a)(t,["ml"]);return a.a.createElement("span",e)})(se(),function(t){return be(t)}),Ee=At.b.a(ue(),function(t){return t.cancel&&"{\n\t\tpadding-left: 15px;\n\t\tcolor: rgba(0,0,0,.87);\n\t\t&:hover {\n\t\t\tcolor: #B03060;\n\t\t}\n\t}"}),ye=Object(At.b)(function(t){t.inline,t.c;var e=Object(Vt.a)(t,["inline","c"]);return a.a.createElement(Wt.a,e)})(le(),function(t){return be(t)},function(t){return t.inline&&"{\n\t\t\tmargin: 0;\n\t\t\tpadding: 0 1rem;\n\t\t}"}),Oe=Object(At.b)(function(t){t.active,t.activeColor,t.selectMode;var e=t.disabled,n=t.onClick,r=Object(Vt.a)(t,["active","activeColor","selectMode","disabled","onClick"]);return a.a.createElement(Qt.a,Object.assign({},r,{disabled:e,onClick:e?void 0:n}))})(ce(),function(t){return be(t)},function(t){return t.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t\t").concat(t.active&&"color: ".concat(pe(t.activeColor)," !important;"),"\n\t\t}")},function(t){return t.disabled&&"opacity: .45!important;"}),je=Object(At.b)(function(t){t.active,t.disabled;var e=Object(Vt.a)(t,["active","disabled"]);return a.a.createElement(Qt.a,Object.assign({},e,{name:"dropdown"}))})(ie(),function(t){return!t.active&&("large"===t.size?"translateX(0) translateY(0) rotate(-90deg) !important":"translateX(-3px) translateY(3px) rotate(-90deg) !important")},function(t){return t.disabled&&"{\n\t\t\tcolor: rgba(0,0,0,.6);\n\t\t}"}),xe=Object(At.b)(function(t){t.activeColor,t.menu;var e=Object(Vt.a)(t,["activeColor","menu"]);return a.a.createElement(Ht.a,e)})(oe(),function(t){return be(t)},function(t){return t.activeColor&&"{\n\t\t\t&:hover {\n\t\t\t\tcolor: ".concat(pe(t.activeColor)," !important;\n\t\t\t}\n\t\t\t&.active {\n\t\t\t\tcolor: ").concat(pe(t.activeColor)," !important;\n        \t}\n\t\t}")},function(t){return t.menu&&"{\n\t\t\tmargin: .25rem 0 .25rem 0.5rem;\n\t\t\tz-index: 3;\n\t\t}"}),we=Object(At.b)(function(t){t.section;var e=Object(Vt.a)(t,["section"]);return a.a.createElement(Kt.a,e)})(ae(),function(t){return be(t)},function(t){return t.section&&"\n\t\t\tmargin-top: 0;\n\t\t\tpadding-left: ".concat(t.theme.widths.detailsPL,";\n\t\t\tbox-shadow: 0 0 0 1px #e0b4b4, 0 0 0 0 transparent;\n\t\t\tborder-radius: 0;\n\t\t")}),ke=a.a.forwardRef(function(t,e){t.head,t.minor,t.small,t.secondary,t.noP,t.noLP,t.noIndent,t.topBorder,t.bottomBorder;var n=t.children,r=t.onClick,o=Object(Vt.a)(t,["head","minor","small","secondary","noP","noLP","noIndent","topBorder","bottomBorder","children","onClick"]);return a.a.createElement("div",Object.assign({ref:e},o,{onClick:r||void 0}),n)}),Ce=Object(At.b)(ke)(re(),function(t){return be(t)},function(t){return t.head&&"{\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding-top: 0;\n\t\tpadding-bottom: 0;\n\t}"},function(t){return t.onClick&&"{\n\t\tcursor: pointer;\n\t}"},function(t){return t.minor&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return!t.size&&t.head&&"{\n\t\tmin-height: 3.5em;\n\t}"},function(t){return"small"===t.size&&"{\n\t\tmin-height: 2.5em;\n\t}"},function(t){return t.secondary&&"{\n\t\tbackground: #f3f4f5;\n\t\tcolor: rgba(0,0,0,.6);\n\t}"},function(t){return t.noLP&&"{\n\t\tpadding-left: 0;\n\t}"},function(t){return t.noIndent&&"{\n\t\tpadding-left: 1em;\n\t}"},function(t){return t.topBorder&&"{\n\t\tborder-top: 1px solid ".concat("dark"===t.topBorder?"rgba(152, 153, 154, 1)":"rgba(34,36,38,.15)",";\n\t}")},function(t){return t.bottomBorder&&"{\n\t\tborder-bottom: 1px solid ".concat("dark"===t.bottomBorder?"rgba(126, 127, 129, 1)":"rgba(34,36,38,.1)",";\n\t}")}),Fe=Object(At.b)(function(t){t.showIf;var e=Object(Vt.a)(t,["showIf"]);return a.a.createElement(Ut.a,e)})(ne(),function(t){return!t.showIf&&"{\n\t\t\topacity: 0;\n\t\t}"}),Ie=At.b.label(ee(),function(t){return be(t)},function(t){return t.theme.widths.formLabel}),Se=a.a.forwardRef(function(t,e){t.w;var n=Object(Vt.a)(t,["w"]);return a.a.createElement(_t.a,{innerRef:e},a.a.createElement(Gt.a,n))}),De=Object(At.b)(Se)(te(),function(t){return be(t)}),qe=(Object(At.b)(Xt.a)(Zt(),function(t){return be(t)}),Object(At.b)(function(t){t.w;var e=Object(Vt.a)(t,["w"]);return a.a.createElement(Yt.a.Field,e)})(Jt(),function(t){return be(t)}),n(11)),Me=n(40),Be=n(69),Pe=n.n(Be),Le=n(51),Ne=function(t){var e=t.message,n=e.id,r=e.type,o=e.title,i=e.content,c=e.timerId,l=t.dismissNotification,u=t.cancelAutoDismiss;return a.a.createElement(we,{m:"0 0 2rem 2rem",w:"unset",mw:"550px",pr:"4em",pe:"all",compact:!0,size:"large",icon:"error"===r?"exclamation":"warning"===r?"info":"success"===r?"check":void 0,header:o,content:i,error:"error"===r,info:"info"===r,success:"success"===r,warning:"warning"===r,onDismiss:c?void 0:function(){return l(n)},onMouseEnter:c?function(){return u(n)}:void 0})};function Te(){var t=Object(v.a)(["\n\tposition: fixed;\n  bottom: 0;\n\ttop: 0;\n\tleft: 0;\n  width: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-end;\n\tpointer-events: none;\n  z-index: 100;\n"]);return Te=function(){return t},t}var $e=At.b.div(Te()),Re=Le.b.div({boobl:{y:200,opacity:0},enter:{y:0,opacity:1},exit:{x:-400,opacity:0}});function Ae(t){var e=t.messages,n=t.dismissNotification,r=t.cancelAutoDismiss;return i.a.createPortal(a.a.createElement($e,null,a.a.createElement(Le.a,{animateOnMount:!0,preEnterPose:"boobl"},e.map(function(t){return a.a.createElement(Re,{key:t.id,initialPose:"boobl"},a.a.createElement(Ne,{message:t,dismissNotification:n,cancelAutoDismiss:r}))}))),document.getElementById("kolmech-notifications"))}var ze=a.a.createContext(),Ve=ze;function We(t){var e=t.children,n=Object(r.useState)([]),o=Object(qe.a)(n,2),i=o[0],c=o[1],l=function(t){t.id=Pe()(),t.timerId=setTimeout(function(){u(t.id)},5e3),c(Object(Me.a)(i,function(e){e.push(t)}))},u=function(t){return c(Object(Me.a)(i,function(e){return console.log("messageId > ",t),e.splice[(i.findIndex(function(e){return e.id===t}),1)]}))},s=Object(r.useMemo)(function(){return{notify:l}},[]);return a.a.createElement(ze.Provider,{value:s},a.a.createElement(Ae,{messages:i,dismissNotification:u,cancelAutoDismiss:function(t){return c(Object(Me.a)(i,function(e){var n=e[i.findIndex(function(e){return e.id===t})];clearTimeout(n.timerId),delete n.timerId}))}}),e)}var Qe=function(t){var e=t.children;return a.a.createElement(ze.Consumer,null,function(t){var n=t.notify;return a.a.createElement(He,{notify:n},e)})},He=a.a.memo(function(t){var e=t.notify;return(0,t.children)({notify:e})}),Ke=function(){var t=Object(r.useContext)(ze).notify;return{notify:Object(r.useCallback)(function(e){return t(e)},[])}},Ue=n(228);function _e(){var t=Object(v.a)(["\n\tmutation highlightFolder ($orgId: ID, $dealId: ID) {\n\t\thighlightFolder (orgId: $orgId, dealId: $dealId) {\n\t\t\tstatusText\n\t\t}\n\t}\n"]);return _e=function(){return t},t}var Ge=E()(_e()),Xe=a.a.createContext(),Ye=Xe,Je=function(t){var e=t.children;return a.a.createElement(Ue.a,{mutation:Ge},function(t){return a.a.createElement(Xe.Provider,{value:{highlightFolder:function(e){var n=e.orgId,r=e.dealId;return t({variables:{orgId:n,dealId:r}})}}},e)})},Ze=n(503),tn=n.n(Ze);function en(t){var e=function(t){var e=tn()(t);if(!e.exp)return null;var n=new Date(0);return n.setUTCSeconds(e.exp),n}(t);return null!==e&&!(e.valueOf()>(new Date).valueOf()+0)}var nn=n(17),rn=n.n(nn),an=n(34),on=n(74);function cn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.onError,a=e.errMsg,o=Object(Vt.a)(e,["onError","errMsg"]),i=Object(r.useContext)(Ve).notify;return Object(on.c)(t,Object(l.a)({},o,{onError:function(t){n&&n(t),i({type:"error",title:a||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445",content:t.message})}}))}var ln=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.onCompleted,a=e.onError,o=e.successMsg,i=e.errMsg,c=(e.mark,Object(Vt.a)(e,["onCompleted","onError","successMsg","errMsg","mark"])),u=Object(r.useContext)(Ve).notify;return Object(on.b)(t,Object(l.a)({},c,{onCompleted:function(t){console.log("onCompleted > ",n),n&&n(t),null!==o&&u({type:"success",title:o||"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b"})},onError:function(t){a&&a(t),u({type:"error",title:i||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445",content:t.message})}}))};function un(){var t=Object(v.a)(["\n\tquery accounts {\n\t\taccounts { ...accountFragmentFull }\n\t}\n\t","\n"]);return un=function(){return t},t}function sn(){var t=Object(v.a)(["\n\tfragment accountFragmentFull on Account {\n\t\t...accountFragmentBasic\n\t\tbalance\n\t\tname\n\t\tnumber\n\t}\n\t","\n"]);return sn=function(){return t},t}function dn(){var t=Object(v.a)(["\n\tfragment accountFragmentBasic on Account {\n\t\tid\n\t}\n"]);return dn=function(){return t},t}var mn=E()(dn()),fn=E()(sn(),mn),pn=E()(un(),fn);function bn(){var t=Object(v.a)(["\n\tmutation Login($email: String!, $password: String!) {\n\t\tlogin(email: $email, password: $password) {\n\t\t\ttoken\n\t\t}\n\t}\n"]);return bn=function(){return t},t}function gn(){var t=Object(v.a)(["\n\tquery MeLocal {\n\t\tme @client {\n\t\t\tperson {\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t\tamoName\n\t\t\t}\n\t\t}\n\t}\n"]);return gn=function(){return t},t}function vn(){var t=Object(v.a)(["\n\tquery Me {\n\t\tme {\n\t\t\tid\n\t\t\temail\n\t\t\tperson {\n\t\t\t\tid\n\t\t\t\tfName\n\t\t\t\tlName\n\t\t\t\tamoName\n\t\t\t\texec {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t}\n\t\t\trole\n\t\t\taccount { ...accountFragmentFull }\n\t\t\taccounts { ...accountFragmentFull }\n\t\t}\n\t}\n\t","\n"]);return vn=function(){return t},t}function hn(){var t=Object(v.a)(["\n\tfragment userFragmentBasic on User {\n\t\tid\n\t\tperson {\n\t\t\tid\n\t\t\tamoName\n\t\t}\n\t}\n"]);return hn=function(){return t},t}var En=E()(hn()),yn=E()(vn(),fn),On=E()(gn()),jn=E()(bn()),xn=n(1094);function wn(){var t=Object(v.a)(["\n\tmax-width: 350px !important;\n\tmargin: auto !important;\n"]);return wn=function(){return t},t}function kn(){var t=Object(v.a)(["\n\tdisplay: inline;\n\tpadding: 0 1rem !important;\n"]);return kn=function(){return t},t}function Cn(){var t=Object(v.a)(["\n\tborder-bottom: 1px solid #7e7e81;\n"]);return Cn=function(){return t},t}var Fn=At.b.div(Cn()),In=Object(At.b)(Wt.a)(kn()),Sn=Object(At.b)(xn.a)(wn());function Dn(t){var e=t.refreshToken,n=Object(r.useState)(""),o=Object(qe.a)(n,2),i=o[0],c=o[1],l=Object(r.useState)(""),u=Object(qe.a)(l,2),s=u[0],d=u[1],m=ln(jn,{variables:{email:i,password:s},successMsg:null}),f=Object(qe.a)(m,2),p=f[0],b=f[1],g=b.loading,v=b.error;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Fn,null,a.a.createElement(In,{size:"large"},a.a.createElement("i",null,"\u041a\u043e\u043b\u043c\u0435\u0445"))),a.a.createElement(Sn,{basic:!0},a.a.createElement(Yt.a,{error:!!v},a.a.createElement(Yt.a.Field,null,a.a.createElement("label",null,"E-mail"),a.a.createElement("input",{type:"email",placeholder:"E-mail",onChange:function(t){var e=t.target.value;return c(e)}})),a.a.createElement(Yt.a.Field,null,a.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),a.a.createElement("input",{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(t){var e=t.target.value;return d(e)}})),a.a.createElement(Kt.a,{error:!0,header:"\u0412\u043e\u0439\u0442\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:v}),a.a.createElement(Ht.a,{primary:!0,type:"submit",floated:"right",disabled:!i||!s||g,loading:g,onClick:Object(an.a)(rn.a.mark(function t(){var n;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:n=t.sent,e(n.data.login.token);case 4:case"end":return t.stop()}},t)}))},"\u0412\u043e\u0439\u0442\u0438"))))}var qn=a.a.createContext(),Mn=qn;function Bn(t){var e=t.children,n=t.apolloClient,o=Object(r.useState)(localStorage.getItem(b)),i=Object(qe.a)(o,2),c=i[0],l=i[1];Object(r.useEffect)(function(){u()},[]);var u=function(){try{var t=localStorage.getItem(b);if(null!==t&&void 0!==t)en(t)?s(null):l(t)}catch(e){console.log("bootStrapData error")}},s=function(t){t?localStorage.setItem(b,t):(localStorage.removeItem(b),console.log("apolloClient > ",n),n&&n.resetStore()),l(t)};return a.a.createElement(qn.Provider,{value:{refreshToken:s}},c?e:a.a.createElement(Dn,{refreshToken:s}))}var Pn=n(1093),Ln=n(1096),Nn=n(1097),Tn=n(1091),$n=a.a.createContext(),Rn=n(16),An=n(21),zn=n(20),Vn=n(18),Wn=n(19),Qn=n(1099),Hn=n(46),Kn=n(1089),Un=n(1080);function _n(){var t=Object(v.a)(["\n  height: 36px;\n\tdisplay: flex;\n\talign-items: center;\n\tborder-bottom: 1px solid #7e7e81;\n  background: white;\n"]);return _n=function(){return t},t}var Gn=At.b.div(_n()),Xn=function(t){var e=t.children,n=t.title,o=t.titleLinkTo,i=Object(r.useContext)(Mn).refreshToken;return a.a.createElement(Gn,null,a.a.createElement(Un.a,{to:o||"",onClick:o?void 0:function(t){return t.preventDefault()}},a.a.createElement(ye,{inline:!0,size:"medium",content:n})),e,a.a.createElement(Ue.b,{query:On},function(t){var e=t.data;if(e&&e.me){var n=e.me.person,r=n.fName,o=n.lName,i=n.amoName,c=i?i.split(" ")[0]:o||r;return a.a.createElement(ye,{inline:!0,ml:"auto",size:"small",content:c})}return null}),a.a.createElement(Qt.a,{link:!0,name:"log out",size:"large",onClick:function(){return i(null)}}))},Yn=Hn(Object(Qn.a)(x,w),Object(Qn.a)(k,{name:"setLayout"}),Object(Qn.a)(C,{name:"setExpanded"}),Object(Qn.a)(Bt,{props:function(t){return{lists:t.data.lists||{}}}}),Object(Qn.a)(Pt,{name:"setList"}))(function(t){var e=t.children,n=t.layout,r=n.details,a=n.extra,o=n.bottomPanel,i=t.setLayout,c=t.setExpanded,l=t.lists.selectedProdIds,u=t.setList;return e({details:r,extra:a,bottomPanel:o,setDetails:function(t){return i({variables:{input:{details:t,extra:null}}})},setExtra:function(t){return i({variables:{input:{extra:t}}})},setBottomPanel:function(t){return i({variables:{input:{bottomPanel:t}}})},setExpanded:function(t){return c({variables:{args:t}})},selectedProdIds:l,setSelectedProdIds:function(t){return u({variables:{name:"selectedProdIds",value:t}})}})});function Jn(){var t=Object(v.a)(["\n\talign-self: stretch;\n\tposition: relative;\n\tmargin-left: 10px;\n\tpadding: 0 1em;\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: #f5f6f7;\n\tborder-top-right-radius: .35rem;\n\tborder-bottom-right-radius: .35rem;\n\t::before {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tleft: 0;\n\t\tbackground-color: #fff;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(-50%) rotate(-45deg);\n\t}\n\t/* ::after {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tcontent: '';\n\t\ttop: 50%;\n\t\tright: 0;\n\t\tbackground-color: #f3f4f5;\n\t\twidth: 1.74em;\n\t\theight: 1.74em;\n\t\ttransform: translateY(-50%) translateX(50%) rotate(-45deg);\n\t} */\n"]);return Jn=function(){return t},t}var Zn=At.b.div(Jn()),tr=Hn(Object(Qn.a)(k,{name:"setLayout"}),Object(Qn.a)(x,w))(function(){return a.a.createElement(Yn,null,function(t){var e=t.details,n=e.type,r=e.id,o=e.enquiryId,i=t.setDetails;return a.a.createElement(Ue.b,{query:kt,variables:{id:"Enquiry"===n?r:o}},function(t){var e=t.data;if(e&&e.enquiryLocal){var o=e.enquiryLocal,c=o.num,l=!o.docs.some(function(t){return"CO"===t.type});return a.a.createElement(Zn,null,a.a.createElement(ye,{inline:!0,c:"rgba(0,0,0,.68)",size:"medium",content:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116".concat(c)}),a.a.createElement(Fe,{position:"bottom left",size:"small",flowing:!0,showIf:l,trigger:a.a.createElement(ge,{inline:!0},a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,ml:"0",activeColor:"green",icon:"plus",content:"\u0417\u0430\u043a\u0430\u0437",active:"Order"===n&&"new"===r,disabled:l,onClick:function(){return i({type:"Order",id:"new",enquiryId:r})}}))},a.a.createElement(Ut.a.Header,{content:"\u041d\u0435 \u0432\u0441\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b"}),a.a.createElement(Ut.a.Content,null,a.a.createElement(Qt.a,{name:"cancel",color:"red"}),"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f")))}return null})})}),er=function(t){var e=t.refetchEnquiries,n=t.enquiriesAreLoading;return a.a.createElement(Yn,null,function(t){var r=t.details,o=t.setDetails;return a.a.createElement(Xn,{title:"\u0417\u0430\u044f\u0432\u043a\u0438 \u0438 \u0437\u0430\u043a\u0430\u0437\u044b"},a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,w:"118.5px",ml:"0",ta:"left",activeColor:"blue",onClick:e},a.a.createElement(Qt.a,{name:"refresh",color:n?"blue":void 0,loading:n}),n?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430":"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",content:"\u0417\u0430\u044f\u0432\u043a\u0430",active:r&&"Enquiry"===r.type&&"new"===r.id,onClick:function(){return o({type:"Enquiry",id:"new"})}}),r&&("Enquiry"===r.type&&"new"!==r.id||"Order"===r.type&&"new"===r.id)&&a.a.createElement(tr,null))})},nr=n(22);function rr(){var t=Object(v.a)(["\n\t/* overflow-y: auto;\n  overflow-x: hidden; */\n"]);return rr=function(){return t},t}function ar(){var t=Object(v.a)(["\n\tpadding-right: 4px;\n\t// @ts-ignore\n\t","\n"]);return ar=function(){return t},t}function or(){var t=Object(v.a)(["\n\tcolor: rgba(0,0,0,.8);\n\tline-height: 1.5em;\n\tbackground: rgb(233, 234, 235);\n\tborder-top: 1px solid #d4d4d5;\n\t/* "," */\n\tborder-bottom: 1px solid #d4d4d5;\n\tfont-weight: bold;\n"]);return or=function(){return t},t}function ir(){var t=Object(v.a)(["\n\ttable-layout: fixed;\n\twidth: 100%;\n\tborder-collapse: collapse;\n\t/* TODO Make this table with scrollable tbody (Not trivial css trick) */\n\t/* thead, tbody, tr {\n\t\tdisplay: block;\n\t} */\n"]);return ir=function(){return t},t}var cr=At.b.table(ir()),lr=At.b.tr(or(),function(t){return t.noTopBorder?"":"border-top: 1px solid #d4d4d5;"}),ur=At.b.td(ar(),function(t){return t.w&&"width: ".concat(t.w,";")}),sr=At.b.tbody(rr()),dr=function(t){var e=t.children,n=(t.expand,t.fields),o=t.indent,i=t.noServiceField,c=(t.noTopBorder,!!o),u=!!i,s=!!t.select,d=[].concat(Object(nr.a)(c?[{name:"indent",width:o}]:[]),Object(nr.a)(u?[]:[{name:"service",width:"28px"}]),Object(nr.a)(s?[{name:"select",width:"28px"}]:[]),Object(nr.a)(n),[{name:"lastField"}]);return a.a.createElement(cr,null,a.a.createElement("thead",null,a.a.createElement(lr,{className:"fz-tableHeaderRow"},d.map(function(t){return a.a.createElement(ur,{key:t.name,w:t.width},t.title)}))),a.a.createElement(sr,null,a.a.createElement(r.Fragment,null,e({tableFields:d.map(function(t){var e=Object(l.a)({},t);return delete e.width,delete e.title,e})}))))},mr=n(504),fr=function(t){var e=t.number;return"rus"===t.country?"+7 "+Object(mr.conformToMask)(e,["(",/\d/,/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,"-",/\d/,/\d/,"-",/\d/,/\d/],{guide:!1}).conformedValue:"+ "+e},pr=function(t,e){if(!t&&0!==t)return"- \u20bd";var n=t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$& ").replace(/\./,",");return e||(n=n.slice(0,-3)),n+" \u20bd"},br=Number.isNaN||function(t){return t!==t};function gr(){var t=Object(v.a)(["\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tbox-sizing: content-box;\n\t/*\n\t// horizontal overlay\n\t:hover {\n\t\twidth: max-content;\n\t\toverflow: unset;\n\t\tbackground-color: white;\n\t} */\n\t/* vertical overlay */\n\t:hover {\n\t\tposition: absolute;\n\t\ttop: 1px;\n\t\tleft: -4px;\n\t\twidth: 100%;\n\t\tz-index: 1;\n\t\toverflow: unset;\n\t\twhite-space: normal;\n\t\tbackground-color: white;\n\t\tborder: 5px solid rgb(242,242,242);\n    border-top: none;\n\t}\n"]);return gr=function(){return t},t}function vr(){var t=Object(v.a)(["\n\tpadding-right: 4px;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\t","\n\t","\n\t",":not(:hover) & {\n\t\t","\n\t}\n\t","\n\t","\n\t","\n"]);return vr=function(){return t},t}function hr(){var t=Object(v.a)(["\n\tvertical-align: unset;\n\tfont-size: 1rem;\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return hr=function(){return t},t}var Er=At.b.tr(hr(),function(t){return!t.noRowHover&&"\n\t\t:hover {\n\t\t\tbackground: ".concat(t.lightRowHower?"rgb(250, 250, 250)":"rgb(242, 242, 242)",";\n\t\t\tcolor: rgba(0,0,0,.95);\n\t\t}\n\t")},function(t){return!!t.onClick&&"cursor: pointer;"},function(t){return t.lineHeight&&"\n\t\tline-height: ".concat(t.lineHeight,";\n\t")},function(t){return t.secondary&&"\n\t\tbackground: rgba(0,0,50,.02);\n\t\t".concat(t.lastSecondaryRow?"":"border-bottom: none;","\n\t")},function(t){return t.active&&"\n\t\tbackground: rgba(0,0,0,.05);\n\t\tfont-weight: bold;\n\t\tborder-top: 1px solid rgba(34, 36, 38, 0.15);\n\t\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\t"},function(t){return t.bold&&"\n\t\tfont-weight: bold;\n\t"}),yr="\n\tbackground: rgba(0,0,0,.12);\n\topacity: 1 !important;\n\t.icon {\n\t\topacity: 1 !important;\n\t}\n",Or=At.b.td(vr(),function(t){return!!t.onClick&&"cursor: pointer;"},function(t){return t.service&&"padding-left: 3px;"},Er,function(t){return t.hoverable&&t.hideUnhovered&&!t.active&&!t.hasEntries&&"\n\t\t\topacity: 0 !important;\n\t\t"},function(t){return t.color&&"color: ".concat(t.color,";")},function(t){return t.truncated&&"position: relative"},function(t){return t.hoverable&&"\n\t\ttransition: background .3s ease;\n\t\t".concat(t.hideUnhovered&&"\n\t\t\topacity: 0.8;\n\t\t\tpadding-left: ".concat(t.hasEntries?"5px":"7.5px",";\n\t\t"),";\n\t\t:hover {\n\t\t\t").concat(yr,"\n\t\t}\n\t\t").concat(t.active?yr:"","\n\t")}),jr=At.b.div(gr()),xr=function(t){var e=t.tableFields,n=t.rowFields,r=void 0===n?[]:n,o=t.entity,i=t.expandFor,c=t.expanded,u=t.expand,s=t.select,d=Object(Vt.a)(t,["tableFields","rowFields","entity","expandFor","expanded","expand","select"]),m=e.map(function(t){var e=r.find(function(e){return e.name===t.name});return e?Object(l.a)({},t,e):t}),f=o.selected,p=o.disabled;return a.a.createElement(Er,d,m.map(function(t){if("service"===t.name&&"undefined"!==typeof c&&o[i].length)return a.a.createElement(Or,{service:!0,key:t.name,onClick:function(t){t.stopPropagation(),u()}},a.a.createElement(je,{active:c?1:0}));if("select"===t.name&&"undefined"!==typeof s)return a.a.createElement(Or,{key:t.name,service:!0,onClick:function(t){t.stopPropagation(),s()}},a.a.createElement(Qt.a,{disabled:p,name:"partly"===f?"square":f?"check square outline":"square outline"}));var e=t.component,n=t.content,r=t.name,l=t.value,d=t.path,m=t.icon,b=t.iconColor,g=t.onClick,v=Object(Vt.a)(t,["component","content","name","value","path","icon","iconColor","onClick"]);if(e||n)return a.a.createElement(Or,Object.assign({key:r},v,{onClick:g?function(t){t.stopPropagation(),g()}:void 0}),e&&e,n||null);var h=l||(d?function(t,e){for(var n=e.split("."),r=0;r<n.length;r++)if(!(t=t[n[r]]))return;return t}(o,d):null);return h&&"amount"===r&&(h=pr(h)),a.a.createElement(Or,Object.assign({key:r},v,{onClick:g?function(t){t.stopPropagation(),g()}:void 0}),h&&m&&a.a.createElement(Qt.a,{link:!!g,name:m,color:b||void 0}),t.truncated?a.a.createElement(jr,null,h):h)}))},wr=[{name:"num",path:"num",title:"\u2116",width:"45px"},{name:"date",path:"dateLocal",title:"\u0414\u0430\u0442\u0430",width:"110px"},{name:"org",path:"org.name",title:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f",width:"225px",truncated:!0},{name:"emps",path:"org.name",width:"50px"},{name:"model",path:"model.name",title:"\u0418\u0437\u0434\u0435\u043b\u0438\u0435",width:"250px"},{name:"qty",path:"qty",title:"\u041a\u043e\u043b.",width:"50px"},{name:"reserved",title:"\u0420\u0435\u0437.",width:"50px"},{name:"amount",title:"\u0421\u0443\u043c\u043c\u0430",width:"105px"},{name:"status",path:"status.name",title:"\u0421\u0442\u0430\u0442\u0443\u0441",width:"130px"}],kr=function(t){var e=t.enquiries;return a.a.createElement(Yn,null,function(t){var n=t.details,o=(t.extra,t.setDetails),i=t.bottomPanel,c=t.setBottomPanel,l=t.setExpanded;return a.a.createElement(dr,{fields:wr},function(t){var u=t.tableFields;return e.map(function(t){var e=t.id,s=t.org,d=t.docs,m=t.isExpanded,f=t.model,p=t.orders,b=n&&"Enquiry"===n.type&&e===n.id;return a.a.createElement(r.Fragment,{key:e},a.a.createElement(xr,{lineHeight:"21px",entity:t,tableFields:u,rowFields:[{name:"amount",value:d.length&&d[d.length-1].amount},{name:"emps",icon:s.employees.length?"user":"user plus",iconColor:"grey",hoverable:!0,hideUnhovered:!0,hasEntries:!!s.employees.length,value:s.employees.length||" ",onClick:function(){c({type:"Employees",orgId:s.id})},active:i&&"Employees"===i.type&&i.orgId===s.id},{name:"model",content:a.a.createElement(ge,{d:"flex"},a.a.createElement(ge,{minw:"215px"},f.name),!!f.drawings.length&&a.a.createElement(Oe,{mr:"5px",o:".6",name:"image outline",color:"grey",size:"large"})),hoverable:!0,onClick:function(){o({type:"Model",id:f.id})},active:n&&"Model"===n.type&&n.id===f.id},{name:"reserved",value:p.reduce(function(t,e){return t+e.prods.length},0)}],expandFor:"orders",expanded:m,expand:function(){l({id:e,value:!m})},active:b,onClick:function(){o({type:"Enquiry",id:e}),l({id:e,value:!b||!m})}}),m&&p.map(function(e,r){var i=e.id,c=e.prods;return a.a.createElement(xr,{key:i,secondary:1,lastSecondaryRow:r===t.orders.length-1?1:0,entity:e,tableFields:u,rowFields:[{name:"num",path:"fullnum"},{name:"org",value:t.org.name},{name:"model",value:t.model&&t.model.name},{name:"reserved",value:c.length},{name:"amount",path:"amount"}],active:n&&"Order"===n.type&&i===n.id,onClick:function(){o({type:"Order",id:i})}})}))})})})},Cr=Hn(Object(Qn.a)(wt,{name:"query1",skip:function(t){return"Enquiry"!==t.type}}),Object(Qn.a)(T,{name:"query2",skip:function(t){return"Order"!==t.type}}),Object(Qn.a)(dt,{name:"query3",skip:function(t){return"Model"!==t.type}}),Object(Qn.a)(kt,{name:"localQuery1",skip:function(t){var e=t.type,n=t.id;return"Enquiry"!==e||"new"===n}}),Object(Qn.a)(N,{name:"localQuery2",skip:function(t){var e=t.type,n=t.id;return"Order"!==e||"new"===n}}),Object(Qn.a)(st,{name:"localQuery3",skip:function(t){var e=t.type,n=t.id;return"Model"!==e||"new"===n}}))(function(t){var e=t.children,n=t.type,r=t.id,a=t.query1,o=t.query2,i=t.query3,c=t.localQuery1,l=t.localQuery2,u=t.localQuery3,s=a||o||i,d=c||l||u;return e({loading:s.loading,error:s.error,refetch:s.refetch,entity:"Enquiry"===n?s.enquiry:"Order"===n?s.order:"Model"===n?s.model:null,localEntity:"new"===r?null:"Enquiry"===n?d.enquiryLocal:"Order"===n?d.orderLocal:"Model"===n?d.modelLocal:null})});function Fr(){var t=Object(v.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Fr=function(){return t},t}function Ir(){var t=Object(v.a)(["\n\t&&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return Ir=function(){return t},t}var Sr=Object(At.b)(Qt.a)(Ir()),Dr=Object(At.b)(je)(Fr()),qr=Object(r.forwardRef)(function(t,e){var n=t.children,r=t.size,o=t.bottomBorder,i=t.close,c=t.expanded,u=t.disabled,s=t.onClick,d=t.noIndent,m=Object(l.a)({},i&&{close:!0},"undefined"!==typeof c&&{expand:!0});return a.a.createElement(Ce,{ref:e,bc:"white",head:!0,noLP:!0,noIndent:d,bottomBorder:o||!0,size:r||void 0,onClick:s},m.close?a.a.createElement(Sr,{link:!0,size:"big",name:"cancel",onClick:i}):m.expand?a.a.createElement(Dr,{size:"large",active:c?1:0,disabled:u}):null,n)}),Mr=function(t){var e=t.content;return a.a.createElement(he,{ml:"10px",fs:"1rem",c:"rgba(0,0,0,.6)",ws:"0.5em"},e)},Br=function(t){var e=t.title,n=t.subtitle,r=t.size;return a.a.createElement(ye,{m:"0",size:r||"medium"},e,(n||0===n)&&a.a.createElement(Mr,{content:n}))},Pr=function(t){var e=t.children;return a.a.createElement(ge,{ml:"auto"},e)};function Lr(){var t=Object(v.a)(["\n\tpadding: .78571429em !important;\n\t&>i {\n\t\topacity: .9 !important;\n\t\tmargin: 0 !important;\n\t}\n"]);return Lr=function(){return t},t}var Nr=Object(At.b)(xe)(Lr()),Tr=function(t){var e=t.loading,n=t.onClick;return a.a.createElement(Nr,{activeColor:"blue",active:e,onClick:n},a.a.createElement(Qt.a,{name:"refresh",loading:e}))},$r={Enquiry:{titleNew:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u044f\u0432\u043a\u0430",titleExisting:"\u0417\u0430\u044f\u0432\u043a\u0430 \u2116"},Order:{titleNew:"\u041d\u043e\u0432\u044b\u0439 \u0437\u0430\u043a\u0430\u0437",titleExisting:"\u0417\u0430\u043a\u0430\u0437 \u2116"},Model:{titleNew:"\u041d\u043e\u0432\u043e\u0435 \u0438\u0437\u0434\u0435\u043b\u0438\u0435",titleExisting:""}},Rr=function(t){var e=t.type,n=t.closeDetails,r=t.loading,o=t.refresh,i=t.setDetails,c=t.editMode,l=t.localEntity,u=l||{},s=u.id,d=u.num,m=u.fullnum,f=u.name,p=u.article,b=u.dateLocal;return a.a.createElement(qr,{close:n},!s&&a.a.createElement(Br,{title:$r[e].titleNew}),s&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Br,{title:"Model"===e?f:$r[e].titleExisting+" "+(d||m),subtitle:"Model"===e?p?"\u0410\u0440\u0442\u0438\u043a\u0443\u043b: ".concat(p):"":"\u043e\u0442 "+b}),a.a.createElement(Pr,null,a.a.createElement(Tr,{loading:r,onClick:o}),a.a.createElement(xe,{icon:"edit",activeColor:"blue",active:c||!1,onClick:function(){return i({type:e,id:l.id,editMode:!0})}}))))};function Ar(){var t=Object(v.a)(["\n\tfont-weight: unset !important;\n\t/* padding-bottom: 0 !important; */\n"]);return Ar=function(){return t},t}function zr(){var t=Object(v.a)(["\n\tpadding-top: 0 !important;\n"]);return zr=function(){return t},t}function Vr(){var t=Object(v.a)(["\n  :nth-child(1) {\n\t\twidth: ",";\n\t// color: rgba(0,0,0,.87);\n\t/* font-size: .92857143em; */\n\t/* line-height: 32px; */\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n\t\tvertical-align: top;\n  }\n  :nth-child(2) {\n\t\t// width: 100px;\n\t\tfont-size: 1em;\n\t\tfont-weight: bold;\n\t\tline-height: 1.21428571em;\n\t\tpadding: .67857143em 0;\n  }\n"]);return Vr=function(){return t},t}function Wr(){var t=Object(v.a)(["\n  margin: 0 0 1em;\n  line-height: 1.4285em;\n  color: rgba(0,0,0,.87);\n"]);return Wr=function(){return t},t}function Qr(){var t=Object(v.a)(["\n\t/* table-layout: fixed; */\n\twidth: 100%;\n\tborder-collapse: collapse;\n"]);return Qr=function(){return t},t}var Hr=At.b.table(Qr()),Kr=At.b.tr(Wr()),Ur=At.b.td(Vr(),function(t){return t.theme.widths.formLabel}),_r=Object(At.b)(Ur)(zr()),Gr=Object(At.b)(_r)(Ar()),Xr=n(1085),Yr=n(160),Jr=n(66),Zr=(n(769),n(505)),ta=function(t){function e(t){var n,r;if(Object(Rn.a)(this,e),(n=Object(zn.a)(this,Object(Vn.a)(e).call(this,t))).onChange=function(t){n.setState({editorState:t});var e=t.getCurrentContent(),r=n.props,a=r.setEditorHasText,o=r.setEditorDiff,i=r.setHasFocus;t&&a&&a(e.hasText()),o&&o(e!==n.state.oriContent),i&&i(t.getSelection().getHasFocus())},n.kolmechKeyBindingFn=function(t){return 13===t.keyCode&&Jr.KeyBindingUtil.hasCommandModifier(t)?"ctrlEnter":Object(Jr.getDefaultKeyBinding)(t)},n.handleKeyCommand=function(t,e){if("ctrlEnter"===t)return n.props.onCtrlEnter(),"handled";var r=Jr.RichUtils.handleKeyCommand(e,t);return r?(n.onChange(r),"handled"):"not-handled"},n.clear=function(){return n.setState({editorState:Jr.EditorState.push(n.state.editorState,Jr.ContentState.createFromText(""),"remove-range")})},n.exportHtml=function(){var t=Object(Zr.stateToHTML)(n.state.editorState.getCurrentContent());return Object(Jr.convertFromHTML)(t).contentBlocks?t:null},t.initFromHtml){var a=Object(Jr.convertFromHTML)(t.initFromHtml);r=Jr.EditorState.createWithContent(Jr.ContentState.createFromBlockArray(a.contentBlocks,a.entityMap))}else r=Jr.EditorState.createEmpty();return n.state={editorState:r,oriContent:r.getCurrentContent()},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return a.a.createElement(Jr.Editor,{editorState:this.state.editorState,onChange:this.onChange,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.kolmechKeyBindingFn,readOnly:this.props.readOnly})}}]),e}(a.a.Component);function ea(){var t=Object(v.a)(["\n\tpadding: calc(0.678571em - 1px) 1em;\n\tline-height: 1.4285em;\n\tborder: 1px solid rgba(34,36,38,.15);\n\tborder-radius: .28571429rem;\n\ttransition: all .1s ease;\n\t","\n"]);return ea=function(){return t},t}var na=At.b.div(ea(),function(t){var e=t.borderless,n=t.hasFocus,r=t.diff;return e&&!n&&!r&&"\n\t\t\tmargin-left: -1em;\n\t\t\tborder: 1px solid white;\n\t\t\t:hover {\n\t\t\t\tbackground: rgba(0,0,0,.05);\n\t\t\t\tcolor: rgba(0,0,0,.65);\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t"}),ra=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={hasFocus:!1},n.setHasFocus=function(t){return n.setState({hasFocus:t})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.state.hasFocus,e=this.props,n=e.borderless,r=e.diff,o=e.forwardedRef,i=Object(Vt.a)(e,["borderless","diff","forwardedRef"]);return a.a.createElement(na,{borderless:n,hasFocus:t,diff:r},a.a.createElement(ta,Object.assign({ref:o,setHasFocus:this.setHasFocus},i)))}}]),e}(r.Component),aa=a.a.forwardRef(function(t,e){return a.a.createElement(ra,Object.assign({forwardedRef:e},t))}),oa=n(506),ia=n(65),ca=n(115),la=n.n(ca),ua=function(t,e){var n=!1;if("number"===typeof t?t=t.toString():"string"!==typeof t&&(t=""),t.length)if(/[^0-9]/.test(t))e.code=2,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0446\u0438\u0444\u0440";else if(-1===[10,12].indexOf(t.length))e.code=3,e.message="\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 10 \u0438\u043b\u0438 12 \u0446\u0438\u0444\u0440";else{var r=function(t,e){var n=0;for(var r in e)n+=e[r]*t[r];return parseInt(n%11%10)};switch(t.length){case 10:r(t,[2,4,10,3,5,9,4,6,8])===parseInt(t[9])&&(n=!0);break;case 12:var a=r(t,[7,2,4,10,3,5,9,4,6,8]),o=r(t,[3,7,2,4,10,3,5,9,4,6,8]);a===parseInt(t[10])&&o===parseInt(t[11])&&(n=!0)}n||(e.code=4,e.message="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0418\u041d\u041d")}else e.code=1,e.message="\u0418\u041d\u041d \u043f\u0443\u0441\u0442";return n},sa=function(t){return t instanceof Date&&!isNaN(t.valueOf())},da=function(t){return sa(new Date(Date.parse(t)))&&10===t.length},ma=6e4*(new Date).getTimezoneOffset(),fa=function(t){return new Date(t.getTime()-ma).toISOString()},pa=function(t){return fa(t).slice(0,10)},ba=function(t){return fa(t).slice(0,16)},ga=function(t){return new Date(Date.parse(t)+ma)};function va(){var t=Object(v.a)(["\n\tfragment opTypeFragmentBasic on OpType {\n\t\tid\n\t\tlaborCost\n\t\tlaborPrice\n\t\tname\n\t\topClass\n\t}\n"]);return va=function(){return t},t}var ha=E()(va());function Ea(){var t=Object(v.a)(["\n\tmutation upsertOrg($input: OrgInput!) {\n\t\tupsertOrg(input: $input) {\n\t\t\t...orgExecFragment\n\t\t}\n\t}\n\t","\n"]);return Ea=function(){return t},t}function ya(){var t=Object(v.a)(["\n\tquery orgDetails ($id: ID!) {\n\t\torgDetails (id: $id) {\n\t\t\t...OrgFragmentFull\n\t\t}\n\t}\n\t","\n"]);return ya=function(){return t},t}function Oa(){var t=Object(v.a)(["\n\tquery OrgLocal ($id: ID!) {\n\t\torgLocal (id: $id) {\n\t\t\t...OrgFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return Oa=function(){return t},t}function ja(){var t=Object(v.a)(["\n\tmutation mergeOrg($id: ID!, $inn: String!) {\n\t\tmergeOrg(id: $id, inn: $inn) {\n\t\t\t...OrgFragmentFull\n\t\t}\n\t}\n\t","\n"]);return ja=function(){return t},t}function xa(){var t=Object(v.a)(["\n\tmutation createOrg($inn: String!) {\n\t\tcreateOrg(inn: $inn) {\n\t\t\t...OrgFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return xa=function(){return t},t}function wa(){var t=Object(v.a)(["\n\tmutation createPostEnvelopeAddressInsert($orgId: ID!) {\n\t\tcreatePostEnvelopeAddressInsert(orgId: $orgId) {\n\t\t\tstatusText\n\t\t}\n\t}\n"]);return wa=function(){return t},t}function ka(){var t=Object(v.a)(["\n\tmutation createContract($id: ID!, $date: String) {\n\t\tcreateContract(id: $id, date: $date) {\n\t\t\tstatusText\n\t\t}\n\t}\n"]);return ka=function(){return t},t}function Ca(){var t=Object(v.a)(["\n\tquery allOrgs {\n\t\torgs {\n\t\t\t...OrgFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return Ca=function(){return t},t}function Fa(){var t=Object(v.a)(["\n\tquery org ($id: ID!) {\n\t\torg (id: $id) {\n\t\t\t...OrgFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return Fa=function(){return t},t}function Ia(){var t=Object(v.a)(["\n\tfragment orgExecFragment on Org {\n\t\tid\n\t\tname\n\t\texec {\n\t\t\tid\n\t\t\topTypes { ...opTypeFragmentBasic }\n\t\t}\n\t}\n\t","\n"]);return Ia=function(){return t},t}function Sa(){var t=Object(v.a)(["\n\tfragment OrgFragmentFull on Org {\n\t\t...OrgFragmentBasic\n\t}\n\t","\n"]);return Sa=function(){return t},t}function Da(){var t=Object(v.a)(["\n\tfragment OrgFragmentBasic on Org {\n\t\tid\n\t\tinn\n\t\tname\n\t}\n"]);return Da=function(){return t},t}var qa=E()(Da()),Ma=E()(Sa(),qa),Ba=E()(Ia(),ha),Pa=(E()(Fa(),qa),E()(Ca(),qa),E()(ka())),La=E()(wa()),Na=E()(xa(),qa),Ta=E()(ja(),Ma),$a=E()(Oa(),qa),Ra=E()(ya(),Ma),Aa=E()(Ea(),Ba);function za(){var t=Object(v.a)(["\n    query AllOrgsAndModels {\n        orgs {\n            id\n            inn\n            name\n        }\n        models {\n            id\n            article\n            name\n        }\n    }\n"]);return za=function(){return t},t}var Va=E()(za()),Wa=n(216),Qa=n.n(Wa);n(412);function Ha(){var t=Object(v.a)(["\n\tdisplay: inline-block;\n\twidth: 180px;\n\t","\n\tinput {\n\t\tcursor: pointer;\n\t\tvertical-align: unset !important;\n\t\tpadding-left: 3.5rem !important;\n\t\t&:focus {\n\t\t\tcursor: text;\n\t\t}\n\t}\n"]);return Ha=function(){return t},t}var Ka=At.b.div(Ha(),function(t){return t.error&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),Ua=function(t){var e=t.selectedDate,n=t.selectDay,o=(t.error,Object(r.useRef)(null)),i=Object(r.useState)(e||new Date),c=Object(qe.a)(i,2),l=c[0],u=c[1],s=Object(r.useState)(fa(l).slice(0,10)),d=Object(qe.a)(s,2),m=d[0],f=d[1],p=Object(r.useState)(""),b=Object(qe.a)(p,2),g=b[0],v=b[1];return Object(r.useEffect)(function(){console.log("useEffect > ")||u(e)||f(fa(e).slice(0,10))},[e]),console.log(" render > date, input, err > ",l,m,g),a.a.createElement(Ka,{error:g},a.a.createElement(Ht.a,{onClick:function(){return f(m.slice(0,-1))}},"Click ME!"),a.a.createElement(Qa.a,{ref:o,value:m,onDayChange:function(t){console.log("onDateChange > ")||da(o.current.input.value)?v("")||u(t):v("Provided date is not valid")},onDayPickerHide:function(){return console.log("onDayPickerHide > "),console.log("selectedDate > ",e),console.log("toLocalISOString(selectedDate).slice(0, 10) > ",fa(e).slice(0,10)),console.log("inputRef.current.input.value > ",o.current.input.value),console.log("isValidDateString(inputRef.current.input.value) > ",da(o.current.input.value)),console.log("((date.getTime() !== selectedDate.getTime()) > ",l.getTime()!==e.getTime()),l.getTime()!==e.getTime()&&da(o.current.input.value)?console.log("selectDay > ")||n(l):console.log("setDate & input > ")||u(e)||f(fa(e).slice(0,10))||v("")||(o.current.input.value=fa(e).slice(0,10))},dayPickerProps:{firstDayOfWeek:1,month:e}}))},_a=function(t){var e=t.title,n=t.content,r=t.onClose;return a.a.createElement(ge,{m:"0 -1em 1em -55px"},a.a.createElement(Ce,{head:!0,minor:!0,secondary:!0,topBorder:!0,bottomBorder:!0,noLP:!!r},!!r&&a.a.createElement(Oe,{bs:"content-box",w:"calc(55px - 1em)",m:"0 0.5em",link:!0,size:"large",name:"close",onClick:r}),a.a.createElement(ye,{m:"0"},e)),a.a.createElement(Ce,{secondary:!0,bottomBorder:!0},n))},Ga=n(43),Xa=function(t,e){var n={};return Ja(e,t,n),n},Ya=function(t,e,n){var r={};return to(n,e,t,r),r},Ja=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;n.id&&(r.id=n.id),Object.keys(e).forEach(function(a){var o=typeof e[a];return"object"===o&&Array.isArray(e[a])?Za(e[a],n[a],r[a]=[]):"object"===o?t(e[a],n[a],r[a]={}):a.endsWith("Id")&&n[a.slice(0,-2)]?r[a]=n[a.slice(0,-2)].id:void(r[a]=n[a]||e[a])})},Za=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if("object"===typeof t[0])return e.length?e.forEach(function(e,r){return Ja(t[0],e,n[r]={})}):Ja(t[0],{},n[0]={})},to=function t(e,n,r,a){r.id&&(a.id=r.id),Object.keys(e).forEach(function(o){var i=typeof e[o];return"object"===i&&Array.isArray(e[o])?eo(e[o],n[o],r[o],a[o]=[]):"object"===i?t(e[o],n[o],r[o],a[o]={}):r[o]!==n[o]?a[o]=r[o]:!r[o]&&e[o]?a[o]=e[o]:void 0})},eo=function(t,e,n,r){if("object"===typeof t[0])return n.forEach(function(n,a){return to(t[0],e[a],n,r[a]={})})},no=function(t){var e={};return ro(t,e),e},ro=function t(e,n){Object.keys(e).forEach(function(r){if("id"===r)return n.id=e.id;if(null!==e[r]){var a=typeof e[r];return"object"===a&&Array.isArray(e[r])?n[r]=ao(e[r]):"object"===a?t(e[r],n[r]={}):void 0}})},ao=function(t){return t.filter(function(t){return"object"===typeof t}).map(function(t){var e={};return ro(t,e),e})},oo=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.indexOf("."),a=e.indexOf("[");if(""===e)return n[n.length-1].last=!0,n;if(r*a===1)return[].concat(Object(nr.a)(n),[{key:e,last:!0}]);if(-1===a||r+1&&r<a)return t(e.slice(r+1),[].concat(Object(nr.a)(n),[{key:e.slice(0,r)}]));if(-1===r||a+1&&a<r){var o=e.indexOf("]");return t(e.slice(o+2),[].concat(Object(nr.a)(n),[{key:e.slice(0,a),array:!0},{key:e.slice(a+1,o),arrayItem:!0}]))}},io=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];oo(e).reduce(function(t,e){var a=e.key,o=e.last,i=e.array,c=e.arrayItem;return!r&&Object.keys(t).filter(function(e){return!("id"===e||e===a||a.startsWith("id=")&&t[e].id===a.slice(3))}).forEach(function(e){c?t[e]={id:t[e].id}:delete t[e]}),c&&"length"===a&&!o?(t[t.length]={},t[t.length-1]):a.startsWith("id=")&&!o?t.find(function(t){return t.id===a.slice(3)}):o?c&&"length"===a?t[t.length]=n:a.startsWith("id=")?t[t.findIndex(function(t){return t.id===a.slice(3)})]=Object(l.a)({},Object.keys(n).length>0&&{id:a.slice(3)},n):t[a]=n:(t[a]||(t[a]=i?[]:{}),t[a])},t)},co=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=oo(e);return Object(Me.a)(t,function(t){a.reduce(function(t,e){var a=e.key,o=e.last,i=e.array,c=e.arrayItem;return Object.keys(t).forEach(function(e){"id"!==e&&e!==a&&(r||(c?t[e]={id:t[e].id}:delete t[e]))}),o?c&&"length"===a?t[t.length]=n:t[a]=n:(t[a]||(t[a]=i?[]:{}),t[a])},t)})},lo=n(36),uo=Object(lo.string)().matches(/^[a-z0-9]{25}$/),so=Object(lo.object)().shape({id:uo.notRequired(),name:Object(lo.string)().trim().min(4).max(255).when("id",function(t,e){return t?e.notRequired():e.required()}),article:Object(lo.string)().trim().min(4).max(10).notRequired()}),mo={name:"",article:""},fo=n(219),po=n.n(fo),bo=function(t){var e=t.placeholder,n=t.name,r=t.value,o=t.setField;return a.a.createElement(a.a.Fragment,null,a.a.createElement(po.a,{customInput:Gt.a,placeholder:e,value:r,decimalSeparator:",",thousandSeparator:" ",decimalScale:2,allowNegative:!1,onValueChange:function(t){return o(n,t.floatValue)}}),a.a.createElement(he,{pl:"6px",fs:"1.3rem",c:"rgba(0,0,0,.6)"},"\u20bd"))},go=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.formik,n=t.name,r=t.type,o=t.options,i=Object(Vt.a)(t,["formik","name","type","options"]),c=Object(Ga.d)(e.values,n);return o?a.a.createElement(Xt.a,Object.assign({},i,{selection:!0,fluid:!0,search:!0,noResultsMessage:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",value:c,options:o,onChange:function(t,r){var a=r.value;return e.setFieldValue(n,a)}})):n.endsWith("amount")?a.a.createElement(bo,{name:n,value:c,setField:e.setFieldValue}):a.a.createElement(De,Object.assign({},i,{w:"100%",name:n,value:"date"===r?c.slice(0,16):c,error:Object(Ga.d)(e.touched,n)&&!!Object(Ga.d)(e.errors,n),onChange:e.handleChange,onBlur:e.handleBlur}))}}]),e}(r.Component),vo=Object(Ga.c)(go),ho=n(510),Eo=n.n(ho);function yo(){var t=Object(v.a)(["\n  color: ",";\n"]);return yo=function(){return t},t}function Oo(){var t=Object(v.a)(["\n\t&&&&&& {\n    ","\n\t}\n"]);return Oo=function(){return t},t}var jo=[{key:"rus",text:"+7",value:"rus"},{key:"notRus",text:"+",value:"notRus"}],xo=Object(At.b)(function(t){t.inputError;var e=Object(Vt.a)(t,["inputError"]);return a.a.createElement(Xt.a,e)})(Oo(),function(t){return t.inputError&&"\n      border: 1px solid ".concat(t.theme.colors.errorBorder,";\n      border-right-color: transparent;\n    ")}),wo=At.b.div(yo(),function(t){return t.theme.colors.error}),ko=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.baseName,n=t.formik,r=Object(Vt.a)(t,["baseName","formik"]),o=Object(Ga.d)(n.values,e+".number"),i=Object(Ga.d)(n.values,e+".country"),c=Object(Ga.d)(n.touched,e+".number"),l=Object(Ga.d)(n.errors,e),u=function(){return a.a.createElement(xo,{tabIndex:-1,name:e+".country",value:i,options:jo,inputError:c&&!!l,onChange:function(t,e){var r=e.name,a=e.value;return n.setFieldValue(r,a)}})};return a.a.createElement(a.a.Fragment,null,"rus"===i?a.a.createElement(Eo.a,{name:e+".number",mask:"( 999 ) 999-99-99",maskChar:"",value:o,onBlur:n.handleBlur,onChange:n.handleChange},function(t){return a.a.createElement(De,Object.assign({w:"240px !important",error:c&&!!l,label:u()},r,t))}):a.a.createElement(vo,Object.assign({w:"240px !important",name:e+".number",error:c&&!!l,label:u()},r)),a.a.createElement(wo,null,c&&l&&l.number))}}]),e}(r.Component),Co=Object(Ga.c)(ko);function Fo(){var t=Object(v.a)(["\n\tcolor: ",";\n"]);return Fo=function(){return t},t}function Io(){var t=Object(v.a)(["\n\tmax-width: 240px;\n"]);return Io=function(){return t},t}function So(){var t=Object(v.a)(["\n\tflex: 1 1 auto;\n\tmax-width: calc(100% - 122px);\n"]);return So=function(){return t},t}function Do(){var t=Object(v.a)(["\n\tflex: 0 0 122px;\n\tpadding-top: calc(10.5rem/14);\n\tfont-size: calc(13rem/14);\n\tfont-weight: bold;\n\tline-height: 1.21428571rem;\n\t","\n"]);return Do=function(){return t},t}function qo(){var t=Object(v.a)(["\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tmargin-bottom: .67857143rem;\n"]);return qo=function(){return t},t}var Mo=At.b.div(qo()),Bo=At.b.div(Do(),function(t){return t.required&&"\n\t\t::after {\n\t\t\tcontent: '*';\n\t\t\tdisplay: inline-block;\n\t\t\tmargin: -.2em 0 0 .2em;\n\t\t\tvertical-align: top;\n\t\t\tcolor: #db2828;\n\t\t}\n\t"}),Po=At.b.div(So()),Lo=At.b.div(Io()),No=At.b.div(Fo(),function(t){return t.theme.colors.error}),To=Object(Ga.c)(function(t){var e=t.label,n=t.required,o=t.name,i=t.type,c=t.formik,l=(t.inputLabel,t.contentBeforeField),u=Object(Vt.a)(t,["label","required","name","type","formik","inputLabel","contentBeforeField"]),s="person.tels"===o;return a.a.createElement(Mo,null,a.a.createElement(Bo,{className:"fz-formFieldLabel",required:n},e),a.a.createElement(Po,null,s?a.a.createElement(Ga.a,{name:o,render:function(t){return a.a.createElement(a.a.Fragment,null,Object(Ga.d)(c.values,o).map(function(t,e){return a.a.createElement(r.Fragment,{key:e},a.a.createElement(Co,{baseName:"".concat(o,".").concat(e)}))}))}}):a.a.createElement(a.a.Fragment,null,a.a.createElement(Lo,null,l,a.a.createElement(vo,Object.assign({},u,{name:o,type:i}))),a.a.createElement(No,null,Object(Ga.d)(c.touched,o)?Object(Ga.d)(c.errors,o):""))))}),$o=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).didMount=!1,n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"componentDidMount",value:function(){this.didMount=!0}},{key:"componentWillUnmount",value:function(){this.didMount=!1}},{key:"render",value:function(){var t=this,e=this.props,n=e.model,r=e.orgId,o=e.toggleEditMode,i=e.refetchQueries,c=e.onSubmit,u=n?mo:Object(l.a)({},mo,{orgId:r}),s=n?Xa(n,u):u;return a.a.createElement(Ue.a,{mutation:mt,onCompleted:function(){return i()}},function(e,r){var i=r.loading,l=r.error;return a.a.createElement(Ga.b,{initialValues:s,validationSchema:so,onSubmit:function(){var r=Object(an.a)(rn.a.mark(function r(a,i){var l,d;return rn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i.resetForm,l=Ya(a,s,u),r.next=4,e({variables:{input:l}});case 4:return d=r.sent,r.abrupt("return",n?o():t.didMount&&c(d.data.upsertModel.id));case 6:case"end":return r.stop()}},r)}));return function(t,e){return r.apply(this,arguments)}}()},function(t){var e=t.handleSubmit,r=t.handleReset;return a.a.createElement(a.a.Fragment,null,a.a.createElement(To,{label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",name:"name",required:!0}),a.a.createElement(To,{label:"\u0410\u0440\u0442\u0438\u043a\u0443\u043b",name:"article"}),!!l&&a.a.createElement(we,{d:"block !important",error:!0,header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c..",content:l&&l.message}),a.a.createElement(xe,{ml:"122px",type:"button",primary:!0,content:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:i,onClick:e}),a.a.createElement(Ee,{cancel:!0,onClick:n?o:r},n?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})}}]),e}(r.Component);function Ro(){var t=Object(v.a)(["\n\t&&&&&& {\n\t\twidth: 350px;\n\t\t&:hover {\n\t\t\tborder-color: rgba(34, 36, 38, 0.15);\n\t\t}\n\t}\n"]);return Ro=function(){return t},t}var Ao=Object(At.b)(Xt.a)(Ro()),zo=function(t){function e(t){var n;Object(Rn.a)(this,e),(n=Object(zn.a)(this,Object(Vn.a)(e).call(this,t))).closeNewModelSection=function(){return n.setState({newModelMode:!1})},n.changeFieldValue=function(t,e){var r;console.log("change ",t," to value > ",e);var a=la()(n.state[t]);a.curVal=e,a.err=!1,n.isNewEnquiry||(a.diff=a.curVal!==a.oriVal);var o=n.fields.filter(function(e){return e!==t}).map(function(t){return n.state[t].diff}).includes(!0)||a.diff;n.setState((r={},Object(ia.a)(r,t,a),Object(ia.a)(r,"diff",o),Object(ia.a)(r,"err",{message:""}),r))},n.selectDay=function(t){if(!sa(t))return n.setState({dateLocal:Object(l.a)({},n.state.dateLocal,{err:!0}),err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u0437\u0430\u044f\u0432\u043a\u0438 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0434\u0430\u0442"}});n.changeFieldValue("dateLocal",fa(t).slice(0,10))},n.handleOrgDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({orgDdn:{search:r,err:!1}})},n.handleModelDropdownSearchChange=function(t,e){var r=e.searchQuery;n.setState({modelDdn:{search:r,err:!1}})},n.handleQtyInputChange=function(t,e){var r=e.value,a=parseInt(r,10)||"";n.changeFieldValue("qty",a)},n.selectOrg=function(t,e){var r=e.value;n.setState({orgDdn:{search:"",loading:!1}}),n.changeFieldValue("orgId",r)},n.selectModel=function(t,e){var r=e.value;n.setState({modelDdn:{search:"",loading:!1}}),n.changeFieldValue("modelId",r)},n.submitNewModel=function(t){n.changeFieldValue("modelId",t),n.closeNewModelSection()},n.createOrg=function(){var t=Object(an.a)(rn.a.mark(function t(e,r){var a,o,i;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,t.prev=1,ua(a,o={})){t.next=6;break}throw new Error(o.message);case 6:return n.setState({orgDdn:{search:a,loading:!0}}),t.next=9,n.props.createOrg({variables:{inn:a}});case 9:if(i=t.sent,n.componentIsMounted){t.next=12;break}return t.abrupt("return");case 12:n.selectOrg(null,{value:i.data.createOrg.id}),t.next=21;break;case 15:if(t.prev=15,t.t0=t.catch(1),n.componentIsMounted){t.next=19;break}return t.abrupt("return");case 19:n.setState({err:{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u043e \u0418\u041d\u041d \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message},orgDdn:{search:a,loading:!1},orgId:Object(l.a)({},n.state.orgId,{err:!0})}),console.log(t.t0);case 21:case"end":return t.stop()}},t,null,[[1,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.submit=function(){var t={};n.fields.forEach(function(e){(n.isNewEnquiry||n.state[e].diff)&&(t[e]=n.state[e].curVal)});var e=Object(l.a)({},t);if(n.isNewEnquiry)return n.createEnquiry(e);e.id=n.props.id,n.updateEnquiry(e)},n.createEnquiry=function(){var t=Object(an.a)(rn.a.mark(function t(e){var r;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.createEnquiry({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),n.props.setDetails({type:"Enquiry",id:r.data.createEnquiry.id}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(0),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,null,[[0,11]])}));return function(e){return t.apply(this,arguments)}}(),n.updateEnquiry=function(){var t=Object(an.a)(rn.a.mark(function t(e){var r,a,o,i;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.props,a=r.id,o=r.updateEnquiry,i=r.setDetails,t.prev=1,n.setState({loading:!0}),t.next=5,o({variables:{input:e}});case 5:if(n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:""}),i({type:"Enquiry",id:a}),t.next=17;break;case 11:if(t.prev=11,t.t0=t.catch(1),n.componentIsMounted){t.next=15;break}return t.abrupt("return");case 15:n.setState({loading:!1,err:{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",message:t.t0.message}}),console.log(t.t0);case 17:case"end":return t.stop()}},t,null,[[1,11]])}));return function(e){return t.apply(this,arguments)}}(),n.componentIsMounted=!0,n.isNewEnquiry="new"===t.id;var r=n.isNewEnquiry;n.state={loading:!1,err:{message:""},orgDdn:{search:"",loading:!1},modelDdn:{search:"",loading:!1},newModelMode:!1};var a=la()(t.enquiry);return r&&(a.dateLocal=fa(new Date).slice(0,10)),delete a.events,a.orgId=a.org?a.org.id:null,a.modelId=a.model?a.model.id:null,a.qty=a.qty?a.qty:"",n.fields=Object.keys(a).filter(function(t){return!["__typename","id","num","org","model"].includes(t)}),n.requiredFields=["dateLocal","orgId","modelId","qty"],n.fields.forEach(function(t){n.state[t]=Object(l.a)({curVal:a[t],err:!1},n.requiredFields.includes(t)&&{required:!0},!r&&{oriVal:a[t],diff:!1})}),r||(n.state.diff=!1),n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state,n=e.dateLocal,o=e.orgId,i=e.orgDdn,c=e.modelId,l=e.modelDdn,u=e.qty,s=e.diff,d=e.loading,m=e.err,f=e.newModelMode,p=this.props,b=p.id,g=p.setDetails,v=p.allOrgsAndModels,h=ga(n.curVal),E=v.orgs,y=v.models,O=this.requiredFields.some(function(e){return!t.state[e].curVal}),j=this.fields.some(function(e){return!!t.state[e].err});return a.a.createElement(r.Fragment,null,a.a.createElement(Ce,{bottomBorder:!0},a.a.createElement(Yt.a,null,a.a.createElement(Yt.a.Field,{inline:!0},a.a.createElement(Ie,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Ua,{error:n.err,selectedDate:h,selectDay:this.selectDay})),a.a.createElement(Yt.a.Field,{inline:!0,error:o.err,required:!0},a.a.createElement(Ie,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(Ao,{loading:!E||i.loading,disabled:"new"!==b||!E||i.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0418\u041d\u041d",options:E?E.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:o.curVal,onChange:this.selectOrg,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:i.search,onSearchChange:this.handleOrgDropdownSearchChange,noResultsMessage:"\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041d\u041d, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c.",allowAdditions:!0,additionLabel:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u0418\u041d\u041d: ",onAddItem:this.createOrg})),f?a.a.createElement(_a,{title:"\u041d\u043e\u0432\u043e\u0435 \u0438\u0437\u0434\u0435\u043b\u0438\u0435",onClose:this.closeNewModelSection,content:a.a.createElement($o,{model:void 0,orgId:o.curVal||void 0,refetchQueries:v.refetch,onSubmit:this.submitNewModel})}):a.a.createElement(Yt.a.Field,{inline:!0,required:!0,error:c.err},a.a.createElement(Ie,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(Ao,{loading:!y||l.loading,disabled:!y||l.loading,selection:!0,placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0443",options:y?y.map(function(t){return{key:t.id,value:t.id,text:t.name}}):[],value:c.curVal,onChange:this.selectModel,selectOnBlur:!1,selectOnNavigation:!1,search:!0,searchQuery:l.search,onSearchChange:this.handleModelDropdownSearchChange,noResultsMessage:'\u0415\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 "\u041d\u0435\u0442 \u0432 \u0441\u043f\u0438\u0441\u043a\u0435"'}),a.a.createElement(xe,{ml:"5px",icon:"plus",activeColor:"green",active:f,onClick:function(){return t.setState({newModelMode:!0})}})),a.a.createElement(Yt.a.Field,{inline:!0,required:!0},a.a.createElement(Ie,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(Gt.a,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",value:u.curVal,onChange:this.handleQtyInputChange}),a.a.createElement(he,{pl:"6px"},"\u0448\u0442.")))),a.a.createElement(Ce,null,a.a.createElement(Kt.a,{error:!0,hidden:!m.message,header:m.title,content:m.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(xe,{primary:!0,content:this.isNewEnquiry?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:!this.isNewEnquiry&&!s||!!m.message||j||!!o.loading||O,loading:d,onClick:this.submit}),a.a.createElement(Ee,{cancel:!0,onClick:"new"===b?function(){return g(null)}:function(){return g({type:"Enquiry",id:b})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))}}]),e}(r.Component),Vo=Hn(Object(Qn.a)(Na,{name:"createOrg",options:{update:function(t,e){var n=e.data.createOrg,r=Va,a=t.readQuery({query:r});a.orgs.push(n),a.orgs.sort(function(t,e){return t.name>e.name}),t.writeQuery({query:r,data:a})}}}),Object(Qn.a)(Va,{name:"allOrgsAndModels"}),Object(Qn.a)(It,{name:"updateEnquiry"}),Object(Qn.a)(Ft,{name:"createEnquiry",options:{update:function(t,e){var n=e.data.createEnquiry,r=xt,a=t.readQuery({query:r});n.isExpanded=!1,a.enquiries.unshift(n),t.writeQuery({query:r,data:a})}}}))(zo),Wo=n(1081);function Qo(){var t=Object(v.a)(["\n\tdisplay: inline-block;\n\twidth: 180px;\n\t","\n\tinput {\n\t\tcursor: pointer;\n\t\tvertical-align: unset !important;\n\t\tpadding-left: 3.5rem !important;\n\t\t&:focus {\n\t\t\tcursor: text;\n\t\t}\n\t}\n"]);return Qo=function(){return t},t}var Ho=At.b.div(Qo(),function(t){return t.err&&"\n\t\tinput {\n\t\t\tcolor: #9f3a38 !important;\n\t\t\tbackground-color: #fff6f6 !important;\n\t\t\tborder-color: #e0b4b4 !important;\n\t\t}"}),Ko=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).handleDayChange=function(t){var e=n.props,r=e.setField,a=e.field.name;sa(t)?r(a,{value:fa(t).slice(0,10)}):r(a,{err:{title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0432\u043e\u0434\u0430 \u0434\u0430\u0442\u044b",message:"\u0414\u0430\u0442\u0430 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u043e\u0440\u043c\u0430\u0442\u0443 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414"}})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props.field,e=t.curVal,n=t.err;return a.a.createElement(Ho,{err:!!n},a.a.createElement(Qa.a,{value:e,onDayChange:this.handleDayChange,dayPickerProps:{firstDayOfWeek:1,month:ga(e)}}))}}]),e}(r.Component),Uo=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.placeholder,n=t.field,o=n.name,i=n.curVal,c=t.setField;return a.a.createElement(r.Fragment,null,a.a.createElement(po.a,{customInput:Gt.a,placeholder:e,value:i,decimalSeparator:",",thousandSeparator:" ",decimalScale:2,allowNegative:!1,onValueChange:function(t){return c(o,{value:t.floatValue})}}),a.a.createElement(he,{pl:"6px",fs:"1.1rem",c:"rgba(0,0,0,.87)"},"\u20bd"),a.a.createElement(he,{pl:"9px",fs:"1.1rem",ws:"0.1em"},"\u0441 \u041d\u0414\u0421"))}}]),e}(r.Component),_o=function(t){function e(t){var n;Object(Rn.a)(this,e),(n=Object(zn.a)(this,Object(Vn.a)(e).call(this,t))).setField=function(t,e){var r=e.value,a=e.err;n.setState(Object(ia.a)({},t,Object(l.a)({},n.state[t],r&&Object(l.a)({curVal:r},!n.isNewEntity&&{diff:r!==n.state[t].oriVal}),{err:a||null})))},n.submit=function(){var t=n.fields.reduce(function(t,e){return t[e]=n.state[e].curVal,t},{});n.props.submit(t)},n.componentIsMounted=!0,n.isNewEntity=t.isNewEntity;var r=t.entity;return n.fields=Object.keys(r),n.requiredFields=t.requiredFields,n.state={},n.fields.forEach(function(t){n.state[t]=Object(l.a)({name:t,curVal:r[t],err:null},n.requiredFields.includes(t)&&{required:!0},!n.isNewEntity&&{oriVal:r[t],diff:!1})}),n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this,e=this.props.children,n=this.requiredFields.some(function(e){return!t.state[e].curVal}),r=this.isNewEntity?null:this.fields.map(function(e){return t.state[e].diff}).includes(!0),a=this.fields.map(function(e){return t.state[e].err}).find(function(t){return!!t});return e({disabled:!this.isNewEntity&&!r||n||!!a,err:a||this.props.err,setField:this.setField,submit:this.submit,formState:this.state})}}]),e}(r.Component),Go=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.cancel,n=t.submit,o=t.loading,i="new"===this.props.id,c=i?{dateLocal:fa(new Date).slice(0,10),amount:""}:{dateLocal:this.props.co.dateLocal,amount:this.props.co.amount};return a.a.createElement(_o,{isNewEntity:i,entity:c,requiredFields:["dateLocal","amount"],submit:n},function(t){var n=t.disabled,i=t.err,c=t.setField,l=t.submit,u=t.formState,s=u.dateLocal,d=u.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(Ce,{head:!0,minor:!0,secondary:!0,topBorder:!0,bottomBorder:!0},a.a.createElement(Wt.a,null,"\u041a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u043e\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u0435")),a.a.createElement(Ce,{secondary:!0,bottomBorder:!0},a.a.createElement(Yt.a,null,a.a.createElement(Yt.a.Field,{inline:!0},a.a.createElement(Ie,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Ko,{field:s,setField:c})),a.a.createElement(Yt.a.Field,{inline:!0,required:!0},a.a.createElement(Ie,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(Uo,{field:d,setField:c,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u041a\u041f"})))),a.a.createElement(Ce,{secondary:!0,small:!0},i&&a.a.createElement(Kt.a,{error:!0,header:i.title,content:i.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(Ht.a,{primary:!0,content:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",disabled:n,loading:o,onClick:l}),a.a.createElement(Ee,{cancel:!0,onClick:e},"\u041e\u0442\u043c\u0435\u043d\u0430")),a.a.createElement(Wo.a,{fitted:!0}))})}}]),e}(r.Component);function Xo(){var t=Object(v.a)(["\n\tmargin-left: 6.35em !important;\n"]);return Xo=function(){return t},t}function Yo(){var t=Object(v.a)(["\n\t& p { margin: 0 !important; }\n\t&>table { \n\t\twidth: 100%;\n\t\tborder-collapse: collapse; \n\t}\n\t&>table>tbody>tr>td {\n\t\tpadding-left: 4px;\n\t\tvertical-align: top;\n\t}\n\t&>table>tbody>tr>td:nth-child(1) {\n\t\twidth: 5px;\n\t}\n\t&>table>tbody>tr>td:nth-child(2) {\n\t\twidth: 25px;\n\t\tmin-width: 90px;\n\t}\n\t&>table>tbody>tr>td:nth-child(3) {\n\t\tpadding-left: 10px;\n\t\twidth: 1000px;\n\t\tmin-width: 240px;\n\t}\n\t&>table>tbody>tr>td>span {\n\t\tmargin-right: 5px;\n\t}\n"]);return Yo=function(){return t},t}function Jo(){var t=Object(v.a)(["\n\tmargin-left: 0 !important;\n  color: rgba(0,0,0,.6) !important;\n"]);return Jo=function(){return t},t}function Zo(){var t=Object(v.a)(["\n  margin-left: 6.5em !important;\n"]);return Zo=function(){return t},t}function ti(){var t=Object(v.a)(["\n  width: 2em;\n  height: 2em;\n  margin-left: 0 !important;\n  padding: .4em 0em !important;\n  float: left;\n\ttext-align: center;\n\t","\n\t// ","\n"]);return ti=function(){return t},t}function ei(){var t=Object(v.a)(["\n\t// apply horizontal offset correction for different icons to be vertically alined\n  width: "," !important;\n\t","\n  margin-top: .15em !important;\n\tfloat: left;\n\topacity: 0.6 !important;\n"]);return ei=function(){return t},t}function ni(){var t=Object(v.a)(["\n\tmargin: 1.5em 1.5em 1.5em 55px !important;\n\t/* margin: 1.5em 1.5em 1.5em 0 !important; */\n"]);return ni=function(){return t},t}function ri(){var t=Object(v.a)(["\n\t& .active.item {\n\t\tdisplay: none !important;\n\t}\n\t& .selected.item {\n\t\tbackground: none !important;\n\t}\n"]);return ri=function(){return t},t}var ai=Object(At.b)(Xt.a)(ri()),oi=Object(At.b)(Xr.a.Group)(ni()),ii=Object(At.b)(Qt.a)(ei(),function(t){return"CREATE"===t.type?"1.73em":"1.4em"},function(t){return"CREATE"===t.type&&"margin-left: -0.33em !important;"}),ci=Object(At.b)(Yr.a)(ti(),function(t){return t.indent&&"margin-left: 42.69px !important;"},function(t){return t.indent&&"margin-left: calc(1.4em + 0.25rem) !important;"}),li=Object(At.b)(Xr.a.Content)(Zo()),ui=Object(At.b)(Xr.a.Metadata)(Jo()),si=Object(At.b)(Xr.a.Text)(Yo()),di=Object(At.b)(Kt.a)(Xo()),mi=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(o)))).isNewEnquiry="new"===n.props.id,n.editorRef=a.a.createRef(),n.noteEditorRef=a.a.createRef(),n.componentIsMounted=!0,n.state={editMode:!!n.isNewEnquiry,editorHasText:!1,noteEditorDiff:!1,noteKey:1,activeCO:"",loading:!1,creatingComment:!1,changingStatus:!1,statusPending:!1,savingNote:!1,error:""},n.enableEditMode=function(){return n.setState({editMode:!0})},n.exitEditMode=function(){return n.setState({editMode:!1})},n.setEditorHasText=function(t){return n.setState({editorHasText:t})},n.setNoteEditorDiff=function(t){return n.setState({noteEditorDiff:t})},n.cancelEdit=function(){if(n.isNewEnquiry)return n.props.closeDetails();n.exitEditMode()},n.createComment=Object(an.a)(rn.a.mark(function t(){var e;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null!==(e=n.editorRef.current.exportHtml())){t.next=4;break}return t.abrupt("return");case 4:return n.setState({creatingComment:!0}),t.next=7,n.props.createEnquiryEvent({variables:{enquiryId:n.props.id,htmlText:e}});case 7:n.setState({creatingComment:!1,editorHasText:!1,error:""}),n.editorRef.current.clear(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),n.setState({creatingComment:!1,error:t.t0.message}),console.log(t.t0);case 15:case"end":return t.stop()}},t,null,[[0,11]])})),n.changeStatus=function(){var t=Object(an.a)(rn.a.mark(function t(e,r){var a,o,i;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.value,o=r.co,i=n.props.enquiryQuery.statuses.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,a!==i){t.next=8;break}if(n.state.statusPending){t.next=7;break}return t.abrupt("return",n.setState({statusPending:!0,activeCO:"new"}));case 7:n.setState({statusPending:!1});case 8:return t.prev=8,n.setState({changingStatus:!0}),t.next=12,n.props.createEnquiryEvent({variables:Object(l.a)({enquiryId:n.props.id,statusId:a},o&&{doc:Object(l.a)({},o)})});case 12:n.setState({changingStatus:!1,activeCO:""}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(8),n.setState({changingStatus:!1,error:t.t0.message}),console.log(t.t0);case 19:case"end":return t.stop()}},t,null,[[8,15]])}));return function(e,n){return t.apply(this,arguments)}}(),n.cancelPendingStatusChange=function(){n.setState({statusPending:!1,activeCO:""})},n.saveNote=Object(an.a)(rn.a.mark(function t(){var e;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=n.noteEditorRef.current.exportHtml())!==n.props.enquiryQuery.enquiry.htmlNote){t.next=4;break}return t.abrupt("return",n.setState({noteKey:n.state.noteKey+1,noteEditorDiff:!1}));case 4:return n.setState({savingNote:!0}),t.next=7,n.props.updateEnquiry({variables:{input:{id:n.props.id,htmlNote:e}}});case 7:if(n.componentIsMounted){t.next=9;break}return t.abrupt("return");case 9:n.setState({savingNote:!1,error:"",noteKey:n.state.noteKey+1,noteEditorDiff:!1}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({savingNote:!1,error:t.t0.message}),console.log(t.t0);case 18:case"end":return t.stop()}},t,null,[[0,12]])})),n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.editorHasText,o=e.creatingComment,i=e.changingStatus,c=e.statusPending,l=e.error,u=e.noteEditorDiff,s=e.noteKey,d=e.savingNote,m=e.activeCO,f=this.props.enquiryQuery,p=this.isNewEnquiry;if(f.loading)return a.a.createElement(Ce,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...");if(f.error)return a.a.createElement(Ce,null,"\u041e\u0448\u0438\u0431\u043a\u0430 ",f.error.message);var b=p?f.newEnquiry:f.enquiry,g=b.org,v=b.model,h=b.qty,E=b.htmlNote,y=b.events,O=y&&y.filter(function(t){return t.doc}),j=y&&y.filter(function(t){return t.status}).pop().status,x=f.statuses.slice(),w=x.find(function(t){return"\u0412\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043e \u041a\u041f"===t.name}).id,k=x.find(function(t){return"\u0417\u0430\u043a\u0430\u0437"===t.name}).id,C=x.filter(function(t){return["\u041d\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","\u041e\u0442\u043a\u0430\u0437"].includes(t.name)}).map(function(t){return t.id}),F=x.sort(function(t,e){return t.stage===e.stage&&C.includes(t.id)}),I=0,S=y&&y.reduce(function(t,e,n){return e.status&&0!==n?C.includes(e.status.id)?[].concat(Object(nr.a)(t),["refuse"]):e.status.id===k?[].concat(Object(nr.a)(t),["order"]):(t.push(e.status.stage-I>0?"up":"down"),I=e.status.stage,t):[].concat(Object(nr.a)(t),[null])},[]);return a.a.createElement(Yn,null,function(e){var f=e.details,p=e.setDetails,x=f.id,I=f.editMode,D="new"===x;return a.a.createElement(r.Fragment,null,(I||D)&&a.a.createElement(Vo,{id:x,enquiry:b,setDetails:p}),!(I||D)&&a.a.createElement(r.Fragment,null,a.a.createElement(Ce,null,a.a.createElement(Hr,null,a.a.createElement("tbody",null,a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(Ur,null,g&&g.name),a.a.createElement(Ur,null)),a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u0418\u0437\u0434\u0435\u043b\u0438\u0435"),a.a.createElement(Ur,null,v&&v.name),a.a.createElement(Ur,null)),a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u041a\u043e\u043b-\u0432\u043e, \u0448\u0442."),a.a.createElement(Ur,null,h),a.a.createElement(Ur,null)),!!O.length&&a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u041a\u041f"),a.a.createElement(Ur,null,O.map(function(t){var e=t.doc,n=e.id,r=e.dateLocal,o=e.amount;return a.a.createElement(ve,{key:n,fw:"normal",lh:"1.21428571em"},a.a.createElement("b",null,pr(o)," ")," ( \u043e\u0442 ",r," )")})),a.a.createElement(Ur,null)),a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f"),a.a.createElement(Gr,null,a.a.createElement(aa,{key:s,borderless:!0,ref:t.noteEditorRef,initFromHtml:E,setEditorDiff:t.setNoteEditorDiff,diff:u,onCtrlEnter:t.saveNote}),u&&a.a.createElement(xe,{mt:".67857143em",content:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u0435",labelPosition:"left",icon:"save",primary:!0,floated:"left",onClick:t.saveNote,disabled:d,loading:d})),a.a.createElement(Ur,null)),a.a.createElement(Kr,null,a.a.createElement(Ur,null,"\u0421\u0442\u0430\u0442\u0443\u0441"),a.a.createElement(_r,null,a.a.createElement(ai,{labeled:!0,button:!0,className:"icon",loading:i,disabled:i||c,value:j.id,text:j.name,options:F.filter(function(t){return(t.id===j.id||1===Math.abs(t.stage-j.stage))&&!(0===t.stage&&0!==j.stage)}).map(function(t){return{key:t.id,text:t.name,value:t.id,label:{basic:!0,content:"\u0441\u0442",detail:t.stage,icon:C.includes(t.id)?"minus circle":t.id===k?"checkmark":"long arrow alternate ".concat(t.stage-j.stage>0?"up":"down")}}}),onChange:t.changeStatus,selectOnBlur:!1,selectOnNavigation:!1}),a.a.createElement(Yr.a,{basic:!0,size:"large",content:"\u0441\u0442\u0430\u0434\u0438\u044f",detail:j.stage})),a.a.createElement(Ur,null))))),m&&a.a.createElement(Go,{id:m,submit:function(e){return t.changeStatus(null,{value:w,co:e})},cancel:t.cancelPendingStatusChange}),a.a.createElement(oi,{minimal:!0},a.a.createElement(Wt.a,{as:"h3",dividing:!0,content:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 \u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"}),y.map(function(t,e){var n=t.user.person,r=n.fName,o=n.lName,i=(o?r.slice(0,1):r.slice(0,2))+(o?o.slice(0,1):"");return a.a.createElement(Xr.a,{key:t.id},t.type&&"COMMENT"!==t.type&&a.a.createElement(ii,{size:"big",type:t.type,color:"CREATE"===t.type?"green":"UPDATE"===t.type?"blue":"STATUS"===t.type&&"up"===S[e]?"yellow":"STATUS"===t.type&&"down"===S[e]?"brown":"STATUS"===t.type&&"refuse"===S[e]?"red":"STATUS"===t.type&&"order"===S[e]?"green":"grey",name:"CREATE"===t.type?"plus":"UPDATE"===t.type?"write square":"STATUS"===t.type&&"refuse"===S[e]?"minus circle":"STATUS"===t.type&&"order"===S[e]?"checkmark":"STATUS"===t.type?"long arrow alternate ".concat(S[e]):"question"}),a.a.createElement(ci,{size:"big",content:i,indent:t.type&&"COMMENT"!==t.type?0:1}),a.a.createElement(li,null,a.a.createElement(ui,{content:t.datetimeLocal.slice(0,16)}),a.a.createElement(si,{dangerouslySetInnerHTML:{__html:Object(oa.sanitize)(t.htmlText)}})))}),a.a.createElement(Yt.a,{reply:!0,error:!!l},a.a.createElement(ge,{m:"0 0 1em 6.35em"},a.a.createElement(aa,{ref:t.editorRef,setEditorHasText:t.setEditorHasText,onSave:t.createComment})),a.a.createElement(di,{error:!0,header:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:l}),a.a.createElement(xe,{content:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442",labelPosition:"left",icon:"edit",primary:!0,floated:"right",onClick:t.createComment,disabled:!n,loading:o})))))})}}]),e}(r.Component),fi=Hn(Object(Qn.a)(It,{name:"updateEnquiry"}),Object(Qn.a)(St,{name:"createEnquiryEvent",options:function(t){return{update:function(e,n){var r=n.data.createEnquiryEvent,a="Enquiry:".concat(t.id),o=Dt,i=e.readFragment({id:a,fragment:o});if(i.events.push(r),e.writeFragment({id:a,fragment:o,data:i}),r.status){var c=xt,l=(i=e.readQuery({query:c})).enquiries.find(function(e){return e.id===t.id});l.status=r.status,r.doc&&l.docs.push(r.doc),e.writeQuery({query:c,data:i})}}}}}),Object(Qn.a)(Ct,{name:"enquiryQuery",skip:function(t){return"new"!==t.id}}),Object(Qn.a)(wt,{name:"enquiryQuery",skip:function(t){return"new"===t.id}}))(mi),pi=n(220),bi=n.n(pi),gi=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(o)))).state={value:n.props.field&&n.props.field.curVal||""},n.input=Object(r.createRef)(),n.debouncedSetField=bi()(function(t){var e=n.props,r=e.field.name;(0,e.setField)(r,{value:t})},250),n.writeVal=function(t){n.setState({value:t}),n.debouncedSetField(t)},n.handleInputChange=function(t,e){var r=e.value;if(""===r)return n.writeVal("");if("int"===n.props.type){var a=parseInt(r,10);return a&&n.writeVal(a)}return n.writeVal(r)},n.onBlur=function(){var t=n.props,e=t.field.name,r=t.setField,a=n.input.current.children[0]||{},o=a.type,i=a.valueAsNumber;"number"===o&&br(i)&&r(e,{err:{title:'\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u043e\u043b\u0435 "\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"',message:"\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"}})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=(t.field,t.setField,t.type),n=Object(Vt.a)(t,["field","setField","type"]),r=this.state.value;return a.a.createElement(De,Object.assign({},n,{type:"int"===e?"number":e||"text",value:r,onChange:this.handleInputChange,onBlur:this.onBlur,ref:this.input}))}}]),e}(r.Component),vi=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).componentIsMounted=!0,n.isNewEntity="new"===n.props.id,n.state={loading:!1,err:null},n.submit=function(t){n.upsertOrder(Object(l.a)({},t,n.isNewEntity&&{enquiryId:n.props.enquiryId},!n.isNewEntity&&{id:n.props.id}))},n.upsertOrder=function(){var t=Object(an.a)(rn.a.mark(function t(e){var r;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n.setState({loading:!0}),t.next=4,n.props.upsertOrder({variables:e});case 4:if(r=t.sent,n.componentIsMounted){t.next=7;break}return t.abrupt("return");case 7:n.setState({loading:!1,err:null}),n.props.setDetails({type:"Order",id:r.data.upsertOrder.id}),n.props.setExpanded({id:r.data.upsertOrder.enquiry.id,value:!0}),t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),n.componentIsMounted){t.next=16;break}return t.abrupt("return");case 16:n.setState({loading:!1,err:{title:"".concat(n.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"," \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c.."),message:t.t0.message}}),console.log(t.t0);case 18:case"end":return t.stop()}},t,null,[[0,12]])}));return function(e){return t.apply(this,arguments)}}(),n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"componentWillUnmount",value:function(){this.componentIsMounted=!1}},{key:"render",value:function(){var t=this,e=this.state.loading,n=this.props,o=n.id,i=n.closeDetails,c=n.setDetails,l="new"===o,u=l?{dateLocal:fa(new Date).slice(0,10),qty:"",amount:""}:this.props.orderLocal.orderLocal;return a.a.createElement(_o,{isNewEntity:l,entity:u,requiredFields:["dateLocal","qty","amount"],submit:this.submit,err:this.state.err},function(n){var l=n.disabled,u=n.err,s=n.setField,d=n.submit,m=n.formState,f=m.dateLocal,p=m.qty,b=m.amount;return a.a.createElement(r.Fragment,null,a.a.createElement(Ce,{bottomBorder:!0},a.a.createElement(Yt.a,null,a.a.createElement(Yt.a.Field,{inline:!0},a.a.createElement(Ie,null,"\u0414\u0430\u0442\u0430"),a.a.createElement(Ko,{field:f,setField:s})),a.a.createElement(Yt.a.Field,{inline:!0,required:!0},a.a.createElement(Ie,null,"\u041a\u043e\u043b-\u0432\u043e"),a.a.createElement(gi,{type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u0448\u0442.",field:p,setField:s}),a.a.createElement(he,{pl:"6px"},"\u0448\u0442.")),a.a.createElement(Yt.a.Field,{inline:!0,required:!0},a.a.createElement(Ie,null,"\u0421\u0443\u043c\u043c\u0430"),a.a.createElement(Uo,{field:b,setField:s,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u0437\u0430\u043a\u0430\u0437\u0430"})))),a.a.createElement(Ce,null,u&&a.a.createElement(Kt.a,{error:!0,header:u.title,content:u.message}),a.a.createElement(ge,{inline:!0,w:"formLabel"}),a.a.createElement(Ht.a,{primary:!0,content:t.isNewEntity?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",disabled:l,loading:e,onClick:d}),a.a.createElement(Ee,{cancel:!0,onClick:"new"===o?i:function(){return c({type:"Order",id:o})}},"\u041e\u0442\u043c\u0435\u043d\u0430")))})}}]),e}(r.Component),hi=Hn(Object(Qn.a)(L,{name:"upsertOrder",options:{update:function(t,e){var n=e.data.upsertOrder,r=xt,a=t.readQuery({query:r}),o=a.enquiries.find(function(t){return t.id===n.enquiry.id});o.orders=[].concat(Object(nr.a)(o.orders.filter(function(t){return t.id!==n.id})),[n]).sort(function(t,e){return t.fullnum>e.fullnum?1:-1}),t.writeQuery({query:r,data:a})}}}),Object(Qn.a)(N,{name:"orderLocal",skip:function(t){return"new"===t.id}}))(vi),Ei=Object(r.forwardRef)(function(t,e){var n=t.buttons,r=t.size,o=t.noIndent,i=t.bottomBorder,c=t.title,l=t.subtitle,u=t.titleSize,s=t.onClick,d=t.expanded;return a.a.createElement(qr,{ref:e,expanded:d,onClick:s,size:r,noIndent:o,bottomBorder:i},a.a.createElement(Br,{title:c,subtitle:l,size:u||r}),n&&a.a.createElement(Pr,null,n))});function yi(){var t=Object(v.a)(["\n  & {\n    z-index: -1;\n    width: 100%;\n    padding: 0;\n    margin-bottom: -1px;\n  }\n"]);return yi=function(){return t},t}function Oi(){var t=Object(v.a)(["\n  & {\n    width: 100%;\n    position: relative;\n    padding: 0;\n    ","\n  }\n"]);return Oi=function(){return t},t}var ji=Object(At.b)(Ce)(Oi(),function(t){return t.expanded&&"{\n      margin-top: -1px;\n      border-bottom-color: rgba(34, 36, 38, 0.15);\n    }"}),xi=Object(Le.b)(Ei)({visible:{opacity:1},invisible:{opacity:0}}),wi=Object(At.b)(Object(Le.b)(Ce)({enter:{y:0},exit:{y:"-100%"}}))(yi()),ki=function(t){var e=t.children,n=t.initiallyExpanded,o=t.disabled,i=t.headerInvisible,c=t.forceExpanded,l=t.overflowVisible,u=(t.mode,Object(Vt.a)(t,["children","initiallyExpanded","disabled","headerInvisible","forceExpanded","overflowVisible","mode"])),s=Object(r.useState)(!1),d=Object(qe.a)(s,2),m=d[0],f=d[1];return Object(r.useEffect)(function(){return f(!!n||!o&&(c||(void 0).state.expanded))},[n,o,c]),a.a.createElement(ji,{expanded:m?1:0,topBorder:m,bottomBorder:m},a.a.createElement(xi,Object.assign({},u,{expanded:m,bottomBorder:m&&"dark",disabled:c,titleSize:"small",onClick:!c&&function(){return f(!m)},pose:i?"invisible":"visible"})),a.a.createElement(ge,{oy:l?void 0:"hidden"},a.a.createElement(Le.a,null,m&&a.a.createElement(wi,{key:1},e))))},Ci=n(226),Fi=n.n(Ci),Ii=function(t){var e=t.children,n=t.prods,r=t.selectedIds,a=t.orderId,o=t.selectLimit,i=t.selectedProds,c=void 0===i?[]:i,u=t.orderProdsQty,s=t.diff,d=t.expandedIds,m=t.expanded,f=Object(l.a)({},a&&{extra:!0},a&&o===r.length&&{limitReached:!0},!a&&{order:!0},s&&{diff:!0},d&&{expand:!0},m&&{expanded:!0}),p=f.extra?n:f.order?Fi.a.unionBy(n,c,"id"):[],b=Fi()(p).sortBy("dept.type").groupBy("dept.name").reduce(function(t,e){var o=Object(l.a)({},e[0].dept);if(o=Object(l.a)({},o,{count:e.length,readyCount:e.filter(function(t){return 100===t.progress}).length,hasDefect:e.filter(function(t){return t.hasDefect}).length,isSpoiled:e.filter(function(t){return t.isSpoiled}).length},f.expand&&{expanded:d.some(function(t){return t===o.id})},f.expanded&&{expanded:!0},{prods:e.map(function(t){var e=Object(l.a)({},t,f.extra&&{selected:r.includes(t.id),ordered:!!t.order&&t.order.id!==a},f.order&&f.diff&&{added:!n.some(function(e){return e.id===t.id}),removed:!c.some(function(e){return e.id===t.id})});return f.extra&&(e=Object(l.a)({},e,{disabled:e.ordered||f.limitReached&&!e.selected})),e})}),f.extra){var i=o.prods.filter(function(t){return t.ordered}).length||0;o=Object(l.a)({},o,{selectedCount:o.prods.filter(function(t){return t.selected}).length||0,orderedCount:i,availCount:o.count-i}),o=Object(l.a)({},o,{selected:o.selectedCount===o.availCount||0!==o.selectedCount&&"partly"}),o=Object(l.a)({},o,{disabled:o.prods.every(function(t){return t.disabled})||f.limitReached&&[!1].includes(o.selected)})}return t.push(o),t},[]);if(f.order){var g=s?u-c.length:u-n.length;g&&b.unshift({id:"unreserved",name:"\u0411\u0435\u0437 \u0440\u0435\u0437\u0435\u0440\u0432\u0430",count:g,prods:[]})}return e({depts:b,xor:!!Fi.a.xorBy(n,c,"id").length})},Si=[{name:"name",path:"name",title:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a / \u2116 \u0418\u0437\u0434\u0435\u043b\u0438\u044f",width:"170px"},{name:"progress",path:"progress",title:"\u0417\u0430\u0432\u0435\u0440\u0448.",width:"65px"},{name:"hasDefect",path:"hasDefect",title:"\u041e\u0442\u043a\u043b\u043e\u043d.",width:"65px"},{name:"isSpoiled",path:"isSpoiled",title:"\u0411\u0440\u0430\u043a",width:"55px"},{name:"reserve",title:"\u0420\u0435\u0437\u0435\u0440\u0432",width:"75px"}],Di=function(t){var e=t.depts,n=t.skipFields,o=void 0===n?[]:n,i=t.select,c=t.expand,l=t.indent,u=t.nameFieldWidth,s=la()(Si);return u&&(s.find(function(t){return"name"===t.name}).width=u),a.a.createElement(dr,{fields:s.filter(function(t){return!o.includes(t.name)}),indent:l,select:i,expand:c},function(t){var n=t.tableFields;return a.a.createElement(r.Fragment,null,e.map(function(t){var e=t.id,o=t.expanded;return"unreserved"===e?a.a.createElement(xr,{key:e,entity:t,tableFields:n,rowFields:[{name:"name",value:t.name+" ("+t.count+")"}]}):a.a.createElement(r.Fragment,{key:e},a.a.createElement(xr,{entity:t,tableFields:n,expandFor:"prods",expanded:o,expand:function(){return c(e)},onClick:function(){return c(e)},select:function(){return i(e)},rowFields:[{name:"name",value:t.name+" ("+t.count+")"},{name:"progress",path:"readyCount",icon:"checkmark",iconColor:"green"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",path:"orderedCount",icon:"gavel",iconColor:"brown"}]}),o&&t.prods.map(function(e,r){var o=e.id,c=e.progress,l=e.order,u=e.added,s=e.removed;return a.a.createElement(xr,{secondary:1,lastSecondaryRow:r===t.prods.length-1?1:0,key:o,entity:e,tableFields:n,select:function(){return i(o)},rowFields:[].concat(Object(nr.a)(u||s?[{name:"service",value:!0,icon:u?"plus":"minus",iconColor:u?"green":"red"}]:[]),[{name:"name",path:"fullnumber"},{name:"progress",value:c&&c+"%"},{name:"hasDefect",path:"hasDefect",icon:"warning sign",iconColor:"orange"},{name:"isSpoiled",path:"isSpoiled",icon:"broken chain",iconColor:"red"},{name:"reserve",value:l&&l.fullnum}]),onClick:i&&function(){return i(o)}})}))}))})};function qi(){var t=Object(v.a)(["\n  &&&& { margin: 0 -.42857143em 0 .42857143em; }\n"]);return qi=function(){return t},t}var Mi=Object(At.b)(Qt.a)(qi()),Bi=function(t){var e=t.modelId,n=t.orderId,r=t.prodIds;return a.a.createElement(Yn,null,function(t){var o=t.extra,i=t.setExtra,c=t.setSelectedProdIds;return a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",active:!!o,onClick:function(t){t.stopPropagation(),c(r),i({type:"Store",modelId:e,orderId:n})}},a.a.createElement(Qt.a,{name:"gavel"}),"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",a.a.createElement(Mi,{name:"angle right"}))})};function Pi(){var t=Object(v.a)(["\n\tquery ProdsLocal ($ids: [ID!]!) {\n\t\tprodsLocal (ids: $ids) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t}\n\t}\n"]);return Pi=function(){return t},t}function Li(){var t=Object(v.a)(["\n\tquery ModelProds ($modelId: ID!) {\n\t\tmodelProds (modelId: $modelId) {\n\t\t\tid\n\t\t\tfullnumber,\n      hasDefect,\n      isSpoiled,\n      progress,\n\t\t\tdept {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\ttype\n\t\t\t}\n\t\t\torder {\n\t\t\t\tid\n\t\t\t\tfullnum\n\t\t\t\tenquiry {\n\t\t\t\t\tid\n\t\t\t\t\tnum\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]);return Li=function(){return t},t}var Ni=E()(Li()),Ti=E()(Pi()),$i=Hn(Object(Qn.a)(Ti,{name:"prodsLocal"}))(function(t){return(0,t.children)({prodsLocal:t.prodsLocal.prodsLocal||[]})}),Ri=function(t){var e=t.order,n=e.id,o=e.model,i=e.qty,c=e.prods;return a.a.createElement(Yn,null,function(t){var e=t.extra,l=t.setExtra,u=t.selectedProdIds;return a.a.createElement(ki,{forceExpanded:!!e,title:o.name,subtitle:i+"\u0448\u0442",buttons:a.a.createElement(Bi,{modelId:o.id,orderId:n,prodIds:c.map(function(t){return t.id})})},a.a.createElement($i,{ids:u},function(t){var o=t.prodsLocal;return a.a.createElement(Ii,{prods:c,selectedProds:o,orderProdsQty:i,expanded:!0,diff:!!e},function(t){var o=t.depts,i=t.xor;return a.a.createElement(r.Fragment,null,a.a.createElement(Di,{depts:o,skipFields:["reserve"],expand:function(){return null},indent:"32px",nameFieldWidth:"200px"}),e&&a.a.createElement(Ue.a,{mutation:$,variables:{orderId:n,prodIds:u}},function(t,e){var n=e.loading,o=e.error;return a.a.createElement(r.Fragment,null,a.a.createElement(Ce,{minor:!0,head:!0,topBorder:"dark"},a.a.createElement(xe,{primary:!0,compact:!0,circular:!0,menu:!0,ml:"0",content:"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c",icon:"gavel",loading:n,disabled:!i,onClick:function(){t(),l(null)}})),o&&a.a.createElement(we,{section:!0,error:!0,header:"\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c..",content:o.message}))}))})}))})},Ai=function(t){var e=t.order;return a.a.createElement(Ri,{order:e})},zi=n(520),Vi=n(1082),Wi=n(71);function Qi(){var t=Object(v.a)(["\n  position: absolute;\n  left: 5px;\n  top: 4px;\n  &&& {\n    opacity: ",";\n    :hover {\n      opacity: .5 !important;\n    }\n  }\n  ",":hover && {\n    opacity: ",";\n  }\n"]);return Qi=function(){return t},t}function Hi(){var t=Object(v.a)(["\n  position: absolute;\n  top: 7px;\n  left: 10px;\n  color: white;\n  &&& {\n    opacity: ",";\n  }\n  ",":hover && {\n    opacity: ",";\n  }\n"]);return Hi=function(){return t},t}function Ki(){var t=Object(v.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  cursor: pointer;\n  transition: background-image .135s cubic-bezier(0.0,0.0,0.2,1);\n  :hover {\n    background-image: linear-gradient(to bottom,rgba(0,0,0,0.26),transparent 56px,transparent);\n  }\n  ","\n  ","\n"]);return Ki=function(){return t},t}function Ui(){var t=Object(v.a)(["\n  width: 100%;\n  height: 100%;\n"]);return Ui=function(){return t},t}function _i(){var t=Object(v.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0,0,50,.03);\n"]);return _i=function(){return t},t}function Gi(){var t=Object(v.a)(["\n  position: relative;\n  width: 100%;\n  padding-top: ","%;\n  margin-bottom: 3px;\n"]);return Gi=function(){return t},t}var Xi=At.b.div(Gi(),function(t){return 100/t.proportion}),Yi=At.b.div(_i()),Ji=Le.b.div({shrinked:{width:"calc(100% - 60px)",height:function(t){var e=t.proportion;return"calc(100% - 60px/".concat(e,")")}},fullsize:{width:"100%",height:"100%"}}),Zi=At.b.img(Ui()),tc=At.b.div(Ki(),function(t){return t.hide&&"\n    background-image: unset !important;\n  "},function(t){return t.off&&"\n    display: none;\n  "}),ec=Object(At.b)(Oe)(Hi(),function(t){return t.active?"1 !important":t.selectMode?".5 !important":"0"},tc,function(t){return t.selectMode?"1 !important":".5"}),nc=Object(At.b)(Oe)(Qi(),function(t){return t.active?".9 !important":"0"},tc,function(t){return t.active?".9 !important":t.selectMode?".5 !important":".2"}),rc=Object(Wi.SortableElement)(function(t){var e=t.drawing,n=e.id,r=e.files,o=t.toggleSelection,i=t.selected,c=t.selectMode,l=t.sortMode,u=r.find(function(t){return"ORIGINAL"===t.imgFor}),s=r.find(function(t){return"FEED_792"===t.imgFor})||u,d=s.path,m=s.width,f=s.height,p=m/f;return a.a.createElement("div",null,a.a.createElement(Xi,{proportion:p},a.a.createElement(Yi,null,a.a.createElement(tc,{hide:i,off:l,onClick:function(){if(i||c)return o(n);window.open(u.path,"_blank").focus()}},a.a.createElement(ec,{link:!0,name:"square",size:"big",fs:"2.2em",active:i,d:l?"none !important":void 0,selectMode:c,color:i?"grey":void 0},a.a.createElement(nc,{link:!0,name:"check",size:"small",color:"black",c:i?"#fff !important":void 0,active:i,selectMode:c,onClick:function(t){t.stopPropagation(),o(n)}}))),a.a.createElement(Ji,{pose:i||l?"shrinked":"fullsize",proportion:p,onClick:function(){return i&&o(n)}},a.a.createElement(Zi,{src:d,width:m,height:f})))))}),ac=Object(Wi.SortableContainer)(function(t){var e=t.drawings,n=t.toggleDrawingSelection,r=t.selectedDrawings,o=t.sortMode;return a.a.createElement("div",null,e.map(function(t,e){return a.a.createElement(rc,{key:t.id,index:e,drawing:t,toggleSelection:n,selected:!!r.includes(t.id),selectMode:!!r.length,sortMode:o,disabled:!o})}))}),oc=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={sortedCollection:[]},n.move=function(t,e){n.setState(Object(Me.a)(function(n){var r=n.sortedCollection.splice(t,1),a=Object(qe.a)(r,1)[0];n.sortedCollection.splice(e,0,a)}))},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return(0,this.props.children)({sortedCollection:this.state.sortedCollection,move:this.move})}}],[{key:"getDerivedStateFromProps",value:function(t,e){if(t.collection!==e.prevPropsCollection){console.log(" > getDerivedStateFromProps");var n=t.collection,r=t.sortBy;return{prevPropsCollection:n,sortedCollection:n.sort(function(t,e){return t[r]<e[r]?-1:1})}}return null}}]),e}(r.Component),ic=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={list:[]},n.toggle=function(t){n.setState(Object(Me.b)(function(e){console.log("draft > ",e);var n=e.list.indexOf(t);-1!==n?e.list.splice(n,1):e.list.push(t)}))},n.clear=function(){return n.setState({list:[]})},n.removeMany=function(t){n.setState(function(e){var n=e.list;return{list:Object(nr.a)(n.filter(function(e){return!t.includes(e)}))}})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return this.props.children({list:this.state.list,toggle:this.toggle,clear:this.clear,removeMany:this.removeMany})}}]),e}(r.Component),cc=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={bool:!1},n.toggle=function(){n.setState(function(t){return{bool:!t.bool}})},n.enable=function(){return n.setState({bool:!0})},n.disable=function(){return n.setState({bool:!1})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return this.props.children({bool:this.state.bool,toggle:this.toggle,enable:this.enable,disable:this.disable})}}]),e}(r.Component);function lc(){var t=Object(v.a)(["\n  &&& {\n\t\tbox-sizing: content-box;\n\t\twidth: calc(55px - 1em);\n\t\tmargin: 0 0.5em;\n\t}\n"]);return lc=function(){return t},t}function uc(){var t=Object(v.a)(["\n  position: absolute;\n  z-index: 1;\n  top: 1px;\n  right: 0;\n  left: 0;\n  height: 48px;\n  display: flex;\n  align-items: center;\n  background-color: rgba(255,255,255,1);\n"]);return uc=function(){return t},t}function sc(){var t=Object(v.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 2;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0,0,0,.65);\n"]);return sc=function(){return t},t}function dc(){var t=Object(v.a)(["\n  position: relative;\n  :focus {\n    outline: none;\n  }\n"]);return dc=function(){return t},t}var mc=At.b.div(dc()),fc=Object(At.b)(Le.b.div({enter:{opacity:1},exit:{opacity:0}}))(sc()),pc=Object(At.b)(Le.b.div({enter:{opacity:1},exit:{opacity:0}}))(uc()),bc=Object(At.b)(Oe)(lc()),gc=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this;console.log("> Drawings render");var e=this.props,n=e.model,r=e.sidebarRef,o=n.id,i=n.drawings;return a.a.createElement(Qe,null,function(e){var c=e.notify;return a.a.createElement(Ue.a,{mutation:J,onCompleted:function(){return c({type:"success",title:"\u0424\u0430\u0439\u043b\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"})},onError:function(t){return c({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u0430\u0439\u043b\u043e\u0432",content:t.message})}},function(e,u){var s=u.loading,d=u.client;return a.a.createElement(Ue.a,{mutation:Z,onCompleted:function(){return c({type:"success",title:"\u0424\u0430\u0439\u043b\u044b \u0443\u0434\u0430\u043b\u0435\u043d\u044b"})},onError:function(t){return c({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432",content:t.message})}},function(u,m){var f=m.loading;return a.a.createElement(Ue.a,{mutation:tt,onCompleted:function(){return c({type:"success",content:"\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0447\u0435\u0440\u0442\u0435\u0436\u0435\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d"})},onError:function(t){return c({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438",content:t.message})}},function(m,p){var b=p.loading;return a.a.createElement(oc,{collection:i,sortBy:"sortOrder"},function(i){var p=i.sortedCollection,g=i.move;return a.a.createElement(ic,null,function(i){var v=i.list,h=i.toggle,E=i.clear,y=i.removeMany;return a.a.createElement(cc,null,function(i){var O=i.bool,j=i.enable,x=i.disable;return a.a.createElement(zi.a,{disabled:O,onDrop:function(){var r=Object(an.a)(rn.a.mark(function r(a){var i,c;return rn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("acceptedFiles > ",a),a.length){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,e({variables:{modelId:o,files:a}});case 5:if(i=r.sent){r.next=8;break}return r.abrupt("return");case 8:c=i.data,d.writeData({id:"Model:".concat(o),data:Object(l.a)({},n,{drawings:[].concat(Object(nr.a)(p),Object(nr.a)(c.createDrawings))})}),t.collapsableSection.expand();case 11:case"end":return r.stop()}},r)}));return function(t){return r.apply(this,arguments)}}(),disableClick:!0,accept:"image/jpeg, image/png",onDropRejected:function(){return c({type:"error",title:"\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0444\u0430\u0439\u043b\u0430",content:"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f .jpeg \u0438\u043b\u0438 .png"})}},function(e){var i=e.getRootProps,w=e.getInputProps,k=e.open,C=e.isDragActive;return a.a.createElement(mc,Object.assign({isDragActive:C},i()),a.a.createElement("input",w()),a.a.createElement(Le.a,null,C&&a.a.createElement(fc,{key:"1"},a.a.createElement(Oe,{name:"download",size:"large",c:"white"})),v.length&&a.a.createElement(pc,{key:"2"},a.a.createElement(bc,{link:!0,size:"large",name:"cancel",onClick:function(){return E()}}),a.a.createElement(he,{fs:"1.1em",c:"rgba(0,0,0,.75)",fw:"700"},"\u0412\u044b\u0431\u0440\u0430\u043d\u043e \u0447\u0435\u0440\u0442\u0435\u0436\u0435\u0439: ",v.length),a.a.createElement(he,{m:"0 23px 0 auto"},a.a.createElement(Oe,{link:!0,d:f?"none":void 0,activeColor:"#db2828",name:"trash alternate outline",size:"large",onClick:Object(an.a)(rn.a.mark(function t(){var e;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=v,t.next=3,u({variables:{ids:e}});case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:d.writeData({id:"Model:".concat(o),data:Object(l.a)({},n,{drawings:Object(nr.a)(p.filter(function(t){return!e.includes(t.id)}))})}),y(e),console.log("deleted!");case 9:case"end":return t.stop()}},t)}))}),a.a.createElement(Vi.a,{inline:!0,size:"small",active:f}))),O&&a.a.createElement(pc,{key:"3"},a.a.createElement(bc,{link:!0,name:"check",size:"large",c:"#016936",onClick:Object(an.a)(rn.a.mark(function t(){var e;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!1,p.forEach(function(t,n){t.sortOrder!==n&&(e=!0,d.writeData({id:"Drawing:".concat(t.id),data:Object(l.a)({},t,{sortOrder:n})}))}),!e){t.next=5;break}return t.next=5,m({variables:{ids:p.map(function(t){return t.id})}});case 5:x();case 6:case"end":return t.stop()}},t)}))}),a.a.createElement(he,{fs:"1.1em",c:"rgba(0,0,0,.75)",fw:"700"},"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430"),a.a.createElement(he,{m:"0 23px 0 auto"},a.a.createElement(Vi.a,{inline:!0,size:"small",active:b})))),a.a.createElement(ki,{ref:function(e){return t.collapsableSection=e},initiallyExpanded:!!p.length,disabled:!p.length,title:"\u0427\u0435\u0440\u0442\u0435\u0436 ",subtitle:a.a.createElement(he,{fs:"1.2em"},a.a.createElement(Oe,{name:"file image outline",mr:"4px"}),p.length),buttons:a.a.createElement(a.a.Fragment,null,a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",onClick:function(t){t.stopPropagation(),c({type:"warning",content:"\u0427\u0442\u043e\u0431\u044b \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b, \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0440\u0430\u0437\u0434\u0435\u043b"}),k()},loading:s}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,icon:"sort",onClick:function(t){t.stopPropagation(),c({type:"warning",content:"\u0427\u0442\u043e\u0431\u044b \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0440\u044f\u0434\u043e\u043a, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u043d\u0443\u0436\u043d\u044b\u0435 \u0447\u0435\u0440\u0442\u0435\u0436\u0438"}),j()}}))},a.a.createElement(ac,{drawings:p,toggleDrawingSelection:h,selectedDrawings:v,sortMode:O,onSortEnd:function(t){var e=t.oldIndex,n=t.newIndex;return g(e,n)},getContainer:function(){return r}})))})})})})})})})})}}]),e}(r.Component),vc=function(t){var e=t.model,n=t.sidebarRef;return a.a.createElement(a.a.Fragment,null,a.a.createElement(gc,{model:e,sidebarRef:n}))};function hc(){var t=Object(v.a)(["\n\t/* flex-grow: 1; */\n\twidth: 60%;  // evaluates to 792px\n"]);return hc=function(){return t},t}var Ec=At.b.div(hc()),yc=function(t){var e=t.closeDetails,n=t.sidebarRef;return a.a.createElement(Yn,null,function(t){var r=t.details,o=r.type,i=r.id,c=r.enquiryId,l=r.editMode,u=t.setDetails,s=t.setExpanded;return a.a.createElement(Ec,null,a.a.createElement(Cr,{type:o,id:i},function(t){var r=t.loading,d=(t.error,t.refetch),m=t.entity,f=t.localEntity;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Rr,{type:o,localEntity:f,closeDetails:e,setDetails:u,editMode:l,loading:r,refresh:function(){return d()}}),"Enquiry"===o?a.a.createElement(fi,{id:i,closeDetails:e}):null,"Order"===o&&("new"===i||l?a.a.createElement(hi,{id:i,enquiryId:c,closeDetails:e,setDetails:u,setExpanded:s}):m&&a.a.createElement(Ai,{order:m})),"Model"===o&&("new"===i||l?a.a.createElement("div",null):m&&a.a.createElement(vc,{model:m,sidebarRef:n})))}))})},Oc=n(512),jc=n.n(Oc),xc=n(513),wc=n.n(xc),kc=n(514),Cc=n.n(kc),Fc=n(515),Ic=n.n(Fc),Sc=n(227),Dc=n.n(Sc),qc=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).select=function(t){var e=n.props,r=e.depts,a=e.setList,o=e.selectLimit,i=la()(r),c=i.reduce(function(t,e){return[].concat(Object(nr.a)(t),Object(nr.a)(e.prods.filter(function(t){return t.selected}).map(function(t){return t.id})))},[]),l=Dc()({id:t},i)||Dc()({prods:[{id:t}]},i),u=l.prods,s=l.id===t?l:Dc()({id:t},u);if(s.disabled)return null;var d=[];if("Prod"===s.__typename&&(d=c.includes(t)?jc()(c,t):[].concat(Object(nr.a)(c),[t])),"Dept"===s.__typename&&(["partly",!0].includes(s.selected)&&(d=Ic()(c,u.map(function(t){return t.id}))),!1===s.selected)){var m=wc()(u.filter(function(t){return!t.disabled}).map(function(t){return t.id}),o-c.length);d=Cc()(c,m)}a(d)},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return(0,this.props.children)({select:this.select})}}]),e}(r.Component),Mc=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={list:[]},n.setList=function(t){return n.setState({list:t})},n.toggle=function(t){var e=n.state.list,r=e.includes(t)?Object(nr.a)(e.filter(function(e){return e!==t})):[].concat(Object(nr.a)(e),[t]);n.setState({list:r})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){return this.props.children({list:this.state.list,setList:this.setList,toggle:this.toggle})}}]),e}(r.Component),Bc=Hn(Object(Qn.a)(N,{name:"orderLocal"}))(function(t){return(0,t.children)({orderLocal:t.orderLocal.orderLocal||[]})});function Pc(){var t=Object(v.a)(["\n\twidth: 40%;\n\tmin-height: calc(100vh - 36px);\n\theight: fit-content;\n\t/* border-left: 1px solid rgb(126, 126, 129); */\n\tborder-left: 1px solid rgb(156, 156, 159);\n"]);return Pc=function(){return t},t}var Lc=At.b.div(Pc()),Nc=function(t){var e=t.closeExtra;return a.a.createElement(Yn,null,function(t){var n=t.extra,o=t.selectedProdIds,i=t.setSelectedProdIds;return a.a.createElement(Lc,null,!!n&&a.a.createElement(r.Fragment,null,a.a.createElement(Ue.b,{query:st,variables:{id:n.modelId}},function(t){var n=t.data.modelLocal;return a.a.createElement(Ei,{title:n.name+" \u0432 \u043d\u0430\u043b\u0438\u0447\u0438\u0438",size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(Qt.a,{link:!0,name:"cancel",onClick:e})})}),a.a.createElement(Ue.b,{query:Ni,variables:{modelId:n.modelId}},function(t){var e=t.loading,r=t.error,c=t.data;return e?a.a.createElement(Ce,{noIndent:!0},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."):r?a.a.createElement(Ce,{noIndent:!0},"\u041e\u0448\u0438\u0431\u043a\u0430 ",r.message):a.a.createElement(Bc,{id:n.orderId},function(t){var e=t.orderLocal;return a.a.createElement(Mc,null,function(t){var r=t.list,l=t.toggle;return a.a.createElement(Ii,{prods:c.modelProds,selectedIds:o,orderId:n.orderId,selectLimit:e.qty,expandedIds:r},function(t){var n=t.depts;return a.a.createElement(qc,{depts:n,setList:i,selectLimit:e.qty},function(t){var e=t.select;return a.a.createElement(Di,{depts:n,select:e,expand:l})})})})})})))})};function Tc(){var t=Object(v.a)(["\n\t&&&& {\n\t\tdisplay: flex;\n\t\twidth: 120%;\n\t\tbackground-color: white;\n\t\ttransition: all .5s ease;\n\t\tmax-width: ",";\n\t\t","\n\t\t","\n\t}\n"]);return Tc=function(){return t},t}var $c=Object(At.b)(Kn.a)(Tc(),function(t){return"Enquiry"===t.type?"1000px":"1320px"},function(t){return!t.extra&&"\n\t\t\t&.ui.visible.right.overlay.sidebar {\n\t\t\t\ttransform: translate3d(40%,0,0);\n\t\t\t}\n\t\t"},function(t){return t.extra&&"\n\t\t\twidth: 86%;\n\t\t"}),Rc=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={detailsClosing:!1},n.closeDetails=function(){n.setState({detailsClosing:!0}),setTimeout(function(){n.props.setLayout({variables:{input:{details:null,extra:null}}}),n.setState({detailsClosing:!1})},300)},n.closeExtra=function(){n.props.setLayout({variables:{input:{extra:null}}})},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this,e=this.state.detailsClosing,n=this.props.layout,o=n.details,i=n.extra;return a.a.createElement(_t.a,{innerRef:function(e){return t.sidebarRef=e}},a.a.createElement($c,{visible:!!o&&!e,extra:i?1:0,type:o&&o.type,animation:"overlay",direction:"right"},o&&a.a.createElement(r.Fragment,null,a.a.createElement(yc,{key:o.type+o.id,closeDetails:this.closeDetails,sidebarRef:this.sidebarRef}),a.a.createElement(Nc,{extra:i,closeExtra:this.closeExtra}))))}}]),e}(r.Component),Ac=Hn(Object(Qn.a)(x,w),Object(Qn.a)(k,{name:"setLayout"}))(Rc);function zc(){var t=Object(v.a)(["\n  flex: 0 0 0;\n  min-height: 387px;\n  background: #fff;\n  z-index: 10;\n  /* box-shadow: 0 0 20px rgba(34,36,38,.15); shadow of semantic-ui Sidebar*/\n  box-shadow: 0 0 20px 5px #fff;\n  transition: min-height .4s ease-out;\n  ","\n"]);return zc=function(){return t},t}function Vc(){var t=Object(v.a)(["\n  flex: 1 0 50px;\n  min-height: 50px;\n  overflow-y: auto;\n  overflow-x: hidden;\n"]);return Vc=function(){return t},t}function Wc(){var t=Object(v.a)(["\n  height: calc(100vh - 36px) !important;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n"]);return Wc=function(){return t},t}var Qc=At.b.div(Wc()),Hc=At.b.div(Vc()),Kc=At.b.div(zc(),function(t){return!t.panelVisible&&"\n    min-height: 0;\n  "}),Uc=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.children,n=t.panel,r=t.panelVisible,o=t.panelRendered;return a.a.createElement(Qc,null,a.a.createElement(Hc,{panelVisible:r},e),a.a.createElement(Kc,{panelVisible:r},o&&n))}}]),e}(r.Component);function _c(){var t=Object(v.a)(["\n\tfragment TelFragment on Tel {\n\t\tid\n\t\tnumber\n\t\ttype\n\t\tcountry\n\t\tnote\n\t\tdefault\n\t}\n"]);return _c=function(){return t},t}var Gc=E()(_c());function Xc(){var t=Object(v.a)(["\n\tmutation upsertPerson2($input: PersonInput!) {\n\t\tupsertPerson2(input: $input) {\n\t\t\t...personExecFragment\n\t\t}\n\t}\n\t","\n"]);return Xc=function(){return t},t}function Yc(){var t=Object(v.a)(["\n\tquery personExec ($id: ID!) {\n\t\tperson (id: $id) { ...personExecFragment }\n\t}\n\t","\n"]);return Yc=function(){return t},t}function Jc(){var t=Object(v.a)(["\n\tquery personExecs {\n\t\tpersons { ...personExecFragment }\n\t}\n\t","\n"]);return Jc=function(){return t},t}function Zc(){var t=Object(v.a)(["\n\tquery Persons {\n\t\tpersons { ...PersonFragmentBasic }\n\t}\n\t","\n"]);return Zc=function(){return t},t}function tl(){var t=Object(v.a)(["\n\tfragment personExecFragment on Person {\n\t\tid\n\t\tamoName\n\t\texec {\n\t\t\tid\n\t\t\topTypes { ...opTypeFragmentBasic }\n\t\t}\n\t}\n\t","\n"]);return tl=function(){return t},t}function el(){var t=Object(v.a)(["\nfragment PersonContactsFragment on Person {\n\t...PersonFragmentBasic\n\thtmlNote\n\ttels { ...TelFragment }\n\tuser {\n\t\temail\n\t\tconfirmed\n\t}\n}\n","\n","\n"]);return el=function(){return t},t}function nl(){var t=Object(v.a)(["\n\tfragment PersonFragmentBasic on Person {\n\t\tid\n\t\tamoId\n\t\tfName\n\t\tlName\n\t\tmName\n\t\tamoName\n\t}\n"]);return nl=function(){return t},t}var rl=E()(nl()),al=E()(el(),Gc,rl),ol=E()(tl(),ha),il=E()(Zc(),rl),cl=(E()(Jc(),ol),E()(Yc(),ol),E()(Xc(),ol));function ll(){var t=Object(v.a)(["\n\tmutation UpsertEmployee(\n\t\t$input: EmployeeInput!\n\t) {\n\t\tupsertEmployee(\n\t\t\tinput: $input\n\t\t) {\n\t\t\tid\n\t\t}\n\t}\n"]);return ll=function(){return t},t}function ul(){var t=Object(v.a)(["\n\tquery OrgEmployees ($orgId: ID!) {\n\t\torgEmployees (orgId: $orgId) {\n\t\t\tid\n\t\t\tposition\n\t\t\tperson { ...PersonContactsFragment }\n\t\t}\n\t}\n\t","\n"]);return ul=function(){return t},t}var sl=E()(ul(),al),dl=E()(ll());function ml(){var t=Object(v.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\tborder-bottom: 1px solid #7e7e81;\n\t/* border-top: 1px solid rgb(180, 181, 182); color of Chrome address section bottom border */\n\tborder-top: 1px solid rgb(160, 161, 162);\n"]);return ml=function(){return t},t}var fl=At.b.div(ml()),pl=function(t){var e=t.closePanel;return a.a.createElement(Yn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(fl,null,a.a.createElement(Oe,{w:"30px",m:"0 10px",link:!0,name:"cancel",size:"large",onClick:e}),a.a.createElement(Ue.b,{query:$a,variables:{id:n.orgId}},function(t){var e=t.data;return e&&e.orgLocal?a.a.createElement(ye,{inline:!0,pl:"0 !important",size:"medium",content:"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u0438 \xa0 ".concat(e.orgLocal.name)}):null}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"plus",active:!n.id,onClick:function(){return r(Object(Me.a)(n,function(t){delete t.id}))}}))})},bl=function(t){var e=t.tel;return a.a.createElement("div",null,fr(e))};function gl(){var t=Object(v.a)(["\n  flex: 1 1 auto;\n  min-width: 210px;\n  font-size: calc(15rem/14);\n  font-weight: bold;\n  line-height: 1.21428571rem;\n  padding-top: .67857143rem;\n"]);return gl=function(){return t},t}function vl(){var t=Object(v.a)(["\n  flex: 0 0 122px;\n  color: rgba(0,0,0,.87);\n  line-height: 1.21428571rem;\n  padding-top: .67857143rem;\n  vertical-align: top;\n"]);return vl=function(){return t},t}function hl(){var t=Object(v.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: .67857143rem;\n"]);return hl=function(){return t},t}var El=At.b.div(hl()),yl=At.b.div(vl()),Ol=At.b.div(gl()),jl=function(t){var e=t.type,n=t.label,o=t.content,i=function(t){return"string"===e?t:"tel"===e?a.a.createElement(bl,{tel:t}):null};return a.a.createElement(El,null,a.a.createElement(yl,null,n),a.a.createElement(Ol,null,Array.isArray(o)?o.map(function(t,e){return a.a.createElement(r.Fragment,{key:e},i(t))}):i(o)))},xl=function(t){return function t(e,n,r){var o=Array.isArray(n)?n[0]:n,i=Object.keys(o);if(i.includes("label")){var c=o.type||"string";return a.a.createElement(jl,{key:r,type:c,label:o.label,content:e})}return i.filter(function(t){return Array.isArray(e[t])?e[t].length:!!e[t]}).map(function(r,a){return t(e[r],n[r],a)})}(t.entity,t.schema,"0")},wl=Object(lo.object)().shape({id:uo.notRequired(),country:Object(lo.string)().oneOf(["rus","notRus"]).when("id",function(t,e){return t?e.notRequired():e.default("rus")}),number:Object(lo.lazy)(function(t){return t?Object(lo.string)().transform(function(t){return t.match(/.*\d.*/)?t.match(/\d+/g).join(""):t}).when("country",{is:"rus",then:Object(lo.string)().matches(/\d{10}/,"\u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c 10 \u0446\u0438\u0444\u0440"),otherwise:Object(lo.string)().matches(/\d{7,25}/,"\u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043e\u0442 7 \u0434\u043e 25 \u0446\u0438\u0444\u0440")}):Object(lo.string)()})}),kl=Object(lo.object)().shape({id:uo.notRequired(),lName:Object(lo.lazy)(function(t){return t?Object(lo.string)().trim().min(2).max(255):Object(lo.string)()}),fName:Object(lo.string)().trim().min(2).max(255).when("id",function(t,e){return t?e.notRequired():e.required("\u041f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435 \u0418\u043c\u044f")}),mName:Object(lo.lazy)(function(t){return t?Object(lo.string)().trim().min(2).max(255):Object(lo.string)()}),tels:Object(lo.array)().of(wl)}),Cl=Object(lo.object)().shape({id:uo.notRequired(),orgId:uo.when("id",function(t,e){return t?e.notRequired():e.required()}),person:kl}),Fl={person:{lName:"",fName:"",mName:"",tels:[{number:"",country:"rus"}]}},Il={person:{lName:{label:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"},fName:{label:"\u0418\u043c\u044f"},mName:{label:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"},tels:[{label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel"}]}},Sl=function(t){var e=t.emp,n=t.toggleEditMode;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ei,{title:e.person.fullname,size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(a.a.Fragment,null,a.a.createElement(Oe,{link:!0,name:"edit",activeColor:"blue",onClick:n}))}),a.a.createElement(ge,{p:"1em"},a.a.createElement(xl,{entity:e,schema:Il})))},Dl=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).didMount=!1,n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"componentDidMount",value:function(){this.didMount=!0}},{key:"componentWillUnmount",value:function(){this.didMount=!1}},{key:"render",value:function(){var t=this,e=this.props,n=e.emp,r=e.orgId,o=e.toggleEditMode,i=e.refetchQueries,c=n?Fl:Object(l.a)({},Fl,{orgId:r}),u=n?Xa(n,c):c;return a.a.createElement(Ue.a,{mutation:dl,onCompleted:function(){return i()}},function(e,r){var i=r.loading,l=r.error;return a.a.createElement(Ga.b,{initialValues:u,validationSchema:Cl,onSubmit:function(){var r=Object(an.a)(rn.a.mark(function r(a,i){var l,s;return rn.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=i.resetForm,s=Ya(a,u,c),r.next=4,e({variables:{input:s}});case 4:return r.abrupt("return",n?o():t.didMount&&l());case 5:case"end":return r.stop()}},r)}));return function(t,e){return r.apply(this,arguments)}}()},function(t){t.values,t.handleChange;var e=t.handleSubmit,r=t.handleReset;t.setFieldValue;return a.a.createElement(a.a.Fragment,null,a.a.createElement(To,{label:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",name:"person.lName"}),a.a.createElement(To,{label:"\u0418\u043c\u044f",required:!0,name:"person.fName"}),a.a.createElement(To,{label:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",name:"person.mName"}),a.a.createElement(To,{label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",name:"person.tels"}),!!l&&a.a.createElement(we,{error:!0,header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c..",content:l&&l.message}),a.a.createElement(xe,{ml:"122px",type:"button",primary:!0,content:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:i,onClick:e}),a.a.createElement(Ee,{cancel:!0,onClick:n?o:r},n?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})}}]),e}(r.Component),ql=function(t){function e(){return Object(Rn.a)(this,e),Object(zn.a)(this,Object(Vn.a)(e).apply(this,arguments))}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this.props,e=t.emp,n=t.orgId,r=t.toggleEditMode,o=t.refetchQueries;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ei,{title:e?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044f",size:"small",noIndent:!0,bottomBorder:"dark",buttons:a.a.createElement(a.a.Fragment,null)}),a.a.createElement(ge,{p:"1em",oy:"auto",h:"315px"},a.a.createElement(Dl,{emp:e,orgId:n,toggleEditMode:r,refetchQueries:o})))}}]),e}(r.Component),Ml=[{name:"fullname",title:"\u0424\u0418\u041e",width:"250px"},{name:"tel",title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",width:"140px"}],Bl=function(t){var e=t.emps;return a.a.createElement(Yn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(dr,{fields:Ml,indent:"27px"},function(t){var o=t.tableFields;return e.map(function(t){var e=t.id,i=t.person,c=i||{},u=c.lName,s=c.fName,d=c.mName,m=c.tels,f=n.id===e;return a.a.createElement(xr,{key:e,entity:t,tableFields:o,rowFields:[{name:"fullname",value:i?[u,s,d].join(" "):"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u044b"},{name:"tel",value:m&&m.length&&fr(m[0])||""}],active:f,onClick:function(){r(Object(l.a)({},n,{editMode:!1,id:e}))}})})})})};function Pl(){var t=Object(v.a)(["\n  flex: 0 0 480px;\n  border: solid rgb(156,156,159);\n  border-width: 0 1px;\n  min-height: 100%;\n"]);return Pl=function(){return t},t}function Ll(){var t=Object(v.a)(["\n  flex: 0 0 600px;\n"]);return Ll=function(){return t},t}function Nl(){var t=Object(v.a)(["\n  display: flex;\n  height: calc(100% - 37px);\n"]);return Nl=function(){return t},t}var Tl=At.b.div(Nl()),$l=At.b.div(Ll()),Rl=At.b.div(Pl()),Al=function(t){var e=t.closePanel;return a.a.createElement(Yn,null,function(t){var n=t.bottomPanel,r=t.setBottomPanel;return a.a.createElement(a.a.Fragment,null,a.a.createElement(pl,{closePanel:e}),a.a.createElement(Ue.b,{query:sl,variables:{orgId:n.orgId}},function(t){var e=t.loading,o=t.error,i=t.data,c=t.refetch;if(e)return"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..";if(o)return"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(o.message);var u,s=i.orgEmployees,d=n.id&&i.orgEmployees.find(function(t){return t.id===n.id});return a.a.createElement(Tl,null,a.a.createElement($l,null,s.length?a.a.createElement(Bl,{emps:s}):a.a.createElement(we,{m:"1em",content:a.a.createElement(a.a.Fragment,null,"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u0435\u043b\u044f",a.a.createElement("br",null),"\ud83d\udc49")})),a.a.createElement(Rl,null,n.id?d.person?n.editMode?a.a.createElement(ql,{emp:d,orgId:n.orgId,toggleEditMode:function(){return r(Object(Me.a)(n,function(t){delete t.editMode}))},refetchQueries:c}):a.a.createElement(Sl,{emp:(u=d,Object(Me.a)(u,function(t){var e=t.person,n=e.lName,r=e.fName,a=e.mName;t.person.fullname=[n,r,a].join(" ")})),toggleEditMode:function(){return r(Object(l.a)({},n,{editMode:!0}))}}):null:a.a.createElement(ql,{orgId:n.orgId,refetchQueries:c})))}))})};function zl(){var t=Object(v.a)(["\n\tmin-height: calc(100vh - 36px) !important;\n"]);return zl=function(){return t},t}var Vl=Object(At.b)(Kn.a.Pushable)(zl()),Wl=function(t){function e(){var t,n;Object(Rn.a)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(zn.a)(this,(t=Object(Vn.a)(e)).call.apply(t,[this].concat(a)))).state={panelClosing:!1},n.closePanel=function(){n.setState({panelClosing:!0}),setTimeout(function(){n.props.setLayout({variables:{input:{bottomPanel:null}}}),n.setState({panelClosing:!1})},430)},n}return Object(Wn.a)(e,t),Object(An.a)(e,[{key:"render",value:function(){var t=this,e=this.props.allEnquiries,n=e.loading,r=e.error,o=e.refetch,i=e.enquiries,c=this.state.panelClosing;return a.a.createElement(a.a.Fragment,null,a.a.createElement(er,{refetchEnquiries:function(){return o()},enquiriesAreLoading:n}),n&&"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",r&&"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(r.message),i&&a.a.createElement(Yn,null,function(e){var n=e.bottomPanel;return a.a.createElement(Vl,null,a.a.createElement(Ac,null),a.a.createElement(Kn.a.Pusher,null,a.a.createElement(Uc,{panel:a.a.createElement(Al,{closePanel:t.closePanel}),panelRendered:!!n,panelVisible:!!n&&!c},a.a.createElement(kr,{enquiries:i}))))}))}}]),e}(r.Component),Ql=Hn(Object(Qn.a)(xt,{name:"allEnquiries",alias:"allEnquiriesQuery"}),Object(Qn.a)(k,{name:"setLayout"}))(Wl),Hl=n(516);function Kl(){var t=Object(v.a)(["\n\tfragment ArticleFragmentFull on Article {\n\t\t...ArticleFragmentBasic\n\t\trelations\n\t}\n\t","\n"]);return Kl=function(){return t},t}function Ul(){var t=Object(v.a)(["\n\tfragment ArticleFragmentBasic on Article {\n\t\tid\n\t\trusName\n\t\tisIncome\n\t\tisLoan\n\t}\n"]);return Ul=function(){return t},t}var _l=E()(Ul()),Gl=E()(Kl(),_l);function Xl(){var t=Object(v.a)(["\n\tfragment mpProjectFragmentFull on MpProject {\n\t\t...mpProjectFragmentBasic\n\t\tStatus\n\t\tSuperProjectId\n\t}\n\t","\n"]);return Xl=function(){return t},t}function Yl(){var t=Object(v.a)(["\n\tfragment mpProjectFragmentBasic on MpProject {\n\t\tId\n\t\tName\n\t}\n"]);return Yl=function(){return t},t}var Jl=E()(Yl()),Zl=E()(Xl(),Jl);function tu(){var t=Object(v.a)(["\n\tmutation createMdKontragent($inn: String!) {\n\t\tcreateMdKontragent(inn: $inn) {\n\t\t\t...mdKontragentFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return tu=function(){return t},t}function eu(){var t=Object(v.a)(["\n\tfragment mdKontragentFragmentBasic on MdKontragent {\n    Id\n    Inn\n\t\tName\n\t}\n"]);return eu=function(){return t},t}var nu=E()(eu()),ru=E()(tu(),nu);function au(){var t=Object(v.a)(["\n\tmutation UpsertPayment(\n\t\t$input: PaymentInput!\n\t) {\n\t\tupsertPayment(\n\t\t\tinput: $input\n\t\t) {\n\t\t\t...PaymentFragmentBasic\n\t\t}\n\t}\n\t","\n"]);return au=function(){return t},t}function ou(){var t=Object(v.a)(["\n\tquery PaymentsPage {\n\t\tarticles { ...ArticleFragmentFull }\n\t\tmdKontragents { ...mdKontragentFragmentBasic }\n\t\tmpProjects { ...mpProjectFragmentFull }\n\t\torgs { ...OrgFragmentBasic }\n\t\tpayments { ...PaymentFragmentBasic }\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return ou=function(){return t},t}function iu(){var t=Object(v.a)(["\n\tquery Payments {\n\t\tpayments { ...PaymentFragmentBasic }\n\t}\n\t","\n"]);return iu=function(){return t},t}function cu(){var t=Object(v.a)(["\n\tfragment PaymentFragmentBasic on Payment {\n\t\tid\n\t\tinn\n\t\tisIncome\n\t\tdateLocal\n\t\tamount\n\t\tpurpose\n\t\taccount { ...accountFragmentBasic }\n\t\tarticle { ...ArticleFragmentBasic }\n\t\tcreatedBy { ...userFragmentBasic }\n\t\tmpProjectId\n\t\torg { ...OrgFragmentBasic }\n\t\tperson { ...PersonFragmentBasic }\n\t\tupdatedBy { ...userFragmentBasic }\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return cu=function(){return t},t}var lu=E()(cu(),mn,_l,qa,rl,En),uu=(E()(iu(),lu),E()(ou(),Gl,qa,nu,Zl,lu)),su=E()(au(),lu),du=n(102);function mu(){var t=Object(v.a)(["\n  width: 100%;\n"]);return mu=function(){return t},t}var fu=At.b.div(mu()),pu=function(t){var e=t.payments.filter(function(t){return!t.article||!t.article.isLoan}).map(function(t){var e=t.article?t.article.isIncome:t.isIncome;return{x:new Date(t.dateLocal.slice(0,10)).getTime(),y:(e?1:-1)*t.amount}}).reduce(function(t,e){var n=t[0].length;return n&&t[0][n-1].x===e.x||(t.forEach(function(t){return t.push({x:e.x,y:0,y0:0})}),n=t[0].length),e.y>0&&(t[0][n-1].y+=e.y),e.y<0&&(t[1][n-1].y0+=e.y),t[2][n-1].y+=e.y,t},[[],[],[]]),n=Object(qe.a)(e,3),r=n[0],o=n[1],i=n[2],c=0,l=i.reverse().reduce(function(t,e){var n=(t.findIndex(function(t){return t.x===e.x})+1||t.push({x:e.x,y:c})&&t.push({x:e.x,y:0}))-1;return t[n].y=c+=e.y,t},[]);return a.a.createElement(fu,null,a.a.createElement(du.a,{height:400,margin:{left:60},stackBy:"y"},a.a.createElement(du.b,null),a.a.createElement(du.e,{tickFormat:function(t){return new Date(t).toLocaleDateString()}}),a.a.createElement(du.f,null),a.a.createElement(du.c,{data:l}),a.a.createElement(du.d,{stack:!0,data:o,color:"rgb(255, 152, 51)"}),a.a.createElement(du.d,{stack:!0,data:r,color:"#4fb79b"})))};function bu(){var t=Object(v.a)(["\n\tmutation SyncWithAmoContacts {\n\t\tsyncWithAmoContacts {\n\t\t\t...PersonFragmentBasic\n\t\t\t...personExecFragment\n\t\t}\n\t}\n\t","\n\t","\n"]);return bu=function(){return t},t}var gu=E()(bu(),rl,ol),vu=Object(lo.object)().shape({id:uo.notRequired(),accountId:uo.when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0447\u0435\u0442 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430")}),articleId:uo.when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430")}),amount:Object(lo.number)().positive("\u0437\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c").when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u043f\u043b\u0430\u0442\u0435\u0436\u0430")}),dateLocal:Object(lo.date)("\u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u0442\u044b").when("id",function(t,e){return t?e.notRequired():e.required("\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414T\u0427\u0427:\u041c\u041c")}),mpProjectId:Object(lo.number)().integer().notRequired(),personId:uo.notRequired(),inn:Object(lo.string)().min(10,"\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c 10-\u0442\u0438 \u0438\u043b\u0438 12-\u0442\u0438 \u0437\u043d\u0430\u0447\u043d\u044b\u043c").max(12,"\u0418\u041d\u041d \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c 10-\u0442\u0438 \u0438\u043b\u0438 12-\u0442\u0438 \u0437\u043d\u0430\u0447\u043d\u044b\u043c").notRequired(),purpose:Object(lo.string)().max(250,"\u043f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (250)").notRequired()});function hu(){var t=Object(v.a)(["\n\t.fz-formFieldLabel {\n\t\t","\n\t}\n"]);return hu=function(){return t},t}function Eu(){var t=Object(v.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\theight: 52px;\n\tpadding: 0 2rem;\n\tfont-size: 1.28571429rem;\n\tline-height: 1.28571429em;\n\tfont-weight: bold;\n\tborder-bottom: 1px solid rgba(34,36,38,.15);\n"]);return Eu=function(){return t},t}function yu(){var t=Object(v.a)(["\n\tmin-height: content;\n\tmax-width: 50%;\n\tmin-width: 430px;\n\tflex: 0 0 430px;\n\tbox-shadow: 0 2px 4px 0 rgba(34,36,38,.12), 0 2px 10px 0 rgba(34,36,38,.15);\n\tborder: 1px solid rgba(34,36,38,.15);\n\tborder-radius: .28571429rem;\n"]);return yu=function(){return t},t}var Ou=At.b.div(yu()),ju=At.b.div(Eu()),xu=At.b.div(hu(),function(t){var e=t.labelWidth;return e?"flex-basis: ".concat(e," !important;"):""}),wu=function(t){var e=t.children,n=t.payment,a=Object(r.useState)(!(!n||!n.org)),o=Object(qe.a)(a,2),i=o[0],c=o[1];return Object(r.useEffect)(function(){c(!(!n||!n.org))},[n]),e({orgCounterparty:i,setOrgCounterparty:c})},ku=function(t){var e=t.accounts,n=t.accountsQuery,r=t.client,o=t.articles,i=t.defaultAccountId,c=t.mdKontragents,u=t.mpProjects,s=t.payment,d=(t.refetchAccounts,t.reset),m=function(t,e){return{dateLocal:fa(t),accountId:e||"",articleId:"",personId:"",inn:"",purpose:"",mpProjectId:"",amount:""}}(new Date,i),f=s?Xa(s,m):m,p=e.filter(function(t){return!t.number}).map(function(t){return{key:t.id,text:t.name,value:t.id}}),b=o.map(function(t){return{key:t.id,text:t.rusName,value:t.id}}),g=u.map(function(t){return{key:t.Id,text:t.Id-1e6+". "+t.Name,value:t.Id}}),v=s&&null!==s.isIncome;return a.a.createElement(Qe,null,function(t){var e=t.notify;return a.a.createElement(Ou,null,a.a.createElement(Ue.b,{query:il,onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432",content:t.message})}},function(t){var o=t.loading,i=t.data,u=t.refetch;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ue.a,{mutation:gu,onCompleted:function(){u(),e({type:"success",title:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441 \u0410\u043c\u043e",content:t.message})}},function(t,e){var n=e.loading;return a.a.createElement(ju,null,(s?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")+" \u043f\u043b\u0430\u0442\u0435\u0436",a.a.createElement(xe,{ml:"auto",icon:"sync alternate",content:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b AmoCRM",onClick:function(){return t()},loading:n}))}),a.a.createElement(ge,{p:"1rem 2rem"},a.a.createElement(Ue.a,{mutation:su,onCompleted:function(){return e({type:"success",title:"\u041f\u043b\u0430\u0442\u0435\u0436 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f",content:t.message})},update:function(){var t=Object(an.a)(rn.a.mark(function t(e,a){var o,i,c,l;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.data.upsertPayment,i=e.readQuery({query:uu}),c=i.payments,e.writeQuery({query:uu,data:{payments:Object(Me.a)(c,function(t){var e=c.findIndex(function(t){return t.id===o.id});-1!==e?t.splice(e,1,o):t.unshift(o)})}}),t.next=5,r.query({query:n,fetchPolicy:"network-only"});case 5:l=t.sent,console.log("accountsFetched > ",l);case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},function(t,n){var r=n.loading;return a.a.createElement(Ga.b,{initialValues:f,enableReinitialize:!0,validationSchema:vu,onSubmit:function(){var e=Object(an.a)(rn.a.mark(function e(n,r){var a,o;return rn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.resetForm,o=Ya(n,s&&s.id?f:Object(l.a)({},m,{dateLocal:"",accountId:""}),m),e.next=4,t({variables:{input:o}});case 4:return e.abrupt("return",s?d():a());case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},function(t){t.values;var n=t.handleSubmit,l=t.handleReset,u=t.setFieldValue;return a.a.createElement(xu,{labelWidth:"110px"},!v&&a.a.createElement(a.a.Fragment,null,a.a.createElement(To,{label:"\u0414\u0430\u0442\u0430",required:!0,name:"dateLocal",type:"date"}),a.a.createElement(To,{label:"\u0421\u0447\u0435\u0442",required:!0,name:"accountId",options:p})),a.a.createElement(To,{label:"\u0421\u0442\u0430\u0442\u044c\u044f",required:!0,name:"articleId",options:b}),a.a.createElement(To,{label:"\u041f\u0440\u043e\u0435\u043a\u0442",name:"mpProjectId",options:g}),!v&&a.a.createElement(wu,{key:s,payment:s},function(t){var n=t.orgCounterparty,r=t.setOrgCounterparty;return n?a.a.createElement(Ue.a,{mutation:ru,onCompleted:function(t){return console.log("res > ",t)||e({type:"success",title:"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430. \u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430",content:t.message})},update:function(t,e){var n=e.data.createMdKontragent,r=t.readQuery({query:uu}).mdKontragents;t.writeQuery({query:uu,data:{mdKontragents:Object(Me.a)(r,function(t){var e=r.findIndex(function(t){return t.Id===n.Id});-1!==e?t.splice(e,1,n):t.unshift(n)})}})}},function(t,e){var n=e.loading;return a.a.createElement(To,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",required:!0,name:"inn",options:c?c.map(function(t){return{key:t.Inn,text:t.Name+" (\u0418\u041d\u041d: "+t.Inn+")",value:t.Inn}}):[],loading:n,disabled:n,allowAdditions:!0,additionLabel:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e \u0418\u041d\u041d: ",onAddItem:function(){var e=Object(an.a)(rn.a.mark(function e(n,r){var a,o,i;return rn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.value,!(o=c.find(function(t){return t.Inn===a}))){e.next=4;break}return e.abrupt("return",u("inn",o.Inn));case 4:return e.next=6,t({variables:{inn:a.toString()}});case 6:i=e.sent,u("inn",i&&i.data&&i.data.createMdKontragent.id);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),contentBeforeField:a.a.createElement("div",null,"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0438\u043b\u0438 ",a.a.createElement(Ee,{onClick:function(){r(!1),u("inn","")}},"\u041f\u0435\u0440\u0441\u043e\u043d\u0430"))})}):a.a.createElement(To,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",required:!0,name:"personId",options:i.persons?i.persons.map(function(t){return{key:t.id,text:t.amoName||t.fName,value:t.id}}):[],loading:o,disabled:o,contentBeforeField:a.a.createElement("div",null,"\u041f\u0435\u0440\u0441\u043e\u043d\u0430 \u0438\u043b\u0438 ",a.a.createElement(Ee,{onClick:function(){r(!0),u("personId","")}},"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f"))})}),!v&&a.a.createElement(a.a.Fragment,null,a.a.createElement(To,{label:"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",name:"purpose"}),a.a.createElement(To,{label:"\u0421\u0443\u043c\u043c\u0430",required:!0,name:"amount"})),a.a.createElement(xe,{ml:"110px",type:"button",primary:!0,content:s?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",loading:r,onClick:n}),a.a.createElement(Ee,{cancel:!0,onClick:s?function(){return d()}:l},s?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))})})))}))})},Cu=n(1088);function Fu(){var t=Object(v.a)(["\n\t&&&&>.value {\n\t\t","\n\t\ttext-align: unset;\n\t}\n\t&&&&>.label {\n\t\tpadding-left: 2em;\n\t\ttext-align: unset;\n\t}\n"]);return Fu=function(){return t},t}function Iu(){var t=Object(v.a)(["\n\tflex-grow: 1;\n\theight: 100%;\n\tmargin-left: 30px;\n  overflow-y: auto;\n\t>div {\n\t\twidth: 100%;\n\t}\n"]);return Iu=function(){return t},t}var Su=At.b.div(Iu()),Du=Object(At.b)(Cu.a)(Fu(),function(t){var e=t.color;return e&&"\n\t\t\tcolor: ".concat("green"===e?"#016936":"red"===e?"#9f3a38":"purple"===e?"#9924bf":"blue"===e?"#2185d0":e,";\n\t\t")}),qu=function(t){var e=t.payments,n=t.accounts,r=t.orgs,o=t.userRole,i=e.filter(function(t){return!!t.person}).map(function(t){return t.person}).reduce(function(t,e){return t.find(function(t){return t.id===e.id})||t.push(e),t},[]),c=e.filter(function(t){return!!t.article}).filter(function(t){return t.article.isLoan}).reduce(function(t,e){return t.find(function(t){return t.id===(e.person&&e.person.id)||t.id===(e.org&&e.org.id)}).total+=(e.article.isIncome?1:-1)*e.amount,t},[].concat(Object(nr.a)(i.map(function(t){return Object(l.a)({},t,{total:0})})),Object(nr.a)(r.map(function(t){return Object(l.a)({},t,{total:0})})))).reduce(function(t,e){return e.total>0?t[1].push(e):e.total<0&&t[0].push(Object(l.a)({},e,{total:-1*e.total})),t},[[],[]]);return a.a.createElement(Su,null,a.a.createElement(Cu.a.Group,null,a.a.createElement(Du,{color:"green"},a.a.createElement(Cu.a.Value,{content:pr(n.filter(function(t){return!t.number}).reduce(function(t,e){return t+e.balance},0))}),a.a.createElement(Cu.a.Label,{content:"\u041a\u0430\u0441\u0441\u0430, \u0432 \u0442.\u0447."}),a.a.createElement(Cu.a.Group,{horizontal:!0,size:"small"},n.filter(function(t){return!t.number}).map(function(t){var e=t.id,n=t.name,r=t.balance;return a.a.createElement(Cu.a,{key:e,label:n,value:pr(r)})}))),"OWNER"===o&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Du,{color:"blue"},a.a.createElement(Cu.a.Value,{content:pr(n.filter(function(t){return!!t.number}).reduce(function(t,e){return t+e.balance},0))}),a.a.createElement(Cu.a.Label,{content:"\u0421\u0447\u0435\u0442\u0430, \u0432 \u0442.\u0447."}),a.a.createElement(Cu.a.Group,{horizontal:!0,size:"small"},n.filter(function(t){return!!t.number}).map(function(t){var e=t.id,n=t.name,r=t.balance;return a.a.createElement(Cu.a,{key:e,label:n,value:pr(r)})}))),a.a.createElement(Du,{color:"purple"},a.a.createElement(Cu.a.Value,{content:pr(c[0].reduce(function(t,e){return t+e.total},0))}),a.a.createElement(Cu.a.Label,{content:"\u041d\u0430\u043c \u0434\u043e\u043b\u0436\u043d\u044b, \u0432 \u0442.\u0447."}),a.a.createElement(Cu.a.Group,{horizontal:!0,size:"small"},c[0].map(function(t){var e=t.id,n=t.amoName,r=t.name,o=t.total;return a.a.createElement(Cu.a,{key:e,label:n?n.slice(0,n.lastIndexOf(" ")+2)+".":r.slice(0,12)+"...",value:pr(o)})}))),a.a.createElement(Du,{color:"red"},a.a.createElement(Cu.a.Value,{content:pr(-c[1].reduce(function(t,e){return t+e.total},0))}),a.a.createElement(Cu.a.Label,{content:"\u041c\u044b \u0434\u043e\u043b\u0436\u043d\u044b, \u0432 \u0442.\u0447."}),a.a.createElement(Cu.a.Group,{horizontal:!0,size:"small"},c[1].map(function(t){var e=t.id,n=t.amoName,r=t.name,o=t.total;return a.a.createElement(Cu.a,{key:e,label:n?n.slice(0,n.lastIndexOf(" ")+2)+".":r.slice(0,12)+"...",value:pr(o)})}))))))};function Mu(){var t=Object(v.a)(["\n  margin-top: 1rem;\n  max-height: 100%;\n  border-radius: 0.285714rem;\n  .fz-tableHeaderRow {\n    border-top: none !important;\n  }\n"]);return Mu=function(){return t},t}var Bu=At.b.div(Mu()),Pu=[{name:"copy",width:"35px"},{name:"edit",width:"35px"},{name:"dateLocal",path:"dateLocal",title:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043c\u044f",width:"145px"},{name:"counterparty",title:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",width:"200px",truncated:!0},{name:"project",title:"\u041f\u0440\u043e\u0435\u043a\u0442",width:"230px",truncated:!0},{name:"article",path:"article.rusName",title:"\u0421\u0442\u0430\u0442\u044c\u044f",width:"200px",truncated:!0},{name:"purpose",path:"purpose",title:"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435",width:"300px",truncated:!0},{name:"amount",path:"amount",title:"\u0421\u0443\u043c\u043c\u0430",width:"140px"},{name:"account",path:"account",title:"\u0421\u0447\u0435\u0442",width:"100px"},{name:"createdBy",title:"\u0410\u0432\u0442\u043e\u0440",width:"100px"},{name:"updatedBy",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u043e\u0440",width:"100px"}];function Lu(t){var e=t.accounts,n=t.activePayment,r=t.mdKontragents,o=t.mpProjects,i=t.onClickEdit,c=t.onClickCopy,l=t.payments;return a.a.createElement(Bu,null,a.a.createElement(dr,{fields:Pu,noServiceField:!0},function(t){var u=t.tableFields;return l.map(function(t){var l=t.id,s=t.dateLocal,d=t.amount,m=t.person,f=t.inn,p=t.createdBy,b=t.updatedBy,g=t.article?t.article.isIncome:t.isIncome,v=f?r.find(function(t){return t.Inn===f}):null,h=e.find(function(e){return e.id===t.account.id});return a.a.createElement(xr,{key:l,entity:t,tableFields:u,rowFields:[{name:"copy",icon:"redo alternate",iconColor:"grey",hoverable:!0,hideUnhovered:!0,hasEntries:!1,value:" ",onClick:function(){return c(l)}},{name:"edit",icon:"edit",iconColor:"grey",hoverable:!0,hideUnhovered:!0,hasEntries:!1,value:" ",onClick:function(){return i(l)},active:n&&n.id===l},{name:"dateLocal",value:s.slice(0,16).replace("T"," ")},{name:"counterparty",value:m?m.amoName:v?v.Name:f,color:f&&!v?"#9f3a38":void 0},{name:"project",value:t.mpProjectId?o.find(function(e){return e.Id===t.mpProjectId}).Name:""},{name:"amount",value:g?d:-d,color:g?"#016936":"#9f3a38"},{name:"account",value:h.name},{name:"createdBy",value:p&&p.person.amoName.split(" ")[0]||"\u0430\u0432\u0442\u043e"},{name:"updatedBy",value:b&&b.person.amoName.split(" ")[0]}]})})}))}function Nu(){var t=Object(v.a)(["\n\tmutation SyncWithTochkaPayments {\n\t\tsyncWithTochkaPayments {\n\t\t\tcount\n\t\t}\n\t}\n"]);return Nu=function(){return t},t}var Tu=E()(Nu()),$u=n(1083);function Ru(){var t=Object(v.a)(["\n  /* flex: 1 1 2000px;\n  margin-top: 1rem; */\n  overflow-y: scroll;\n"]);return Ru=function(){return t},t}function Au(){var t=Object(v.a)(["\n  flex: 1 0 content;\n  min-height: ","px;\n  display: flex;\n  border-bottom: 1px solid gray;\n"]);return Au=function(){return t},t}function zu(){var t=Object(v.a)(["\n  height: calc(100% - 36px);\n  display: flex;\n  flex-direction: column;\n  padding: 1rem;\n"]);return zu=function(){return t},t}var Vu=At.b.div(zu()),Wu=At.b.div(Au(),463),Qu=At.b.div(Ru()),Hu=function(t){Object(Hl.a)(t);var e=Object(r.useContext)($n).me,n=e.role,o=e.account,i=e.accounts,c=cn(pn),l=c.loading,u=c.error,s=c.data.accounts,d=c.refetch,m=c.client,f=Object(r.useState)(null),p=Object(qe.a)(f,2),b=p[0],g=p[1];return a.a.createElement(Qe,null,function(t){var e=t.notify;return a.a.createElement(Ue.b,{query:uu,onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0435\u0439",content:t.message})}},function(t){var r=t.loading,c=t.error,f=t.data,p=(f=void 0===f?{}:f).articles,v=f.mdKontragents,h=f.mpProjects,E=f.orgs,y=f.payments,O=t.refetch;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ue.a,{mutation:Tu,onCompleted:function(t){var n=t.syncWithTochkaPayments.count;O(),e({type:"success",title:"\u041f\u043b\u0430\u0442\u0435\u0436\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0441 \u0431\u0430\u043d\u043a\u043e\u043c. \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e: "+n})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441 \u0422\u043e\u0447\u043a\u043e\u0439",content:t.message})}},function(t,e){var r=e.loading;return a.a.createElement(Xn,{title:"\u041f\u043b\u0430\u0442\u0435\u0436\u0438",titleLinkTo:"/pay"},"OWNER"===n&&a.a.createElement(a.a.Fragment,null,a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,w:"120px",ml:"0",ta:"left",activeColor:"blue",onClick:t},a.a.createElement(Oe,{name:"refresh",color:r?"blue":void 0,loading:r}),r?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..":"\u0422\u043e\u0447\u043a\u0430 \u0411\u0430\u043d\u043a"),a.a.createElement(Un.a,{to:Object($u.a)(window.location.href.replace(/.*#/,""),"/pay/chart")?"/pay":"/pay/chart"},a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,activeColor:"green",icon:"chart bar outline",content:"\u0413\u0440\u0430\u0444\u0438\u043a",active:!!Object($u.a)(window.location.href.replace(/.*#/,""),"/pay/chart")}))))}),a.a.createElement(Vu,null,r||l?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":c||u?"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(c.message):a.a.createElement(a.a.Fragment,null,a.a.createElement(Wu,null,a.a.createElement(Nn.a,{exact:!0,path:"/pay",render:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(ku,{accounts:"OWNER"===n?s:[o].concat(Object(nr.a)(i)),accountsQuery:pn,articles:p,client:m,defaultAccountId:o.id,mdKontragents:v,mpProjects:h,orgs:E,payment:b,refetchAccounts:d,reset:function(){return g(null)}}),a.a.createElement(qu,{accounts:"OWNER"===n?s:[o].concat(Object(nr.a)(i)),orgs:E,payments:y,userRole:n}))}}),a.a.createElement(Nn.a,{exact:!0,path:"/pay/chart",render:function(){return a.a.createElement(pu,{payments:y})}})),a.a.createElement(Qu,null,a.a.createElement(Lu,{accounts:s,activePayment:b,mdKontragents:v,mpProjects:h,onClickEdit:function(t){return g(y.find(function(e){return e.id===t}))},onClickCopy:function(t){return g(Object(Me.a)(y.find(function(e){return e.id===t}),function(t){delete t.id,delete t.dateLocal}))},payments:y})))))})})};function Ku(){var t=Object(v.a)(["\n\tfragment DealStatusFragmentFull on DealStatus {\n\t\t...DealStatusFragmentBasic\n    amoId\n\t}\n\t","\n"]);return Ku=function(){return t},t}function Uu(){var t=Object(v.a)(["\n\tfragment DealStatusFragmentBasic on DealStatus {\n    id\n    name\n    color\n    sort\n\t}\n"]);return Uu=function(){return t},t}var _u=E()(Uu()),Gu=E()(Ku(),_u);function Xu(){var t=Object(v.a)(["\n\tfragment bpStatFragmentMiddle on BpStat {\n\t\t...bpStatFragmentBasic\n\t\tautoPlanCost\n\t\tautoPlanLabor\n\t\tautoPlanRevenue\n\t\tfactCost\n\t\tfactLabor\n\t\tfactRevenue\n\t\tplanCost\n\t\tplanLabor\n\t\tplanRevenue\n\t}\n\t","\n"]);return Xu=function(){return t},t}function Yu(){var t=Object(v.a)(["\n\tfragment bpStatFragmentBasic on BpStat {\n\t\tid\n\t}\n"]);return Yu=function(){return t},t}var Ju=E()(Yu()),Zu=E()(Xu(),Ju);function ts(){var t=Object(v.a)(["\n\tmutation upsertExec($input: ExecInput!) {\n\t\tupsertExec(input: $input) {\n\t\t\tid\n\t\t}\n\t}\n"]);return ts=function(){return t},t}function es(){var t=Object(v.a)(["\n\tquery orgsAndPersonsExecs {\n\t\torgs { ...orgExecFragment }\n\t\tpersons { ...personExecFragment }\n\t}\n\t","\n\t","\n"]);return es=function(){return t},t}function ns(){var t=Object(v.a)(["\n\tfragment execFragmentBasic on Exec {\n\t\tid\n\t\tperson { ...PersonFragmentBasic }\n\t}\n\t","\n"]);return ns=function(){return t},t}var rs=E()(ns(),rl),as=E()(es(),Ba,ol);E()(ts());function os(){var t=Object(v.a)(["\n\tmutation upsertTask($input: TaskInput!) {\n\t\tupsertTask(input: $input) {\n\t\t\t...taskFragmentFull\n\t\t}\n\t}\n\t","\n"]);return os=function(){return t},t}function is(){var t=Object(v.a)(["\n\tquery tasks {\n\t\ttasks { ...taskFragmentFull }\n\t}\n\t","\n"]);return is=function(){return t},t}function cs(){var t=Object(v.a)(["\n\tquery task ($id: ID!) {\n\t\ttask (id: $id) { ...taskFragmentFull }\n\t}\n\t","\n"]);return cs=function(){return t},t}function ls(){var t=Object(v.a)(["\n\tfragment taskFragmentFull on Task {\n\t\t...taskFragmentMiddle\n    appoint {\n\t\t\tid\n\t\t\texec { ...execFragmentBasic }\n\t\t}\n\t}\n\t","\n  ","\n"]);return ls=function(){return t},t}function us(){var t=Object(v.a)(["\n\tfragment taskFragmentMiddle on Task {\n\t\t...taskFragmentBasic\n    end\n\t\tfrom\n\t\torder\n\t\tstatus\n\t\ttext\n    to\n  }\n  ","\n"]);return us=function(){return t},t}function ss(){var t=Object(v.a)(["\n\tfragment taskFragmentBasic on Task {\n\t\tid\n\t}\n"]);return ss=function(){return t},t}var ds=E()(ss()),ms=E()(us(),ds),fs=E()(ls(),rs,ms),ps=(E()(cs(),fs),E()(is(),fs)),bs=E()(os(),fs);function gs(){var t=Object(v.a)(["\n\tmutation upsertAppoint($input: AppointInput!) {\n\t\tupsertAppoint(input: $input) {\n\t\t\t...appointFragmentMiddle\n\t\t}\n\t}\n\t","\n"]);return gs=function(){return t},t}function vs(){var t=Object(v.a)(["\n\tquery appointExecLocal ($id: ID!) {\n\t\tappoint (id: $id) @client {\n\t\t\tid\n\t\t}\n\t}\n"]);return vs=function(){return t},t}function hs(){var t=Object(v.a)(["\n\tfragment appointFragmentExec on Appoint {\n\t\t...appointFragmentBasic\n\t\texec { ...execFragmentBasic }\n\t}\n\t","\n\t","\n"]);return hs=function(){return t},t}function Es(){var t=Object(v.a)(["\n\tfragment appointFragmentMiddle on Appoint {\n\t\t...appointFragmentBasic\n\t\tlaborCost\n\t\tbpStat { ...bpStatFragmentMiddle }\n\t\texec { ...execFragmentBasic }\n\t\ttasks { ...taskFragmentMiddle }\n\t}\n\t","\n\t","\n\t","\n\t","\n"]);return Es=function(){return t},t}function ys(){var t=Object(v.a)(["\n\tfragment appointFragmentBasic on Appoint {\n\t\tid\n\t}\n"]);return ys=function(){return t},t}var Os=E()(ys()),js=E()(Es(),Zu,Os,rs,ms),xs=(E()(hs(),Os,rs),E()(vs()),E()(gs(),js));function ws(){var t=Object(v.a)(["\n\tmutation upsertOp($input: OpInput!) {\n\t\tupsertOp(input: $input) {\n\t\t\t...opFragmentMiddle\n\t\t}\n\t}\n\t","\n"]);return ws=function(){return t},t}function ks(){var t=Object(v.a)(["\n\tfragment opFragmentDetails on Op {\n\t\t...opFragmentBasic\n\t\tdescription\n\t}\n\t","\n"]);return ks=function(){return t},t}function Cs(){var t=Object(v.a)(["\n\tfragment opFragmentMiddle on Op {\n\t\t...opFragmentBasic\n\t\tlaborPrice\n\t\tappoints { ...appointFragmentMiddle }\n\t}\n\t","\n\t","\n"]);return Cs=function(){return t},t}function Fs(){var t=Object(v.a)(["\n\tfragment opFragmentBasic on Op {\n\t\tid\n\t\tdealLabor\n\t\topType { ...opTypeFragmentBasic }\n\t}\n\t","\n"]);return Fs=function(){return t},t}var Is=E()(Fs(),ha),Ss=E()(Cs(),Is,js),Ds=E()(ks(),Is);E()(ws(),Ss);function qs(){var t=Object(v.a)(["\n\tfragment procFragmentDetails on Proc {\n\t\t...procFragmentBasic\n\t\tops { ...opFragmentDetails }\n\t}\n\t","\n\t","\n"]);return qs=function(){return t},t}function Ms(){var t=Object(v.a)(["\n\tfragment procFragmentMiddle on Proc {\n\t\t...procFragmentBasic\n\t\tops { ...opFragmentMiddle }\n\t}\n\t","\n\t","\n"]);return Ms=function(){return t},t}function Bs(){var t=Object(v.a)(["\n\tfragment procFragmentBasic on Proc {\n\t\tid\n\t\tname\n\t\tops { ...opFragmentBasic }\n\t}\n\t","\n"]);return Bs=function(){return t},t}var Ps=E()(Bs(),Is),Ls=E()(Ms(),Ps,Ss),Ns=E()(qs(),Ps,Ds);function Ts(){var t=Object(v.a)(["\n\tfragment elementFragmentDetails on Element {\n\t\t...elementFragmentBasic\n\t\tproc { ...procFragmentDetails }\n\t}\n\t","\n\t","\n"]);return Ts=function(){return t},t}function $s(){var t=Object(v.a)(["\n\tfragment elementFragmentMiddle on Element {\n\t\t...elementFragmentBasic\n\t\top { ...opFragmentMiddle }\n\t\tproc { ...procFragmentMiddle }\n\t}\n\t","\n\t","\n\t","\n"]);return $s=function(){return t},t}function Rs(){var t=Object(v.a)(["\n\tfragment elementFragmentBasic on Element {\n    id\n    sort\n    proc { ...procFragmentBasic }\n  }\n  ","\n"]);return Rs=function(){return t},t}var As=E()(Rs(),Ps),zs=E()($s(),As,Ss,Ls),Vs=E()(Ts(),As,Ns);function Ws(){var t=Object(v.a)(["\n\tfragment WorkpieceFragmentWithDrawings on Workpiece {\n\t\t...WorkpieceFragmentBasic\n\t\tdrawing { ...DrawingFragmentBasic }\n\t}\n\t","\n\t","\n"]);return Ws=function(){return t},t}function Qs(){var t=Object(v.a)(["\n\tfragment WorkpieceFragmentBasic on Workpiece {\n    id\n    hardness\n    material\n    name\n\t}\n"]);return Qs=function(){return t},t}var Hs=E()(Qs()),Ks=E()(Ws(),Hs,X);function Us(){var t=Object(v.a)(["\n\tmutation upsertBatch($input: BatchInput!) {\n\t\tupsertBatch(input: $input) {\n\t\t\t...batchFragmentMiddle\n\t\t\t...batchFragmentDetails\n\t\t}\n\t}\n\t","\n\t","\n"]);return Us=function(){return t},t}function _s(){var t=Object(v.a)(["\n\tquery batch ($id: ID!) {\n\t\tbatch (id: $id) {\n\t\t\t...batchFragmentDetails\n\t\t}\n\t}\n\t","\n"]);return _s=function(){return t},t}function Gs(){var t=Object(v.a)(["\n\tfragment batchFragmentDetails on Batch {\n\t\t...batchFragmentBasic\n\t\tdescript\n\t\tinfo\n\t\twarning\n\t\telements (orderBy: sort_ASC) { ...elementFragmentDetails }\n\t\tmodel { ...ModelFragmentWithDrawings }\n\t\tprocs { ...procFragmentDetails }\n\t\tworkpiece { ...WorkpieceFragmentWithDrawings }\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return Gs=function(){return t},t}function Xs(){var t=Object(v.a)(["\n\tfragment batchFragmentMiddle on Batch {\n\t\t...batchFragmentBasic\n\t\tsort\n\t\tbpStat { ...bpStatFragmentMiddle }\n\t\telements (orderBy: sort_ASC) { ...elementFragmentMiddle }\n\t\tmodel { ...ModelFragmentBasic }\n\t\tops { ...opFragmentMiddle }\n\t\tprocs { ...procFragmentMiddle }\n\t}\n\t","\n\t","\n\t","\n\t","\n\t","\n\t","\n"]);return Xs=function(){return t},t}function Ys(){var t=Object(v.a)(["\n\tfragment batchFragmentBasic on Batch {\n\t\tid\n\t\tqty\n\t\tmodel { ...ModelFragmentBasic }\n\t\telements (orderBy: sort_ASC) { ...elementFragmentBasic }\n\t\tprocs { ...procFragmentBasic }\n\t}\n\t","\n\t","\n\t","\n"]);return Ys=function(){return t},t}var Js=E()(Ys(),ct,As,Ps),Zs=E()(Xs(),Zu,Js,zs,ct,Ss,Ls),td=E()(Gs(),lt,Js,Vs,Ns,Ks),ed=E()(_s(),td),nd=E()(Us(),Zs,td);function rd(){var t=Object(v.a)(["\n\tmutation upsertDeal($input: DealInput!) {\n\t\tupsertDeal(input: $input) {\n\t\t\t...DealFragmentMiddle\n\t\t}\n\t}\n\t","\n"]);return rd=function(){return t},t}function ad(){var t=Object(v.a)(["\n\tmutation syncDeals {\n\t\tsyncDeals {\n\t\t\tcount\n\t\t}\n\t}\n"]);return ad=function(){return t},t}function od(){var t=Object(v.a)(["\n\tmutation ConnectDealToOrg($orgId: ID! $dealId: ID!) {\n\t\tconnectDealToOrg(orgId: $orgId dealId: $dealId) {\n\t\t\t...DealFragmentMiddle\n\t\t}\n\t}\n\t","\n"]);return od=function(){return t},t}function id(){var t=Object(v.a)(["\n\tmutation createComOffer($dealId: ID!, $date: String) {\n\t\tcreateComOffer(dealId: $dealId, date: $date) {\n\t\t\tstatusText\n\t\t}\n\t}\n"]);return id=function(){return t},t}function cd(){var t=Object(v.a)(["\n\tquery deal ($id: ID!) {\n\t\tdeal (id: $id) {\n\t\t\tid\n\t\t\tbatches (orderBy: sort_ASC) { ...batchFragmentDetails}\n\t\t}\n\t}\n\t","\n"]);return cd=function(){return t},t}function ld(){var t=Object(v.a)(["\n\tquery Deals {\n\t\tdeals { ...DealFragmentMiddle }\n\t\topTypes { ...opTypeFragmentBasic }\n\t}\n\t","\n\t","\n"]);return ld=function(){return t},t}function ud(){var t=Object(v.a)(["\n\tfragment DealFragmentFull on Deal {\n\t\t...DealFragmentMiddle\n    status { ...DealStatusFragmentFull }\n\t}\n\t","\n\t","\n"]);return ud=function(){return t},t}function sd(){var t=Object(v.a)(["\n\tfragment DealFragmentMiddle on Deal {\n\t\t...DealFragmentBasic\n\t\tdate\n\t\tbatches (orderBy: sort_ASC) { ...batchFragmentMiddle}\n\t\torg { ...OrgFragmentBasic}\n  }\n  ","\n  ","\n  ","\n"]);return sd=function(){return t},t}function dd(){var t=Object(v.a)(["\n\tfragment DealFragmentBasic on Deal {\n    id\n    amoId\n    name\n\t\tstatus { ...DealStatusFragmentBasic }\n  }\n  ","\n"]);return dd=function(){return t},t}var md=E()(dd(),_u),fd=E()(sd(),md,qa,Zs),pd=(E()(ud(),fd,Gu),E()(ld(),fd,ha)),bd=E()(cd(),td),gd=E()(id()),vd=(E()(od(),fd),E()(ad())),hd=E()(rd(),fd),Ed=a.a.createContext(),yd=function(t){var e=t.children,n=t.opTypes,r=t.budgetMode;return a.a.createElement(Ed.Provider,{value:{opTypes:n,budgetMode:r}},e)},Od=function(t){return a.a.createElement(ge,{w:"55px",ta:"center"},a.a.createElement(Oe,Object.assign({link:!0},t)))};function jd(){var t=Object(v.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\twidth: 100%;\n  height: 46px;\n\tpadding-right: 1em;\n\t/* border-bottom: 1px solid #7e7e81; */\n\t/* border-bottom: 1px solid rgba(34,36,38,.15); */\n\tborder-bottom: 1px solid rgba(152, 153, 154, 1);\n"]);return jd=function(){return t},t}var xd=At.b.div(jd()),wd=function(t){var e=t.title,n=t.subtitle,r=t.setDetails,o=t.onSubmit;return a.a.createElement(xd,null,a.a.createElement(Od,{size:"big",name:"cancel",onClick:function(){return r(null)}}),e&&a.a.createElement(ge,{fs:"1.28571429rem",fw:"bold"},e),n&&a.a.createElement(ge,{mt:"4px",ml:"10px",fs:"1rem",c:"rgba(0,0,0,.6)",ws:"0.1em"},n),o&&a.a.createElement(Oe,{link:!0,name:"check",ml:"auto",color:"green",size:"big",onClick:o}))},kd=function(t){var e=t.notify,n=t.id,o=Object(r.useState)(""),i=Object(qe.a)(o,2),c=i[0],l=i[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ue.a,{mutation:Ta,variables:{id:n},onCompleted:function(){e({type:"success",title:"\u0418\u041d\u041d \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d"})},onError:function(t){return e({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d\u0438\u044f \u0418\u041d\u041d",content:t.message})}},function(t,e){var r=e.loading;return a.a.createElement(ge,{p:"1em 1em 1em 55px"},a.a.createElement(Gt.a,{value:c,onChange:function(t,e){var n=e.value;return l(n)},placeholder:"\u0418\u041d\u041d",onBlur:function(){return t({variables:{id:n,inn:c}})},loading:r}))}))};function Cd(t){t.org;var e=Object(r.useState)(""),n=Object(qe.a)(e,2);n[0],n[1];return a.a.createElement(a.a.Fragment,null)}var Fd=n(327);function Id(){var t=Object(v.a)(["\n\tcursor: pointer;\n\tpadding-left: 67.85px;\n\t/* border-color: rgba(34,36,38,0.15); */\n"]);return Id=function(){return t},t}var Sd=At.b.input(Id()),Dd=function(t){var e=t.onChange,n=Object(Vt.a)(t,["onChange"]);return a.a.createElement(Sd,Object.assign({},n,{onChange:function(t){var n=t.target.value;return e(n)}}))};function qd(){var t=Object(v.a)(["\n\twidth: 100%;\n  padding-right: 4px;\n  padding-left: 4px;\n"]);return qd=function(){return t},t}var Md=At.b.input(qd()),Bd=Object(r.forwardRef)(function(t,e){var n=t.value,o=t.onChange,i=t.onBlur,c=Object(Vt.a)(t,["value","onChange","onBlur"]),l=Object(r.useState)(""),u=Object(qe.a)(l,2),s=u[0],d=u[1];Object(r.useEffect)(function(){return d(n||"")},[n]);var m=function(){return n!==s&&o(s)};return a.a.createElement(Md,Object.assign({},c,{ref:e,value:s,onChange:function(t){var e=t.target.value;return d(e)},onBlur:function(){m(),i&&i()},onKeyDown:function(t){return"Enter"===t.key&&m()}}))});function Pd(){var t=Object(v.a)(["\n\twidth: 100%;\n  padding-right: 4px;\n  padding-left: 4px;\n"]);return Pd=function(){return t},t}var Ld=At.b.textarea(Pd()),Nd=function(t){var e=t.value,n=t.onChange,o=t.debouncedWrite,i=Object(Vt.a)(t,["value","onChange","debouncedWrite"]),c=Object(r.useRef)(null),l=Object(r.useState)(""),u=Object(qe.a)(l,2),s=u[0],d=u[1];Object(r.useEffect)(function(){return d(e||"")},[e]);var m=bi()(n,500);return a.a.createElement(Ld,Object.assign({},i,{ref:c,value:s,onChange:function(t){var e=t.target.value;d(e),o&&m()},onBlur:function(){return e!==s&&n(s)}}))};function Td(){var t=Object(v.a)(["\n  width: 100%;\n  padding-right: 4px;\n  padding-left: 4px;\n"]);return Td=function(){return t},t}var $d=At.b.select(Td()),Rd=Object(r.forwardRef)(function(t,e){var n=t.value,r=t.onChange,o=t.options,i=t.undefinedOptionName,c=void 0===i?"--":i,l=Object(Vt.a)(t,["value","onChange","options","undefinedOptionName"]);return a.a.createElement($d,Object.assign({},l,{ref:e,value:n,onChange:function(t){var e=t.target.value;return r(e)}}),[{id:-1,name:c}].concat(Object(nr.a)(o)).map(function(t){var e=t.key,n=t.id,r=t.name;return a.a.createElement("option",{key:e||n,value:n},r)}),"}")});function Ad(){var t=Object(v.a)(["\n\tcolor: ",";\n"]);return Ad=function(){return t},t}function zd(){var t=Object(v.a)(["\n\twidth: ",";\n"]);return zd=function(){return t},t}function Vd(){var t=Object(v.a)(["\n\tflex: 1 1 auto;\n\tmax-width: calc(100% - 122px);\n"]);return Vd=function(){return t},t}function Wd(){var t=Object(v.a)(["\n\tflex: 0 0 122px;\n\t/* padding-top: calc(10.5rem/14); */\n\tfont-size: calc(13rem/14);\n\t/* font-weight: bold; */\n\tline-height: 1.21428571rem;\n\t","\n\t","\n"]);return Wd=function(){return t},t}function Qd(){var t=Object(v.a)(["\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\talign-items: center;\n\tmargin-bottom: .67857143rem;\n\t","\n"]);return Qd=function(){return t},t}var Hd=At.b.div(Qd(),function(t){return t.indent&&"\n\t\tborder-left: 1px solid rgba(34, 36, 38, 0.15);\n\t"}),Kd=At.b.div(Wd(),function(t){return t.required&&"\n\t\t::after {\n\t\t\tcontent: '*';\n\t\t\tdisplay: inline-block;\n\t\t\tmargin: -.2em 0 0 .2em;\n\t\t\tvertical-align: top;\n\t\t\tcolor: #db2828;\n\t\t}\n\t"},function(t){return t.indent&&"\n\t\tpadding-left: 10px;\n\t"}),Ud=At.b.div(Vd()),_d=At.b.div(zd(),function(t){return t.width||"215px"}),Gd=At.b.div(Ad(),function(t){return t.theme.colors.error}),Xd=function(t){var e=t.label,n=t.required,r=t.indent,o=t.inputWidth,i=t.type,c=t.contentBeforeField,l=t.error,u=Object(Vt.a)(t,["label","required","indent","inputWidth","type","contentBeforeField","error"]);return a.a.createElement(Hd,{indent:r},a.a.createElement(Kd,{className:"fz-formFieldLabel",required:n,indent:r},e),a.a.createElement(Ud,null,a.a.createElement(_d,{width:o},c,"date"===i||"datetime-local"===i?a.a.createElement(Dd,Object.assign({type:i},u)):"textarea"===i?a.a.createElement(Nd,u):"select"===i?a.a.createElement(Rd,u):a.a.createElement(Bd,u)),l&&a.a.createElement(Gd,null,l)))};function Yd(){var t=Object(v.a)(["\n  position: absolute;\n  z-index: 10;\n  top: 0;\n  right: 0;\n  left: 0;\n  height: 48px;\n  padding-right: 0.7em;\n  display: flex;\n  align-items: center;\n  background-color: rgba(255,255,255,1);\n"]);return Yd=function(){return t},t}var Jd=Object(At.b)(Fd.a.div)(Yd()),Zd=function(t){var e=t.notify,n=t.org,o=t.initiallyExpanded,i=Object(r.useState)(!1),c=Object(qe.a)(i,2),l=c[0],u=c[1];Object(r.useEffect)(function(){},[l]);var s=Object(Fd.b)(l,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}),d=Object(r.useState)(pa(new Date)),m=Object(qe.a)(d,2),f=m[0],p=m[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ue.a,{mutation:Pa,onCompleted:function(t){e({type:"success",title:"\u0414\u043e\u0433\u043e\u0432\u043e\u0440 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d"})}},function(t,e){e.loading;return a.a.createElement(ki,{initiallyExpanded:o,title:"\u0414\u043e\u0433\u043e\u0432\u043e\u0440",overflowVisible:!0,buttons:a.a.createElement(a.a.Fragment,null,a.a.createElement(Oe,{link:!0,activeColor:"green",name:"plus",onClick:function(t){t.stopPropagation(),u(!0)}}))},s.map(function(e){var r=e.item,o=e.key,i=e.props;return r&&a.a.createElement(Jd,{key:o,style:i},a.a.createElement(Od,{size:"large",name:"check",color:"green",onClick:Object(an.a)(rn.a.mark(function e(){return rn.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({variables:{id:n.id,date:f}});case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=u(!1);case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}))}),a.a.createElement(ge,{fs:"1.1em",c:"rgba(0,0,0,.75)",fw:"700"},"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u0430"),a.a.createElement(Oe,{link:!0,name:"cancel",ml:"auto",size:"large",onClick:function(){return u(!1)}}))}),a.a.createElement(ge,{p:"1em 1em 1em 55px"},a.a.createElement(Xd,{label:"\u0414\u0430\u0442\u0430 \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u0430",type:"date",value:f,onChange:function(t){return p(t)}})))}))};function tm(t){var e=t.details,n=e.orgId,r=e.section,o=t.setDetails,i=Ke().notify;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ue.b,{query:$a,variables:{id:n}},function(t){var e=t.data.orgLocal;return e?a.a.createElement(a.a.Fragment,null,a.a.createElement(wd,{setDetails:o,title:e.name,subtitle:e.inn&&"\u0418\u041d\u041d: ".concat(e.inn)}),e.inn?a.a.createElement(Ue.b,{query:Ra,variables:{id:n},onError:function(t){return i({type:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u043e\u0432 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438",content:t.message})}},function(t){var e=t.data.orgDetails;return t.loading?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..":e?a.a.createElement(a.a.Fragment,null,a.a.createElement(Cd,{org:e}),a.a.createElement(Zd,{notify:i,org:e,initiallyExpanded:"contract"===r})):null}):a.a.createElement(kd,{notify:i,id:n})):null}))}var em=n(1095);function nm(t){var e,n,r=t.batch,o=t.bIndex,i=t.batchId,c=ln(nd),l=Object(qe.a)(c,1)[0];if(!r){var u=cn(ed,{variables:{id:i}});e=u.loading,n=u.data}var s=r||n&&n.batch||{};if(!r&&e)return a.a.createElement(em.a,{active:!0},a.a.createElement(Vi.a,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430.."));var d=s.descript,m=s.info,f=s.warning,p=s.model,b=p.name,g=Object(qe.a)(p.drawings,1)[0],v=(g=void 0===g?{}:g).name,h=s.workpiece,E=Object(qe.a)(s.procs,1)[0],y=(E=void 0===E?{}:E).ops,O=void 0===y?[]:y,j=h||{},x=j.name,w=j.material,k=j.hardness,C=(j.drawing||{}).name,F=no(s);return a.a.createElement(ge,{p:"1em 1em 1em 55px"},a.a.createElement("p",null,a.a.createElement("b",null,"".concat(o+1,". ").concat(b))),a.a.createElement(ge,{pl:"10px",bl:"1px solid rgba(34, 36, 38, 0.15)"},a.a.createElement(Xd,{label:"\u0427\u0435\u0440\u0442\u0435\u0436",value:v||"",onChange:function(t){return l({variables:{input:co(F,"model.drawings[0].name",t)}})}}),a.a.createElement(Xd,{label:"\u0417\u0430\u0433\u043e\u0442\u043e\u0432\u043a\u0430",value:x||"",onChange:function(t){return l({variables:{input:co(F,"workpiece.name",t)}})}}),a.a.createElement(Xd,{label:"\u0427\u0435\u0440\u0442\u0435\u0436",indent:!0,value:C||"",onChange:function(t){return l({variables:{input:co(F,"workpiece.drawing.name",t)}})}}),a.a.createElement(Xd,{label:"\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b",value:w||"",onChange:function(t){return l({variables:{input:co(F,"workpiece.material",t)}})}}),a.a.createElement(Xd,{label:"\u0422\u0432\u0435\u0440\u0434\u043e\u0441\u0442\u044c",value:k||"",onChange:function(t){return l({variables:{input:co(F,"workpiece.hardness",t)}})}}),a.a.createElement(Xd,{label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",type:"textarea",value:d||"",onChange:function(t){return l({variables:{input:co(F,"descript",t)}})}}),a.a.createElement(Xd,{label:"\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u0435",type:"textarea",value:m||"",onChange:function(t){return l({variables:{input:co(F,"info",t)}})}}),a.a.createElement(Xd,{label:"\u041f\u0440\u0435\u0434\u0443\u043f\u0440\u0435\u0436\u0434\u0435\u043d\u0438\u0435",type:"textarea",value:f||"",onChange:function(t){return l({variables:{input:co(F,"warning",t)}})}}),O.filter(function(t){return"MACHINING"===t.opType.opClass}).map(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=t.opType,r=t.description,i=arguments.length>1?arguments[1]:void 0,c=(n||{}).name;return a.a.createElement("div",{key:e},a.a.createElement("p",null,a.a.createElement("b",null,"".concat(o+1,".").concat(i+1,". ").concat(c))),a.a.createElement(Xd,{label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",type:"textarea",indent:!0,value:r||"",onChange:function(t){return l({variables:{input:co(F,"procs[0].ops[".concat(i,"].description"),t)}})}}))})))}function rm(t){var e=t.dealId,n=cn(bd,{variables:{id:e}}),r=n.loading,o=n.data;return a.a.createElement(a.a.Fragment,null,r?a.a.createElement(em.a,{active:!0},a.a.createElement(Vi.a,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..")):o&&o.deal&&o.deal.batches.map(function(t,e){return a.a.createElement(nm,{key:t.id,batch:t,bIndex:e})}))}function am(t){var e=t.details.dealId,n=t.setDetails,o=Object(r.useState)(pa(new Date)),i=Object(qe.a)(o,2),c=i[0],l=i[1],u=ln(gd,{variables:{dealId:e,date:c}}),s=Object(qe.a)(u,1)[0];return a.a.createElement(a.a.Fragment,null,a.a.createElement(wd,{setDetails:n,title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u041a\u041f",onSubmit:function(){return s()}}),a.a.createElement(ge,{h:"calc(100% - 47px)",oy:"scroll"},a.a.createElement(ge,{p:"1em 1em 1em 55px"},a.a.createElement(Xd,{label:"\u0414\u0430\u0442\u0430",type:"date",value:c,onChange:function(t){return l(t)}})),a.a.createElement(rm,{dealId:e})))}function om(t){var e=t.details.appointId,n=t.setDetails,o=Object(r.useState)(ba(new Date)),i=Object(qe.a)(o,2),c=i[0],l=i[1],u=Object(r.useState)(),s=Object(qe.a)(u,2),d=s[0],m=s[1],f=ln(bs,{variables:{input:{from:new Date(c).toISOString(),text:d,status:"ACTIVE",appointId:e}}}),p=Object(qe.a)(f,1)[0];return a.a.createElement(a.a.Fragment,null,a.a.createElement(wd,{setDetails:n,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443",onSubmit:function(){return console.log("{ from, text, status: ACTIV, appointId } > ",{from:c,text:d,status:"ACTIVE",appointId:e})&&p()}}),a.a.createElement(ge,{h:"calc(100% - 47px)",oy:"scroll"},a.a.createElement(ge,{p:"1em 1em 1em 55px"},a.a.createElement(Xd,{label:"\u0414\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043c\u044f",type:"datetime-local",value:c,onChange:function(t){return l(t)}}),a.a.createElement(Xd,{label:"\u0417\u0430\u0434\u0430\u0447\u0430",inputWidth:"257px",type:"textarea",value:d,onChange:function(t){return m(t)}}))))}var im=n(325),cm=n.n(im);function lm(t,e,n){var r=ln("deal"===t?hd:"batch"===t?nd:"personExec"===t?cl:"orgExec"===t?Aa:void 0,n),a=Object(qe.a)(r,1)[0];return[function(){var t=Object(an.a)(rn.a.mark(function t(n,r){return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.length%2===0){t.next=2;break}throw new Error("useUpsert requires first array argument consisting of alternating paths and values");case 2:return t.abrupt("return",a(Object(l.a)({},r,{variables:{input:Object(Me.a)(no(e),function(t){for(var e=0;e<n.length;e+=2)e%2!==1&&io(t,n[e],n[e+1],e>0)})}})));case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()]}function um(t,e){var n=ln("deal"===t?hd:"batch"===t?nd:"personExec"===t?cl:"orgExec"===t?Aa:void 0,e),r=Object(qe.a)(n,1)[0];return[function(){var t=Object(an.a)(rn.a.mark(function t(e,n,a){return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.length%2===0){t.next=2;break}throw new Error("useUpsert requires first array argument consisting of alternating paths and values");case 2:return t.abrupt("return",r(Object(l.a)({},a,{variables:{input:Object(Me.a)(no(e),function(t){for(var e=0;e<n.length;e+=2)e%2!==1&&io(t,n[e],n[e+1],e>0)})}})));case 3:case"end":return t.stop()}},t)}));return function(e,n,r){return t.apply(this,arguments)}}()]}function sm(){var t=Object(v.a)(["\n\t&&& {\n\t\topacity: 0;\n\t\ttransition: opacity .25s ease;\n\t\t",":hover & {\n\t\t\topacity: .45;\n\t\t}\n\t}\n"]);return sm=function(){return t},t}function dm(){var t=Object(v.a)(["\n  display: flex;\n\tpadding-right: 1em;\n\tcursor: pointer;\n\tborder-width: 1px 0;\n\tborder-style: solid;\n\tborder-color: white;\n  :hover {\n    background: rgb(250, 250, 250);\n    color: rgba(0,0,0,.95);\n  }\n  ","\n"]);return dm=function(){return t},t}function mm(){var t=Object(v.a)([" &&& {\n\tmargin: 0 0 1em;\n\tpadding: 0 55px;\n}"]);return mm=function(){return t},t}function fm(){var t=Object(v.a)(["\n\tmargin: 0;\n\tpadding: 1em 1em 1em 55px;\n\t/* :first-child {\n\t\tpadding-top: 0;\n\t} */\n\tdisplay: flex;\n"]);return fm=function(){return t},t}function pm(){var t=Object(v.a)(["\n\theight: calc(100% - 47px - 67px);\n\toverflow-y: scroll;\n"]);return pm=function(){return t},t}function bm(){var t=Object(v.a)(["\n\tpadding: 1em 1em 1em 55px;\n\tborder-bottom: 1px solid rgba(34, 36, 38, 0.15);\n\tbox-shadow: 0 20px 20px 0 #fff;\n"]);return bm=function(){return t},t}var gm=At.b.div(bm()),vm=At.b.div(pm()),hm=At.b.h4(fm()),Em=Object(At.b)(Wt.a)(mm()),ym=At.b.div(dm(),function(t){return t.active&&"\n\t\tbackground: rgba(0,0,0,.05);\n\t\tfont-weight: bold;\n\t\tborder-color: rgba(34, 36, 38, 0.15);\n\t"}),Om=Object(At.b)(Oe)(sm(),ym),jm=function(t){var e=t.active,n=t.text,r=t.onClick,o=t.onRemove;return a.a.createElement(ym,{active:e,onClick:r},a.a.createElement(Od,{name:e?"check square outline":"square outline"}),a.a.createElement(ge,null,n),o&&a.a.createElement(Om,{link:!0,name:"close",ml:"auto",color:"grey",activeColor:"red",onClick:function(t){return t.stopPropagation()||o()}}))};function xm(t){var e=t.details,n=e.opTypeId,o=e.onSubmit,i=t.setDetails,c=Object(r.useRef)(null),l=cn(as),u=l.data,s=l.loading,d=l.error,m=Object(r.useState)(""),f=Object(qe.a)(m,2),p=f[0],b=f[1],g=Object(r.useState)(null),v=Object(qe.a)(g,2),h=v[0],E=v[1],y=Object(r.useState)(""),O=Object(qe.a)(y,2),j=O[0],x=O[1],w=Object(r.useState)(""),k=Object(qe.a)(w,2),C=k[0],F=k[1],I=u&&u.orgs&&u.orgs.filter(function(t){return!C||-1!==t.name.toLowerCase().indexOf(C.toLowerCase())})||[],S=u&&u.persons&&u.persons.filter(function(t){return!C||-1!==t.amoName.toLowerCase().indexOf(C.toLowerCase())})||[],D=ln(gu,{successMsg:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b",errMsg:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441 \u0410\u043c\u043e",mark:"syncWithAmoContacts"}),q=Object(qe.a)(D,2),M=q[0],B=q[1].loading,P=um("personExec",{successMsg:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f",errMsg:"\u041e\u0448\u0438\u0431\u043a\u0430. \u0414\u0430\u043d\u043d\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b"}),L=Object(qe.a)(P,1)[0],N=um("orgExec",{successMsg:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f",errMsg:"\u041e\u0448\u0438\u0431\u043a\u0430. \u0414\u0430\u043d\u043d\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b"}),T=Object(qe.a)(N,1)[0],$=cm()(S,function(t){var e=t.exec;return e&&e.opTypes.findIndex(function(t){return t.id===n})>-1}),R=Object(qe.a)($,2),A=R[0],z=R[1],V=cm()(I,function(t){var e=t.exec;return e&&e.opTypes.findIndex(function(t){return t.id===n})>-1}),W=Object(qe.a)(V,2),Q=W[0],H=W[1];return Object(r.useEffect)(function(){return c.current.focus()}),a.a.createElement(a.a.Fragment,null,a.a.createElement(wd,{setDetails:i,title:"\u0412\u044b\u0431\u043e\u0440 \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044f",onSubmit:Object(an.a)(rn.a.mark(function t(){var e,r,a,c,l,u;return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=7;break}return t.next=3,L(h,["exec.opTypes[length]",{opTypeId:n}]);case 3:e=t.sent,r=e.data,(a=r&&r.upsertPerson2.exec.id)&&o(a);case 7:if(!j){t.next=15;break}return t.next=10,T(j,["exec.opTypes[length]",{opTypeId:n}]);case 10:c=t.sent,l=c.data,console.log("data > ",l),(u=l&&l.upsertOrg.exec.id)&&o(u);case 15:p&&o(p),i(null);case 17:case"end":return t.stop()}},t)}))}),a.a.createElement(gm,null,a.a.createElement(Gt.a,{ref:c,fluid:!0,icon:"search",placeholder:"\u0418\u0441\u043a\u0430\u0442\u044c..",value:C,onChange:function(t,e){var n=e.value;return F(n)}})),a.a.createElement(vm,null,!d&&s?a.a.createElement(em.a,{active:!0},a.a.createElement(Vi.a,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..")):a.a.createElement(a.a.Fragment,null,a.a.createElement(hm,null,"\u0414\u043b\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"),A.length>0&&a.a.createElement(Em,{sub:!0}," \u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b "),A.map(function(t){return a.a.createElement(jm,{key:t.id,active:t.exec.id===p,text:t.amoName,onClick:function(){return b(t.exec.id)||E(null)||x(null)},onRemove:function(){return L(t,["exec.opTypes[id=".concat(n,"]"),{disconnect:!0}])}})}),Q.length>0&&a.a.createElement(Em,{sub:!0}," \u041a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 "),Q.map(function(t){return a.a.createElement(jm,{key:t.id,active:t.exec.id===p,text:t.name,onClick:function(){return b(t.exec.id)||E(null)||x(null)},onRemove:function(){return T(t,["exec.opTypes[id=".concat(n,"]"),{disconnect:!0}])}})}),a.a.createElement(hm,null,"\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u044b",a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,w:"180px",ml:"auto",ta:"left",activeColor:"blue",onClick:M},a.a.createElement(Oe,{name:"refresh",color:B?"blue":void 0,loading:B}),B?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..":"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b AmoCRM")),z.map(function(t){return a.a.createElement(jm,{key:t.id,active:t===h,text:t.amoName,onClick:function(){return E(t)||x(null)||b("")}})}),a.a.createElement(hm,null,"\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438"),H.map(function(t){return a.a.createElement(jm,{key:t.id,active:t===j,text:t.name,onClick:function(){return x(t)||E(null)||b("")}})}))))}var wm=n(518),km=n.n(wm);function Cm(){var t=Object(v.a)(["\n  display: flex;\n  justify-content: flex-end;\n  opacity: 0;\n  transition: opacity 0.25s linear;\n"]);return Cm=function(){return t},t}function Fm(){var t=Object(v.a)(["\n  width: 25px;\n  margin-left: auto;\n  transition: transform 0.25s linear;\n"]);return Fm=function(){return t},t}var Im=At.b.div(Fm()),Sm=At.b.div(Cm());function Dm(t){var e=t.taskId,n=t.upsertAppoint;return a.a.createElement(Im,{className:"taskControlsContainer"},a.a.createElement(Sm,{className:"taskControls"},a.a.createElement(Oe,{link:!0,name:"trash",color:"grey",activeColor:"red",onClick:function(){return n(function(t){io(t,"tasks[id=".concat(e,"]"),{})})}})))}function qm(){var t=Object(v.a)(["\n  display: flex;\n  padding: 0 1em 0 55px;\n\tcursor: pointer;\n\tborder-width: 1px 0;\n\tborder-style: solid;\n\tborder-color: white;\n  :hover {\n    background: rgb(250, 250, 250);\n    color: rgba(0,0,0,.95);\n    .taskControls {\n      opacity: 1;\n    }\n  }\n  ","\n"]);return qm=function(){return t},t}var Mm=At.b.div(qm(),function(t){return t.active&&"\n\t\tbackground: rgba(0,0,0,.05);\n\t\tfont-weight: bold;\n\t\tborder-color: rgba(34, 36, 38, 0.15);\n  "});function Bm(t){var e=t.task,n=e.text,r=e.order,o=t.upsertAppoint;return a.a.createElement(Mm,null,a.a.createElement(ge,{w:"25px"},r+1,"."),a.a.createElement(ge,null,n),a.a.createElement(Dm,{upsertAppoint:o}))}function Pm(){var t=Object(v.a)(["\n  display: flex;\n  align-items: baseline;\n  padding: 1em 1em 1em 0;\n  border-top: 1px solid #2185d0;\n  border-bottom: 1px solid #2185d0;\n"]);return Pm=function(){return t},t}var Lm=At.b.div(Pm());function Nm(t){t.task;var e=t.upsertAppoint,n=Object(r.useState)(ba(new Date)),o=Object(qe.a)(n,2),i=o[0],c=(o[1],Object(r.useState)()),l=Object(qe.a)(c,2),u=l[0],s=l[1];Object(on.a)();return a.a.createElement(Lm,null,a.a.createElement(Od,{size:"big",name:"plus",color:"blue",disabled:!u,onClick:function(){return e(function(t){io(t,"tasks[length]",{from:new Date(i).toISOString(),text:u,status:"ACTIVE",order:t.tasks&&t.tasks.length||0})},{onCompleted:function(t){var e=t.appoint;console.log("appoint > ",e)}})}}),a.a.createElement(Xd,{label:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430",inputWidth:"257px",type:"textarea",value:u,onChange:function(t){return s(t)},debouncedWrite:!0}))}function Tm(){var t=Object(v.a)(["\n\tmargin: 0;\n\tpadding: 1em 1em 1em 55px;\n\tdisplay: flex;\n"]);return Tm=function(){return t},t}var $m=At.b.h4(Tm());function Rm(t){var e=t.details,n=e.appoint,o=e.upsertAnyAppoint,i=e.upsertAppoint,c=t.setDetails,u=n.exec.id,s=Object(r.useContext)($n).me.person.exec.id,d=cn(ps).data,m=d&&d.tasks?function(){var t=km()(d.tasks,"appoint.exec.id");return t[u]=t[u]||[],t[u].push({isNew:!0,appoint:n}),t}():{};console.log("tasksByExec > ",m);var f=Object.keys(m);return a.a.createElement(a.a.Fragment,null,a.a.createElement(wd,{setDetails:c,title:"\u0417\u0430\u0434\u0430\u0447\u0438"}),a.a.createElement(ge,{h:"calc(100% - 47px)",oy:"scroll"},f.length?a.a.createElement(a.a.Fragment,null,a.a.createElement($m,null,"\u041c\u043e\u0438 \u0437\u0430\u0434\u0430\u0447\u0438"),f.filter(function(t){return t!==s}).map(function(t){var e=m[t];return console.log("tasks > ",e),console.log("tasks[0].appoint.exec.person.amoName > ",e[0].appoint.exec.person.amoName),a.a.createElement("div",{key:t},a.a.createElement($m,null,e[0].appoint.exec.person.amoName),e.map(function(t){return t.isNew?a.a.createElement(Nm,{key:Pe()(),task:t,upsertAppoint:i}):a.a.createElement(Bm,{key:t.id,task:t,upsertAppoint:function(n,r){return o(Object(l.a)({},t.appoint,{tasks:e}),n,r)}})}))})):a.a.createElement(em.a,{active:!0},a.a.createElement(Vi.a,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430.."))))}function Am(){var t=Object(v.a)(["\n  position: absolute;\n  z-index: 12;\n  top: 36px;\n  right: 0;\n  width: ",";\n  height: calc(100% - 36px);\n\tbackground-color: rgba(255,255,255,1);\n\tbox-shadow: 0 0 20px rgba(34,36,38,.15);\n"]);return Am=function(){return t},t}var zm=Object(At.b)(Le.b.div({enter:{x:0,transition:{ease:"easeInOut"}},exit:{x:"100%",transition:{ease:"easeInOut"}}}))(Am(),function(t){return["CreateComOffer","createTask","tasks"].includes(t.type)?"470px":"600px"}),Vm=a.a.createContext(),Wm=Vm,Qm=function(t){var e=t.children,n=Object(r.useState)(null),o=Object(qe.a)(n,2),i=o[0],c=o[1],l=(i||{}).type,u=Object(r.useMemo)(function(){return{setDetails:c}},[]);return a.a.createElement(Vm.Provider,{value:u},a.a.createElement(Le.a,null,i&&a.a.createElement(zm,{key:"1",type:l},"Org"===l?a.a.createElement(tm,{details:i,setDetails:c}):"CreateComOffer"===l?a.a.createElement(am,{details:i,setDetails:c}):"tasks"===l?a.a.createElement(Rm,{details:i,setDetails:c}):"createTask"===l?a.a.createElement(om,{details:i,setDetails:c}):"SelectExec"===l?a.a.createElement(xm,{details:i,setDetails:c}):null)),e)};function Hm(){var t=Object(v.a)(["\n  .dropdown {\n    width: 30px;\n    text-align: center;\n  }\n  .icon {\n    margin: 0;\n    color: rgba(50,50,50,.87);\n  }\n  transition: background .3s ease;\n  :hover {\n    background: rgba(0,0,0,.12);\n    .icon {\n      opacity: 1 !important;\n    }\n  }\n"]);return Hm=function(){return t},t}var Km=At.b.div(Hm()),Um=function(t){var e=t.children;return a.a.createElement(Km,null,a.a.createElement(Xt.a,{icon:{name:"bars",link:!0},direction:"left"},a.a.createElement(Xt.a.Menu,null,e)))};function _m(){var t=Object(v.a)(["\n  display: none;\n  margin-left: auto;\n  ",":hover & {\n    display: unset;\n  }\n"]);return _m=function(){return t},t}function Gm(){var t=Object(v.a)(["\n  ",":hover & {\n    width: '80px';\n    font-weight: bold;\n  }\n"]);return Gm=function(){return t},t}function Xm(){var t=Object(v.a)(["\n  display: flex;\n"]);return Xm=function(){return t},t}var Ym=At.b.div(Xm()),Jm=Object(At.b)(ge)(Gm(),Ym),Zm=Object(At.b)(ge)(_m(),Ym),tf=a.a.memo(function(t){var e=t.dealId,n=t.org,o=n.id,i=n.name,c=n.inn,l=t.setDetails,u=Object(r.useContext)(Ye).highlightFolder,s=ln(La,{variables:{orgId:o},successMsg:"\u041f\u043e\u0447\u0442\u043e\u0432\u043e\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043e",errMsg:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0433\u043e \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u044f",mark:"Org createPostEnvelopeAddressInsert"}),d=Object(qe.a)(s,1)[0];return a.a.createElement(Ym,null,a.a.createElement(Jm,{ov:"hidden",to:"ellipsis",whs:"nowrap",pos:"relative",pl:"6px"},i),a.a.createElement(Zm,null,a.a.createElement(Um,null,a.a.createElement(Xt.a.Item,{icon:"folder",text:"\u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u0442\u044c \u043f\u0430\u043f\u043a\u0443",onClick:function(){return u({orgId:o})}}),a.a.createElement(Xt.a.Item,{icon:"newspaper outline",text:"\u0420\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u044b",onClick:function(){return l({orgId:o,type:"Org"})}}),a.a.createElement(Xt.a.Item,{icon:"file alternate",text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u041a\u041f",onClick:function(){return l({dealId:e,type:"CreateComOffer"})}}),a.a.createElement(Xt.a.Item,{icon:"file alternate outline",text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440",onClick:function(){return l({orgId:o,type:"Org",section:"contract"})},disabled:!c}),a.a.createElement(Xt.a.Item,{icon:"mail",text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u043e\u0435 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435",onClick:function(){return d()}}))))}),ef=function(t){var e=t.deal,n=t.batch,o=n.id,i=n.isNew,c=t.model,l=(c=void 0===c?{}:c).name,u=t.upsertDeal,s=e.batches,d=Object(r.useRef)(null),m=Object(r.useState)(!1),f=Object(qe.a)(m,2),p=f[0],b=f[1];return Object(r.useEffect)(function(){return p&&d.current&&d.current.focus()||void 0}),p?a.a.createElement(Bd,{ref:d,placeholder:"\u041d\u043e\u0432\u043e\u0435 \u0418\u0437\u0434\u0435\u043b\u0438\u0435",value:l||"",onChange:function(t){return""!==t&&u([i?"batches[length]":"batches[id=".concat(o,"].model"),i?{qty:1,sort:s.length,model:{name:t}}:{name:t}])},onBlur:function(){return b(!1)}}):i?a.a.createElement(Oe,{link:!0,name:"plus",onClick:function(){return b(!0)}}):a.a.createElement(ge,{ov:"hidden",to:"ellipsis",fw:"bold",onClick:function(){return b(!0)}},l)};function nf(){var t=Object(v.a)(["\n  width: 40px;\n"]);return nf=function(){return t},t}var rf=At.b.input(nf()),af=function(t){t.deal;var e=t.batch,n=e.id,o=e.qty,i=t.upsertDeal,c=Object(r.useRef)(null),l=Object(r.useState)(!1),u=Object(qe.a)(l,2),s=u[0],d=u[1];Object(r.useEffect)(function(){return s&&c.current&&c.current.focus()||void 0});var m=Object(r.useState)(o),f=Object(qe.a)(m,2),p=f[0],b=f[1];return s?a.a.createElement(rf,{ref:c,placeholder:"1",value:p,onChange:function(t){var e=t.target.value;return b(e)},onBlur:Object(an.a)(rn.a.mark(function t(){return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p===o){t.next=3;break}return t.next=3,i(["batches[id=".concat(n,"].qty"),p]);case 3:d(!1);case 4:case"end":return t.stop()}},t)}))}):a.a.createElement(ge,{pl:"4px",onClick:function(){return d(!0)}},p," \u0448\u0442")};function of(t){var e=t.value,n=t.isAuto,o=t.type,i=t.onChange,c=t.onAutoEnable,l=Object(r.useRef)(null),u=Object(r.useState)(!1),s=Object(qe.a)(u,2),d=s[0],m=s[1];return Object(r.useEffect)(function(){return d&&l.current&&l.current.focus()||void 0}),d?a.a.createElement(Bd,{ref:l,placeholder:"0",value:e||"",onChange:function(t){return i(t)},onBlur:function(){return m(!1)}}):a.a.createElement(ge,{pl:"2px",onClick:function(){return m(!0)}},!1===n&&a.a.createElement(Oe,{link:!0,activeColor:"red",name:"hand paper",size:"small",fl:"left",m:"2px auto 0 1px",color:"grey",onClick:function(t){t.stopPropagation(),c()}}),"currency"===o?!1!==n&&0===e?"- \u20bd":pr(e):"labor"===o?!1===n||e?"- /"+e+" \u0447":"- / - \u0447 ":e)}function cf(){var t=Object(v.a)(["\n  display: flex;\n"]);return cf=function(){return t},t}var lf=At.b.div(cf());function uf(t){var e=t.bpStat,n=t.budgetMode,r=t.upsertParent,o=t.hideLaborCell,i=e||{},c=i.autoPlanCost,l=i.autoPlanLabor,u=i.autoPlanRevenue,s=i.factCost,d=i.factLabor,m=i.factRevenue,f=i.planCost,p=i.planLabor,b=i.planRevenue;return a.a.createElement(lf,null,!o&&a.a.createElement(ge,{w:"90px",pl:"2px",c:d||p?void 0:"rgba(34,36,38,0.6)",bl:"1px solid rgba(34,36,38,0.15)"},a.a.createElement(of,{type:"labor",value:p,isAuto:l,onChange:function(t){r(function(e){io(e,"bpStat.planLabor",t),io(e,"bpStat.autoPlanLabor",!1,!0)})},onAutoEnable:function(){r(function(t){io(t,"bpStat.autoPlanLabor",!0)})}})),n&&a.a.createElement(a.a.Fragment,null,a.a.createElement(ge,{w:"90px",pr:"2px",c:m||b?void 0:"rgba(34,36,38,0.6)",ta:"right",bl:"1px solid rgba(34,36,38,0.15)"},a.a.createElement(of,{type:"currency",value:b,isAuto:u,onChange:function(t){r(function(e){io(e,"bpStat.planRevenue",t),io(e,"bpStat.autoPlanRevenue",!1,!0)})},onAutoEnable:function(){r(function(t){io(t,"bpStat.autoPlanRevenue",!0)})}})),a.a.createElement(ge,{w:"90px",pr:"2px",c:s||f?void 0:"rgba(34,36,38,0.6)",ta:"right",bl:"1px solid rgba(34,36,38,0.15)"},a.a.createElement(of,{type:"currency",value:f,isAuto:c,onChange:function(t){r(function(e){io(e,"bpStat.planCost",t),io(e,"bpStat.autoPlanCost",!1,!0)})},onAutoEnable:function(){r(function(t){io(t,"bpStat.autoPlanCost",!0)})}})),a.a.createElement(ge,{w:"500px",bl:"1px solid rgba(34,36,38,0.15)"},"..")))}function sf(){var t=Object(v.a)(["\n  :hover {\n    color: #9f3a38 !important;\n    .icon {\n      color: #9f3a38 !important;\n    }\n  }\n"]);return sf=function(){return t},t}function df(){var t=Object(v.a)(["\n  display: none;\n  margin-left: auto;\n  ",":hover & {\n    display: unset;\n  }\n"]);return df=function(){return t},t}function mf(){var t=Object(v.a)(["\n  position: relative;\n  /* width: 100%; */\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  /* ",":hover & {\n    ","\n    ","\n  } */\n"]);return mf=function(){return t},t}function ff(){var t=Object(v.a)(["\n  display: flex;\n"]);return ff=function(){return t},t}var pf=Object(At.b)(ge)(ff()),bf=At.b.div(mf(),pf,function(t){return!t.isNew&&"width: 140px;"},function(t){return!t.isNew&&t.isMachiningClass&&"width: 140px;"}),gf=At.b.div(df(),pf),vf=Object(At.b)(Xt.a.Item)(sf());function hf(t){var e=t.modelId,n=t.proc,o=t.upsertBatch,i=t.deleteElement,c=n.isNew,l=n.name,u=Object(r.useRef)(null),s=Object(r.useState)(!1),d=Object(qe.a)(s,2),m=d[0],f=d[1];return Object(r.useEffect)(function(){return m&&u.current&&u.current.focus()||void 0}),m?a.a.createElement(Bd,{ref:u,placeholder:"\u041d\u043e\u0432\u044b\u0439 \u0442\u0435\u0445\u043f\u0440\u043e\u0446\u0435\u0441\u0441",value:l||"",onChange:function(t){o(function(n){io(n,"procs[0]",{name:t,modelId:e})})},onBlur:function(){return f(!1)}}):c?a.a.createElement(Qt.a,{link:!0,name:"plus",onClick:function(){return f(!0)}}):a.a.createElement(pf,{w:"170px"},a.a.createElement(bf,null,l),a.a.createElement(gf,null,a.a.createElement(Um,null,a.a.createElement(vf,{icon:"trash",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:i}))))}function Ef(t){var e=t.path,n=t.isNewOp,o=t.opClass,i=t.opType,c=(i=void 0===i?{}:i).id,u=i.name,s=(i.laborPrice,t.upsertBatch),d=Object(r.useContext)(Ed).opTypes,m=Object(r.useRef)(null),f=Object(r.useState)(!1),p=Object(qe.a)(f,2),b=p[0],g=p[1],v="MACHINING"===o;return Object(r.useEffect)(function(){return b&&m.current&&m.current.focus()||void 0}),b?a.a.createElement(Rd,{ref:m,value:c,options:d.filter(function(t){return t.opClass===o}),onChange:function(t){return s(function(n){var r=d.find(function(e){return e.id===t}).laborPrice;io(n,e,Object(l.a)({opTypeId:t},r&&{laborPrice:r}))})},onBlur:function(){return g(!1)}}):n?a.a.createElement(Oe,{ml:v?"6px":void 0,c:"rgba(50,50,50,.87)",link:!0,name:"plus",onClick:function(){return g(!0)}}):a.a.createElement(ge,{ov:"hidden",to:"ellipsis",pl:v?"6px":void 0},u)}var yf=function(t){var e=t.basePath,n=t.dealLabor,o=t.upsertBatch,i=Object(r.useRef)(null),c=Object(r.useState)(!1),l=Object(qe.a)(c,2),u=l[0],s=l[1];return Object(r.useEffect)(function(){return u&&i.current&&i.current.focus()||void 0}),u?a.a.createElement(Bd,{ref:i,placeholder:"0",value:n||"",onChange:function(t){o(function(n){io(n,"".concat(e,"dealLabor"),t)})},onBlur:function(){return s(!1)}}):a.a.createElement(ge,{pl:"4px",onClick:function(){return s(!0)}},n," \u0447")};function Of(t){var e=t.basePath,n=t.appoint,o=(t.opIndex,t.opType),i=o.id,c=o.laborCost,u=t.upsertBatch,s=n.isNew,d=n.exec,m=(d=void 0===d?{}:d).person,f=((m=void 0===m?{}:m).id,m.amoName),p=Object(r.useContext)(Wm).setDetails,b=Object(r.useState)(!1),g=Object(qe.a)(b,2),v=g[0],h=g[1];return a.a.createElement(ge,{ov:"hidden",to:"ellipsis",pl:"6px"},s?a.a.createElement(Oe,{c:v?"green":"rgba(50,50,50,.87)",link:!0,name:"plus",activeColor:"green",onClick:function(){h(!0),p({type:"SelectExec",opTypeId:i,onSubmit:function(t){u(function(n){io(n,e+"appoints[length]",Object(l.a)({execId:t},c&&{laborCost:c}))})}})}}):f)}function jf(){var t=Object(v.a)(["\n\n"]);return jf=function(){return t},t}function xf(){var t=Object(v.a)(["\n  width: 255px;\n  padding-left: 6px;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tbox-sizing: content-box;\n  color: rgba(0,0,0,.68);\n\t/* vertical overlay */\n\t:hover {\n\t\t/* position: absolute; */\n\t\t/* top: 1px; */\n\t\t/* left: -4px; */\n\t\tz-index: 1;\n\t\toverflow: unset;\n\t\twhite-space: normal;\n\t\t/* background-color: white; */\n\t\t/* border: 5px solid rgb(242,242,242); */\n    border-top: none;\n\t}\n"]);return xf=function(){return t},t}function wf(){var t=Object(v.a)(["\n  display: flex;\n  .taskControlsContainer {\n    border-right: 1px solid rgba(34,36,38,0.15);\n    transform: translateX(-100%);\n  }\n  :hover {\n    .taskControlsContainer {\n      transform: translateX(0);\n    }\n    .taskControls {\n      opacity: 1;\n    }\n  }\n"]);return wf=function(){return t},t}function kf(){var t=Object(v.a)(["\n  display: flex;\n  position: relative;\n  width: 100%;\n  border-top: 1px solid rgba(34,36,38,0.15);\n  min-height: calc(1.5em + 1px);\n"]);return kf=function(){return t},t}var Cf=At.b.div(kf()),Ff=At.b.div(wf()),If=At.b.div(xf());At.b.div(jf());function Sf(t){var e=t.task,n=e.id,r=e.text,o=e.order,i=t.upsertAppoint;return a.a.createElement(Cf,null,a.a.createElement(Ff,null,a.a.createElement(If,null,o+1+". "+r),a.a.createElement(Dm,{taskId:n,upsertAppoint:i})))}function Df(){var t=Object(v.a)(["\n  :hover {\n    color: #9f3a38 !important;\n    .icon {\n      color: #9f3a38 !important;\n    }\n  }\n"]);return Df=function(){return t},t}function qf(){var t=Object(v.a)(["\n  display: none;\n  margin-left: auto;\n  ",":hover & {\n    display: unset;\n  }\n"]);return qf=function(){return t},t}function Mf(){var t=Object(v.a)(["\n  width: 100%;\n  ",":hover & {\n    width: 139px;\n  }\n"]);return Mf=function(){return t},t}function Bf(){var t=Object(v.a)(["\n  display: flex;\n"]);return Bf=function(){return t},t}function Pf(){var t=Object(v.a)(["\n  display: flex;\n  width: 170px;\n"]);return Pf=function(){return t},t}function Lf(){var t=Object(v.a)(["\n  position: relative;\n  width: 100%;\n  :not(:last-child) {\n    border-bottom: 1px solid rgba(34,36,38,0.15);\n  }\n"]);return Lf=function(){return t},t}var Nf=At.b.div(Lf()),Tf=At.b.div(Pf()),$f=At.b.div(Bf()),Rf=Object(At.b)(ge)(Mf(),Tf),Af=At.b.div(qf(),Tf),zf=Object(At.b)(Xt.a.Item)(Df());function Vf(t){var e=t.basePath,n=t.appoint,o=t.op,i=t.opIndex,c=t.upsertBatch,l=t.budgetMode,u=o.opType,s=n.id,d=n.isNew,m=n.tasks,f=n.bpStat,p=Object(r.useContext)(Wm).setDetails,b=ln(xs),g=Object(qe.a)(b,1)[0],v=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return console.log("options > ",n)||g({variables:{input:Object(Me.a)(no(t),e)},options:n})},h=function(t,e){return v(n,t,e)};return a.a.createElement(a.a.Fragment,null,a.a.createElement(Nf,null,a.a.createElement($f,null,a.a.createElement(Tf,null,a.a.createElement(Rf,{whs:"nowrap",to:"ellipsis",pos:"relative"},a.a.createElement(Of,{basePath:e,appoint:n,opIndex:i,opType:u,upsertBatch:c})),!d&&a.a.createElement(Af,null,a.a.createElement(Um,null,a.a.createElement(zf,{icon:"remove",text:"\u041e\u0442\u043a\u0440\u0435\u043f\u0438\u0442\u044c",onClick:function(){return c(function(t){io(t,"".concat(e,"appoints[id=").concat(s,"]"),{})})}}),a.a.createElement(Xt.a.Item,{icon:"plus",text:"\u0417\u0430\u0434\u0430\u0447\u0430",onClick:function(){return p({appoint:n,upsertAppoint:h,upsertAnyAppoint:v,type:"tasks"})}})))),!d&&a.a.createElement(uf,{bpStat:f,budgetMode:l,upsertParent:h})),m&&m.map(function(t){return a.a.createElement(Sf,{key:t.id,task:t,upsertAppoint:h})})))}function Wf(){var t=Object(v.a)(["\n  :hover {\n    color: #9f3a38 !important;\n    .icon {\n      color: #9f3a38 !important;\n    }\n  }\n"]);return Wf=function(){return t},t}function Qf(){var t=Object(v.a)(["\n  display: none;\n  margin-left: auto;\n  ",":hover & {\n    display: unset;\n  }\n"]);return Qf=function(){return t},t}function Hf(){var t=Object(v.a)(["\n  position: relative;\n  /* width: 100%; */\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  ",":hover & {\n    ","\n    ","\n  }\n"]);return Hf=function(){return t},t}function Kf(){var t=Object(v.a)(["\n  display: flex;\n"]);return Kf=function(){return t},t}function Uf(){var t=Object(v.a)(["\n  display: flex;\n"]);return Uf=function(){return t},t}var _f=At.b.div(Uf()),Gf=Object(At.b)(ge)(Kf()),Xf=At.b.div(Hf(),Gf,function(t){return!t.isNew&&"width: 140px;"},function(t){return!t.isNew&&t.isMachiningClass&&"width: 140px;"}),Yf=At.b.div(Qf(),Gf),Jf=Object(At.b)(Xt.a.Item)(Wf()),Zf=function(t){var e=t.basePath,n=t.op,r=t.opClass,o=t.opIndex,i=t.upsertBatch,c=t.deleteElement,l=t.budgetMode,u=n.id,s=n.isNew,d=n.appoints,m=n.opType,f=n.dealLabor,p=e.endsWith("proc.");return a.a.createElement(_f,null,a.a.createElement(Gf,{d:"flex",w:p?"125px":"170px"},a.a.createElement(Xf,{isNew:s,isMachiningClass:p},a.a.createElement(Ef,{path:e+(p?"ops[length]":"op"),opType:m,opClass:r,isNewOp:s,upsertBatch:i})),!s&&a.a.createElement(Yf,null,a.a.createElement(Um,null,a.a.createElement(Jf,{icon:"trash",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:p?function(){return i(function(t){io(t,e+"ops[id=".concat(u,"]"),{})})}:c})))),!s&&p&&a.a.createElement(ge,{w:"45px",bl:"1px solid rgba(34,36,38,0.15)"},a.a.createElement(yf,{basePath:"".concat(e,"ops[id=").concat(u,"]."),dealLabor:f,opIndex:o,upsertBatch:i})),!s&&a.a.createElement(ge,{bl:"1px solid rgba(34,36,38,0.15)"},[].concat(Object(nr.a)(d),[{id:Pe()(),isNew:!0}]).map(function(t,r){return a.a.createElement(Vf,{key:t.id,basePath:e+(p?"ops[id=".concat(u,"]."):"op."),appoint:t,appointIndex:r,op:n,opIndex:o,upsertBatch:i,budgetMode:l})})))};function tp(){var t=Object(v.a)(["\n  :not(:last-child) {\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\n\t}\n  background: rgba(0,0,0,.05);\n"]);return tp=function(){return t},t}var ep=At.b.div(tp()),np=function(t){var e=t.basePath,n=t.ops,r=t.upsertBatch,o=t.budgetMode;return[].concat(Object(nr.a)(n),[{id:Pe()(),isNew:!0}]).map(function(t,n){return a.a.createElement(ep,{key:t.id},a.a.createElement(Zf,{basePath:e,op:t,opClass:"MACHINING",opIndex:n,upsertBatch:r,budgetMode:o}))})};function rp(){var t=Object(v.a)(["\n  width: 100%;\n  border-bottom: 1px solid rgba(34,36,38,0.15);\n  line-height: 1.5em !important;\n"]);return rp=function(){return t},t}var ap=Object(At.b)(ge)(rp());function op(t){var e=t.element,n=e.id,r=e.op,o=e.proc,i=t.upsertBatch,c=t.deleteElement,l=t.budgetMode;return a.a.createElement(ap,null,r&&a.a.createElement(Zf,{op:r,opClass:"SURVEY",basePath:"elements[id=".concat(n,"]."),upsertBatch:i,deleteElement:c,budgetMode:l}),o&&a.a.createElement(a.a.Fragment,null,a.a.createElement(hf,{proc:o,upsertBatch:i,deleteElement:c}),!o.isNew&&a.a.createElement(np,{basePath:"elements[id=".concat(n,"].proc."),ops:o.ops,upsertBatch:i,budgetMode:l})))}function ip(t){var e=t.modelId,n=t.opClass,o=t.upsertBatch,i=t.newElementIndex,c=Object(r.useContext)(Ed).opTypes,u=Object(r.useRef)(null),s=Object(r.useRef)(null),d=Object(r.useRef)(null),m=Object(r.useState)(!1),f=Object(qe.a)(m,2),p=f[0],b=f[1],g=Object(r.useState)(""),v=Object(qe.a)(g,2),h=v[0],E=v[1];Object(r.useEffect)(function(){return p&&u.current&&u.current.focus()||void 0}),Object(r.useEffect)(function(){return!!h&&s.current&&s.current.focus()||void 0}),Object(r.useEffect)(function(){return!!h&&d.current&&d.current.focus()||void 0});var y=function(t){var e=c.find(function(e){return e.id===t}).laborPrice;o(["elements[length]",{op:Object(l.a)({opTypeId:t},e&&{laborPrice:e}),sort:i}])};return p?a.a.createElement(Rd,{ref:u,options:[{id:"op",name:"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f"},{id:"supplier",name:"\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a"},{id:"proc",name:"\u0422\u0435\u0445\u043f\u0440\u043e\u0446\u0435\u0441\u0441"}],onChange:function(t){if(b(!1),"supplier"===t)return y(c.find(function(t){return"SUPPLIER"===t.opClass}).id);E(t)},onBlur:function(){return b(!1)}}):"op"===h?a.a.createElement(Rd,{ref:s,options:c.filter(function(t){return t.opClass===n}),undefinedOptionName:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044e",onChange:function(t){return y(t)},onBlur:function(){return E("")}}):"proc"===h?a.a.createElement(Bd,{ref:d,placeholder:"\u041d\u043e\u0432\u044b\u0439 \u0442\u0435\u0445\u043f\u0440\u043e\u0446\u0435\u0441\u0441",onChange:function(t){return o(["elements[length]",{proc:{name:t,modelId:e},sort:i}])},onBlur:function(){return E("")}}):a.a.createElement(Oe,{link:!0,name:"plus",c:"rgba(50,50,50,.87)",onClick:function(){return b(!0)}})}function cp(){var t=Object(v.a)(["\n  :hover {\n    .elementDragHandle {\n      opacity: 1 !important;\n    }\n  }\n"]);return cp=function(){return t},t}var lp=Object(At.b)(ge)(cp()),up=Object(Wi.sortableContainer)(function(t){var e=t.children;return a.a.createElement("div",null,e)}),sp=Object(Wi.sortableHandle)(function(){return a.a.createElement(ge,{className:"elementDragHandle",w:"19px",ml:"-19px",o:"0",c:"rgba(0,0,0,.6)",fw:"bold",ta:"center",lh:"initial",cur:"move",tr:"opacity 0.25s ease-in-out"},"::")}),dp=Object(Wi.sortableElement)(function(t){return a.a.createElement(lp,{d:"flex",z:"99"},a.a.createElement(sp,null),a.a.createElement(op,t))});function mp(t){var e=t.batch,n=t.elements,r=t.upsertBatch,o=t.modelId,i=t.budgetMode,c=lm("batch",e),l=Object(qe.a)(c,1)[0];return a.a.createElement(a.a.Fragment,null,a.a.createElement(up,{onSortEnd:function(t){var e=t.oldIndex,r=t.newIndex;e!==r&&l(["elements[id=".concat(n[e].id,"]"),{sort:r},"elements[id=".concat(n[r].id,"]"),{sort:e}])},useDragHandle:!0},n.map(function(t,e){return a.a.createElement(dp,{key:t.id,index:e,element:t,upsertBatch:r,deleteElement:function(){var e=t.id,r=["elements[id=".concat(e,"]"),{}];n.filter(function(t){return t.id!==e}).forEach(function(t,e){r=[].concat(Object(nr.a)(r),["elements[id=".concat(t.id,"]"),{sort:e}])}),l(r)},budgetMode:i})})),a.a.createElement(ge,{w:"170px"},a.a.createElement(ip,{key:Pe()(),batch:e,modelId:o,opClass:"SURVEY",upsertBatch:l,newElementIndex:n.length})))}function fp(){var t=Object(v.a)(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  display: flex;\n  justify-content: flex-end;\n  opacity: 0;\n  transition: opacity 0.25s linear;\n  ",":hover & {\n    opacity: 1;\n  }\n"]);return fp=function(){return t},t}function pp(){var t=Object(v.a)(["\n  position: relative;\n  width: 311px;\n  border-right: 1px solid rgba(34,36,38,0.15);\n"]);return pp=function(){return t},t}function bp(){var t=Object(v.a)(["\n  width: 100%;\n  border-bottom: 1px solid rgba(34,36,38,0.15);\n  line-height: 1.5em !important;\n"]);return bp=function(){return t},t}var gp=At.b.div(bp()),vp=At.b.div(pp()),hp=At.b.div(fp(),vp),Ep=a.a.memo(function(t){var e=t.deal,n=t.batch,o=t.upsertDeal,i=e.batches,c=Object(r.useContext)(Ed).budgetMode,l=ln(nd),u=Object(qe.a)(l,1)[0],s=function(t,e){return u({variables:{input:Object(Me.a)(no(n),t)},options:e})},d=Object(Me.a)(n,function(t){var e={planCost:0,planLabor:0,planRevenue:0},n=function(t,e){var n=!0,r=!1,a=void 0;try{for(var o,i=t.appoints[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var c=o.value;c.bpStat||(c.bpStat={});var l=c.bpStat,u=c.laborCost,s=l.autoPlanCost,d=l.autoPlanLabor,m=l.autoPlanRevenue;!1!==d&&(l.planLabor=t.dealLabor),!1!==s&&(u&&l.planLabor?l.planCost=u*l.planLabor:l.planCost=void 0),!1!==m&&(t.laborPrice&&t.dealLabor?l.planRevenue=t.laborPrice*t.dealLabor:l.planRevenue=void 0);for(var f=0,p=["planCost","planLabor","planRevenue"];f<p.length;f++){var b=p[f];l[b]&&(e[b]+=l[b])}}}catch(g){r=!0,a=g}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}},r=!0,a=!1,o=void 0;try{for(var i,c=t.elements[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value,u=l.op,s=l.proc;if(u&&n(u,e),s){var d=!0,m=!1,f=void 0;try{for(var p,b=s.ops[Symbol.iterator]();!(d=(p=b.next()).done);d=!0){n(p.value,e)}}catch(E){m=!0,f=E}finally{try{d||null==b.return||b.return()}finally{if(m)throw f}}}}}catch(E){a=!0,o=E}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}if(t.bpStat)for(var g=0,v=["autoPlanCost","autoPlanLabor","autoPlanRevenue"];g<v.length;g++){var h=v[g];!1!==t.bpStat[h]&&(t.bpStat["p"+h.slice(5)]=e["p"+h.slice(5)])}else t.bpStat=e}),m=d.id,f=d.bpStat,p=d.elements,b=d.model;return a.a.createElement(gp,null,a.a.createElement(ge,{d:"flex",bb:"1px solid rgba(34, 36, 38, 0.15)"},a.a.createElement(vp,null,a.a.createElement(ef,{batch:n,deal:e,model:b,upsertDeal:o}),a.a.createElement(hp,null,a.a.createElement(Oe,{link:!0,name:"trash",color:"grey",activeColor:"red",onClick:function(){var t=["batches[id=".concat(m,"]"),{}];i.filter(function(t){return t.id!==m}).forEach(function(e,n){t=[].concat(Object(nr.a)(t),["batches[id=".concat(e.id,"]"),{sort:n}])}),o(t)}}))),a.a.createElement(ge,{w:"50px"},a.a.createElement(af,{deal:e,batch:n,upsertDeal:o})),a.a.createElement(uf,{bpStat:f,upsertParent:s,budgetMode:c})),a.a.createElement(ge,{pl:"19px",bl:"1px solid rgba(34, 36, 38, 0.15)"},a.a.createElement(mp,{batch:n,elements:p,upsertBatch:s,modelId:b.id,budgetMode:c})))});function yp(){var t=Object(v.a)(["\n  :hover {\n    .dragHandle {\n      opacity: 1 !important;\n    }\n  }\n"]);return yp=function(){return t},t}var Op=Object(At.b)(ge)(yp()),jp=Object(Wi.sortableContainer)(function(t){var e=t.children;return a.a.createElement("div",null,e)}),xp=Object(Wi.sortableHandle)(function(){return a.a.createElement(ge,{className:"dragHandle",w:"32px",ml:"-32px",o:"0",c:"rgba(0,0,0,.6)",fw:"bold",ta:"center",lh:"initial",cur:"move",tr:"opacity 0.25s ease-in-out"},"::")}),wp=Object(Wi.sortableElement)(function(t){return a.a.createElement(Op,{d:"flex",z:"99"},a.a.createElement(xp,null),a.a.createElement(Ep,t))});function kp(t){var e=t.deal,n=e.batches,r=lm("deal",e),o=Object(qe.a)(r,1)[0];return a.a.createElement(a.a.Fragment,null,a.a.createElement(jp,{onSortEnd:function(t){var e=t.oldIndex,r=t.newIndex;e!==r&&o(["batches[id=".concat(n[e].id,"]"),{sort:r},"batches[id=".concat(n[r].id,"]"),{sort:e}])},useDragHandle:!0},e.batches.map(function(t,n){return a.a.createElement(wp,{key:t.id,index:n,deal:e,batch:t,upsertDeal:o})})),a.a.createElement(ef,{key:Pe()(),batch:{isNew:!0},deal:e,upsertDeal:o}))}function Cp(){var t=Object(v.a)(["\n  display: none;\n  margin-left: auto;\n  ",":hover & {\n    display: unset;\n  }\n"]);return Cp=function(){return t},t}function Fp(){var t=Object(v.a)(["\n  ",":hover & {\n    width: 150px;\n  }\n"]);return Fp=function(){return t},t}function Ip(){var t=Object(v.a)(["\n  display: flex;\n  position: relative;\n  :not(:last-child) {\n\t\tborder-bottom: 1px solid rgba(34,36,38,0.15);\n\t}\n"]);return Ip=function(){return t},t}var Sp=At.b.div(Ip()),Dp=Object(At.b)(ge)(Fp(),Sp),qp=At.b.div(Cp(),Sp),Mp=function(t){var e=t.deal,n=e.id,o=e.amoId,i=e.name,c=Object(r.useContext)(Ye).highlightFolder;return a.a.createElement(Sp,null,a.a.createElement(Dp,{ov:"hidden",to:"ellipsis",fw:"bold"},i),a.a.createElement(qp,null,a.a.createElement(Um,null,a.a.createElement(Xt.a.Header,null,a.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://kolomnatutamailcom.amocrm.ru/leads/detail/".concat(o)},"AmoCRM")),a.a.createElement(Xt.a.Divider,null),a.a.createElement(Xt.a.Item,{icon:"folder",text:"\u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u0442\u044c \u043f\u0430\u043f\u043a\u0443",onClick:function(){return c({dealId:n})}}))))};function Bp(){var t=Object(v.a)(["\n  display: flex;\n  width: 100%;\n  line-height: 1.5em;\n  :hover {\n    background: rgba(0,0,0,.025);\n    color: rgba(0,0,0,.95);\n  }\n"]);return Bp=function(){return t},t}var Pp=At.b.div(Bp()),Lp=a.a.memo(function(t){!function(t){var e=Object(r.useRef)(t);Object(r.useEffect)(function(){var n=Object.entries(t).reduce(function(t,n){var r=Object(qe.a)(n,2),a=r[0],o=r[1];return e.current[a]!==o&&(t[a]=[e.current[a],o]),t},{});Object.keys(n).length>0&&console.log("Changed props:",n),e.current=t})}(t);var e=t.isFirstRow,n=t.deal,o=t.budgetMode,i=n.amoId,c=n.date,l=n.batches,u=n.status,s=Object(r.useContext)(Wm).setDetails;return a.a.createElement(Pp,null,a.a.createElement(ge,{w:"max-content",pos:"relative",pe:"auto"},a.a.createElement(ge,{d:"flex",bt:e?void 0:"1px solid rgb(125,125,126)",w:"max-content",pe:"auto"},a.a.createElement(ge,{w:"22px",m:"5px",bs:"border-box",bc:u.color}),a.a.createElement(ge,{w:"80px"},i),a.a.createElement(ge,{w:"90px"},c),a.a.createElement(ge,{w:"170px",whs:"nowrap",to:"ellipsis",pos:"relative"},a.a.createElement(Mp,{deal:n,setDetails:s})),a.a.createElement(ge,{w:"111px"},n.org&&a.a.createElement(tf,{dealId:n.id,org:n.org,setDetails:s})),l.length?a.a.createElement(uf,{budgetMode:o,hideLaborCell:!0}):a.a.createElement(ge,{w:"680px"})),a.a.createElement(ge,{pos:l.length?void 0:"absolute",t:l.length?void 0:"0",l:l.length?void 0:"482px",w:l.length?void 0:"260px",pl:l.length?"32px":"5px",bt:l.length?"1px solid rgba(34,36,38,0.35)":void 0},a.a.createElement(kp,{deal:n}))))});function Np(){var t=Object(v.a)(["\n  position: fixed;\n  height: 100%;\n  background: white;\n  z-index: -1;\n  transition: width .5s ease;\n"]);return Np=function(){return t},t}function Tp(){var t=Object(v.a)(["\n  position: fixed;\n  display: flex;\n  /* width: 542px; */\n  padding: 0 0 0 32px;\n  line-height: 1.5em;\n  font-weight: bold;\n  background: rgb(233, 234, 235);\n  border-top: 1px solid #d4d4d5;\n  border-bottom: 1px solid #d4d4d5;\n  pointer-events: auto;\n  z-index: 15;\n  transition: width .5s ease;\n"]);return Tp=function(){return t},t}var $p=Object(At.b)(ge)(Tp()),Rp=Object(At.b)(ge)(Np());function Ap(t){var e=t.deals,n=Object(r.useContext)(Ed).budgetMode;return a.a.createElement(ge,{pos:"absolute",w:"100%",h:"100%",pe:"none",z:"10"},a.a.createElement($p,{w:n?"1142px":"472px"},a.a.createElement(ge,{w:"80px"},"#"),a.a.createElement(ge,{w:"90px"},"\u0414\u0430\u0442\u0430"),a.a.createElement(ge,{w:"170px"},"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),a.a.createElement(ge,{w:"100px"},"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442")),a.a.createElement(Rp,{w:n?"1142px":"372px"}),a.a.createElement(ge,{h:"calc(100% - 23px)",mt:"23px"},e&&e.map(function(t,e){return a.a.createElement(Lp,{key:t.id,isFirstRow:0===e,deal:t,budgetMode:n})}),a.a.createElement(ge,{h:"400px",w:"472px",bc:"white"})))}function zp(t){var e=t.title,n=t.titleLinkTo,r=t.refetchDeals,o=t.budgetMode,i=t.setBudgetMode,c=ln(vd,{successMsg:"\u0421\u0434\u0435\u043b\u043a\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u0441 AmoCRM",errMsg:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u0434\u0435\u043b\u043e\u043a \u0441 AmoCRM"}),l=Object(qe.a)(c,2),u=l[0],s=l[1].loading;return a.a.createElement(Xn,{title:e,titleLinkTo:n},a.a.createElement(Oe,{link:!0,name:"ruble sign",size:"large",mr:"9px",activeColor:"green",active:o,onClick:function(){return i(!o)}}),a.a.createElement(xe,{compact:!0,circular:!0,menu:!0,w:"170px",ml:"0",ta:"left",activeColor:"blue",onClick:Object(an.a)(rn.a.mark(function t(){return rn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:r();case 3:case"end":return t.stop()}},t)}))},a.a.createElement(Oe,{name:"refresh",color:s?"blue":void 0,loading:s}),s?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..":"\u0421\u0434\u0435\u043b\u043a\u0438 AmoCRM"))}function Vp(){var t=Object(v.a)(["\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(135deg,rgba(0,0,0,.01) 0%,rgba(200,201,202,1) 100%);\n  box-shadow: inset 0 0 20px rgba(34,36,38,.15);\n  z-index: -1;\n  transition: all 0.5s ease;\n"]);return Vp=function(){return t},t}var Wp=Object(At.b)(ge)(Vp());function Qp(t){var e=t.budgetMode;return a.a.createElement(Wp,{l:e?"1142px":"472px",onClick:function(){return console.log("container here!")}})}function Hp(){var t=Object(v.a)(["\n  display: flex;\n  width: 100%;\n  height: 23px;\n  background: rgb(233, 234, 235);\n  border-top: 1px solid #d4d4d5;\n  border-bottom: 1px solid #d4d4d5;\n"]);return Hp=function(){return t},t}var Kp=At.b.div(Hp());function Up(t){var e=t.days;return a.a.createElement(Kp,{onClick:function(){return console.log("plotHeader here!")}},e.map(function(t){var e=t.key,n=t.day;return a.a.createElement(ge,{key:e,w:"48px",c:"rgba(0,0,0,.6)",ta:"center"},n)}))}function _p(){var t=Object(v.a)(["\n  position: absolute;\n  left: -672px;\n  width: 2016px;\n  height: calc(100% - 36px);\n"]);return _p=function(){return t},t}function Gp(){var t=Object(v.a)(["\n  position: fixed;\n  left: 472px;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 5;\n"]);return Gp=function(){return t},t}var Xp=Object(At.b)(ge)(Gp()),Yp=Object(At.b)(Le.b.div({draggable:"x"}))(_p());function Jp(t){t.budgetMode;for(var e=new Date((new Date).setDate((new Date).getDate()-18)),n=Math.floor((Date.now()-e.setHours(0,0,0,0))/18e5),r=[],o=new Date(e),i=0;i<42;o.setDate(o.getDate()+1),i++)r.push({key:i,day:o.getDate(),isWeekend:[6,0].includes(o.getDay())});return a.a.createElement(Xp,null,a.a.createElement(Yp,{onClick:function(){return console.log("plot here!")}},a.a.createElement(Up,{days:r}),r.filter(function(t){return t.isWeekend}).map(function(t){var e=t.key;return a.a.createElement(ge,{key:e,pos:"absolute",t:"0",l:"".concat(48*e,"px"),w:"48px",h:"100%",bc:"rgba(0,0,0,.07)"})}),a.a.createElement(ge,{pos:"absolute",t:"0",l:"".concat(n,"px"),w:"1px",h:"100%",bc:"teal"})))}function Zp(){var t=Object(v.a)(["\n  position: fixed;\n  height: 23px;\n  overflow: hidden;\n  z-index: 20;\n  background: rgb(233,234,235);\n  border-top: 1px solid #d4d4d5;\n  border-bottom: 1px solid #d4d4d5;\n  transition: width .5s ease;\n"]);return Zp=function(){return t},t}function tb(){var t=Object(v.a)(["\n  position: relative;\n  /* top: calc(36px); */\n  /* top: calc(36px + 23px); */\n  width: 100%;\n  height: calc(100% - 36px);\n  /* height: calc(100% - 36px - 23px); */\n  overflow-x: hidden;\n  overflow-y: scroll;\n  /* z-index: 1; */\n"]);return tb=function(){return t},t}var eb=At.b.div(tb());Object(At.b)(ge)(Zp());function nb(){var t=Object(r.useState)(!0),e=Object(qe.a)(t,2),n=e[0],o=e[1],i=cn(pd),c=i.loading,l=i.error,u=i.data,s=i.refetch;return a.a.createElement(a.a.Fragment,null,a.a.createElement(zp,{title:"\u0421\u0434\u0435\u043b\u043a\u0438",titleLinkTo:"/deals",refetchDeals:s,budgetMode:n,setBudgetMode:o}),a.a.createElement(Qm,null,a.a.createElement(eb,null,c?a.a.createElement(em.a,{active:!0},a.a.createElement(Vi.a,null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..")):l?"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(l.message):u&&a.a.createElement(yd,{opTypes:u.opTypes,budgetMode:n},a.a.createElement(Qp,{budgetMode:n}),a.a.createElement(Jp,{budgetMode:n}),a.a.createElement(Ap,{deals:u.deals})))))}function rb(){var t=Object(r.useContext)(Mn).refreshToken,e=cn(yn),n=e.data,o=e.loading,i=e.error;o||i||n||t(null);var c=n&&n.me;return a.a.createElement(a.a.Fragment,null,!i&&o||!c?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..":a.a.createElement($n.Provider,{value:{me:c}},a.a.createElement(Pn.a,null,a.a.createElement(Ln.a,null,a.a.createElement(Nn.a,{exact:!0,path:"/",component:Ql}),a.a.createElement(Nn.a,{path:"/pay",component:Hu}),a.a.createElement(Nn.a,{path:"/deals",component:nb}),a.a.createElement(Tn.a,{to:"/"})))))}i.a.render(a.a.createElement(function(){return a.a.createElement(c.b,{client:Rt},a.a.createElement(We,null,a.a.createElement(At.a,{theme:fe},a.a.createElement(Je,null,a.a.createElement(Bn,{apolloClient:Rt},a.a.createElement(rb,null))))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},534:function(t,e,n){t.exports=n(1065)}},[[534,1,2]]]);
//# sourceMappingURL=main.1f2a9942.chunk.js.map